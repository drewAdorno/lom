System.register("chunks:///_virtual/GuildLogView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StorageUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./GuildWarControl.ts","./RoleDataCache.ts","./GuildControl.ts","./GuildDataCache.ts","./GuildDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,s,l,d,a,r,c,u,h,f,g,v,I,p,C,m;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.ScrollView,l=t.Sprite,d=t.Label,a=t.js},function(t){r=t.ListItem},function(t){c=t.default},function(t){u=t.default},function(t){h=t.default},function(t){f=t.default},null,function(t){g=t.default},function(t){v=t.RoleDataCache},function(t){I=t.default},function(t){p=t.default},function(t){C=t.GuildEventDefine},function(t){m=t.BaseView}],execute:function(){n._RF.push({},"7935f4N/gdCb4kDlTyXg+V1","GuildLogView",void 0);var G=1,x=2,y=(t("default",function(t){function n(){var e;return(e=t.call(this)||this).tabBtns=[],e.curIndex=0,e.scroll=void 0,e.nothing=void 0,e.name="GuildLogView",e.url="ui/module/guild/GuildLogView",e}e(n,t);var l=n.prototype;return l.onInit=function(){var t=this,e=this.findChild("view/btnClose");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.close()}));for(var i=function(e){var i=c.findChild(t.node,a.formatStr("tab/scrollTab/view/content/item%s",e)),n={itemGo:i,normalGo:c.findChild(i,"normal"),selectedGo:c.findChild(i,"selected"),index:e};t.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.SetIndex(n.index)})),t.tabBtns[e]=n},n=1;n<=2;n++)i(n);this.nothing=this.findChild("view/nothing");var l=this.findChildComponent("view/scroll",s);this.scroll=this.addUIList(l,y)},l.registerUpdateHandler=function(){this.addEvent(C.GUILD_LOG_UPDATE,this.updateInfo,this)},l.onAfterOpen=function(){for(var t,e=IS(p).GetLog(),n=0,o=i(null!=e?e:[]);!(t=o()).done;){var s=t.value;s.guild_log_id>n&&(n=s.guild_log_id)}IS(I).send_29_38(n),this.SetIndex(G)},l.onBeforeClose=function(){for(var t,e=IS(v).GetRoleId(),n=IS(p).GetLog(),o=0,s=i(null!=n?n:[]);!(t=s()).done;){var l=t.value;l.log_time>o&&(o=l.log_time)}u.set("guildLogLastTime"+e,o),this.curIndex>0&&(this.tabBtns[this.curIndex].normalGo.active=!0,this.tabBtns[this.curIndex].selectedGo.active=!1,this.curIndex=0)},l.onDestroy=function(){},l.SetIndex=function(t){this.curIndex!=t&&(this.curIndex>0&&(this.tabBtns[this.curIndex].selectedGo.active=!1,this.tabBtns[this.curIndex].normalGo.active=!0),this.curIndex=t,this.tabBtns[this.curIndex].normalGo.active=!1,this.tabBtns[this.curIndex].selectedGo.active=!0,this.updateInfo())},l.updateInfo=function(){if(0!=this.curIndex)if(this.curIndex==G){var t,e=null!=(t=IS(p).GetLog().filter((function(t){return 0==configGuild_log.getDataByKey(t.type).type})))?t:[];this.scroll.datas=e,this.scroll.node.active=e.length>0,this.nothing.active=0==e.length}else if(this.curIndex==x){var i,n=null!=(i=IS(p).GetLog().filter((function(t){return 1==configGuild_log.getDataByKey(t.type).type})))?i:[];this.scroll.datas=n,this.scroll.node.active=n.length>0,this.nothing.active=0==n.length}},n}(m)),function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).txtDesc=void 0,e.txtTime=void 0,e.btn=void 0,e.new=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.new=c.findChild(this.node,"new"),this.view.loadIcon(c.findChildComponent(this.node,"new",l),"farm","zy_ui_new"),this.btn=c.findChild(this.node,"btn"),this.view.addComponentCallbackListener(this.btn,o.EventType.CLICK,(function(){t.data.boss_replay_id&&IS(g).reqGuildBossRankInfo(t.data.boss_replay_id,1)})),this.txtDesc=c.findChildComponent(this.node,"desc",d),this.txtTime=c.findChildComponent(this.node,"time",d)},n.onRender=function(t,e){var i=configGuild_log.getDataByKey(t.type);this.txtDesc.string=h.formatStr.apply(h,[i.desc].concat(t.str_list)),this.txtTime.string=f.getDateDiff(t.log_time),this.btn.active=3==t.type||4==t.type;var n=IS(v).GetRoleId(),o=u.get("guildLogLastTime"+n);this.new.active=!o||""==o||t.log_time>o},i}(r));n._RF.pop()}}}));

