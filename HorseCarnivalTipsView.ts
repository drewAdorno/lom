System.register("chunks:///_virtual/HorseCarnivalTipsView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./HorseCarnivalDataCache.ts","./BasePopupView.ts"],(function(t){"use strict";var i,e,o,n,r,s,a,h,d,l,c,g,v,f,p;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,n=t.UITransform,r=t.ScrollView,s=t.Button,a=t.Label,h=t.js},function(t){d=t.ItemGrid},function(t){l=t.ListItem},function(t){c=t.default},null,function(t){g=t.default},function(t){v=t.ActivityType},function(t){f=t.HorseCarnivalDataCache},function(t){p=t.BasePopupView}],execute:function(){var u;o._RF.push({},"35614THPZVOkJ/R7qGqGLMV","HorseCarnivalTipsView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).scroll=void 0,i.bgNode=void 0,i.bgUT=void 0,i.viewContainerNode=void 0,i.arrNode=void 0,i.arrUT=void 0,i.targetNode=void 0,i.scroll0=void 0,i.scroll1=void 0,i.scroll2=void 0,i.txtWeight1=void 0,i.txtWeight2=void 0,i.txtWeight3=void 0,i.actType=void 0,i.name="HorseCarnivalTipsView",i.url="ui/module/horsecarnival/HorseCarnivalTipsView",i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.viewContainerNode=this.findChild("view"),this.bgNode=this.findChild("view/imgBg"),this.bgUT=this.bgNode.getComponent(n),this.arrNode=this.findChild("view/imgBg/imgArr"),this.arrUT=this.arrNode.getComponent(n);var i=this.findChildComponent("view/imgBg/scroll",r);this.scroll=this.addUIList(i,C);var e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){t.close()}));var o=this.findChild("root/imgMask");this.addComponentCallbackListener(o,s.EventType.CLICK,(function(){t.close()}));var h=this.findChildComponent("root/bg/nodeDesc0/ScrollView",r);this.scroll0=this.addUIList(h,m);var d=this.findChildComponent("root/bg/nodeDesc1/ScrollView",r);this.scroll1=this.addUIList(d,m);var l=this.findChildComponent("root/bg/nodeDesc2/ScrollView",r);this.scroll2=this.addUIList(l,m),this.txtWeight1=this.findChildComponent("root/bg/nodeDesc0/txtTitle-002",a),this.txtWeight2=this.findChildComponent("root/bg/nodeDesc1/txtTitle-002",a),this.txtWeight3=this.findChildComponent("root/bg/nodeDesc2/txtTitle-002",a)},o.registerUpdateHandler=function(){},o.onAfterOpen=function(){t.prototype.onAfterOpen.call(this),this.targetNode=this.openArgs[0],this.actType=this.openArgs[1];var i=IS(g).GetActivityInfo(this.actType),e=configMount_draw.getDatas();u=0;var o=[];this.actType==v.Artifact?(this.findChild("view").active=!0,this.findChild("root").active=!1):(this.findChild("view").active=!1,this.findChild("root").active=!0);var n=0,r=0,s=0,a=[],h=[],d=[];for(var l in e)if(e.hasOwnProperty(l)){var c=e[l];c.type==i.type&&c.group_id==i.roundCfg.group_id&&(1==c.quality?(a.push(c),n+=c.weight):2==c.quality?(h.push(c),r+=c.weight):3==c.quality?(d.push(c),s+=c.weight):o.push(c),u+=c.weight)}this.txtWeight1.string=(n/u*100).toFixed(2)+"%",this.txtWeight2.string=(r/u*100).toFixed(2)+"%",this.txtWeight3.string=(s/u*100).toFixed(2)+"%",this.scroll0.datas=a,this.scroll1.datas=h,this.scroll2.datas=d,this.scroll.datas=o,this.UpdateAlign()},o.onBeforeClose=function(){},o.onDestroy=function(){},o.UpdateAlign=function(){var t=this.GetAlignCenter(),i=t.posX,e=t.posY,o=t.angleZ,n=t.arrowX,r=t.arrowY;this.viewContainerNode.setPosition(i,e),this.arrNode.setRotationFromEuler(0,0,o),this.arrNode.setPosition(n,r)},o.GetAlignCenter=function(){var t,i=this.targetNode.worldPosition,e=this.targetNode.getComponent(n),o=this.node.getComponent(n).convertToNodeSpaceAR(i),r=o.x-this.bgUT.width/2,s=o.x+this.bgUT.width/2,a=0,h=0,d=0,l=0,c=0;if((a=o.x)>=0){var g=s-360;g>0&&(c=g)}else{var v=r- -360;v<0&&(c=v)}return a-=c,t=c,o.y<0?(h=o.y+e.height/2+this.bgUT.height/2+this.arrUT.height-30,d=18-(this.bgUT.height/2+this.arrUT.height/2),l=0):(h=o.y-e.height/2-this.bgUT.height/2-this.arrUT.height+30,d=this.bgUT.height/2+this.arrUT.height/2-18,l=180),{posX:a,posY:h,angleZ:l,arrowX:t,arrowY:d}},e}(p));var C=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).txtName=void 0,i.txtValue=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){this.txtName=c.findChildComponent(this.node,"txtName",a),this.txtValue=c.findChildComponent(this.node,"txtValue",a)},o.onRender=function(t,i){var e=configGoods.getDataByKey(t.reward[0]);this.txtName.string=e.name+"*"+t.reward[1],this.txtValue.string=h.formatStr("%s%",(t.weight/u*100).toFixed(2))},e}(l),m=function(t){function o(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).nodeItem=void 0,i.txtLimit=void 0,i.txtRatio=void 0,i}i(o,t);var n=o.prototype;return n.onInit=function(){this.nodeItem=c.findChild(this.node,"itemGrid"),this.txtLimit=c.findChildComponent(this.node,"txtLimit",a),this.txtRatio=c.findChildComponent(this.node,"txtRatio",a),this.txtLimit.node.active=!1},n.onRender=function(t,i){var o=t.num;if(o>0){this.txtLimit.node.active=!0,this.txtLimit.string=GetLanguage(300160)+h.formatStr("%s/%s",o,o);var n=this.view,r=IS(f).getInfo(n.actType);if(r.get_drop&&r.get_drop.length>0)for(var s,a=e(r.get_drop);!(s=a()).done;){var l=s.value,c=l.k,g=l.v;c==t.id&&(this.txtLimit.node.active=!0,this.txtLimit.string=GetLanguage(300160)+h.formatStr("%s/%s",o-g,o))}}this.txtRatio.string=h.formatStr("%s%",(t.weight/u*100).toFixed(2)),new d(this.view,this.nodeItem).SetItemId(t.reward[0],t.reward[1])},o}(l);o._RF.pop()}}}));

