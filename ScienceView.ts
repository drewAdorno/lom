System.register("chunks:///_virtual/ScienceView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./BaseView.ts","./ItemIcon.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./AdDefine.ts","./AdModel.ts","./BagDefine.ts","./BagModel.ts","./MessageView.ts","./GuildControl.ts","./GuildDataCache.ts","./GuildDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./SdkControl.ts","./ScienceControl.ts","./ScienceDataCache.ts","./ScienceDefine.ts","./ScienceModel.ts","./UIDefine.ts"],(function(e){"use strict";var t,i,n,o,s,c,d,a,h,r,l,f,u,m,I,g,v,p,S,C,y,w,x,L,_,T,B,R,b,U,E,A,D,N,G,M,P,k,F;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.math,o=e.Button,s=e.Sprite,c=e.RichText,d=e.LabelOutline,a=e.Label,h=e.UITransform,r=e.js,l=e.Color},function(e){f=e.RedPointType},function(e){u=e.RedPointMgr},function(e){m=e.default},function(e){I=e.default},function(e){g=e.default},null,function(e){v=e.BaseView},function(e){p=e.IconAseetType},function(e){S=e.ConfigGlobal},function(e){C=e.default},function(e){y=e.AdEventDefine,w=e.ADS_TYPE},function(e){x=e.AdModel},function(e){L=e.BagEventDefine},function(e){_=e.BagModel},function(e){T=e.default},function(e){B=e.default},function(e){R=e.default},function(e){b=e.HelpType,U=e.GuildEventDefine},function(e){E=e.default},function(e){A=e.RoleDataCache},function(e){D=e.RoleEventDefine},function(e){N=e.default},function(e){G=e.default},function(e){M=e.ScienceDataCache},function(e){P=e.ScienceEventDefine},function(e){k=e.ScienceModel},function(e){F=e.PanelTabType}],execute:function(){var O;i._RF.push({},"5e0b7W26v1LL4Gr9LMx6Ono","ScienceView",void 0);var H=n.Vec3,K=n.Vec2,V=S.accelerate_goods_effect[0][0],j=S.accelerate_goods_effect[0][1],X=S.accelerate_goods_effect[1][0],W=S.accelerate_goods_effect[1][1],q=[1007,1002],z=(e("default",function(e){function i(){var t;return(t=e.call(this)||this).imgBtnUpgrade=void 0,t.imgCost=void 0,t.txtCost=void 0,t.imgCostBg=void 0,t.outlineCost=void 0,t.outLineBtnUpgrade=void 0,t.imgFrame=void 0,t.imgIcon=void 0,t.imgLevelBg=void 0,t.imgLevel=void 0,t.txtLevel=void 0,t.nodeTime=void 0,t.txtTime=void 0,t.txtName=void 0,t.nodeOne=void 0,t.txtEffectOne=void 0,t.nodeTwo=void 0,t.txtEffectCur=void 0,t.txtEffectNext=void 0,t.nodeRowItem=void 0,t.nodeRowParent=void 0,t.utContent=void 0,t.nodeContent=void 0,t.nodeInUpgrade=void 0,t.scienceRowItems=void 0,t.scienceRowInfos=void 0,t.curSelectScienceId=void 0,t.nodeBtnUpgrade=void 0,t.nodeMax=void 0,t.nodeLock=void 0,t.txtCondition=void 0,t.txtRemainTime=void 0,t.txtAccName=void 0,t.endTime=void 0,t.curCostItem=void 0,t.curCostNeedNum=void 0,t.nodeButtonParent=void 0,t.btnHelpImg=void 0,t.txtAdDesc=void 0,t.txtAdCount=void 0,t.nodeAdIcon=void 0,t.time=void 0,t.nodeResParent=void 0,t.nodeResItem=void 0,t.resItems=void 0,t.name="ScienceView",t.url="ui/module/science/ScienceView",t.fullScreen=!0,t}t(i,e);var n=i.prototype;return n.onInit=function(){var e=this;this.time=0,this.endTime=0,this.nodeResParent=this.findChild("resRoot"),this.nodeResItem=this.findChild("resRoot/resItem"),this.nodeResItem.active=!1,this.initResShow();var t=this.findChild("content/btnClose");this.addComponentCallbackListener(t,o.EventType.CLICK,(function(){e.onCloseClick()})),this.nodeBtnUpgrade=this.findChild("content/selectInfo/buttons/btnUpgrade"),this.addComponentCallbackListener(this.nodeBtnUpgrade,o.EventType.CLICK,(function(){e.onUpgradeClick()})),this.imgBtnUpgrade=this.nodeBtnUpgrade.getComponent(s),this.nodeButtonParent=this.findChild("content/selectInfo/buttons"),this.nodeMax=this.findChild("content/selectInfo/buttons/max"),this.nodeLock=this.findChild("content/selectInfo/buttons/lock"),this.txtCondition=this.findChildComponent("content/selectInfo/buttons/lock/txtCondition",c),this.outLineBtnUpgrade=this.findChildComponent("content/selectInfo/buttons/btnUpgrade/Label",d),this.imgCost=this.findChildComponent("content/selectInfo/buttons/btnUpgrade/imgIcon",s),this.txtCost=this.findChildComponent("content/selectInfo/buttons/btnUpgrade/txtCost",a),this.outlineCost=this.txtCost.node.getComponent(d),this.imgCostBg=this.findChildComponent("content/selectInfo/buttons/btnUpgrade/imgCostBg",s),this.imgFrame=this.findChildComponent("content/selectInfo/item/imgFrame",s),this.imgIcon=this.findChildComponent("content/selectInfo/item/imgIcon",s),this.addRedPoint("scienceSelect",this.findChild("content/selectInfo/item"),new K(28,30),f.Dot),this.imgLevelBg=this.findChildComponent("content/selectInfo/item/pbLevel",s),this.imgLevel=this.findChildComponent("content/selectInfo/item/pbLevel/Bar",s),this.txtLevel=this.findChildComponent("content/selectInfo/item/txtLevel",a),this.nodeTime=this.findChild("content/selectInfo/time"),this.txtTime=this.findChildComponent("content/selectInfo/time/txtTime",a),this.txtName=this.findChildComponent("content/selectInfo/txtName",a),this.nodeOne=this.findChild("content/selectInfo/effectOne"),this.txtEffectOne=this.findChildComponent("content/selectInfo/effectOne/txtEffect",a),this.nodeTwo=this.findChild("content/selectInfo/effectTwo"),this.txtEffectCur=this.findChildComponent("content/selectInfo/effectTwo/effectCur/txtEffect",a),this.txtEffectNext=this.findChildComponent("content/selectInfo/effectTwo/effectNext/txtEffect",a),this.utContent=this.findChildComponent("content/scrollScienceList/view/content",h),this.nodeContent=this.utContent.node,this.nodeRowParent=this.findChild("content/scrollScienceList/view/content/scienceBox"),this.nodeRowItem=this.findChild("content/scrollScienceList/view/content/scienceBox/box1"),this.nodeRowItem.active=!1,this.nodeInUpgrade=this.findChild("content/UpgradeState"),this.txtRemainTime=this.findChildComponent("content/UpgradeState/txtRemainTime",a),this.txtAccName=this.findChildComponent("content/UpgradeState/txtName",c);var i=this.findChild("content/UpgradeState/btnAcc");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){e.onAccClick()}));var n=this.findChild("content/UpgradeState/btnAd");this.addComponentCallbackListener(n,o.EventType.CLICK,(function(){e.onAdClick()}));var r=this.findChild("content/UpgradeState/btnHelp");this.btnHelpImg=this.findChildComponent("content/UpgradeState/btnHelp",s),this.addComponentCallbackListener(r,o.EventType.CLICK,(function(){if(IS(A).HasGuild()){var e=IS(k).getScienceTreeByType(1);IS(R).IsAskHelp(b.Science,e.type)?T.showFlyTip(GetLanguage(200252)):IS(B).send_29_29(b.Science,e.type)}else T.showFlyTip(GetLanguage(200251))})),this.txtAdDesc=this.findChildComponent("content/UpgradeState/btnAd/txtDesc",a),this.txtAdCount=this.findChildComponent("content/UpgradeState/btnAd/txtCount",a),this.nodeAdIcon=this.findChild("content/UpgradeState/btnAd/imgAd1"),this.nodeAdIcon.active=1==S.ads_icon_is_show,this.txtAdCount.node.position=1==S.ads_icon_is_show?new H(19.7,-43.7,0):new H(0,-43.7,0),this.showScienceTree()},n.initResShow=function(){var e,t=this;this.resItems=new Array;for(var i=function(i){var n=nodeInstantiate.instantiate(t.nodeResItem);n.parent=t.nodeResParent,n.active=!0,e=q[i],t.addComponentCallbackListener(n,o.EventType.CLICK,(function(){var e=m.findChild(n,"txtNum");IS(_).OpenItemTips(q[i],e)}));var c=configGoods.getDataByKey(e),d=m.findChildComponent(n,"imgIcon",s);t.loadIcon(d,"icon_item",c.icon),t.resItems.push({node:n,txtNum:m.findChildComponent(n,"txtNum",a),goodsGtid:e})},n=0;n<q.length;n++)i(n)},n.showScienceTree=function(){this.scienceRowItems={};var e=IS(k).getCacheScienceList(1);for(var t in this.scienceRowInfos={},e){var i=e[t];null==this.scienceRowInfos[i.index]&&(this.scienceRowInfos[i.index]=new Array),this.scienceRowInfos[i.index].push(i)}var n=0;for(var o in this.scienceRowInfos){n+=1;var s=nodeInstantiate.instantiate(this.nodeRowItem);s.parent=this.nodeRowParent,s.active=!0;var c=this.scienceRowInfos[o],d=new z;d.onInit(this,s,c),this.scienceRowItems[o]=d}this.utContent.height=190*n+10},n.getIndexInfoByScienceId=function(e,t){for(var i=this.scienceRowInfos[e],n=i.length,o=0;o<n;o++)if(i[o].id==t)return{index:o,length:n}},n.registerUpdateHandler=function(){this.addEvent(P.SCIENCE_TREE_UPDATE,this.onScienceTreeUpdate,this),this.addEvent(L.GOODS_INFO_UPDATE,this.onGoodsInfoUpdate,this),this.addEvent(D.ROLE_RES_UPDATE,this.onRoleResUpdate,this),this.addEvent(y.AD_INFO_UPDATE,this.onAdInfoUpdate,this),this.addEvent(U.GUILD_HELP_UPDATE,this.updateBtnHelp,this)},n.onAfterOpen=function(){IS(B).send_29_28(2),IS(B).send_29_32(),this.updateResShow();var e=IS(k).getRecommondScienceByType(1);this.curSelectScienceId=e.id;var t=e.index;this.updateScienceItemsShow(),this.updateSelectInfo(),this.updateUpgradeShow(),this.updateAdShow(),this.updateSelectRedPoint();var i=10+190*(t-1)-306.7445;i<=0?this.nodeContent.setPosition(new H(0,0,0)):this.nodeContent.setPosition(new H(0,i,0))},n.updateResShow=function(){for(var e=0;e<this.resItems.length;e++)this.resItems[e].txtNum.string=I.GetNumString(IS(_).getGoodsCountByGoodsGtid(this.resItems[e].goodsGtid))},n.updateSelectRedPoint=function(){IS(u).changeValue("scienceSelect",IS(M).getScienceRedPoint(this.curSelectScienceId))},n.updateScienceItemsShow=function(){for(var e in this.scienceRowItems)this.scienceRowItems[e].show()},n.updateSelectInfo=function(){for(var e in this.scienceRowItems)this.scienceRowItems[e].updateSelect();var t=IS(k).getScienceInfoByScienceId(this.curSelectScienceId),i=C.isEmpty(t)||!1,n=i?0:t.science_lv,o=configScience.getDataByList("id",this.curSelectScienceId),s=o.length,c=n==s;this.imgLevel.fillRange=.83*Math.min(1,n/s),this.txtLevel.string=r.formatStr("%s/%s",n,s),this.loadIcon(this.imgFrame,"icon_science",c?"jy_ui_kejidi01":"jy_ui_kejidi02"),this.loadIcon(this.imgIcon,"icon_science",o[0].icon);var d=i?1:n,a=configScience.getDataByKeys("id",this.curSelectScienceId,"level",d),h=c?a:configScience.getDataByKeys("id",this.curSelectScienceId,"level",d+1);this.txtName.string=a.name;var l,f,u=i?a.condition:h.condition,m=!1,v=!1;if(null!=u){for(var p,S=[],y=0;y<u.length;y++){l=u[y][0],f=u[y][1];var w=IS(k).getScienceInfoByScienceId(l);p=null!=w?w.science_lv:0,C.isEmpty(w)&&(m=!0),p<f&&(m=!0,v=!1,S.push({id:l,needScienceLevel:f}))}var x="";if(!v){for(var L=0;L<S.length;L++){0!=L&&(x=r.formatStr("%s,",x));var _=configScience.getDataByKey(S[L].id);x=I.formatStrWithMirrorDeal(GetLanguage(200496),x,_.name,S[L].needScienceLevel)}x=r.formatStr("%s%s",x,GetLanguage(200101))}this.txtCondition.string=r.formatStr("<bold><color=#544231>%s</color></bold>",x)}if(m||c||null==h||n<=0?(this.nodeTwo.active=!1,this.nodeOne.active=!0,this.txtEffectOne.string=I.formatStr.apply(I,[a.describe].concat(a.desc_parm))):(this.nodeTwo.active=!0,this.nodeOne.active=!1,this.txtEffectCur.string=I.formatStr.apply(I,[a.describe].concat(a.desc_parm)),this.txtEffectNext.string=I.formatStr.apply(I,[h.describe].concat(h.desc_parm))),this.nodeMax.active=c,this.nodeLock.active=m,this.nodeBtnUpgrade.active=!c&&!m,this.nodeTime.active=!c&&!m,this.imgFrame.grayscale=m,this.imgLevelBg.grayscale=m,this.imgIcon.grayscale=m,this.curCostItem=0,this.curCostNeedNum=0,!c&&!m){var T=i?a.time:h.time;this.txtTime.string=g.formatTimeForSecond(T);var B=i?a.cost:h.cost;this.curCostItem=B[0][0],this.curCostNeedNum=B[0][1],this.txtCost.string=String(this.curCostNeedNum),this.updateUpgradeBtnStatus()}},n.updateUpgradeBtnStatus=function(){if(this.curCostItem&&0!=this.curCostItem){var e=IS(_).getGoodsCountByGoodsGtid(this.curCostItem)>=this.curCostNeedNum;this.loadIcon(this.imgBtnUpgrade,"common",e?"common_ICON_anniu02lv":"common_ICON_zhihuianniu02",null,p.UI_ATLAS,!0),this.imgCostBg.grayscale=!e,this.txtCost.color=e?new l(255,255,255):new l(242,52,52),this.outLineBtnUpgrade.color=e?new l(41,65,21):new l(76,76,76),this.outlineCost.color=e?new l(41,65,21):new l(76,76,76)}},n.updateBtnHelp=function(){var e=IS(k).getScienceTreeByType(1);!IS(A).HasGuild()||IS(R).IsAskHelp(b.Science,e.type)?this.btnHelpImg.color=new l(128,128,128):this.btnHelpImg.color=new l(255,255,255)},n.updateUpgradeShow=function(){var e=IS(k).getScienceTreeByType(1),t=e.doing;this.nodeInUpgrade.active=0!=t,this.nodeButtonParent.active=0==t,0!=t&&(this.txtAccName.string=r.formatStr("<b><outline color=#1A1D2C width=2><color=#FFFFFF>%s<color><color=#FFEB45>%s<color></outline></b>",GetLanguage_UI(100775),configScience.getDataByKeys("id",t,"level",1).name)),this.updateBtnHelp(),this.endTime=e.etime||0,this.refreshTime()},n.updateAdShow=function(){var e=configAds.getDataByKey(w.AD_SCIENCE_1),t=IS(x).getAdRewardValue(w.AD_SCIENCE_1);this.txtAdDesc.string=I.formatStrWithMirrorDeal(e.desc,t/60);var i=IS(x).getAdWatchCount(w.AD_SCIENCE_1);this.txtAdCount.string=r.formatStr("(%s/%s)",e.times-i,e.times)},n.onUpdate=function(e){0!=this.endTime&&(this.time=this.time+e,this.time<1||(this.time=0,this.refreshTime()))},n.refreshTime=function(){if(!(this.endTime<=0)){var e=this.endTime-g.serverTime;this.txtRemainTime.string=g.formatTimeForSecond(e)}},n.onBeforeClose=function(){this.time=0,this.endTime=0},n.onDestroy=function(){for(var e in this.scienceRowItems)this.scienceRowItems[e].destroy();this.scienceRowItems=null},n.onCloseClick=function(){this.close()},n.onScienceTreeUpdate=function(e){1==e&&(this.updateScienceItemsShow(),this.updateSelectInfo(),this.updateUpgradeShow(),this.updateSelectRedPoint())},n.onGoodsInfoUpdate=function(e,t){this.updateResShow(),t==V&&this.refreshTime()},n.onRoleResUpdate=function(){this.updateUpgradeBtnStatus(),this.updateSelectRedPoint()},n.onAdInfoUpdate=function(e){e==w.AD_SCIENCE_1&&this.updateAdShow()},n.onUpgradeClick=function(){if(IS(_).getGoodsCountByGoodsGtid(this.curCostItem)>=this.curCostNeedNum){var e=IS(k).getScienceLevelByScienceId(this.curSelectScienceId);IS(G).reqScienceResearch(this.curSelectScienceId,e+1),IS(A).isHaveHideByType(1)||IS(A).GetIsClickSubscribe(1)||(IS(N).requestSubscribeMessage([1]),IS(A).clickSubscribe(1))}else T.showFlyTip(GetLanguage(200591))},n.onAccClick=function(){var e=this.endTime-g.serverTime,t=IS(_).getGoodsCountByGoodsGtid(V);if(t<=0){var i=Math.ceil(e/W),n=I.formatStrWithMirrorDeal(GetLanguage(200497),i);T.showBoxTip({tip:n,title:GetLanguage(200048),todayTog:"acc_diamond_science",func:function(e){if("type_yes"==e){if(i>IS(_).getGoodsCountByGoodsGtid(X))return void T.showFlyTip(GetLanguage(200257));IS(E).send_3_19(2,X,i,1)}}})}else{var o=Math.ceil(e/j),s=Math.min(t,o);uiMgr.openView("ItemUseView",V,s,(function(e,t){IS(E).send_3_19(2,e,t,1)}),s)}},n.onAdClick=function(){IS(x).tryWatchAd(w.AD_SCIENCE_1)},i}(v)),e("RowItem",function(){function e(){this.node=void 0,this.rowInfo=void 0,this.nodeScience=void 0,this.scienceItemList=void 0}var t=e.prototype;return t.onInit=function(e,t,i){this.node=t,this.nodeScience=m.findChild(this.node,"science"),this.nodeScience.active=!1,this.scienceItemList=new Array;for(var n=0;n<i.length;n++){var o=nodeInstantiate.instantiate(this.nodeScience);o.parent=this.node,o.active=!0;var s=new J;s.onInit(e,o,i[n]),this.scienceItemList.push(s)}},t.updateSelect=function(){for(var e=0;e<this.scienceItemList.length;e++)this.scienceItemList[e].updateSelect()},t.show=function(){for(var e=0;e<this.scienceItemList.length;e++)this.scienceItemList[e].show()},t.destroy=function(){for(var e=0;e<this.scienceItemList.length;e++)this.scienceItemList[e].destroy();this.node.destroy()},e}())),Y=((O={})[1]=[0],O[2]=[-1,1],O[3]=[-2,0,2],O),J=e("ScienceItem",function(){function e(){this.node=void 0,this.imgFrame=void 0,this.imgIcon=void 0,this.imgLevelBg=void 0,this.imgLevel=void 0,this.txtLevel=void 0,this.nodeMax=void 0,this.nodeSelect=void 0,this.lineInfos=void 0,this.scienceId=void 0,this.child=void 0,this.curIndex=void 0,this.view=void 0,this.nodeBox=void 0}var t=e.prototype;return t.onInit=function(e,t,i){this.node=t,this.nodeBox=m.findChild(this.node,"box"),this.view=e,this.nodeBox.on(o.EventType.CLICK,this.onNodeClick,this),this.scienceId=i.id,this.child=i.childId,this.curIndex=i.index,this.view.addRedPoint(r.formatStr("MainView/tab-%s/science/scienceItem-%s",F.Main_Mystery,this.scienceId),this.nodeBox,new K(28,30),f.Dot),this.node.name=String(this.scienceId),this.imgFrame=m.findChildComponent(this.node,"box/imgFrame",s),this.imgFrame.node.name=r.formatStr("frame_%s",this.scienceId),this.imgIcon=m.findChildComponent(this.node,"box/imgIcon",s),this.imgLevelBg=m.findChildComponent(this.node,"box/pbLevel",s),this.imgLevel=m.findChildComponent(this.node,"box/pbLevel/Bar",s),this.txtLevel=m.findChildComponent(this.node,"box/txtLevel",a),this.nodeMax=m.findChild(this.node,"box/imgMax"),this.nodeSelect=m.findChild(this.node,"box/imgSelect"),this.nodeSelect.active=!1,this.lineInfos={};for(var n=1;n<=3;n++){var c=m.findChild(this.node,r.formatStr("line%s",n));c.name=r.formatStr("line_%s_%s",this.scienceId,n),this.lineInfos[n]={node:c,utNode:c.getComponent(h),imgLine:c.getComponent(s),lineType:1,posSpace:0,scaleX:1}}this.setLines()},t.setLines=function(){for(var e=1;e<=3;e++)this.lineInfos[e].node.active=!1;for(var t,i,n,o,s=this.view.getIndexInfoByScienceId(this.curIndex,this.scienceId),c=0,d=0,a=0,h=this.child.length,r=0;r<h;r++){t=r+1;var l=this.lineInfos[t];l.node.active=!0;var f=this.view.getIndexInfoByScienceId(this.curIndex+1,this.child[r]),u=this.getUseLineInfoByIndexInfo(s,f);o=u.useType,l.lineType=o,n=u.scaleX,l.node.setScale(new H(n,1,1)),l.scaleX=n,i=u.posSpace,l.posSpace=u.posSpace,i>a&&(a=i),2==o&&1==n&&(d+=1),2==o&&-1==n&&(c+=1)}for(var m=c>=2||d>=2||!1,I=0;I<h;I++){var g=this.lineInfos[I+1];1!=g.lineType?m&&g.posSpace==a?(g.utNode.width=120*g.posSpace-20,g.node.setPosition(new H(29*g.scaleX,-94.39,0))):(g.utNode.width=120*g.posSpace,g.node.setPosition(new H(9*g.scaleX,-114.39,0))):(g.utNode.width=10,g.node.setPosition(new H(-5,-114.39,0)))}},t.getUseLineInfoByIndexInfo=function(e,t){var i=Y[e.length][e.index],n=Y[t.length][t.index];return i==n?{useType:1,posSpace:0,scaleX:1}:{useType:2,scaleX:n>i?1:-1,posSpace:Math.abs(n-i)}},t.show=function(){IS(u).changeValue(r.formatStr("MainView/tab-%s/science/scienceItem-%s",F.Main_Mystery,this.scienceId),IS(M).getScienceRedPoint(this.scienceId));IS(k).getScienceTreeByType(1);var e=IS(k).getScienceInfoByScienceId(this.scienceId),t=C.isEmpty(e)||!1,i=t?0:e.science_lv,n=configScience.getDataByList("id",this.scienceId),o=n.length;this.imgLevel.fillRange=.83*Math.min(1,i/o),this.txtLevel.string=r.formatStr("%s/%s",i,o),this.nodeMax.active=i==o,this.view.loadIcon(this.imgFrame,"icon_science",i==o?"jy_ui_kejidi01":"jy_ui_kejidi02"),this.view.loadIcon(this.imgIcon,"icon_science",n[0].icon);var s=t?1:Math.min(i+1,o),c=configScience.getDataByKeys("id",this.scienceId,"level",s).condition;if(this.updateLines(),null==c||c.length<=0)return this.imgFrame.grayscale=!1,this.imgLevelBg.grayscale=!1,void(this.imgIcon.grayscale=!1);for(var d,a,h=!1,l=0;l<c.length;l++){d=c[l][0],a=c[l][1];var f=IS(k).getScienceInfoByScienceId(d);if(C.isEmpty(f)){h=!0;break}if(f.science_lv<a){h=!0;break}}this.imgFrame.grayscale=h,this.imgLevelBg.grayscale=h,this.imgIcon.grayscale=h},t.updateSelect=function(){this.nodeSelect.active=this.view.curSelectScienceId==this.scienceId},t.updateLines=function(){for(var e,t,i=IS(k).getScienceInfoByScienceId(this.scienceId),n=C.isEmpty(i)?0:i.science_lv,o=0;o<this.child.length;o++){e=this.child[o];var s=IS(k).getScienceInfoByScienceId(e),c=configScience.getDataByList("id",e);t=C.isEmpty(s)?1:Math.min(c.length,s.science_lv+1);for(var d=configScience.getDataByKeys("id",e,"level",t).condition,a=0;a<d.length;a++)if(d[a][0]==this.scienceId){var h=n>=d[a][1],r=this.lineInfos[o+1];1==r.lineType?this.view.loadIcon(r.imgLine,"icon_science",h?"jy_ui_xianlu02":"jy_ui_xianludi02"):this.view.loadIcon(r.imgLine,"icon_science",h?"jy_ui_xianlu01":"jy_ui_xianludi01");break}}},t.onNodeClick=function(){this.view.curSelectScienceId=this.scienceId,this.view.updateSelectInfo(),this.view.updateSelectRedPoint()},t.destroy=function(){this.view=null,this.nodeBox.off(o.EventType.CLICK,this.onNodeClick,this),this.node.destroy()},e}());i._RF.pop()}}}));

