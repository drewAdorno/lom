System.register("chunks:///_virtual/ActivityPoolPartyBirdView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StorageUtil.ts","./TimeUtil.ts","./index57.ts","./RoleDataCache.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ActivityPoolPartyControl.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,a,d,r,s,c,h,l,u,f,m,v,p,y,C,T,G,g,w;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.Label,a=t.ScrollView,d=t.Layout},function(t){r=t.audioMgr},function(t){s=t.ItemGrid},function(t){c=t.SelectedType,h=t.ListItem},function(t){l=t.default},function(t){u=t.default},function(t){f=t.default},null,function(t){m=t.RoleDataCache},function(t){v=t.default},function(t){p=t.default},function(t){y=t.ActivityType,C=t.ActivityEventDefine,T=t.ActivityState,G=t.ActivityTaskState},function(t){g=t.default},function(t){w=t.BaseView}],execute:function(){e._RF.push({},"d50e84Y1wxI0rFAVER02iKA","ActivityPoolPartyBirdView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).txtLeftTime=void 0,i.txtDesc=void 0,i.leftTime=0,i.deltaTime=0,i.canUpdate=!1,i.actType=void 0,i.txtTopScore=void 0,i.rewardList=void 0,i.received=void 0,i.undone=void 0,i.btnGet=void 0,i.curRewardInfo=void 0,i.name="ActivityPoolPartyBirdView",i.url="ui/module/activityPoolParty/ActivityPoolPartyBirdView",i.fullScreen=!0,i.actType=y.PoolPartyEndBirdGame,i}i(e,t);var s=e.prototype;return s.onInit=function(){var t=this,i=this.findChild("bottom/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("content/btnStart");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyBirdGameView")}));var r=this.findChild("bottom/btnGuide");this.addComponentCallbackListener(r,n.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyGameGuideView",2)}));var s=this.findChild("bottom/btnRank");this.addComponentCallbackListener(s,n.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyBirdRankView")})),this.txtLeftTime=this.findChildComponent("top/nodeTime/txtTime",o),this.txtDesc=this.findChildComponent("content/nodeReward/txtDesc",o),this.txtTopScore=this.findChildComponent("content/nodeScore/txtTopScore",o);var h=this.findChildComponent("content/nodeReward/ScrollView",a);this.rewardList=this.addUIList(h,I,!0),this.rewardList.selectedMode=c.SINGLE,this.rewardList.lackCenter=!0,this.received=this.findChild("content/nodeReward/received"),this.undone=this.findChild("content/nodeReward/undone"),this.btnGet=this.findChild("content/nodeReward/btnGet"),this.addComponentCallbackListener(this.btnGet,n.EventType.CLICK,(function(){t.curRewardInfo&&IS(v).send_24_15(y.PoolPartyEndBirdGame,t.curRewardInfo.task_id,t.curRewardInfo.group_id)})),this.dealMirrorLayout(this.findChildComponent("top/nodeTime",d)),this.adjustMirrorNode(this.findChild("content/img")),this.adjustMirrorNode(this.findChild("bottom/btnRank/img")),this.adjustMirrorNode(this.findChild("bottom/btnGuide/img"))},s.registerUpdateHandler=function(){this.addEvent(C.OnFlappyFrogGameStart,this.GameStart,this),this.addEvent(C.OnActivityInfoUpdate,this.updateTimeInfo,this),this.addEvent(C.OnActivityInfoTaskUpdate,this.OnTaskUpdate,this),this.addEvent(C.OnFlappyFrogInfoUpdate,this.updateInfo,this)},s.onAfterOpen=function(){""==u.get("poolpartybird"+IS(m).GetRoleId())&&(this.addTimer(1,0,(function(){uiMgr.openView("ActivityPoolPartyGameGuideView",2)})),u.set("poolpartybird"+IS(m).GetRoleId(),"1")),IS(v).send_24_14(y.PoolPartyEndBirdGame),IS(g).send_24_130(y.PoolPartyEndBirdGame),this.updateTimeInfo(),r.playMusic("yongchi_mainbgm")},s.onBeforeClose=function(){this.canUpdate=!1,r.playMusic("battle")},s.onDestroy=function(){},s.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=f.formatTimeStringForSecond(this.leftTime):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},s.GameStart=function(){uiMgr.openView("ActivityPoolPartyBirdGameView")},s.updateTimeInfo=function(t){if(t||(t=IS(p).GetActivityInfo(y.PoolPartyEndBirdGame)),t){var i,e=null!=(i=t.state_time[t.state])?i:t.state_time[T.Open];this.leftTime=e.end_time-f.serverTime,this.leftTime>0?(t.state==T.Preview?GetLanguage(200763):t.state==T.Open?GetLanguage(200764):t.state==T.EndShow&&GetLanguage(200765),this.canUpdate=!0,this.txtLeftTime.string=f.formatTimeStringForSecond(this.leftTime)):this.txtLeftTime.string=GetLanguage(200026)}},s.updateInfo=function(t){this.txtTopScore.string=t.toString()},s.OnTaskUpdate=function(){var t=IS(p).GetActivityInfo(y.PoolPartyEndBirdGame),i=[];for(var e in t.task_list)t.task_list.hasOwnProperty(e)&&i.push(t.task_list[e]);this.curRewardInfo=i[0],this.txtDesc.string=configActivity_task.getDataByKey(i[0].task_id).desc,this.curRewardInfo.state==G.CanGet?(this.received.active=!1,this.undone.active=!1,this.btnGet.active=!0):this.curRewardInfo.state==G.HadGet?(this.received.active=!0,this.undone.active=!1,this.btnGet.active=!1):(this.received.active=!1,this.undone.active=!0,this.btnGet.active=!1),this.rewardList.datas=this.curRewardInfo.cfg.reward},e}(w));var I=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.itemGridNode=l.findChild(this.node,"itemGrid"),this.itemGrid=new s(this.view,this.itemGridNode)},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1])},e}(h);e._RF.pop()}}}));

