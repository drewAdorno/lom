System.register("chunks:///_virtual/RankView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./AudioMgr.ts","./GuildPinItem.ts","./RankTitle.ts","./UIList.ts","./NodeUtil.ts","./PlatformUtil.ts","./StringUtil.ts","./BaseView.ts","./ChapterDataCache.ts","./MessageView.ts","./FriendControl.ts","./GuildControl.ts","./LoginDataCache.ts","./FrameDataCache.ts","./RoleDataCache.ts","./RoleDefine.ts","./RankControl.ts","./RankDefine.ts","./RankModel.ts"],(function(t){"use strict";var i,n,e,a,r,o,s,l,d,h,k,c,m,_,f,g,v,u,R,I,C,p,b,F,y,S,T,G,L,N,M,P;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t.Button,a=t.UITransform,r=t.Label,o=t.Sprite,s=t.ScrollView,l=t.sys,d=t.Vec2,h=t.Vec3},function(t){k=t.V2},function(t){c=t.audioMgr},function(t){m=t.GuildPinItem},function(t){_=t.RankTitle,f=t.TitleType},function(t){g=t.SelectedType,v=t.ListItem},function(t){u=t.default},function(t){R=t.PlatformUtil},function(t){I=t.default},function(t){C=t.BaseView},function(t){p=t.ChapterDataCache},function(t){b=t.default},function(t){F=t.default},function(t){y=t.default},function(t){S=t.LoginDataCache},function(t){T=t.FrameDataCache},function(t){G=t.RoleDataCache},function(t){L=t.PlayerAttr},function(t){N=t.default},function(t){M=t.RankDefine},function(t){P=t.RankModel}],execute:function(){n._RF.push({},"844faGZV21CJIL68cKEFyoi","RankView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).btnContent=void 0,i.btnAllSelect=void 0,i.btnFriendSelect=void 0,i.btnCrossSelect=void 0,i.btnAll=void 0,i.btnCross=void 0,i.btnFriend=void 0,i.mainRank=void 0,i.list_content=void 0,i.friendRank=void 0,i.rankList=void 0,i.rank1Name=void 0,i.rank1ServId=void 0,i.rank1Score=void 0,i.rank1Icon=void 0,i.rank1Head=void 0,i.rank1ImgFrame=void 0,i.rank1Title=void 0,i.rank1GuildFlag=void 0,i.rank1HeadFram=void 0,i.rank1FlyPetNode=void 0,i.rank1FlyPetModel=void 0,i.rank2Name=void 0,i.rank2ServId=void 0,i.rank2Score=void 0,i.rank2Icon=void 0,i.rank2Head=void 0,i.rank2ImgFrame=void 0,i.rank2Title=void 0,i.rank2GuildFlag=void 0,i.rank2HeadFram=void 0,i.rank2FlyPetNode=void 0,i.rank2FlyPetModel=void 0,i.rank3Name=void 0,i.rank3ServId=void 0,i.rank3Score=void 0,i.rank3Icon=void 0,i.rank3Head=void 0,i.rank3ImgFrame=void 0,i.rank3Title=void 0,i.rank3GuildFlag=void 0,i.rank3HeadFram=void 0,i.rank3FlyPetNode=void 0,i.rank3FlyPetModel=void 0,i.meRank=void 0,i.meRankFrame=void 0,i.meRankIcon=void 0,i.meRankServId=void 0,i.imgHeadFrame=void 0,i.meRankIndex=void 0,i.meNoRank=void 0,i.meRankGuildFlag=void 0,i.meRankHeadFram=void 0,i.meRankScore=void 0,i.meRankName=void 0,i.rank_tab_list=void 0,i.item_height=100,i.select_index=0,i.select_tab=1,i.page=1,i.screen_height=500,i.is_send_server=!1,i.send_num=0,i.rank_info_list=void 0,i.rankInfo=void 0,i.rank1Role=void 0,i.rank2Role=void 0,i.rank3Role=void 0,i.pos1=new k,i.pos2=new k,i.pos3=new k,i.btn_list_trans=void 0,i.Rank1Job=void 0,i.Rank2Job=void 0,i.Rank3Job=void 0,i.tabShowOrder={1:[1001,1002,1003,1004,1005,1014],2:[1036,1037,1038]},i.RankIdToType={1001:1,1002:2,1003:3,1004:4,1005:5,1014:5,1036:3,1037:4,1038:5},i.name="RankView",i.url="ui/module/rank/RankView",i.fullScreen=!0,i}i(n,t);var v=n.prototype;return v.onInit=function(){var t=this,i=this.findChild("root/content/btnClose");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.onMaskClick()})),this.btnContent=this.findChildComponent("root/content/btnList",a),this.btnAll=this.findChild("root/content/btnList/btnAll"),this.addComponentCallbackListener(this.btnAll,e.EventType.CLICK,(function(){t.onSelectTab(1)})),this.btnFriend=this.findChild("root/content/btnList/btnFriend"),this.addComponentCallbackListener(this.btnFriend,e.EventType.CLICK,(function(){t.onSelectTab(3)})),this.btnCross=this.findChild("root/content/btnList/btnCross"),this.addComponentCallbackListener(this.btnCross,e.EventType.CLICK,(function(){t.onSelectTab(2)})),this.btnAllSelect=this.findChild("root/content/btnList/btnAll/select"),this.btnCrossSelect=this.findChild("root/content/btnList/btnCross/select"),this.btnFriendSelect=this.findChild("root/content/btnList/btnFriend/select"),this.mainRank=this.findChild("root/content/mainRank"),this.friendRank=this.findChild("root/content/friendRank"),this.rank1FlyPetNode=this.findChild("root/content/mainRank/rank1/fly_pet"),this.rank1Name=this.findChildComponent("root/content/mainRank/rank1/name",r),this.rank1Score=this.findChildComponent("root/content/mainRank/rank1/score",r),this.rank1Icon=this.findChild("root/content/mainRank/rank1/imgFrame"),this.rank1Head=this.findChildComponent("root/content/mainRank/rank1/imgFrame/frame/imgIcon",o),this.rank1ImgFrame=this.findChildComponent("root/content/mainRank/rank1/imgFrame/frame/imgHeadFrame",o),this.rank1Title=this.findChild("root/content/mainRank/rank1/titleIcon"),this.rank1GuildFlag=new m(this,u.findChild(this.node,"root/content/mainRank/rank1/imgFrame/GuildPinItem")),this.rank1HeadFram=this.findChild("root/content/mainRank/rank1/imgFrame/frame2"),this.loadIcon(this.findChildComponent("root/content/mainRank/rank1/imgFrame/rank_icon",o),"friend","hy_ICON_paiming01"),this.loadIcon(this.findChildComponent("root/content/mainRank/rank2/imgFrame/rank_icon",o),"friend","hy_ICON_paiming02"),this.loadIcon(this.findChildComponent("root/content/mainRank/rank3/imgFrame/rank_icon",o),"friend","hy_ICON_paiming03"),this.addComponentCallbackListener(this.rank1Icon,e.EventType.CLICK,(function(){t.rank_info_list&&t.rank_info_list.length>0&&(4==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?IS(F).reqOtherRoleNotice(t.rank_info_list[0].belong_id,2):5==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?t.rank_info_list[0].belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(t.rank_info_list[0].belong_id):IS(F).reqOtherRoleNotice(t.rank_info_list[0].belong_id))})),this.Rank1Job=this.findChild("root/content/mainRank/rank1/role");var n=this.findChild("root/content/mainRank/rank1/role/click");this.addComponentCallbackListener(n,e.EventType.CLICK,(function(){t.rank_info_list&&t.rank_info_list.length>0&&(4==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?IS(F).reqOtherRoleNotice(t.rank_info_list[0].belong_id,2):5==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?t.rank_info_list[0].belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(t.rank_info_list[0].belong_id):IS(F).reqOtherRoleNotice(t.rank_info_list[0].belong_id))})),this.rank2FlyPetNode=this.findChild("root/content/mainRank/rank2/fly_pet"),this.rank2Name=this.findChildComponent("root/content/mainRank/rank2/name",r),this.rank2Score=this.findChildComponent("root/content/mainRank/rank2/score",r),this.rank2Icon=this.findChild("root/content/mainRank/rank2/imgFrame"),this.rank2Head=this.findChildComponent("root/content/mainRank/rank2/imgFrame/frame/imgIcon",o),this.rank2ImgFrame=this.findChildComponent("root/content/mainRank/rank2/imgFrame/frame/imgHeadFrame",o),this.rank2Title=this.findChild("root/content/mainRank/rank2/titleIcon"),this.rank2GuildFlag=new m(this,u.findChild(this.node,"root/content/mainRank/rank2/imgFrame/GuildPinItem")),this.rank2HeadFram=this.findChild("root/content/mainRank/rank2/imgFrame/frame2"),this.addComponentCallbackListener(this.rank2Icon,e.EventType.CLICK,(function(){t.rank_info_list&&t.rank_info_list.length>1&&(4==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?IS(F).reqOtherRoleNotice(t.rank_info_list[1].belong_id,2):5==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?t.rank_info_list[1].belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(t.rank_info_list[1].belong_id):IS(F).reqOtherRoleNotice(t.rank_info_list[1].belong_id))}));var l=this.findChild("root/content/mainRank/rank2/role/click");this.addComponentCallbackListener(l,e.EventType.CLICK,(function(){t.rank_info_list&&t.rank_info_list.length>1&&(4==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?IS(F).reqOtherRoleNotice(t.rank_info_list[1].belong_id,2):5==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?t.rank_info_list[1].belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(t.rank_info_list[1].belong_id):IS(F).reqOtherRoleNotice(t.rank_info_list[1].belong_id))})),this.Rank2Job=this.findChild("root/content/mainRank/rank2/role"),this.rank3FlyPetNode=this.findChild("root/content/mainRank/rank3/fly_pet"),this.rank3Name=this.findChildComponent("root/content/mainRank/rank3/name",r),this.rank3Score=this.findChildComponent("root/content/mainRank/rank3/score",r),this.rank3Icon=this.findChild("root/content/mainRank/rank3/imgFrame"),this.rank3Head=this.findChildComponent("root/content/mainRank/rank3/imgFrame/frame/imgIcon",o),this.rank3ImgFrame=this.findChildComponent("root/content/mainRank/rank3/imgFrame/frame/imgHeadFrame",o),this.rank3Title=this.findChild("root/content/mainRank/rank3/titleIcon"),this.rank3GuildFlag=new m(this,u.findChild(this.node,"root/content/mainRank/rank3/imgFrame/GuildPinItem")),this.rank3HeadFram=this.findChild("root/content/mainRank/rank3/imgFrame/frame2"),this.addComponentCallbackListener(this.rank3Icon,e.EventType.CLICK,(function(){t.rank_info_list&&t.rank_info_list.length>2&&(4==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?IS(F).reqOtherRoleNotice(t.rank_info_list[2].belong_id,2):5==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?t.rank_info_list[2].belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(t.rank_info_list[2].belong_id):IS(F).reqOtherRoleNotice(t.rank_info_list[2].belong_id))}));var d=this.findChild("root/content/mainRank/rank3/role/click");this.addComponentCallbackListener(d,e.EventType.CLICK,(function(){t.rank_info_list&&t.rank_info_list.length>2&&(4==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?IS(F).reqOtherRoleNotice(t.rank_info_list[2].belong_id,2):5==t.RankIdToType[t.rank_tab_list[t.select_index].rank_id]?t.rank_info_list[2].belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(t.rank_info_list[2].belong_id):IS(F).reqOtherRoleNotice(t.rank_info_list[2].belong_id))})),this.Rank3Job=this.findChild("root/content/mainRank/rank3/role");var h=this.findChild("root/content/mainRank/rankList"),k=this.findChildComponent("root/content/mainRank/rankList",s);this.list_content=this.findChild("root/content/mainRank/rankList/view/content"),this.rankList=this.addUIList(k,w),this.rankList.selectedMode=g.SINGLE,this.meRank=this.findChild("root/content/meRank"),this.meRankFrame=this.findChildComponent("root/content/mainRank/meRank/imgFrame",o),this.meRankIcon=this.findChildComponent("root/content/mainRank/meRank/imgFrame/frame/imgIcon",o),this.imgHeadFrame=this.findChildComponent("root/content/mainRank/meRank/imgFrame/frame/imgHeadFrame",o),this.meRankGuildFlag=new m(this,u.findChild(this.node,"root/content/mainRank/meRank/imgFrame/GuildPinItem")),this.meRankHeadFram=this.findChild("root/content/mainRank/meRank/imgFrame/frame2"),this.meRankName=this.findChildComponent("root/content/mainRank/meRank/name",r),this.meRankIndex=this.findChildComponent("root/content/mainRank/meRank/rank",r),this.meRankServId=this.findChildComponent("root/content/mainRank/meRank/serverId",r),this.meNoRank=this.findChild("root/content/mainRank/meRank/no_rank"),this.meRankScore=this.findChildComponent("root/content/mainRank/meRank/score",r),this.addComponentCallbackListener(h,s.EventType.SCROLL_ENDED,(function(){t.checkNeedSend()})),this.btn_list_trans=this.findChildComponent("root/content/mainRank/btn_list",a),this.rank_tab_list=[];for(var c=function(i){var n=t.findChild("root/content/mainRank/btn_list/btn"+i),a=u.findChildComponent(n,"normal/Label",r),o=u.findChildComponent(n,"select/Label",r),s=u.findChild(n,"select");s.active=!1,t.rank_tab_list.push({go:n,normal_txt:a,select_txt:o,select:s,rank_id:0});var l=u.findChild(n,"");t.addComponentCallbackListener(l,e.EventType.CLICK,(function(){t.onSelectRankTab(i-1)}))},_=1;_<=5;_++)c(_);this.pos1.set(0,-35),this.pos2.set(0,-15),this.pos3.set(0,-15)},v.RefreshTabPos=function(){var t=3;GlobalDefine.IS_APP&&(t--,this.btnFriend.active=!1),IS(P).GetRankCrossStatus()?this.btnCross.active=!0:(t--,this.btnCross.active=!1),this.btnContent.width=175.3*t+10*(t-1)},v.GetDetailHeight=function(){return 90*this.rank_info_list.length},v.checkNeedSend=function(){if(this.rank_info_list&&!(this.rank_info_list.length>=this.rankInfo.total_num)){var t=this.list_content.position.y;this.item_height=this.GetDetailHeight();var i=this.item_height+100;if(t+this.screen_height+100>i-1e3&&!this.is_send_server){if(this.is_send_server=!0,this.send_num++,this.send_num>this.rankInfo.total_num/10+1)return void printLogErr("出bug了，不可能请求这么多的 "+this.send_num);this.page++;var n=new Array,e=this.rank_tab_list[this.select_index].rank_id;n.push({type:e,server:1,page:this.page}),IS(N).reqRankList(n)}}},v.onSelectRankTab=function(t){if(t!=this.select_index){for(var i=0;i<this.rank_tab_list.length;i++)this.rank_tab_list[i].select.active=!1;this.select_index=t,null!=this.rank_tab_list[this.select_index]&&(this.rank_tab_list[this.select_index].select.active=!0),this.SendProto()}},v.SendProto=function(){this.page=1,this.send_num=0;var t=new Array,i=this.rank_tab_list[this.select_index].rank_id;t.push({type:i,server:1,page:this.page}),this.rankList.clearData(),IS(N).reqRankList(t)},v.registerUpdateHandler=function(){this.addEvent(M.RankInfoBack,this.updateData,this),this.addEvent(M.RankCrossStatus,this.RefreshTabPos,this)},v.onSelectTab=function(t){if(this.select_tab=t,1==this.select_tab)this.btnAllSelect.active=!0,this.btnCrossSelect.active=!1,this.btnFriendSelect.active=!1,this.mainRank.active=!0,this.friendRank.active=!1,this.RefershRankTab();else if(2==this.select_tab)this.btnAllSelect.active=!1,this.btnCrossSelect.active=!0,this.btnFriendSelect.active=!1,this.mainRank.active=!0,this.friendRank.active=!1,this.RefershRankTab();else{var i=IS(p),n=0;i.curChapterId&&(n=i.curChapterId),R.setUserCloudStorage(IS(S).roleId,n),R.openFriendRank(),this.btnAllSelect.active=!1,this.btnCrossSelect.active=!1,this.btnFriendSelect.active=!0,this.mainRank.active=!1,this.friendRank.active=!0}},v.onMaskClick=function(){this.close()},v.onAfterOpen=function(){IS(N).reqRankCrossStatus(),c.playSound("common_jiemian"),this.select_index=999,this.RefreshTabPos(),this.onSelectTab(1)},v.RefershRankTab=function(){for(var t=this.tabShowOrder[this.select_tab],i=[],n=0;n<t.length;n++){var e=configRanktype.getDataByKey(t[n]);1==e.is_show&&i.push(e)}i.sort((function(t,i){return t.order-i.order})),this.btn_list_trans.width=172*i.length;for(var a=0;a<5;a++)null!=this.rank_tab_list[a]&&(this.rank_tab_list[a].go.active=!1);for(var r=0;r<i.length;r++)null!=this.rank_tab_list[r]&&(this.rank_tab_list[r].go.active=!0,this.rank_tab_list[r].normal_txt.string=i[r].name,this.rank_tab_list[r].select_txt.string=i[r].name,this.rank_tab_list[r].rank_id=i[r].id);this.select_index=null,this.onSelectRankTab(0)},v.onBeforeClose=function(){null!=this.rank1FlyPetModel&&(this.removeUIEffect(this.rank1FlyPetModel),this.rank1FlyPetModel=null),null!=this.rank2FlyPetModel&&(this.removeUIEffect(this.rank2FlyPetModel),this.rank2FlyPetModel=null),null!=this.rank3FlyPetModel&&(this.removeUIEffect(this.rank3FlyPetModel),this.rank3FlyPetModel=null)},v.updateData=function(){this.is_send_server=!1;var t=IS(P).GetRankInfoByType(this.rank_tab_list[this.select_index].rank_id);if(null!=t){this.rankInfo=t;var i=new Array,n=t.rank_list;this.rank_info_list=n;var e=t.my_info,a="",r="",o="";if(1==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])a="";else if(2==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])a=GetLanguage(200295),r=GetLanguage(200295);else if(3==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])a=GetLanguage(200569),r=GetLanguage(200569);else if(4==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])o="";else if(5==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])r=GetLanguage(200295);else{var s=configRanktype.getDataByKey(this.rank_tab_list[this.select_index].rank_id).prefix;a=s,r=s}for(var k=0;k<t.rank_list.length;k++)k>2&&i.push({info:t.rank_list[k],des_str:r,rank_id:this.rank_tab_list[this.select_index].rank_id});if(this.rank1Name.string=GetLanguage(200038),this.rank1Score.string=l.uiMirror?"0":this.getDescPreByDescStr(a)+"0"+o,this.rank1Icon.active=!1,this.rank2Name.string=GetLanguage(200038),this.rank2Score.string=l.uiMirror?"0":this.getDescPreByDescStr(a)+"0"+o,this.rank2Icon.active=!1,this.rank3Name.string=GetLanguage(200038),this.rank3Score.string=l.uiMirror?"0":this.getDescPreByDescStr(a)+"0"+o,this.rank3Icon.active=!1,null!=this.rank1Role&&(this.rank1Title.active=!1,this.removeUnitModel(this.rank1Role),this.rank1Role=null),null!=this.rank2Role&&(this.rank2Title.active=!1,this.removeUnitModel(this.rank2Role),this.rank2Role=null),null!=this.rank3Role&&(this.rank3Title.active=!1,this.removeUnitModel(this.rank3Role),this.rank3Role=null),null!=this.rank1FlyPetModel&&(this.removeUIEffect(this.rank1FlyPetModel),this.rank1FlyPetModel=null),null!=this.rank2FlyPetModel&&(this.removeUIEffect(this.rank2FlyPetModel),this.rank2FlyPetModel=null),null!=this.rank3FlyPetModel&&(this.removeUIEffect(this.rank3FlyPetModel),this.rank3FlyPetModel=null),n&&n.length>0){for(var c=t.rank_list[0].figure,m=c.skin_list||[],g=0,v=0,u=0;u<m.length;u++)2==m[u].k?g=m[u].v:7==m[u].k&&(v=m[u].v);for(var R=0,C=0,p=0,b=0,F=0;F<c.equip_list.length;F++)1==c.equip_list[F].k&&(R=c.equip_list[F].v),2==c.equip_list[F].k&&(C=c.equip_list[F].v),3==c.equip_list[F].k&&(p=c.equip_list[F].v),5==c.equip_list[F].k&&(b=c.equip_list[F].v);var y=c.gender||1;if(this.rank1Role=this.addUnitModel({job:c.job_figure,dressId:g,gender:y,parent:this.Rank1Job,color:c.hair_figure,weapon:R,ornaments:C,face:p,mount:c.mount_figure,shenqi:c.artifact_figure,wing:b}),l.uiMirror&&(this.getUnitModel(this.rank1Role).dir=-1),5==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])this.rank1Head.node.active=!1,this.rank1HeadFram.active=!1,this.rank1ImgFrame.node.active=!1,this.rank1GuildFlag.node.active=!0,this.rank1GuildFlag.SetItem(t.rank_list[0].guild_flag);else{this.rank1Head.node.active=!0,this.rank1HeadFram.active=!0,this.rank1GuildFlag.node.active=!1,this.loadRemoteIcon(t.rank_list[0].head.url,this.rank1Head);var S=t.rank_list[0].head.frame_id;if(S>0){this.rank1ImgFrame.node.active=!0;var N=configAvatar_frame.getDataByKey(S);this.loadIcon(this.rank1ImgFrame,"icon_frame",N.icon)}else this.rank1ImgFrame.node.active=!1}if(v&&v>0){var M=configFly.getDataByKey(v),w=configUnitModel.getDataByKey(M.unitid);this.rank1FlyPetModel=this.addUIEffect(w.path,this.rank1FlyPetNode,-1,new d(0,-60),w.scale/100*1,(function(t){l.uiMirror&&(t.dir=-1)}))}var H=c.current_title;if(H>0){var x=this.getUnitModel(this.rank1Role).modelHeight;this.rank1Title.setPosition(0,x+50),this.rank1Title.active=!0,new _(this,this.rank1Title).SetRankTitle(H,f.NORMAL)}else this.rank1Title.active=!1;this.rank1Icon.active=!0,this.rank1Name.string=I.GetServNameById(t.rank_list[0].serv_id)+t.rank_list[0].name,this.rank1Score.string=l.uiMirror?I.GetNumString(t.rank_list[0].score):this.getDescPreByDescStr(a)+I.GetNumString(t.rank_list[0].score)+o}if(n&&n.length>1){for(var D=t.rank_list[1].figure,q=D.skin_list||[],B=0,U=0,E=0;E<q.length;E++)2==q[E].k?B=q[E].v:7==q[E].k&&(U=q[E].v);for(var A=D.gender||1,K=0,O=0,V=0,J=0,j=0;j<D.equip_list.length;j++)1==D.equip_list[j].k&&(K=D.equip_list[j].v),2==D.equip_list[j].k&&(O=D.equip_list[j].v),3==D.equip_list[j].k&&(V=D.equip_list[j].v),5==D.equip_list[j].k&&(J=D.equip_list[j].v);if(this.rank2Role=this.addUnitModel({job:D.job_figure,dressId:B,gender:A,parent:this.Rank2Job,color:D.hair_figure,weapon:K,ornaments:O,face:V,mount:D.mount_figure,shenqi:D.artifact_figure,wing:J}),l.uiMirror&&(this.getUnitModel(this.rank2Role).dir=-1),this.getUnitModel(this.rank2Role).mount=D.mount_figure,5==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])this.rank2Head.node.active=!1,this.rank2HeadFram.active=!1,this.rank2ImgFrame.node.active=!1,this.rank2GuildFlag.node.active=!0,this.rank2GuildFlag.SetItem(t.rank_list[1].guild_flag);else{this.rank2Head.node.active=!0,this.rank2HeadFram.active=!0,this.rank2GuildFlag.node.active=!1,this.loadRemoteIcon(t.rank_list[1].head.url,this.rank2Head);var Z=t.rank_list[1].head.frame_id;if(Z>0){this.rank2ImgFrame.node.active=!0;var z=configAvatar_frame.getDataByKey(Z);this.loadIcon(this.rank2ImgFrame,"icon_frame",z.icon)}else this.rank2ImgFrame.node.active=!1}if(U&&U>0){var Q=configFly.getDataByKey(U),W=configUnitModel.getDataByKey(Q.unitid);this.rank2FlyPetModel=this.addUIEffect(W.path,this.rank2FlyPetNode,-1,new d(0,-60),W.scale/100*1,(function(t){l.uiMirror&&(t.dir=-1)}))}this.rank2Icon.active=!0,this.rank2Name.string=I.GetServNameById(t.rank_list[1].serv_id)+t.rank_list[1].name,this.rank2Score.string=l.uiMirror?I.GetNumString(t.rank_list[1].score):this.getDescPreByDescStr(a)+I.GetNumString(t.rank_list[1].score)+o;var X=D.current_title;if(X>0){var Y=this.getUnitModel(this.rank2Role).modelHeight;this.rank2Title.setPosition(0,Y+50),this.rank2Title.active=!0,new _(this,this.rank2Title).SetRankTitle(X,f.NORMAL)}else this.rank2Title.active=!1}if(n&&n.length>2){for(var $=t.rank_list[2].figure,tt=$.skin_list||[],it=0,nt=0,et=0;et<tt.length;et++)2==tt[et].k?it=tt[et].v:7==tt[et].k&&(nt=tt[et].v);for(var at=0,rt=0,ot=0,st=0,lt=0;lt<$.equip_list.length;lt++)1==$.equip_list[lt].k&&(at=$.equip_list[lt].v),2==$.equip_list[lt].k&&(rt=$.equip_list[lt].v),3==$.equip_list[lt].k&&(ot=$.equip_list[lt].v),5==$.equip_list[lt].k&&(st=$.equip_list[lt].v);var dt=$.gender||1;if(this.rank3Role=this.addUnitModel({job:$.job_figure,dressId:it,gender:dt,parent:this.Rank3Job,color:$.hair_figure,weapon:at,ornaments:rt,face:ot,mount:$.mount_figure,shenqi:$.artifact_figure,wing:st}),l.uiMirror&&(this.getUnitModel(this.rank3Role).dir=-1),5==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])this.rank3Head.node.active=!1,this.rank3HeadFram.active=!1,this.rank3ImgFrame.node.active=!1,this.rank3GuildFlag.node.active=!0,this.rank3GuildFlag.SetItem(t.rank_list[2].guild_flag);else{this.rank3Head.node.active=!0,this.rank3HeadFram.active=!0,this.rank3GuildFlag.node.active=!1,this.loadRemoteIcon(t.rank_list[2].head.url,this.rank3Head);var ht=t.rank_list[2].head.frame_id;if(ht>0){this.rank3ImgFrame.node.active=!0;var kt=configAvatar_frame.getDataByKey(ht);this.loadIcon(this.rank3ImgFrame,"icon_frame",kt.icon)}else this.rank3ImgFrame.node.active=!1}if(nt&&nt>0){var ct=configFly.getDataByKey(nt),mt=configUnitModel.getDataByKey(ct.unitid);this.rank3FlyPetModel=this.addUIEffect(mt.path,this.rank3FlyPetNode,-1,new d(0,-60),mt.scale/100*1,(function(t){l.uiMirror&&(t.dir=-1)}))}this.rank3Icon.active=!0,this.rank3Name.string=I.GetServNameById(t.rank_list[2].serv_id)+t.rank_list[2].name,this.rank3Score.string=l.uiMirror?I.GetNumString(t.rank_list[2].score):this.getDescPreByDescStr(a)+I.GetNumString(t.rank_list[2].score)+o;var _t=$.current_title;if(_t>0){var ft=this.getUnitModel(this.rank3Role).modelHeight;this.rank3Title.setPosition(0,ft+50),this.rank3Title.active=!0,new _(this,this.rank3Title).SetRankTitle(_t,f.NORMAL)}else this.rank3Title.active=!1}this.rankList.datas=i,this.meNoRank.active=e.rank<=0,2==this.select_tab?(this.meRankName.node.position=new h(this.meRankName.node.position.x,-3.6,0),e.name&&""!=e.name?this.meRankServId.string=I.GetServNameById(IS(G).GetServerId()):this.meRankServId.string=""):(this.meRankName.node.position=new h(this.meRankName.node.position.x,10,0),this.meRankServId.string=""),e.rank>0?this.meRankIndex.string=e.rank+"":this.meRankIndex.string="";var gt=IS(G).GetRoleAttr(L.ROLE_ATTR_HEAD_URL);if(5==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id])this.meRankIcon.node.active=!1,this.meRankHeadFram.active=!1,this.meRankGuildFlag.node.active=!0,this.meRankGuildFlag.SetItem(e.guild_flag);else{this.meRankIcon.node.active=!0,this.meRankHeadFram.active=!0,this.meRankGuildFlag.node.active=!1,this.loadRemoteIcon(gt,this.meRankIcon);var vt=IS(T).curFrameId;if(vt>0){var ut=configAvatar_frame.getDataByKey(vt);this.loadIcon(this.imgHeadFrame,"icon_frame",ut.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1}this.meRankName.string=e.name,this.meRankScore.string=l.uiMirror?I.GetNumString(e.score):this.getDescPreByDescStr(r)+I.GetNumString(e.score),4==this.RankIdToType[this.rank_tab_list[this.select_index].rank_id]&&(this.meRankScore.string=l.uiMirror?e.score:this.getDescPreByDescStr(r)+e.score+" "+GetLanguage(200231))}},v.onDestroy=function(){},v.getDescPreByDescStr=function(t){return t&&""!=t?t+" ":""},n}(C));var w=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),a=0;a<n;a++)e[a]=arguments[a];return(i=t.call.apply(t,[this].concat(e))||this).imgFrame=void 0,i.imgIcon=void 0,i.imgHeadFrame=void 0,i.titleIcon=void 0,i.txtScore=void 0,i.txtRank=void 0,i.txtName=void 0,i.btnHead=void 0,i.guildFlag=void 0,i.imgHeadFram=void 0,i.serverId=void 0,i}i(n,t);var a=n.prototype;return a.onInit=function(){var t=this;this.imgFrame=u.findChildComponent(this.node,"imgFrame",o),this.imgIcon=u.findChildComponent(this.node,"imgFrame/frame/imgIcon",o),this.imgHeadFrame=u.findChildComponent(this.node,"imgFrame/frame/imgHeadFrame",o),this.titleIcon=u.findChild(this.node,"titleIcon"),this.txtScore=u.findChildComponent(this.node,"score",r),this.txtRank=u.findChildComponent(this.node,"rank",r),this.txtName=u.findChildComponent(this.node,"name",r),this.guildFlag=new m(this.view,u.findChild(this.node,"imgFrame/GuildPinItem")),this.imgHeadFram=u.findChild(this.node,"imgFrame/frame2"),this.btnHead=u.findChild(this.node,"imgFrame"),this.serverId=u.findChildComponent(this.node,"serverId",r),this.view.addComponentCallbackListener(this.btnHead,e.EventType.CLICK,(function(){t.onItemClick()}))},a.onRender=function(t,i){5==this.view.RankIdToType[this.data.rank_id]?(this.imgIcon.node.active=!1,this.imgHeadFram.active=!1,this.guildFlag.node.active=!0,this.guildFlag.SetItem(t.info.guild_flag)):(this.imgIcon.node.active=!0,this.imgHeadFram.active=!0,this.guildFlag.node.active=!1,this.view.loadRemoteIcon(t.info.head.url,this.imgIcon));var n=t.info.head.frame_id;if(n>0){this.imgHeadFrame.node.active=!0;var e=configAvatar_frame.getDataByKey(n);this.view.loadIcon(this.imgHeadFrame,"icon_frame",e.icon)}else this.imgHeadFrame.node.active=!1;this.txtRank.string=t.info.rank;var a=this.view;this.txtScore.string=l.uiMirror?I.GetNumString(t.info.score):a.getDescPreByDescStr(t.des_str)+I.GetNumString(t.info.score),4==this.view.RankIdToType[this.data.rank_id]&&(this.txtScore.string=l.uiMirror?t.info.score:a.getDescPreByDescStr(t.des_str)+t.info.score+" "+GetLanguage(200231)),this.txtName.string=t.info.name;var r=t.info.figure.current_title;r>0&&2!=this.view.select_index&&2!=this.view.select_tab?(this.titleIcon.active=!0,this.txtName.node.setPosition(249,-90),this.serverId.node.active=!1,new _(this.view,this.titleIcon).SetRankTitle(r,f.NORMAL)):2==this.view.select_tab?(this.titleIcon.active=!1,this.serverId.node.active=!0,this.serverId.string=I.GetServNameById(t.info.serv_id),this.txtName.node.setPosition(249,-90)):(this.serverId.node.active=!1,this.titleIcon.active=!1,this.txtName.node.setPosition(249,-58))},a.onItemClick=function(){4==this.view.RankIdToType[this.data.rank_id]?IS(F).reqOtherRoleNotice(this.data.info.belong_id,2):5==this.view.RankIdToType[this.data.rank_id]?this.data.info.belong_id==IS(G).GetGuildId()?b.showFlyTip(GetLanguage(200233)):IS(y).send_29_1(this.data.info.belong_id):IS(F).reqOtherRoleNotice(this.data.info.belong_id)},n}(v);n._RF.pop()}}}));

