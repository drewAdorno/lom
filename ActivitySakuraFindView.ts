System.register("chunks:///_virtual/ActivitySakuraFindView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./BagModel.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,a,s,d,r,o,c,h,l,v,u,f,m,S,p,w,g;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,a=t.Button,s=t.ScrollView,d=t.Label},function(t){r=t.ItemGrid},function(t){o=t.ListItem},function(t){c=t.default},function(t){h=t.default},function(t){l=t.default},null,function(t){v=t.ConfigGlobal},function(t){u=t.BagModel},function(t){f=t.default},function(t){m=t.default},function(t){S=t.ActivityEventDefine,p=t.ActivityType,w=t.ActivityState},function(t){g=t.BaseView}],execute:function(){n._RF.push({},"9676dFrd0ZKUqWc8amn0/PU","ActivitySakuraFindView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).rewardScroll=void 0,i.taskList=void 0,i.name="ActivitySakuraFindView",i.url="ui/module/activitySakura/ActivitySakuraFindView",i}i(n,t);var d=n.prototype;return d.onInit=function(){var t=this,i=this.findChild("btnClose");this.addComponentCallbackListener(i,a.EventType.CLICK,(function(){t.close()})),this.rewardScroll=this.addUIList(this.findChildComponent("view/reward/reward/rewardScroll",s),k),this.taskList=this.addUIList(this.findChildComponent("view/taskList",s),C)},d.registerUpdateHandler=function(){this.addEvent(S.OnActivityFindUpdate,this.updateInfo,this)},d.onAfterOpen=function(){IS(f).send_24_52(p.SakuraFind),this.rewardScroll.datas=v.act_search_complete_reward.find((function(t){return t[0]==p.SakuraFind}))[1]},d.onBeforeClose=function(){},d.onDestroy=function(){},d.updateInfo=function(){for(var t,i=IS(m).GetActivityInfo(p.SakuraFind),n=[],a=configMoonfestival_search.getDatas(),s=e(a);!(t=s()).done;){var d=t.value;d.type==i.type&&d.group_id==i.roundCfg.group_id&&n.push(d)}var r=IS(m).getFindInfo(p.SakuraFind);n.sort((function(t,i){var e,n,a=null!=(e=r.list[t.id])?e:0,s=null!=(n=r.list[i.id])?n:0;return a==s?t.rank_num-i.rank_num:2==a?1:2==s||1==a?-1:1==s?1:void 0})),this.taskList.datas=n,this.rewardScroll.updateAll()},n}(g));var k=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i.received=void 0,i.mask=void 0,i.canGet=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.received=c.findChild(this.node,"received"),this.mask=c.findChild(this.node,"mask"),this.canGet=c.findChild(this.node,"canGet"),this.itemGridNode=c.findChild(this.node,"itemGrid"),this.itemGrid=new r(this.view,this.itemGridNode,(function(){t.canGet.active?IS(f).send_24_53(0,p.SakuraFind):IS(u).OpenItemTips(t.data[0],t.node)}))},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1]);var e=IS(m).getFindInfo(p.SakuraFind);this.received.active=1==e.total_reward,this.mask.active=1==e.total_reward,this.canGet.active=0==e.total_reward&&IS(m).isAllFind(p.SakuraFind)},e}(o),C=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).title=void 0,i.txtState=void 0,i.txtDesc=void 0,i.received=void 0,i.state1=void 0,i.state2=void 0,i.state3=void 0,i.mask=void 0,i.nothing=void 0,i.rewardScroll=void 0,i}i(n,t);var a=n.prototype;return a.onInit=function(){this.title=c.findChildComponent(this.node,"txtTitle",d),this.txtDesc=c.findChildComponent(this.node,"txtDesc",d),this.txtState=c.findChildComponent(this.node,"state3/Label",d),this.state1=c.findChild(this.node,"state1"),this.state2=c.findChild(this.node,"state2"),this.state3=c.findChild(this.node,"state3"),this.mask=c.findChild(this.node,"mask"),this.nothing=c.findChild(this.node,"nothing"),this.rewardScroll=this.view.addUIList(c.findChildComponent(this.node,"rewardScroll",s),I)},a.onRender=function(t,i){var n;this.title.string=h.formatStrWithMirrorDeal(GetLanguage(999300208),t.rank_num),this.txtDesc.string=t.clue;for(var a,s=[],d=e(t.clue_reward);!(a=d()).done;){var r=a.value;s.push({id:t.id,reward:r})}this.rewardScroll.datas=s;var o=null!=(n=IS(m).getFindInfo(p.SakuraFind).list[t.id])?n:0;if(this.mask.active=2==o,2==o)this.state1.active=!1,this.state2.active=!0,this.state3.active=!1,this.nothing.active=!1,this.rewardScroll.node.active=!0,this.txtDesc.node.active=!0;else if(0==o){this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,this.nothing.active=!0,this.rewardScroll.node.active=!1,this.txtDesc.node.active=!1;var c=IS(m).GetActivityInfo(p.SakuraFind).state_time[w.Open].start_time+24*(this.data.open_time-1)*3600,v=l.formatDate(l.ServerDate(1e3*c),"MM.dd");this.txtState.string=h.formatStrWithMirrorDeal(GetLanguage(201369),v)}else{this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,IS(m).getCurFind(p.SakuraFind)==t.id?(this.state1.active=!0,this.state2.active=!1,this.state3.active=!1,this.nothing.active=!1,this.rewardScroll.node.active=!0,this.txtDesc.node.active=!0):(this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,this.nothing.active=!0,this.rewardScroll.node.active=!1,this.txtDesc.node.active=!1,this.txtState.string=GetLanguage(201370))}},n}(o),I=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i.received=void 0,i.mask=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.received=c.findChild(this.node,"received"),this.mask=c.findChild(this.node,"mask"),this.itemGridNode=c.findChild(this.node,"itemGrid"),this.itemGrid=new r(this.view,this.itemGridNode)},n.onRender=function(t,i){var e;this.itemGrid.SetItemId(t.reward[0],t.reward[1]);var n=null!=(e=IS(m).getFindInfo(p.SakuraFind).list[t.id])?e:0;this.received.active=2==n,this.mask.active=2==n},e}(o);n._RF.pop()}}}));

