System.register("chunks:///_virtual/CircleOfFriendsEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./ChatDataCache.ts","./CommonDefine.ts","./MessageView.ts","./RoleDataCache.ts","./NativeToJs.ts","./CircleOfFriendsControl.ts","./BaseView.ts"],(function(t){"use strict";var i,n,e,o,s,c,a,d,l,u,p,r,h,f,C,m;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t.Button,o=t.EditBox,s=t.Label,c=t.js,a=t.Sprite},function(t){d=t.default},function(t){l=t.default},null,function(t){u=t.ConfigGlobal},function(t){p=t.ChatDataCache},function(t){r=t.CommonEventDefine},function(t){h=t.default},function(t){f=t.RoleDataCache},null,function(t){C=t.default},function(t){m=t.BaseView}],execute:function(){n._RF.push({},"dd633xn50JCWoFWvF5oJTsM","CircleOfFriendsEditView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).inputField=void 0,i.addBtn=void 0,i.picMask=void 0,i.pic=void 0,i.picUrl=void 0,i.inputNum=void 0,i.name="CircleOfFriendsEditView",i.url="ui/module/CircleOfFriends/CircleOfFriendsEditView",i.fullScreen=!1,i}i(n,t);var m=n.prototype;return m.registerUpdateHandler=function(){this.addEvent(r.PhotoUpLoadSuccess,this.UpLoadSuccess,this)},m.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.close()})),this.inputField=this.findChildComponent("content/inputField",o),this.inputField.placeholder=GetLanguage_UI(300127),this.inputNum=this.findChildComponent("content/inputField/num",s),this.addComponentCallbackListener(this.inputField.node,o.EventType.TEXT_CHANGED,(function(){var i=d.getStrLength(t.inputField.string);t.inputNum.string=c.formatStr("(%s/%s)",i,u.circle_text_limit)})),this.inputField.maxLength=u.circle_text_limit,this.addBtn=this.findChild("content/picAdd/addBtn"),this.addComponentCallbackListener(this.findChild("content/picAdd"),e.EventType.CLICK,(function(){t.UpLoadPic()})),this.picMask=this.findChild("content/picAdd/picMask"),this.addComponentCallbackListener(this.picMask,e.EventType.CLICK,(function(){t.UpLoadPic()})),this.pic=this.findChildComponent("content/picAdd/picMask/pic",a),this.addComponentCallbackListener(this.findChild("content/sendBtn"),e.EventType.CLICK,(function(){""!=t.inputField.string?(IS(C).sendToPostMoment(t.inputField.string,t.picUrl),t.close()):h.showFlyTip(GetLanguage(300141))}))},m.UpLoadPic=function(){var t=this,i=IS(p).GetIsBanRole(IS(f).GetRoleId());i&&i>l.serverTime?h.showFlyTip(GetLanguage(300158)):0!=GlobalDefine.SERVER_LIST_TYPE?sdkControl.H5SelectImg("2"):h.showBoxTip({tip:GetLanguage(300071),title:GetLanguage(300070),func:function(i){"type_yes"==i?0==GlobalDefine.SERVER_LIST_TYPE&&t.addTimer(.1,1,(function(){normalEvent.emit(r.PhotoUpLoadSuccess,"http://test.chat.4399sy.com/vipkf/static/img/big.png","2")})):"type_cancel"==i&&0==GlobalDefine.SERVER_LIST_TYPE&&t.addTimer(.1,1,(function(){normalEvent.emit(r.PhotoUpLoadSuccess,"http://test.chat.4399sy.com/vipkf/static/img/big.png","2")}))},ensure:GetLanguage(300073),cancel:GetLanguage(300072)})},m.onAfterOpen=function(){this.picUrl=null,this.inputField.string="",this.inputField.maxLength=u.circle_text_limit,this.inputNum.string=c.formatStr("(%s/%s)",0,u.circle_text_limit),this.picMask.active=!1,this.addBtn.active=!0},m.UpLoadSuccess=function(t,i){"2"==i&&(this.picMask.active=!0,this.picUrl=t,this.addBtn.active=!1,this.loadRemoteIcon(t,this.pic))},m.onBeforeClose=function(){},m.onDestroy=function(){},n}(m));n._RF.pop()}}}));

