System.register("chunks:///_virtual/MonopolyPoliceView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./StringUtil.ts","./index57.ts","./SpineSkeleton.ts","./MessageView.ts","./MonopolyControl.ts","./MonopolyDefine.ts","./BaseView.ts"],(function(i){"use strict";var t,e,n,o,s,c,a,r,d,l,u,h;return{setters:[function(i){t=i.inheritsLoose},function(i){e=i.cclegacy,n=i.Button,o=i.Label,s=i.Vec2},function(i){c=i.audioMgr},function(i){a=i.default},null,function(i){r=i.SpineSkeleton},function(i){d=i.default},function(i){l=i.default},function(i){u=i.MonopolyEventDefine},function(i){h=i.BaseView}],execute:function(){e._RF.push({},"ff3bcJtK2lDDJNbcTlCPEV9","MonopolyPoliceView",void 0);i("default",function(i){function e(){var t;return(t=i.call(this)||this).txtContent=void 0,t.nodeCur=void 0,t.isWaitng=!1,t.txtTimes=void 0,t.nodeContainer=void 0,t.event=void 0,t.canClose=!1,t.skipAnim=void 0,t.curData=void 0,t.diceAniTimer=void 0,t.diceWaitTimer=void 0,t.diceSpine=void 0,t.effectDice=void 0,t.name="MonopolyPoliceView",t.url="ui/module/activity/MonopolyPoliceView",t}t(e,i);var h=e.prototype;return h.onInit=function(){var i=this,t=this.findChild("root/imgMask");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){i.onMaskClick()})),this.txtContent=this.findChildComponent("root/content/txt1",o),this.nodeCur=this.findChild("root/content/cur"),this.nodeContainer=this.findChild("root/content"),this.txtTimes=this.findChildComponent("root/content/cur/txtDesc",o);var e=this.findChild("root/content/cur/imgDice");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){i.isWaitng||!i.event||i.event.times<=0||(IS(l).reqMonopolyDice(),i.isWaitng=!0)})),this.skipAnim=this.findChild("root/skipAnim"),this.addComponentCallbackListener(this.skipAnim,n.EventType.CLICK,(function(){i.SkipAnim()}))},h.registerUpdateHandler=function(){this.addEvent(u.MONO_GRID_DICE_BACK,this.onMonoGridDiceBack,this)},h.onMaskClick=function(){this.canClose&&this.close()},h.onAfterOpen=function(){this.skipAnim.active=!1,this.canClose=!1,this.event=this.openArgs[0],this.nodeCur.active=!0;var i=configMonopoly_random.getDataByKey(this.event.id);this.txtContent.string=i.desc,this.txtTimes.string=a.formatStr(GetLanguage(700000310),this.event.times)},h.onMonoGridDiceBack=function(i){var t=this;this.curData=i,this.nodeCur.active=!1;var e=i.dice_num;c.playSound("dfw_zhitouzi"),this.effectDice=this.addUIEffect("prefab/ui-effect/MX_shaizi_dafuweng",this.nodeContainer,3,new s(0,-400),1,(function(i){var n=i.node.getComponent(r);t.diceSpine=n,n.needAnimation="chixu",t.skipAnim.active=!0,t.diceAniTimer=t.addTimer(2,1,(function(){t.skipAnim.active=!1,n.setAnimation(0,String(e),!1),t.diceAniTimer=null}))})),this.diceWaitTimer=this.addTimer(3,1,(function(){t.playShow(),t.diceSpine=null,t.diceWaitTimer=null}))},h.playShow=function(){if(6!=this.curData.dice_num){if(!this.curData.event||this.curData.event.times<=0){for(var i,t=this.curData.reward,e=0;e<t.length;e++)if(6==t[e].type){i=t[e].goods_list[0];break}if(i){var n=configGoods.getDataByKey(i.gtid);d.showFlyTip(a.formatStr(GetLanguage(700000323),n.name,i.num),!1,{time1:.6,time2:.6})}return normalEvent.emit(u.MONO_POLICE_UPDATE_RES),void(this.canClose=!0)}this.isWaitng=!1,this.nodeCur.active=!0,this.txtTimes.string=a.formatStr(GetLanguage(700000310),this.curData.event.times)}else this.canClose=!0},h.SkipAnim=function(){var i=this;this.diceAniTimer&&(this.removeTimer(this.diceAniTimer),this.diceAniTimer=null),this.diceWaitTimer&&(this.removeTimer(this.diceWaitTimer),this.diceWaitTimer=null),this.skipAnim.active=!1,this.diceSpine.setAnimation(0,String(this.curData.dice_num),!1),this.addTimer(1,1,(function(){i.effectDice&&(i.removeUIEffect(i.effectDice),i.effectDice=null),i.playShow(),i.diceSpine=null,i.diceWaitTimer=null}))},h.onBeforeClose=function(){this.effectDice=null,this.isWaitng=!1,this.canClose=!1},h.onDestroy=function(){},e}(h));e._RF.pop()}}}));

