System.register("chunks:///_virtual/ActivityPoolPartyEndView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./RedPoint.ts","./RedPointMgr.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./BattlePassDefine.ts","./MessageView.ts","./PayDefine.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./HorseCarnivalDataCache.ts","./ActivityPoolPartyDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,a,o,s,r,d,l,h,u,f,p,c,v,g,y,m,P,T;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Label,a=t.Button,o=t.Vec2},function(t){s=t.audioMgr},function(t){r=t.RedPointType},function(t){d=t.RedPointMgr},function(t){l=t.default},function(t){h=t.default},null,function(t){u=t.BattlePassDefine},function(t){f=t.default},function(t){p=t.PayEventDefine},function(t){c=t.default},function(t){v=t.ActivityType,g=t.ActivityState,y=t.ActivityEventDefine},function(t){m=t.HorseCarnivalDataCache},function(t){P=t.default},function(t){T=t.BaseView}],execute:function(){i._RF.push({},"5ac4fWu+O1PV4MN/eNSuzSu","ActivityPoolPartyEndView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).txtTimeDesc=void 0,e.txtLeftTime=void 0,e.leftTime=0,e.deltaTime=0,e.canUpdate=!1,e.name="ActivityPoolPartyEndView",e.url="ui/module/activityPoolParty/ActivityPoolPartyEndView",e.fullScreen=!0,e}e(i,t);var T=i.prototype;return T.onInit=function(){var t=this;this.txtTimeDesc=this.findChildComponent("nodeTime/txtDesc",n),this.txtLeftTime=this.findChildComponent("nodeTime/txtTime",n);var e=this.findChild("view/btnClose");this.addComponentCallbackListener(e,a.EventType.CLICK,(function(){t.close()}));var i=this.findChild("nodeTime/tips");this.addComponentCallbackListener(i,a.EventType.CLICK,(function(){IS(c).ShowSysTips(v.PoolPartyEnd)}));var s=this.findChild("view/btnGame");this.addRedPoint("poolparty_shot",s,new o(130,25),r.Dot),this.addComponentCallbackListener(s,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndShotGame);if(t&&t.state==g.Open)uiMgr.openView("ActivityPoolPartyShotMainView");else if(t&&t.state==g.Preview){var e=t.state_time[g.Open].start_time-h.serverTime;f.showFlyTip(l.formatStrWithMirrorDeal(GetLanguage(201410),h.formatTimeStringForSecond(e)))}else f.showFlyTip(GetLanguage(200026))}));var d=this.findChild("view/btnPass");this.addRedPoint("poolparty_endpass",d,new o(155,25),r.Dot),this.addComponentCallbackListener(d,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndPass);if(t&&t.state==g.Open)uiMgr.openView("ActivityPoolPartyEndPassView");else if(t&&t.state==g.Preview){var e=t.state_time[g.Open].start_time-h.serverTime;f.showFlyTip(l.formatStrWithMirrorDeal(GetLanguage(201410),h.formatTimeStringForSecond(e)))}else f.showFlyTip(GetLanguage(200026))}));var u=this.findChild("view/btnTurn");this.addRedPoint("poolparty_endturn",u,new o(110,25),r.Dot),this.addComponentCallbackListener(u,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndTurn);if(t&&t.state==g.Open)uiMgr.openView("ActivityPoolPartyEndTurnView");else if(t&&t.state==g.Preview){var e=t.state_time[g.Open].start_time-h.serverTime;f.showFlyTip(l.formatStrWithMirrorDeal(GetLanguage(201410),h.formatTimeStringForSecond(e)))}else f.showFlyTip(GetLanguage(200026))}));var p=this.findChild("view/btnRank");this.addComponentCallbackListener(p,a.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyRankView",v.PoolPartyEndPass)}));var y=this.findChild("view/btnTask");this.addRedPoint("poolparty_endtask",y,new o(25,30),r.Dot),this.addComponentCallbackListener(y,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndTurn);t&&t.state==g.Open?uiMgr.openView("ActivityPoolPartyTaskView",v.PoolPartyEndTurn):t&&t.state==g.Preview?f.showFlyTip(GetLanguage(200086)):f.showFlyTip(GetLanguage(200026))}));var m=this.findChild("view/btnGift");this.addComponentCallbackListener(m,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndTurn);t&&t.state==g.Open?uiMgr.openView("ActivityPoolPartyGiftView",v.PoolPartyEndTurn):t&&t.state==g.Preview?f.showFlyTip(GetLanguage(200086)):f.showFlyTip(GetLanguage(200026))}));var P=this.findChild("view/btnGift2");this.addComponentCallbackListener(P,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndEgg);if(t&&t.state==g.Open)uiMgr.openView("ActivityPoolPartyGiftView",v.PoolPartyEndEgg);else if(t&&t.state==g.Preview){var e=t.state_time[g.Open].start_time-h.serverTime;f.showFlyTip(l.formatStrWithMirrorDeal(GetLanguage(201410),h.formatTimeStringForSecond(e)))}else f.showFlyTip(GetLanguage(200026))}));var T=this.findChild("view/btnStore");this.addRedPoint("poolparty_endstore",T,new o(25,30),r.Dot),this.addComponentCallbackListener(T,a.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyStoreView",v.PoolPartyEnd)}));var w=this.findChild("view/btnFind");this.addRedPoint("poolparty_find",w,new o(130,25),r.Dot),this.addComponentCallbackListener(w,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndFind);t&&t.state==g.Open?uiMgr.openView("ActivityPoolPartyFindView"):t&&t.state==g.Preview?f.showFlyTip(GetLanguage(200086)):f.showFlyTip(GetLanguage(200026))}));var C=this.findChild("view/btnEgg");this.addRedPoint("poolparty_endegg",this.findChild("view/btnEgg"),new o(110,25),r.Dot),this.addComponentCallbackListener(C,a.EventType.CLICK,(function(){var t=IS(c).GetActivityInfo(v.PoolPartyEndEgg);if(t&&t.state==g.Open)uiMgr.openView("ActivityPoolPartyEndEggView");else if(t&&t.state==g.Preview){var e=t.state_time[g.Open].start_time-h.serverTime;f.showFlyTip(l.formatStrWithMirrorDeal(GetLanguage(201410),h.formatTimeStringForSecond(e)))}else f.showFlyTip(GetLanguage(200026))}))},T.registerUpdateHandler=function(){this.addEvent(y.OnActivityInfoUpdate,this.updateInfo,this),this.addEvent(y.OnActivityInfoTaskUpdate,this.updateRed,this),this.addEvent(y.OnActivityInfoUpdate,this.updateRed,this),this.addEvent(y.OnActivityEggUpdate,this.updateRed,this),this.addEvent(y.OnActivityEggReward,this.updateRed,this),this.addEvent(y.OnHorseCarnivalUpdate,this.updateRed,this),this.addEvent(y.OnHorseCarnivalReward,this.updateRed,this),this.addEvent(u.BATTLE_PASS_INFO_UPDATE,this.updateRed,this),this.addEvent(p.PAY_REWARD_UPDATE,this.updateRed,this)},T.onAfterOpen=function(){this.updateRed(),s.playMusic("xiaohuangya_mainbgm");var t=IS(c).GetActivityInfo(v.PoolPartyEnd);if(t){var e,i=null!=(e=t.state_time[t.state])?e:t.state_time[g.Open];if(this.leftTime=i.end_time-h.serverTime,this.leftTime>0){var n="";t.state==g.Preview?n=GetLanguage(200763):t.state==g.Open?n=GetLanguage(200764):t.state==g.EndShow&&(n=GetLanguage(200765)),this.txtTimeDesc.string=n,this.canUpdate=!0,this.txtLeftTime.string=l.formatStrWithMirrorDeal("%s",h.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}else this.txtTimeDesc.string=GetLanguage(200765),this.txtLeftTime.string=GetLanguage(200026)},T.onBeforeClose=function(){s.playMusic("battle"),this.canUpdate=!1},T.onDestroy=function(){},T.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=l.formatStrWithMirrorDeal("%s",h.formatTimeStringForSecond(this.leftTime)):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},T.updateRed=function(){IS(d).changeValue("poolparty_endtask",IS(c).GetTaskRedNum(v.PoolPartyEndTurn)),IS(d).changeValue("poolparty_endstore",IS(P).GetEndStoreRed()),IS(d).changeValue("poolparty_endturn",IS(m).getRedNum(v.PoolPartyEndTurn)),IS(d).changeValue("poolparty_endegg",IS(P).getEndEggRed()),IS(d).changeValue("poolparty_endpass",IS(P).getEndPassRedNum()),IS(d).changeValue("poolparty_shot",IS(c).GetTaskRedNum(v.PoolPartyEndShotGame)),IS(d).changeValue("poolparty_find",IS(P).getFindRedNum())},T.updateInfo=function(t){if(t.type==v.PoolPartyEnd&&t.state!=g.Null){var e,i=null!=(e=t.state_time[t.state])?e:t.state_time[g.Open];if(this.leftTime=i.end_time-h.serverTime,this.leftTime>0){var n="";t.state==g.Preview?n=GetLanguage(200763):t.state==g.Open?n=GetLanguage(200764):t.state==g.EndShow&&(n=GetLanguage(200765)),this.txtTimeDesc.string=n,this.canUpdate=!0,this.txtLeftTime.string=l.formatStrWithMirrorDeal("%s",h.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}},i}(T));i._RF.pop()}}}));

