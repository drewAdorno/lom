System.register("chunks:///_virtual/SlumberPartyTipsView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./HorseCarnivalDataCache.ts","./BasePopupView.ts"],(function(t){"use strict";var i,e,o,n,s,r,h,a,l,d,c,g,v,u,f;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t.UITransform,n=t.ScrollView,s=t.Button,r=t.Label,h=t.js},function(t){a=t.ItemGrid},function(t){l=t.ListItem},function(t){d=t.default},function(t){c=t.default},null,function(t){g=t.default},function(t){v=t.ActivityType},function(t){u=t.HorseCarnivalDataCache},function(t){f=t.BasePopupView}],execute:function(){var p;e._RF.push({},"c33c1gT+v9P4KPD5Z8r7uTC","SlumberPartyTipsView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).scroll=void 0,i.bgNode=void 0,i.bgUT=void 0,i.viewContainerNode=void 0,i.arrNode=void 0,i.arrUT=void 0,i.targetNode=void 0,i.scrollNode0=void 0,i.scroll0=void 0,i.scroll1=void 0,i.scroll2=void 0,i.scroll3=void 0,i.txtTitle1=void 0,i.txtDesc1=void 0,i.txtWeight1=void 0,i.txtWeight2=void 0,i.txtWeight3=void 0,i.txtWeight4=void 0,i.actType=void 0,i.name="SlumberPartyTipsView",i.url="ui/module/slumberparty/SlumberPartyTipsView",i}i(e,t);var h=e.prototype;return h.onInit=function(){var t=this;this.viewContainerNode=this.findChild("view"),this.bgNode=this.findChild("view/imgBg"),this.bgUT=this.bgNode.getComponent(o),this.arrNode=this.findChild("view/imgBg/imgArr"),this.arrUT=this.arrNode.getComponent(o);var i=this.findChildComponent("view/imgBg/scroll",n);this.scroll=this.addUIList(i,w);var e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){t.close()}));var h=this.findChild("root/imgMask");this.addComponentCallbackListener(h,s.EventType.CLICK,(function(){t.close()}));var a=this.findChildComponent("root/ScrollView/view/content/nodeDesc0/ScrollView",n);this.scrollNode0=this.findChild("root/ScrollView/view/content/nodeDesc0"),this.scroll0=this.addUIList(a,C);var l=this.findChildComponent("root/ScrollView/view/content/nodeDesc1/ScrollView",n);this.scroll1=this.addUIList(l,C);var d=this.findChildComponent("root/ScrollView/view/content/nodeDesc2/ScrollView",n);this.scroll2=this.addUIList(d,C);var c=this.findChildComponent("root/ScrollView/view/content/nodeDesc3/ScrollView",n);this.scroll3=this.addUIList(c,C),this.txtTitle1=this.findChildComponent("root/ScrollView/view/content/nodeDesc0/txtTitle",r),this.txtDesc1=this.findChildComponent("root/ScrollView/view/content/nodeDesc0/txtDesc",r),this.txtWeight1=this.findChildComponent("root/ScrollView/view/content/nodeDesc0/txtTitle-002",r),this.txtWeight2=this.findChildComponent("root/ScrollView/view/content/nodeDesc1/txtTitle-002",r),this.txtWeight3=this.findChildComponent("root/ScrollView/view/content/nodeDesc2/txtTitle-002",r),this.txtWeight4=this.findChildComponent("root/ScrollView/view/content/nodeDesc3/txtTitle-002",r)},h.registerUpdateHandler=function(){},h.onAfterOpen=function(){t.prototype.onAfterOpen.call(this),this.targetNode=this.openArgs[0],this.actType=this.openArgs[1];var i=IS(g).GetActivityInfo(this.actType),e=configMount_draw.getDatas();p=0;var o=[];this.actType==v.Artifact?(this.findChild("view").active=!0,this.findChild("root").active=!1):(this.findChild("view").active=!1,this.findChild("root").active=!0);var n=0,s=0,r=0,h=0,a=[],l=[],d=[],f=[];for(var w in e)if(e.hasOwnProperty(w)){var C=e[w];if(C.type==i.type&&C.group_id==i.roundCfg.group_id){if(1==C.quality||4==C.quality||6==C.quality)l.push(C),s+=C.weight;else if(2==C.quality)d.push(C),r+=C.weight;else if(3==C.quality)f.push(C),h+=C.weight;else if(5==C.quality){var m,x,y=null!=(m=null==(x=IS(u).getInfo(this.actType).choose_list[C.id])?void 0:x[1])?m:0;if(this.txtDesc1.string=c.formatStrWithMirrorDeal(GetLanguage(201377),configGoods.getDataByKey(C.reward_replace[0][1][0]).name),y>0){var T={quality:5,reward:C.reward_replace[0][1],weight:C.weight};a.push(T),this.txtTitle1.string=GetLanguage(201378)}else a.push(C),this.txtTitle1.string=GetLanguage(201379);n+=C.weight}else o.push(C);p+=C.weight}}this.txtWeight1.string=(n/p*100).toFixed(2)+"%",this.txtWeight2.string=(s/p*100).toFixed(2)+"%",this.txtWeight3.string=(r/p*100).toFixed(2)+"%",this.txtWeight4.string=(h/p*100).toFixed(2)+"%",this.scrollNode0.active=a.length>0,this.scroll0.datas=a,this.scroll1.datas=l,this.scroll2.datas=d,this.scroll3.datas=f,this.scroll.datas=o,this.UpdateAlign()},h.onBeforeClose=function(){},h.onDestroy=function(){},h.UpdateAlign=function(){var t=this.GetAlignCenter(),i=t.posX,e=t.posY,o=t.angleZ,n=t.arrowX,s=t.arrowY;this.viewContainerNode.setPosition(i,e),this.arrNode.setRotationFromEuler(0,0,o),this.arrNode.setPosition(n,s)},h.GetAlignCenter=function(){var t,i=this.targetNode.worldPosition,e=this.targetNode.getComponent(o),n=this.node.getComponent(o).convertToNodeSpaceAR(i),s=n.x-this.bgUT.width/2,r=n.x+this.bgUT.width/2,h=0,a=0,l=0,d=0,c=0;if((h=n.x)>=0){var g=r-360;g>0&&(c=g)}else{var v=s- -360;v<0&&(c=v)}return h-=c,t=c,n.y<0?(a=n.y+e.height/2+this.bgUT.height/2+this.arrUT.height-30,l=18-(this.bgUT.height/2+this.arrUT.height/2),d=0):(a=n.y-e.height/2-this.bgUT.height/2-this.arrUT.height+30,l=this.bgUT.height/2+this.arrUT.height/2-18,d=180),{posX:h,posY:a,angleZ:d,arrowX:t,arrowY:l}},e}(f));var w=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).txtName=void 0,i.txtValue=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){this.txtName=d.findChildComponent(this.node,"txtName",r),this.txtValue=d.findChildComponent(this.node,"txtValue",r)},o.onRender=function(t,i){var e=configGoods.getDataByKey(t.reward[0]);this.txtName.string=e.name+"*"+t.reward[1],this.txtValue.string=h.formatStr("%s%",(t.weight/p*100).toFixed(2))},e}(l),C=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).nodeItem=void 0,i.txtLimit=void 0,i.txtRatio=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){this.nodeItem=d.findChild(this.node,"itemGrid"),this.txtLimit=d.findChildComponent(this.node,"txtLimit",r),this.txtRatio=d.findChildComponent(this.node,"txtRatio",r),this.txtLimit.node.active=!1},o.onRender=function(t,i){1==t.quality?(this.txtLimit.node.active=!0,this.txtLimit.string=GetLanguage(201180)):4==t.quality?(this.txtLimit.node.active=!0,this.txtLimit.string=GetLanguage(201181)):this.txtLimit.node.active=!1,this.txtRatio.string=h.formatStr("%s%",(t.weight/p*100).toFixed(2)),new a(this.view,this.nodeItem).SetItemId(t.reward[0],t.reward[1])},e}(l);e._RF.pop()}}}));

