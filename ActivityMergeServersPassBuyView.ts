System.register("chunks:///_virtual/ActivityMergeServersPassBuyView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./UIList.ts","./NodeUtil.ts","./ItemGrid.ts","./ActivityDataCache.ts","./BattlePassDataCache.ts","./StringUtil.ts","./BagModel.ts","./PayControl.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,r,a,s,d,l,u,c,f,v,h,g,y;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,r=t.Label,a=t.ScrollView,s=t.js},null,function(t){d=t.ListItem},function(t){l=t.default},function(t){u=t.ItemGrid},function(t){c=t.default},function(t){f=t.BattlePassDataCache},function(t){v=t.default},function(t){h=t.BagModel},function(t){g=t.default},function(t){y=t.BaseView}],execute:function(){n._RF.push({},"2f128BLoPBOuJwDKDIADvee","ActivityMergeServersPassBuyView",void 0);t("default",function(t){function n(){var e;return(e=t.call(this)||this).nodeReward1=void 0,e.nodeReward2=void 0,e.scroll1=void 0,e.scroll2=void 0,e.rewardTitle=void 0,e.txtContent=void 0,e.txtDiamond=void 0,e.cfgId=0,e.name="ActivityMergeServersPassBuyView",e.url="ui/module/activityMergeServers/ActivityMergeServersPassBuyView",e}e(n,t);var d=n.prototype;return d.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.close()}));var i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()})),this.txtContent=this.findChildComponent("view/tips/btnDiamond/txtContent",r),this.txtDiamond=this.findChildComponent("view/tips/btnDiamond/txtDiamond",r),this.nodeReward1=this.findChild("view/reward1"),this.nodeReward2=this.findChild("view/reward2"),this.rewardTitle=this.findChildComponent("view/reward2/title/Label",r);var n=this.findChildComponent("view/reward1/rewardScroll",a);this.scroll1=this.addUIList(n,C);var s=this.findChildComponent("view/reward2/rewardScroll",a);this.scroll2=this.addUIList(s,C);var d=this.findChild("view/tips/buttons/btnEnsure");this.addComponentCallbackListener(d,o.EventType.CLICK,(function(){IS(g).send_19_5(t.cfgId),t.close()}));var l=this.findChild("view/tips/buttons/btnCancel");this.addComponentCallbackListener(l,o.EventType.CLICK,(function(){t.close()}))},d.registerUpdateHandler=function(){},d.onAfterOpen=function(){this.txtDiamond.string=v.GetNumString(IS(h).getGoodsCountByGoodsGtid(999));var t=IS(c).GetActivityInfo(this.openArgs[0]),e=this.openArgs[1],n=t.roundCfg.group_id,o=IS(f).getPassInfo(n),r=configWartoken_reward.getDataByList("id",n);if(r){var a="";if(1==e){a="high_reward";var d=configWartoken.getDataByKey(n),l=configPay_mall.getDataByKey(d.bundle_id);this.txtContent.string=s.formatStr(GetLanguage(200475),l.price),this.cfgId=d.bundle_id}else if(2==e){a="middle_reward";var u=configWartoken.getDataByKey(n),g=configPay_mall.getDataByKey(u.bundle_id2);this.txtContent.string=s.formatStr(GetLanguage(200475),g.price),this.cfgId=u.bundle_id2}var y=0,C=[];C[1]=0;for(var m=0;m<r.length;m++){var w=r[m];y+=w.exp,C[w.level+1]=y}this.rewardTitle.string=v.formatStr(GetLanguage(204311),GetLanguage(303645),C[o.max_lev]);for(var p,I=[],B=i(r);!(p=B()).done;)for(var L,D=p.value,G=i(D[a]);!(L=G()).done;){var S=L.value;o.lev<D.level||(I[S[0]]||(I[S[0]]={id:S[0],num:0}),I[S[0]].num=I[S[0]].num+S[1])}var b=[];for(var _ in I)I.hasOwnProperty(_)&&b.push(I[_]);if(b.sort((function(t,e){var i=configGoods.getDataByKey(t.id),n=configGoods.getDataByKey(e.id);return i.quality==n.quality?t.id-e.id:n.quality-i.quality})),this.scroll1.datas=b,o.lev<o.max_lev){this.nodeReward1.setPosition(0,95),this.nodeReward2.active=!0;for(var P,x=[],K=i(r);!(P=K()).done;)for(var A,R=P.value,k=i(R[a]);!(A=k()).done;){var M=A.value;x[M[0]]||(x[M[0]]={id:M[0],num:0}),x[M[0]].num=x[M[0]].num+M[1]}var q=[];for(var T in x)x.hasOwnProperty(T)&&q.push(x[T]);q.sort((function(t,e){var i=configGoods.getDataByKey(t.id),n=configGoods.getDataByKey(e.id);return i.quality==n.quality?t.id-e.id:n.quality-i.quality})),this.scroll2.datas=q}else this.nodeReward1.setPosition(0,-30),this.nodeReward2.active=!1}},d.onBeforeClose=function(){this.cfgId=0},d.onDestroy=function(){},n}(y));var C=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,e.itemGrid=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.itemGridNode=l.findChild(this.node,"itemGrid"),this.itemGrid=new u(this.view,this.itemGridNode)},n.onRender=function(t,e){this.itemGrid.SetItemId(t.id,t.num)},i}(d);n._RF.pop()}}}));

