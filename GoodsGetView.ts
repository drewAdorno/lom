System.register("chunks:///_virtual/GoodsGetView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./FixMath.ts","./ArtifactDataCache.ts","./ArtifactDefine.ts","./BagDefine.ts","./BagModel.ts","./BasePopupView.ts"],(function(t){"use strict";var i,e,o,n,a,s,r,d,c,l,h,f,g,u,m,p,v,I,y,C,S,w;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,n=t.Button,a=t.ScrollView,s=t.Label,r=t.Sprite,d=t.js,c=t.Vec3},function(t){l=t.audioMgr},function(t){h=t.SelectedType,f=t.ListItem},function(t){g=t.default},null,function(t){u=t.IconAseetType},function(t){m=t.ConfigGlobal},function(t){p=t.FixMath},function(t){v=t.ArtifactDataCache},function(t){I=t.posToRotation},function(t){y=t.ItemIdDefine,C=t.GoodsType},function(t){S=t.BagModel},function(t){w=t.BasePopupView}],execute:function(){o._RF.push({},"4e9acdGcvZHmoX3iHxSQjCl","GoodsGetView",void 0);t("default",function(t){function o(){var i;return(i=t.call(this)||this).itemList=void 0,i.scrollUIList=void 0,i.desScroll=void 0,i.data=void 0,i.baseNode=void 0,i.nodeExtra=void 0,i.imgExtra=void 0,i.txtExtra=void 0,i.des=void 0,i.name="GoodsGetView",i.url="ui/module/common/GoodsGetView",i}i(o,t);var f=o.prototype;return f.onInit=function(){var t=this,i=this.findChild("root/content/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.onMaskClick()}));var e=this.findChildComponent("root/content/scrollGoodsList",a);this.itemList=this.addUIList(e,A),this.itemList.selectedMode=h.SINGLE;var o=this.findChildComponent("root/content/desScroll",a);this.desScroll=this.addUIList(o,A),this.desScroll.selectedMode=h.SINGLE,this.des=this.findChildComponent("root/content/des",s),this.nodeExtra=this.findChild("root/content/extra"),this.imgExtra=this.findChildComponent("root/content/extra/imgIcon",r),this.txtExtra=this.findChildComponent("root/content/extra/num",s)},f.registerUpdateHandler=function(){},f.onMaskClick=function(){this.close()},f.onAfterOpen=function(){t.prototype.onAfterOpen.call(this),l.playSound("common_reward");for(var i,o=this.openArgs[0],n=[],a=[],s=e(o);!(i=s()).done;){var r=i.value;2!=r.gtid?n.push(r):a.push(r)}if(n.length>1&&n.sort((function(t,i){var e=configGoods.getDataByKey(t.gtid),o=configGoods.getDataByKey(i.gtid);if(e)var n=e.quality;else n=IS(v).getStoneInfoByID(t.gtid).quality;if(e)var a=o.quality;else a=IS(v).getStoneInfoByID(i.gtid).quality;return n>=a?-1:1})),a.length>0)for(var c,h=e(a);!(c=h()).done;){var f=c.value;n.unshift(f)}this.data=n,this.findChild("root/content/content").active=this.data.length<5;var g=this.openArgs[2];this.itemList.scrollView.node.active=!g&&this.data.length>=5,this.desScroll.scrollView.node.active=g&&this.data.length>=5,this.des.string=g||"",this.data.length<5?(this.baseNode=this.findChild("root/content/content"),this.onUpdateSmallGrid(this.data)):g?this.desScroll.datas=this.data:this.itemList.datas=this.data;var u=this.openArgs[1];if(this.nodeExtra.active=null!=u,null!=u){var m=u[0],p=configGoods.getDataByKey(m);this.loadIcon(this.imgExtra,p.icon_group,p.icon),this.txtExtra.string=d.formatStr("+%s",u[1])}},f.onUpdateSmallGrid=function(t){var i=this.findChild("root/content/content/item");this.baseNode.removeAllChildren();for(var e=0;e<t.length;e++){this.onCopy(i,t[e]).setParent(this.baseNode)}},f.onCopy=function(t,i){var e=nodeInstantiate.instantiate(t);e.active=!0;var o=g.findChildComponent(e,"imgFrame",r),a=g.findChildComponent(e,"imgIcon",r),l=g.findChildComponent(e,"num",s);i.gtid==y.FakeRechare?l.string=d.formatStr("%s ",p.round(i.num/100)):l.string=i.num+"";var h=configGoods.getDataByKey(i.gtid);if(a.node.eulerAngles=new c(0,0,0),o.node.eulerAngles=new c(0,0,0),h||i.type!=C.Artifact){if(h&&h.type==C.Fate){var f=configFate.getDataByKey(h.effect[0]);this.loadIcon(o,"fate",m.fate_quality_pos[f.quality-1][1]),this.loadIcon(a,"icon_fate",f.icon,null,u.ICON_SPRITE)}else if(h){var w=configColor.getDataByKey(h.quality);this.loadIcon(o,"icon_equip",w.path),this.loadIcon(a,h.icon_group,h.icon)}}else{var A=IS(v).getStoneInfoByID(i.gtid),_=configArtifact_gemquality.getDataByKey(A.quality).frame;this.loadIcon(o,"icon_gem",_);var x=configArtifact_gemsets.getDataByKey(A.suit);this.loadIcon(a,"icon_gem",x.icon),a.node.eulerAngles=new c(0,0,I[A.pos]),o.node.eulerAngles=new c(0,0,I[A.pos])}return this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){h||i.type!=C.Artifact?IS(S).OpenItemTips(null==h?void 0:h.id,e):uiMgr.openView("ArtifactInfoTipsView",i.gtid,e)})),e},f.onDestroy=function(){},o}(w));var A=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).imgFrame=void 0,i.imgIcon=void 0,i.txtNum=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){this.imgFrame=g.findChildComponent(this.node,"imgFrame",r),this.imgIcon=g.findChildComponent(this.node,"imgIcon",r),this.txtNum=g.findChildComponent(this.node,"num",s)},o.onRender=function(t,i){var e=this;t.gtid==y.FakeRechare?this.txtNum.string=d.formatStr("%s ",p.round(t.num/100)):this.txtNum.string=t.num+"";var o=configGoods.getDataByKey(t.gtid);if(this.imgIcon.node.eulerAngles=new c(0,0,0),this.imgFrame.node.eulerAngles=new c(0,0,0),o||t.type!=C.Artifact)if(o.type==C.Fate){var a=configFate.getDataByKey(o.effect[0]);this.view.loadIcon(this.imgFrame,"fate",m.fate_quality_pos[a.quality-1][1]),this.view.loadIcon(this.imgIcon,"icon_fate",a.icon,null,u.ICON_SPRITE)}else{var s=configColor.getDataByKey(o.quality);this.view.loadIcon(this.imgFrame,"icon_equip",s.path),this.view.loadIcon(this.imgIcon,o.icon_group,o.icon)}else{var r=IS(v).getStoneInfoByID(t.gtid),l=configArtifact_gemquality.getDataByKey(r.quality).frame;this.view.loadIcon(this.imgFrame,"icon_gem",l);var h=configArtifact_gemsets.getDataByKey(r.suit);this.view.loadIcon(this.imgIcon,"icon_gem",h.icon),this.imgIcon.node.eulerAngles=new c(0,0,I[r.pos]),this.imgFrame.node.eulerAngles=new c(0,0,I[r.pos])}this.view.addComponentCallbackListener(this.imgIcon.node,n.EventType.CLICK,(function(){o||t.type!=C.Artifact?IS(S).OpenItemTips(o.id,e.imgIcon.node):uiMgr.openView("ArtifactInfoTipsView",t.gtid,e.imgIcon.node)}))},o.onItemClick=function(){},e}(f);o._RF.pop()}}}));

