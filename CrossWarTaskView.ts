System.register("chunks:///_virtual/CrossWarTaskView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var e,i,n,s,o,a,r,d,c,h,u,f,v,l,p,C,y;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,s=t.ScrollView,o=t.Label,a=t.ProgressBar,r=t.Button,d=t.js},function(t){c=t.ItemGrid},function(t){h=t.ListItem},function(t){u=t.default},null,function(t){f=t.default},function(t){v=t.default},function(t){l=t.ActivityEventDefine,p=t.ActivityType,C=t.ActivityTaskState},function(t){y=t.BaseSubView}],execute:function(){n._RF.push({},"f966fgTmOpL8qeVwO2rrRMD","CrossWarTaskView",void 0);t("default",function(t){function n(){var e;return(e=t.call(this)||this).taskUIList=void 0,e.name="CrossWarTaskView",e.url="ui/module/crosswar/CrossWarTaskView",e.poolTime=3e3,e}e(n,t);var o=n.prototype;return o.onInit=function(){var t=this.findChildComponent("root/scrollTask",s);this.taskUIList=this.addUIList(t,g)},o.registerUpdateHandler=function(){this.addEvent(l.OnActivityInfoTaskUpdate,this.OnTaskUpdate,this),this.addEvent(l.OnActivityInfoUpdate,this.OnTaskUpdate,this)},o.onAfterOpen=function(){IS(f).send_24_14(p.CrossWar),this.OnTaskUpdate()},o.OnTaskUpdate=function(){for(var t,e=IS(v).GetActivityInfo(p.CrossWar),n=[],s=IS(v).GetRoundCfg(p.CrossWar,e.round),o=configActivity_task_group.getDataByKey(s.task_list[0]),a=i(o.task_list);!(t=a()).done;){var r=t.value;if(e.task_list.hasOwnProperty(r))n.push(e.task_list[r]);else{var d={cfg:configActivity_task.getDataByKey(r),state:0,count:0};n.push(d)}}n.sort((function(t,e){return t.state==C.CanGet&&e.state!=C.CanGet?-1:t.state!=C.CanGet&&e.state==C.CanGet?1:t.state!=e.state?t.state-e.state:t.id-e.id})),this.taskUIList.datas=n},o.onBeforeClose=function(){},o.onDestroy=function(){},n}(y));var g=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this).txtDesc=void 0,e.btnGet=void 0,e.received=void 0,e.undone=void 0,e.pb=void 0,e.schedule=void 0,e.RewardList=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.txtDesc=u.findChildComponent(this.node,"txtDesc",o),this.pb=u.findChildComponent(this.node,"ProgressBar",a),this.schedule=u.findChildComponent(this.node,"ProgressBar/schedule",o),this.received=u.findChild(this.node,"received"),this.undone=u.findChild(this.node,"undone"),this.btnGet=u.findChild(this.node,"btnGet"),this.view.addComponentCallbackListener(this.btnGet,r.EventType.CLICK,(function(){IS(f).send_24_15(p.CrossWar,t.data.task_id,t.data.group_id)}));var e=u.findChildComponent(this.node,"ScrollView",s);this.RewardList=this.view.addUIList(e,m,!1),this.RewardList.touchEvent=!1},n.onRender=function(t,e){this.txtDesc.string=t.cfg.desc,this.RewardList.datas=t.cfg.reward;var i=t.cfg.condition[2]-t.cfg.difference,n=Math.min(Math.max(0,t.count-t.cfg.difference),i);this.schedule.string=d.formatStr("%s/%s",n,i),this.pb.progress=n/i,t.state==C.CanGet?(this.received.active=!1,this.undone.active=!1,this.btnGet.active=!0):t.state==C.HadGet?(this.received.active=!0,this.undone.active=!1,this.btnGet.active=!1):(this.received.active=!1,this.undone.active=!0,this.btnGet.active=!1)},i}(h),m=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,e.itemGrid=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.itemGridNode=u.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode)},n.onRender=function(t,e){this.itemGrid.SetItemId(t[0],t[1])},i}(h);n._RF.pop()}}}));

