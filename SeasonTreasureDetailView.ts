System.register("chunks:///_virtual/SeasonTreasureDetailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./BagModel.ts","./SeasonControl.ts","./SeasonDataCache.ts","./SeasonDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,r,a,h,d,c,l,u,p,f,g,m,I,v,C;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.Sprite,s=t.Label,r=t.ScrollView,a=t.Layout,h=t.sys},function(t){d=t.ItemGrid},function(t){c=t.ListItem},function(t){l=t.default},function(t){u=t.default},null,function(t){p=t.IconAseetType},function(t){f=t.BagModel},function(t){g=t.default},function(t){m=t.SeasonDataCache},function(t){I=t.SeasonShipEventDefind,v=t.TREASURE_QUALITY_TO_INFO},function(t){C=t.BaseView}],execute:function(){e._RF.push({},"a57c1TECPVJUIGnJrSt6UkH","SeasonTreasureDetailView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).imgLight=void 0,i.imgIcon=void 0,i.txtName=void 0,i.nodeUpgrade=void 0,i.btnTop=void 0,i.btnUpgrade=void 0,i.btnUnlock=void 0,i.ownUIList=void 0,i.useUIList=void 0,i.starUIList=void 0,i.nodeBuff=void 0,i.Item=void 0,i.txtTips1=void 0,i.txtTips2=void 0,i.topNode=void 0,i.ownTopUIList=void 0,i.useTopUIList=void 0,i.curItemID=void 0,i.name="SeasonTreasureDetailView",i.url="ui/module/season/SeasonTreasureDetailView",i.poolTime=3e3,i}i(e,t);var h=e.prototype;return h.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()})),this.imgLight=this.findChildComponent("root/itemshow/bg",o),this.imgIcon=this.findChildComponent("root/itemshow/icon",o),this.txtName=this.findChildComponent("root/itemshow/nameBG/Label",s);var e=this.findChildComponent("root/content/nodeSkill/ScrollView",r);this.ownUIList=this.addUIList(e,U);var h=this.findChildComponent("root/content/nodeChange/ScrollView",r);this.useUIList=this.addUIList(h,U);var c=l.findChildComponent(this.node,"root/itemshow/ScrollView",r);this.starUIList=this.addUIList(c,T,!1,0),this.nodeBuff=this.findChild("root/content/nodeChange"),this.nodeUpgrade=this.findChild("root/content/nodeUpgrade"),this.btnTop=this.findChild("root/btnTop"),this.addComponentCallbackListener(this.btnTop,n.EventType.CLICK,(function(){t.showTopAttr()})),this.btnUpgrade=this.findChild("root/content/nodeUpgrade/btnUpgrade"),this.addComponentCallbackListener(this.btnUpgrade,n.EventType.CLICK,(function(){IS(g).reqShipTreasureLevelUp(t.curItemID)})),this.btnUnlock=this.findChild("root/content/nodeUpgrade/btnActive"),this.addComponentCallbackListener(this.btnUnlock,n.EventType.CLICK,(function(){IS(g).reqShipTreasureLevelUp(t.curItemID)}));var u=this.findChild("root/content/nodeUpgrade/itemGrid");this.Item=new d(this,u),this.txtTips1=this.findChildComponent("root/content/nodeSkill/common_ui_xiaotidi/txtName",s),this.txtTips2=this.findChildComponent("root/content/nodeChange/common_ui_xiaotidi/txtName",s),this.topNode=this.findChild("top");var p=this.findChild("top/imgMask");this.addComponentCallbackListener(p,n.EventType.CLICK,(function(){t.topNode.active=!1}));var f=this.findChildComponent("top/content/nodeSkill/ScrollView",r);this.ownTopUIList=this.addUIList(f,U);var m=this.findChildComponent("top/content/nodeChange/ScrollView",r);this.useTopUIList=this.addUIList(m,U);for(var I=this.node.getComponentsInChildren(a),v=0;v<I.length;v++)1==I[v].type&&this.dealMirrorLayout(I[v])},h.registerUpdateHandler=function(){this.addEvent(I.TYPE_TREASURE_LIST_UPDATE,this.updateInfo,this)},h.onAfterOpen=function(){this.topNode.active=!1,this.curItemID=this.openArgs[0],this.refreshAttrShow(),this.refreshStar()},h.refreshStar=function(){for(var t=IS(m).getTreasureInfoById(this.curItemID).star,i=[0,0,0,0,0],e=0;e<t;e++){i[e%5]+=1}this.starUIList.datas=i},h.refreshAttrShow=function(){var t=IS(m).getTreasureInfoById(this.curItemID).star,i=configSeason_treasure.getDataByKeys("id",this.curItemID,"level",t),e=configSeason_treasure.getDataByKeys("id",this.curItemID,"level",t+1),n=!1;if(0==t?(this.ownUIList.datas=e.own,this.useUIList.datas=e.extra,this.txtTips1.string=GetLanguage(204238),this.txtTips2.string=GetLanguage(204238)):(this.ownUIList.datas=i.own,this.useUIList.datas=i.extra,this.txtTips1.string=GetLanguage(204239),this.txtTips2.string=GetLanguage(204239)),i.cost&&i.cost.length>0){this.Item.SetItemId(i.cost[0][0],0);var o=IS(f).getGoodsCountByGoodsGtid(i.cost[0][0]),r=i.cost[0][1];n=o>=r,this.findChildComponent("root/content/nodeUpgrade/itemGrid/num",s).string=o+"/"+r}else this.txtTips1.string=GetLanguage(204628),this.txtTips2.string=GetLanguage(204628);null!=e?(this.btnTop.active=!0,this.nodeUpgrade.active=!0,this.Item.node.active=!0,this.btnUnlock.active=!1,this.btnUpgrade.active=!0,this.nodeUpgrade.active=!0,0==IS(m).getTreasureInfoById(this.curItemID).star&&(this.btnUnlock.active=!0,this.btnUpgrade.active=!1)):(this.nodeUpgrade.active=!1,this.btnTop.active=!1,this.nodeUpgrade.active=!1,this.Item.node.active=!1,this.btnUnlock.active=!1,this.btnUpgrade.active=!1),l.findChild(this.btnUnlock,"rp").active=n,l.findChild(this.btnUpgrade,"rp").active=n,this.loadIcon(this.imgIcon,"season_equip",i.icon,null,p.ICON_SPRITE),this.loadIcon(this.imgLight,"season_treasure",v[i.type].light),this.txtName.string=i.name},h.showTopAttr=function(){this.topNode.active=!0;var t=configSeason_treasure.getDataByList("id",this.curItemID),i=t[t.length-1];this.ownTopUIList.datas=i.own,this.useTopUIList.datas=i.extra},h.onBeforeClose=function(){},h.onDestroy=function(){},h.updateInfo=function(){this.refreshAttrShow(),this.refreshStar()},e}(C));var U=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtName=void 0,i.txtAttr=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.txtName=l.findChildComponent(this.node,"name",s),this.txtAttr=l.findChildComponent(this.node,"attr",s)},n.onRender=function(t,i){var e=configAttribute.getDataByKey(t[0]);this.txtName.string=e.name;var n=1==e.num_type?"":"%";2==e.show_type?this.txtAttr.string=u.formatStr(h.uiMirror?"##2##1+":"+##1##2",u.GetNumString(t[1]/100),n):3==e.show_type?this.txtAttr.string=u.formatStr(h.uiMirror?"##1+":"+##1",u.GetNumString(Math.floor(t[1]/100)/100)):this.txtAttr.string=u.formatStr(h.uiMirror?"##2##1+":"+##1##2",u.GetNumString(t[1]),n)},e}(c),T=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).imgOne=void 0,i.imgTwo=void 0,i.imgThree=void 0,i.imgDark=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.imgOne=l.findChild(this.node,"one"),this.imgTwo=l.findChild(this.node,"two"),this.imgThree=l.findChild(this.node,"three"),this.imgDark=l.findChild(this.node,"dark")},n.onRender=function(t,i){this.imgDark.active=0==t,this.imgOne.active=1==t,this.imgTwo.active=2==t,this.imgThree.active=3==t},n.onItemClick=function(){},e}(c);e._RF.pop()}}}));

