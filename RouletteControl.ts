System.register("chunks:///_virtual/RouletteControl.ts",["cc","./RedPointMgr.ts","./TimeUtil.ts","./RouletteDataCache.ts","./RouletteDefine.ts","./index57.ts","./AdDefine.ts","./AdModel.ts","./ControlMgr.ts","./RoleDataCache.ts","./UIDefine.ts"],(function(e){"use strict";var t,n,o,i,c,a,l,r,u,s;return{setters:[function(e){t=e.cclegacy},function(e){n=e.RedPointMgr},function(e){o=e.default},function(e){i=e.RouletteDataCache},function(e){c=e.RouletteEventDefine},null,function(e){a=e.ADS_TYPE},function(e){l=e.AdModel},function(e){r=e.controlMgr},function(e){u=e.RoleDataCache},function(e){s=e.OpenFunction}],execute:function(){t._RF.push({},"c83acDOz6ZIVLtzUOlwqerO","RouletteControl",void 0);e("default",function(){var e=t.prototype;function t(){netManager.addEventListener("ad.ad_wheel_info_s2c",this.on_ad_wheel_info_s2c,this),netManager.addEventListener("ad.ad_wheel_spin_s2c",this.on_ad_wheel_spin_s2c,this),r.addControl(this)}return e.clear=function(){printLog("RouletteControl")},e.onLogin=function(){this.reqRollInfo()},e.onReconnect=function(){},e.reqRollInfo=function(){netManager.send("ad.ad_wheel_info_c2s",{})},e.reqStartRoll=function(){IS(i).rollTime>0?netManager.send("ad.ad_wheel_spin_c2s",{}):IS(l).tryWatchAd(a.AD_TURNTABLE)},e.on_ad_wheel_info_s2c=function(e){IS(i).rollTime=e.num,IS(i).rollCD=e.cd},e.on_ad_wheel_spin_s2c=function(e){IS(i).rewardNum=e.id,normalEvent.emit(c.ROULETTE_INFO_UPDATE),t.checkRedPoint()},t.checkRedPoint=function(){var e=IS(l).getAdWatchCount(a.AD_TURNTABLE),t=configAds.getDataByKey(a.AD_TURNTABLE),c=IS(i).rollCD,r=Math.max(0,c-o.serverTime);return IS(i).rollTime<0||e>=t.times||r>0?(IS(n).changeValue("Roulette_Redpoint",0),0):(IS(n).changeValue("Roulette_Redpoint",1),IS(u).CheckFuncOpen(s.FUNC_ROLL)?1:0)},t}());t._RF.pop()}}}));

