System.register("chunks:///_virtual/PlayerInfoView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./AudioMgr.ts","./FlagItem.ts","./RankTitle.ts","./UIList.ts","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./PlatformUtil.ts","./StringUtil.ts","./index57.ts","./UIUnitModelObj.ts","./MulLanguageUtil.ts","./ArtifactDefine.ts","./BagModel.ts","./GameSetting.ts","./MessageView.ts","./EquipDefine.ts","./EquipModel.ts","./HorseDefine.ts","./LoginDataCache.ts","./LoginDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./NativeToJs.ts","./WelfareDataCache.ts","./WingDataCache.ts","./BubbleDataCache.ts","./CustomeHeadDataCache.ts","./CustomeHeadDefine.ts","./FrameDataCache.ts","./TitleControl.ts","./TitleDataCache.ts","./TitleDefine.ts","./LoginControl.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,s,o,a,d,h,l,r,c,u,v,f,C,g,I,p,L,m,S,_,y,k,w,b,E,T,R,x,B,U,P,A,N,G,D,M,K,V,F,O,H,q,W,j,J,Y,Z,Q,z;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,s=t.Button,o=t.Vec2,a=t.Label,d=t.Sprite,h=t.sys,l=t.js,r=t.ScrollView,c=t.Layout},function(t){u=t.NATIVE},function(t){v=t.audioMgr},function(t){f=t.FlagItem},function(t){C=t.RankTitle,g=t.TitleType},function(t){I=t.SelectedType,p=t.ListItem},function(t){L=t.RedPointType},function(t){m=t.RedPointMgr},function(t){S=t.default},function(t){_=t.PlatformUtil,y=t.PlatformAuthSetting},function(t){k=t.default},null,function(t){w=t.UIUnitModelObj},function(t){b=t.default},function(t){E=t.ArtifactEvent},function(t){T=t.BagModel},function(t){R=t.default,x=t.GameSettingKey},function(t){B=t.default},function(t){U=t.EquipEventDefine},function(t){P=t.EquipModel},function(t){A=t.HorseEvent},function(t){N=t.LoginDataCache},function(t){G=t.LoginEventDefine},function(t){D=t.default},function(t){M=t.RoleDataCache},function(t){K=t.RoleEventDefine,V=t.PlayerAttr},function(t){F=t.NativeToJs},null,function(t){O=t.WingDataCache},function(t){H=t.BubbleDataCache},function(t){q=t.CustomeHeadDataCache},function(t){W=t.CustomeHeadDefine},function(t){j=t.FrameDataCache},function(t){J=t.default},function(t){Y=t.TitleDataCache},function(t){Z=t.TitleEventDefine},function(t){Q=t.default},function(t){z=t.BaseView}],execute:function(){n._RF.push({},"a60a9lLG+FEM7MmYZuofxZp","PlayerInfoView",void 0);var X=1,$=2,tt=3,et=4,it=(t("default",function(t){function i(){var e;return(e=t.call(this)||this).curIndex=0,e.tabBtns=[],e.playerPanel=void 0,e.settingPanel=void 0,e.notifyPanel=void 0,e.skinPanel=void 0,e.settingValues={},e.name="PlayerInfoView",e.url="ui/module/player/PlayerInfoView",e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this,e=this.findChild("btnClose");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){t.onCloseClick()}));var i=this.findChild("imgMask");this.addComponentCallbackListener(i,s.EventType.CLICK,(function(){t.onCloseClick()}));for(var n=function(e){var i=S.findChild(t.node,l.formatStr("tab/content/item%s",e)),n={itemGo:i,selectedGo:S.findChild(i,"selected"),index:e};t.addComponentCallbackListener(i,s.EventType.CLICK,(function(){t.SetIndex(n.index)})),t.tabBtns[e]=n},o=1;o<=3;o++)n(o);this.playerPanel=new it,this.playerPanel.init(this.findChild("container/player"),this),this.settingPanel=new nt,this.settingPanel.init(this.findChild("container/setting"),this),this.skinPanel=new ot,this.skinPanel.init(this.findChild("container/skin"),this),this.notifyPanel=new dt,this.notifyPanel.init(this.findChild("container/notify"),this)},n.onCloseClick=function(){this.close()},n.registerUpdateHandler=function(){this.addEvent(K.ROLE_INFO_UPDATE,this.updateInfo,this),this.addEvent(K.ROLE_SKIN_CHANGE,this.updateInfo,this),this.addEvent(U.EQUIP_FIGURE_UPDATE,this.updateInfo,this),this.addEvent(E.TYPE_ARTIFACT_CHANGE,this.updateInfo,this),this.addEvent(A.TYPE_HORSE_CHANGE,this.updateInfo,this),this.addEvent(G.UPLOADIMGBACK,this.updateRolePanel,this),this.addEvent(G.ROLE_SKIN_LEVEL_UP,this.updateInfo,this),this.addEvent(G.ROLE_SKIN_LEVEL_UP,this.updateInfo,this),this.addEvent(K.ROLE_SKIN_LIST,this.updateInfo,this),this.addEvent(Z.Title_INFO_UPDATE,this.updateTitleInfo,this),this.addEvent(Z.Frame_INFO_UPDATE,this.updateInfo,this),this.addEvent(Z.Bubble_INFO_UPDATE,this.updateInfo,this),this.addEvent(W.UpdateHeadRed,this.updateInfo,this)},n.onAfterOpen=function(){IS(D).send_3_16(),IS(J).send_42_1(),this.SetIndex(X),this.UpdateSkinRed()},n.onBeforeClose=function(){for(var t in this.playerPanel.hide(),this.curIndex>0&&(this.tabBtns[this.curIndex].selectedGo.active=!1,this.curIndex=0),this.settingValues)if(this.settingValues.hasOwnProperty(t)){var e=this.settingValues[t];null!=e&&(IS(R).set(Number(t),e),this.settingValues[t]=null)}},n.onDestroy=function(){},n.UpdateSkinRed=function(){this.addRedPoint("skin_red",this.tabBtns[tt].itemGo,new o(60,15),L.Dot),IS(M).CheckSkinRed()},n.SetIndex=function(t){if(this.curIndex!=t){for(var e in this.curIndex,this.curIndex=t,this.tabBtns)this.tabBtns[e].selectedGo.active=Number(e)==this.curIndex;this.curIndex==X?(this.playerPanel.setActive(!0),this.settingPanel.setActive(!1),this.skinPanel.setActive(!1),this.notifyPanel.setActive(!1),this.playerPanel.show()):this.curIndex==$?(this.playerPanel.setActive(!1),this.playerPanel.hide(),this.settingPanel.setActive(!0),this.skinPanel.setActive(!1),this.notifyPanel.setActive(!1),this.settingPanel.show()):this.curIndex==tt?(this.playerPanel.setActive(!1),this.playerPanel.hide(),this.settingPanel.setActive(!1),this.notifyPanel.setActive(!1),this.skinPanel.setActive(!0),this.skinPanel.show()):this.curIndex==et&&(this.playerPanel.setActive(!1),this.playerPanel.hide(),this.skinPanel.setActive(!1),this.settingPanel.setActive(!1),this.notifyPanel.setActive(!0),this.notifyPanel.show())}},n.updateRolePanel=function(t){this.playerPanel.updateUrl(t)},n.updateInfo=function(){this.curIndex==X?this.playerPanel.show():this.curIndex==$||(this.curIndex==tt?this.skinPanel.show():this.curIndex),this.UpdateSkinRed()},n.updateTitleInfo=function(){this.curIndex==X&&this.playerPanel.show()},n.OnSettingChange=function(t,e){this.settingValues[t]=e,t==x.MUSIC_ON?v.setMusicVolume(e?1:0):t==x.SOUND_ON&&v.setSoundVolume(e?1:0)},i}(z)),t("PlayerPanel",function(){function t(){this.view=void 0,this.node=void 0,this.txtName=void 0,this.genderIcon=void 0,this.headicon=void 0,this.headFrame=void 0,this.titleicon=void 0,this.titleNode=void 0,this.txtMbti=void 0,this.flagItem=void 0,this.flagTxt=void 0,this.txtUid=void 0,this.txtServer=void 0,this.txtServer2=void 0,this.txtGender=void 0,this.topnode=void 0,this.wechatUserInfoButton=void 0,this.avatarUrl="",this.imgJob=void 0,this.model=void 0,this.styleBtn=void 0,this.btnCustom=void 0,this.headBtn=void 0,this.roleList=[],this.serverList=[]}var e=t.prototype;return e.init=function(t,e){this.view=e,this.node=t,this.onInit()},e.onInit=function(){var t=this;this.txtName=S.findChildComponent(this.node,"name/desc",a),this.txtGender=S.findChild(this.node,"gender/desc"),this.genderIcon=S.findChildComponent(this.node,"gender/img",d),this.txtMbti=S.findChildComponent(this.node,"mbti/desc",a),this.txtUid=S.findChildComponent(this.node,"uid",a),this.txtServer=S.findChildComponent(this.node,"server/server",a),this.txtServer2=S.findChildComponent(this.node,"server/server2",a),this.imgJob=S.findChild(this.node,"style/role"),this.titleicon=S.findChild(this.node,"style/title"),this.titleNode=S.findChild(this.node,"style/title"),this.flagTxt=S.findChildComponent(this.node,"flag/desc",a),this.flagItem=new f(this.view,S.findChild(this.node,"flag/flag")),this.topnode=S.findChild(this.node,"head/toppos"),this.headicon=S.findChildComponent(this.node,"head/image",d),this.headFrame=S.findChildComponent(this.node,"head/headFrame",d);var e=S.findChild(this.node,"mbti/btn");this.view.addComponentCallbackListener(e,s.EventType.CLICK,(function(){var t=IS(M).GetRoleAttr(V.ROLE_ATTR_MBTI);_.HideContactButton(),uiMgr.openView("PlayerMbtiView",t)}));var i=S.findChild(this.node,"name/btn");this.view.addComponentCallbackListener(i,s.EventType.CLICK,(function(){_.HideContactButton(),uiMgr.openView("PlayerRenameView")}));var n=S.findChild(this.node,"gender/btn");this.view.addComponentCallbackListener(n,s.EventType.CLICK,(function(){_.HideContactButton(),uiMgr.openView("PlayerGenderView")}));var o=S.findChild(this.node,"flag/btn");this.view.addComponentCallbackListener(o,s.EventType.CLICK,(function(){_.HideContactButton(),uiMgr.openView("FlagSelectView",1)})),this.headBtn=S.findChild(this.node,"head/btn"),this.headBtn.active=!F.IsPreviewServer(),this.view.addComponentCallbackListener(this.headBtn,s.EventType.CLICK,(function(){_.HideContactButton(),uiMgr.openView("PlayerCustomeHeadView")})),this.styleBtn=S.findChild(this.node,"style/btn"),this.view.addComponentCallbackListener(this.styleBtn,s.EventType.CLICK,(function(){_.HideContactButton(),uiMgr.openView("PlayerClosetView")}));var l=S.findChild(this.node,"server/btnServer");l.active=!F.IsPreviewServer(),this.view.addComponentCallbackListener(l,s.EventType.CLICK,(function(){uiMgr.openView("PlayerServerView"),_.HideContactButton(),null!=t.wechatUserInfoButton&&(t.wechatUserInfoButton.destroy(),t.wechatUserInfoButton=null)}));var r=S.findChild(this.node,"btn_list/btnNotice");r.active=!F.IsPreviewServer(),this.view.addComponentCallbackListener(r,s.EventType.CLICK,(function(){_.HideContactButton(),t.onNoticeClick()}));var c=S.findChild(this.node,"btn_list/btnCode");c.active=!F.IsPreviewServer(),this.view.addComponentCallbackListener(c,s.EventType.CLICK,(function(){_.HideContactButton(),t.onCodeClick()})),this.btnCustom=S.findChild(this.node,"btn_list/btnCustom"),this.btnCustom.active=!F.IsPreviewServer(),this.view.addComponentCallbackListener(this.btnCustom,s.EventType.CLICK,(function(){uiMgr.openView("KeFuNoticeView")}));var v=S.findChild(this.node,"btn_list/btnSwitchUser");this.view.addComponentCallbackListener(v,s.EventType.CLICK,(function(){1==GlobalDefine.ENABLE_SDK?sdkControl.SwitchUser():mainGame.exitApp()}));var C=S.findChild(this.node,"btn_list/btnBindAccount");C.active=!F.IsPreviewServer(),this.view.addComponentCallbackListener(C,s.EventType.CLICK,(function(){var t=IS(N);if(t.sdkExt&&t.sdkExt.length>0){var e=JSON.parse(t.sdkExt);console.log(e.is_tmp_account),"yes"==e.is_tmp_account?sdkControl.hwLoginBind():B.showFlyTip(GetLanguage(300100))}}));var g=S.findChild(this.node,"btn_list/btnClearCache"),I=S.findChildComponent(this.node,"btn_list/btnClearCache/Label",a),p=h.os==h.OS.IOS;h.os==h.OS.ANDROID&&(p=1==F.GetBagTag()),p=p&&u,g.active=p,I.string=GetLanguage(300118),this.view.addComponentCallbackListener(g,s.EventType.CLICK,(function(){F.deleteAccount()}))},e.onNoticeClick=function(){uiMgr.openView("NoticeView")},e.onCodeClick=function(){uiMgr.openView("RedeemCodeView")},e.onCustomClick=function(){sdkControl.openCustomService()},e.updateHeadFrame=function(){var t=IS(j).curFrameId;if(t>0){var e=configAvatar_frame.getDataByKey(t);this.view.loadIcon(this.headFrame,"icon_frame",e.icon),this.headFrame.node.active=!0}else this.headFrame.node.active=!1},e.updateUrl=function(t){this.avatarUrl=t;var e=new Array;e.push({k:V.ROLE_ATTR_HEAD_URL,s:this.avatarUrl});var i={ks:e};IS(D).send_3_22(i),this.view.loadRemoteIcon(this.avatarUrl,this.headicon)},e.hide=function(){_.HideContactButton(),null!=this.wechatUserInfoButton&&(this.wechatUserInfoButton.destroy(),this.wechatUserInfoButton=null),null!=this.model&&(this.view.removeUnitModel(this.model),this.model=null)},e.GetUserInfo=function(){var t=this;_.getUserInfo((function(e,i,n){1==n&&e!=t.avatarUrl&&sdkControl.uploadImg(e)}))},e.show=function(){var t=this,e=this.topnode.worldPosition.x,i=S.TransCocosPosToScreenPosY(this.topnode.worldPosition.y);0==_.hasAuthSeting(y.UserInfo)&&null==this.wechatUserInfoButton&&(this.wechatUserInfoButton=_.createUserInfoButton(e,i,116,116),this.wechatUserInfoButton.onTap((function(e){var i;null!=e.encryptedData&&(_.setAuthSeting(y.UserInfo,!0),t.GetUserInfo(),null==(i=t.wechatUserInfoButton)||i.destroy(),t.wechatUserInfoButton=null)})));var n=IS(M);this.txtName.string=n.GetRoleAttr(V.ROLE_ATTR_NAME);var s=n.GetRoleAttr(V.ROLE_ATTR_MBTI);if(s>0){var o=configMbti.getDataByKey(s);this.txtMbti.string=o.type}else this.txtMbti.string=GetLanguage(200310);this.txtUid.string=l.formatStr("UID:%s",n.GetShowId()),this.txtServer.string=GetLanguage(200533)+"\n"+IS(N).loginServer.name,this.txtServer2.node.active=!1,this.RequestServerList(),0==n.GetRoleAttr(V.ROLE_ATTR_GENDER)?(this.txtGender.active=!0,this.txtGender.getComponent(a).string=GetLanguage(200310),this.genderIcon.node.active=!1):1==n.GetRoleAttr(V.ROLE_ATTR_GENDER)?(this.txtGender.active=!1,this.genderIcon.node.active=!0,this.view.loadIcon(this.genderIcon,"player","grxx_ui_nan")):(this.txtGender.active=!1,this.genderIcon.node.active=!0,this.view.loadIcon(this.genderIcon,"player","grxx_ui_nv"));var d=n.GetRoleAttr(V.ROLE_ATTR_FLAG);d>0?(this.flagItem.SetFlag(d),this.flagTxt.string=""):(this.flagItem.SetFlag(0),this.flagTxt.string=GetLanguage(200310)),this.avatarUrl=n.GetRoleAttr(V.ROLE_ATTR_HEAD_URL),this.view.loadRemoteIcon(this.avatarUrl,this.headicon),null!=this.model&&(this.view.removeUnitModel(this.model),this.model=null);var r=1,c=IS(P).getShowEquipCfgIdByLocation(1),u=IS(O).wing_id,v=IS(P).getShowEquipCfgIdByLocation(2),f=IS(P).getShowEquipCfgIdByLocation(3),I=IS(M).GetTypeUsedSkin(1),p=IS(M).GetTypeUsedSkin(0),L=IS(M).GetRoleAttr(V.ROLE_ATTR_GENDER),m=IS(M).GetTypeUsedSkin(2)||0,k=w.getModelId(p,m,L),b=configUnitModel.getDataByKey(k);b&&b.skin_scale>0&&(r=.66*b.skin_scale),this.model=this.view.addUnitModel({job:IS(M).GetTypeUsedSkin(0),dressId:m,gender:IS(M).GetRoleAttr(V.ROLE_ATTR_GENDER),weapon:c,ornaments:v,face:f,color:I,parent:this.imgJob,shenqi:0,wing:u},null,r),h.uiMirror&&(this.view.getUnitModel(this.model).dir=-1);var E=IS(Y).curTitleId;if(E>0){var T=this.view.getUnitModel(this.model).modelHeight;configTitle.getDataByKey(E);this.titleNode.setPosition(0,T),this.titleNode.active=!0,new C(this.view,this.titleicon).SetRankTitle(E,g.NORMAL)}else this.titleNode.active=!1;this.updateStyleRed(),this.UpdateCustomeHeadRed(),this.updateHeadFrame()},e.updateStyleRed=function(){this.view.addRedPoint("style_red",this.styleBtn,new o(100,30),L.Dot);var t=IS(Y).CanUnLockTitle(),e=IS(j).CanUnLockFrame(),i=IS(H).CanUnLockBubble();IS(m).changeValue("style_red",t+e+i)},e.UpdateCustomeHeadRed=function(){this.view.addRedPoint("customeHead_red",this.headBtn,new o(10,22),L.Dot);var t=IS(q).GetIsRed();IS(m).changeValue("customeHead_red",t)},e.setActive=function(t){this.node.active=t},e.updateServerInfo=function(){var t,e,i=IS(M).GetRoleAttr(V.ROLE_ATTR_SERVER),n=this.roleList.find((function(t){return t.role_id==IS(M).GetRoleId()})),s=null!=(t=null==n?void 0:n.original_server_id)?t:0,o=null!=(e=null==n?void 0:n.original_server_name)?e:"";0==s||s==i?this.txtServer2.node.active=!1:(this.txtServer2.node.active=!0,this.txtServer2.string=GetLanguage(700030171)+"\n"+o)},e.RequestServerList=function(){var t=this,e=IS(N);this.serverList=e.serverList,null==e.serverList||0==e.serverList.length?IS(Q).requestServerList((function(i){i&&(t.serverList=e.serverList,IS(Q).use2LoginServer()?(console.error("使用双登录服，请求第二个登录服"),IS(Q).requestServer2ListUrl((function(i){i&&IS(Q).requestServerList2((function(i){i&&(t.serverList=t.serverList.concat(e.serverList2),t.RequestRoleList())}))}))):t.RequestRoleList())})):(console.error("服务器列表不为空"),console.error(JSON.stringify(this.serverList)),console.error(JSON.stringify(e.serverList2)),IS(Q).use2LoginServer()?null==e.serverList2||0==e.serverList2.length?IS(Q).requestServer2ListUrl((function(i){i&&IS(Q).requestServerList2((function(i){i&&(t.serverList=t.serverList.concat(e.serverList2),t.RequestRoleList())}))})):(this.serverList=this.serverList.concat(e.serverList2),this.RequestRoleList()):this.RequestRoleList())},e.RequestRoleList=function(){var t=this,e=IS(N);this.roleList=IS(N).roleList,null==this.roleList||0==this.roleList.length?loginControl.RequestRoleList(e.plat,e.uid,(function(e,i){e&&(t.roleList=IS(N).roleList,loginControl.use2LoginServer()?t.RequestRoleList2():t.updateServerInfo())})):(console.error("角色列表不为空"),loginControl.use2LoginServer()?null!=IS(N).roleList2&&IS(N).roleList2.length>0?(this.roleList=this.roleList.concat(IS(N).roleList2),this.updateServerInfo()):this.RequestRoleList2():this.updateServerInfo())},e.RequestRoleList2=function(){var t=this,e=IS(N),i=IS(N).roleList2;null==i||0==i.length?loginControl.RequestRoleList2(e.plat,e.uid,(function(e,i){e&&(t.roleList=t.roleList.concat(IS(N).roleList2),t.updateServerInfo())})):(this.roleList=this.roleList.concat(i),this.updateServerInfo())},t}())),nt=t("SettingPanel",function(){function t(){this.view=void 0,this.node=void 0,this.CNBtn=void 0,this.TWBtn=void 0,this.CNBtnSelect=void 0,this.TWBtnSelect=void 0,this.txtVersion=void 0,this.languageText=void 0,this.settingList=void 0}var e=t.prototype;return e.init=function(t,e){this.view=e,this.node=t,this.onInit()},e.onInit=function(){var t=this;this.txtVersion=S.findChildComponent(this.node,"txtVersion",a);var e=S.findChild(this.node,"btn");this.view.addComponentCallbackListener(e,s.EventType.CLICK,(function(){}));var i=S.findChild(this.node,"lanauage/btnchangelaguange");this.view.addComponentCallbackListener(i,s.EventType.CLICK,(function(){uiMgr.openView("PlayerLanguageView")})),this.languageText=S.findChildComponent(this.node,"lanauage/btnchangelaguange/Label",a),this.CNBtn=S.findChild(this.node,"voice/btn1"),this.view.addComponentCallbackListener(this.CNBtn,s.EventType.CLICK,(function(){F.UseLanguage="CN",t.CNBtnSelect.active=!0,t.TWBtnSelect.active=!1,IS(R).set(x.LANGUAGE_SELECT,2)})),this.TWBtn=S.findChild(this.node,"voice/btn2"),this.view.addComponentCallbackListener(this.TWBtn,s.EventType.CLICK,(function(){F.UseLanguage="HK",t.CNBtnSelect.active=!1,t.TWBtnSelect.active=!0,IS(R).set(x.LANGUAGE_SELECT,1)})),this.CNBtnSelect=S.findChild(this.node,"voice/btn1/select"),this.TWBtnSelect=S.findChild(this.node,"voice/btn2/select");var n=S.findChildComponent(this.node,"scrollSetting",r);this.settingList=this.view.addUIList(n,st)},e.show=function(){var t=IS(R).Get(x.LANGUAGE_SELECT);if(t>0){var e="CN";1==t&&(e="HK"),F.UseLanguage=e}this.languageText.string=b.GetCurLanuageDesc(),printLogErr("7777777777",t,F.UseLanguage),"HK"!=F.UseLanguage?(this.CNBtnSelect.active=!0,this.TWBtnSelect.active=!1):(this.CNBtnSelect.active=!1,this.TWBtnSelect.active=!0),this.txtVersion.string=k.formatStrWithMirrorDeal(GetLanguage(200534),GlobalDefine.VERSION+"."+String(GlobalDefine.SMALLVERSION));for(var n,s=[].concat(configSetting.getDataByList("type",1)),o=[],a=i(s);!(n=a()).done;){var d=n.value;1==d.is_show&&o.push(d)}o.sort((function(t,e){return t.rank-e.rank})),this.settingList.datas=o},e.setActive=function(t){this.node.active=t},t}()),st=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this).txtName=void 0,e.icon=void 0,e.select=void 0,e.normal=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.txtName=S.findChildComponent(this.node,"txtName",a),this.icon=S.findChildComponent(this.node,"icon",d),this.select=S.findChild(this.node,"toggle/select"),this.normal=S.findChild(this.node,"toggle/normal");var e=S.findChild(this.node,"toggle");this.view.addComponentCallbackListener(e,s.EventType.CLICK,(function(){var e=t.select.active;e=!e,t.view.OnSettingChange(t.data.id,e),t.select.active=e,t.normal.active=!e}))},n.onRender=function(t,e){this.txtName.string=t.title,this.view.loadIcon(this.icon,"player",l.formatStr("grxx_ui_tubiao0%s",t.id));var i=t.id;if(2==t.state){var n=this.view.settingValues[t.id];null==n&&(n=IS(R).Get(i)),this.select.active=n,this.normal.active=!n}},i}(p),ot=t("SkinPanel",function(){function t(){this.view=void 0,this.node=void 0,this.roleNode=void 0,this.skinList=void 0,this.skinLab=void 0,this.skin_attr_name=void 0,this.skin_attr_old=void 0,this.skin_attr_new=void 0,this.imgNextNode=void 0,this.need_item=void 0,this.need_item_frame=void 0,this.need_item_icon=void 0,this.need_item_num=void 0,this.btnUnlock=void 0,this.btnLevel=void 0,this.btnMax=void 0,this.skinBtn=void 0,this.btnCloth=void 0,this.unlock_desc=void 0,this.usedList={},this.skinInfoList={},this.curId=void 0,this.select_skin=void 0,this.skinModel=void 0,this.const_cloth_id=9}var e=t.prototype;return e.init=function(t,e){this.view=e,this.node=t,this.onInit()},e.onInit=function(){var t=this;this.skinBtn=S.findChild(this.node,"top/btn"),this.skinLab=S.findChildComponent(this.node,"top/btn/Label",a),this.view.addComponentCallbackListener(this.skinBtn,s.EventType.CLICK,(function(){if(t.usedList[2]==t.curId)IS(D).send_3_17(t.const_cloth_id);else if(t.curId>0&&t.curId!=t.const_cloth_id){if(null==t.skinInfoList[2][t.curId])return void B.showFlyTip(GetLanguage(200535));IS(D).send_3_17(t.curId)}})),this.roleNode=S.findChild(this.node,"top/role"),this.skin_attr_name=S.findChildComponent(this.node,"bottom/nodeChange/txtEffect",a),this.skin_attr_old=S.findChildComponent(this.node,"bottom/nodeChange/txtBase",a),this.skin_attr_new=S.findChildComponent(this.node,"bottom/nodeChange/txtNext",a),this.imgNextNode=S.findChild(this.node,"bottom/nodeChange/Sprite"),this.view.dealMirrorLayout(S.findChildComponent(this.node,"bottom/nodeChange/common_ui_xiaotidi",c)),this.need_item=S.findChild(this.node,"bottom/item"),this.view.addComponentCallbackListener(this.need_item,s.EventType.CLICK,(function(){var e=configSkin.getDataByKey(t.curId);uiMgr.openView("ItemTipsView",e.condition[0][0],t.need_item_icon.node)})),this.need_item_frame=S.findChildComponent(this.node,"bottom/item/imgFrame",d),this.need_item_icon=S.findChildComponent(this.node,"bottom/item/imgIcon",d),this.need_item_num=S.findChildComponent(this.node,"bottom/item/txtNext",a),this.btnUnlock=S.findChild(this.node,"bottom/btnUnlock"),this.view.addComponentCallbackListener(this.btnUnlock,s.EventType.CLICK,(function(){IS(M).CanUnLockSkin(t.curId)?IS(D).send_3_35(t.curId):B.showFlyTip(GetLanguage(200536))})),this.btnMax=S.findChildComponent(this.node,"bottom/btnMax",d),this.btnMax.grayscale=!0,this.btnLevel=S.findChild(this.node,"bottom/btnLevel"),this.view.addComponentCallbackListener(this.btnLevel,s.EventType.CLICK,(function(){if(t.curId!=t.const_cloth_id){var e=t.skinInfoList[2][t.curId].level,i=configFashion_skin.getDataByKeys("skin_id",t.curId,"skin_level",e);if(!i||null==i.expend||null==i.expend[0])return void B.showFlyTip(GetLanguage(200538));if(IS(T).getGoodsCountByGoodsGtid(i.expend[0][0])<i.expend[0][1])return void B.showFlyTip(GetLanguage(200537));IS(D).send_3_37(t.curId)}})),this.roleNode=S.findChild(this.node,"top/role");var e=S.findChildComponent(this.node,"bottom/ScrollView",r);this.skinList=this.view.addUIList(e,at),this.skinList.selectedMode=I.SINGLE},e.UpdateModel=function(){null!=this.skinModel&&(this.view.removeUnitModel(this.skinModel),this.skinModel=null);var t=this.curId;this.curId<=0&&(t=this.const_cloth_id);var e=IS(P).getShowEquipCfgIdByLocation(1),i=IS(P).getShowEquipCfgIdByLocation(2),n=IS(P).getShowEquipCfgIdByLocation(3),s=IS(M).GetTypeUsedSkin(1),o=1.3,a=IS(M).GetTypeUsedSkin(0),d=IS(M).GetRoleAttr(V.ROLE_ATTR_GENDER),l=w.getModelId(a,t,d),r=configUnitModel.getDataByKey(l);r&&r.skin_scale>0&&(o=.66*r.skin_scale),this.skinModel=this.view.addUnitModel({job:a,dressId:t,gender:d,weapon:e,ornaments:i,face:n,color:s,parent:this.roleNode,shenqi:0},null,o),h.uiMirror&&(this.view.getUnitModel(this.skinModel).dir=-1)},e.show=function(){this.usedList=IS(M).GetUsedSkinList(),this.skinInfoList=IS(M).GetSkinList();for(var t=[].concat(configSkin.getDataByList("type",2)),e=[],i=0;i<t.length;i++)if(IS(M).checkSkinCanShow(t[i].id)&&t[i].id!=this.const_cloth_id){var n=0;null==this.skinInfoList[2][t[i].id]?IS(M).CanUnLockSkin(t[i].id)&&(n=3):(n=1,this.usedList[2]==t[i].id&&(n=2)),e.push({state:n,id:t[i].id,info:t[i]})}e.sort((function(t,e){return t.state!=e.state?t.state>e.state?-1:1:t.id-e.id})),this.skinList.datas=e,this.curId<=0&&(this.curId=e[0].id),this.updateInfo(),S.findChild(this.node,"bottom/nodeChange/common_ui_xiaotidi/txtName-001").setScale(1,1,1)},e.updateInfo=function(){var t,e,i=0;if(this.btnMax.node.active=!1,this.curId>0)if(null==this.skinInfoList[2][this.curId]){var n=configSkin.getDataByKey(this.curId);t=n.condition[0][0],e=n.condition[0][1]}else{var s=this.skinInfoList[2][this.curId],o=s.level,a=configFashion_skin.getDataByKeys("skin_id",this.curId,"skin_level",o);a&&null!=a.expend&&null!=a.expend[0]&&(t=a.expend[0][0],e=a.expend[0][1]),i=s.level}if(i>0){var d=configFashion_skin.getDataByKeys("skin_id",this.curId,"skin_level",i),h=configAttribute.getDataByKey(d.attr[0][0]),l=configFashion_skin.getDataByKeys("skin_id",this.curId,"skin_level",i+1);l?(this.skin_attr_new.node.active=!0,this.imgNextNode.active=!0,this.skin_attr_new.string=l.attr[0][1]/100+"%"):(this.skin_attr_new.node.active=!1,this.imgNextNode.active=!1,this.btnMax.node.active=!0),this.skin_attr_name.string=h.name,this.skin_attr_old.string=d.attr[0][1]/100+"%"}else{var r=configFashion_skin.getDataByKeys("skin_id",this.curId,"skin_level",1),c=configAttribute.getDataByKey(r.attr[0][0]);this.skin_attr_new.node.active=!1,this.imgNextNode.active=!1,this.skin_attr_name.string=c.name,this.skin_attr_old.string=r.attr[0][1]/100+"%"}if(this.need_item.active=!1,this.btnLevel.active=!1,t&&t>0){this.need_item.active=!0,this.btnLevel.active=null!=this.skinInfoList[2][this.curId];var u=configGoods.getDataByKey(t),v=configColor.getDataByKey(u.quality);this.view.loadIcon(this.need_item_frame,"icon_equip",v.path),this.view.loadIcon(this.need_item_icon,u.icon_group,u.icon);var f=IS(T).getGoodsCountByGoodsGtid(t);this.need_item_num.string=f+"/"+e}this.btnUnlock.active=null==this.skinInfoList[2][this.curId],this.skinBtn.active=null!=this.skinInfoList[2][this.curId];var C=GetLanguage(200539);this.curId==this.usedList[2]&&(C=GetLanguage(200540)),this.skinLab.string=C,this.UpdateModel()},e.setActive=function(t){this.curId=0,this.node.active=t},e.SelectItem=function(t){this.curId=t,this.skinList.updateAll(),this.updateInfo()},t}()),at=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this).imgFrame=void 0,e.icon=void 0,e.jobIcon=void 0,e.used=void 0,e.select=void 0,e.mask=void 0,e.red=void 0,e.lock=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.jobIcon=S.findChildComponent(this.node,"jobIcon/jobIcon",d),this.icon=S.findChildComponent(this.node,"icon",d),this.imgFrame=S.findChildComponent(this.node,"frame",d),this.used=S.findChild(this.node,"used"),this.select=S.findChild(this.node,"select"),this.mask=S.findChild(this.node,"mask"),this.red=S.findChild(this.node,"red"),this.lock=S.findChild(this.node,"lock"),this.view.loadIcon(this.used.getComponent(d),"player","grxx_ui_gouxuan")},n.onRender=function(t,e){this.view.loadIcon(this.icon,"player",t.info.icon);var i=configSkin.getDataByKey(t.id);if(i&&i.condition&&i.condition[0]){var n=configGoods.getDataByKey(i.condition[0][0]),s=configColor.getDataByKey(n.quality);this.view.loadIcon(this.imgFrame,"icon_equip",s.path)}this.used.active=this.view.skinPanel.usedList[t.info.type]==t.id,this.select.active=this.view.skinPanel.curId==t.id;var o=null!=this.view.skinPanel.skinInfoList[t.info.type]&&null!=this.view.skinPanel.skinInfoList[t.info.type][t.id];this.mask.active=!o,this.red.active=IS(M).CanUnLockSkin(t.id),this.lock.active=!o},n.onItemClick=function(){this.view.skinPanel.SelectItem(this.data.id)},i}(p),dt=t("NotifyPanel",function(){function t(){this.view=void 0,this.node=void 0,this.notifyList=void 0}var e=t.prototype;return e.init=function(t,e){this.view=e,this.node=t,this.onInit()},e.onInit=function(){var t=S.findChildComponent(this.node,"scrollNotify",r);this.notifyList=this.view.addUIList(t,ht)},e.show=function(){var t=[].concat(configSetting.getDataByList("type",2));t.sort((function(t,e){return t.rank-e.rank})),this.notifyList.datas=t},e.setActive=function(t){this.node.active=t},t}()),ht=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this).txtName=void 0,e.select=void 0,e.normal=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.txtName=S.findChildComponent(this.node,"content/txtName",a),this.select=S.findChild(this.node,"content/toggle/select"),this.normal=S.findChild(this.node,"content/toggle/normal");var e=S.findChild(this.node,"content/toggle");this.view.addComponentCallbackListener(e,s.EventType.CLICK,(function(){var e=t.select.active;e=!e,t.view.OnSettingChange(t.data.id,e),t.select.active=e,t.normal.active=!e}))},n.onRender=function(t,e){this.txtName.string=t.title;var i=t.id;if(2==t.state){var n=this.view.settingValues[t.id];null==n&&(n=IS(R).Get(i)),this.select.active=n,this.normal.active=!n}},i}(p);n._RF.pop()}}}));

