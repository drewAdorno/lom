System.register("chunks:///_virtual/PvpCompetitionRecordView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./ChatDataCache.ts","./ChatDefine.ts","./FrameDataCache.ts","./RoleDataCache.ts","./RoleDefine.ts","./PvpControl.ts","./PvpDefine.ts","./BaseView.ts"],(function(e){"use strict";var t,i,n,o,s,a,r,h,d,c,m,l,v,f,u,p,C,g,_;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.ScrollView,o=e.Button,s=e.Label,a=e.Sprite,r=e.sys},function(e){h=e.ListItem},function(e){d=e.default},function(e){c=e.default},null,function(e){m=e.ChatDataCache,l=e.EPvpShareType},function(e){v=e.ChatDefine},function(e){f=e.FrameDataCache},function(e){u=e.RoleDataCache},function(e){p=e.PlayerAttr},function(e){C=e.default},function(e){g=e.PvpEventDefine},function(e){_=e.BaseView}],execute:function(){i._RF.push({},"df2b5BpLWdJ15xXrSmixs4Y","PvpCompetitionRecordView",void 0);e("PvpCompetitionRecordView",function(e){function i(){var t;return(t=e.call(this)||this).scrollPvpList=void 0,t.nodeBattle=void 0,t.updateList=!1,t.txtTime=void 0,t.name="PvpCompetitionRecordView",t.url="ui/module/pvp/PvpCompetitionRecordView",t}t(i,e);var s=i.prototype;return s.onInit=function(){var e=this,t=this.findChild("content"),i=d.findChildComponent(t,"scrollPvp",n);this.scrollPvpList=this.addUIList(i,S);var s=this.findChild("btnClose");this.addComponentCallbackListener(s,o.EventType.CLICK,(function(){e.close()}))},s.registerUpdateHandler=function(){this.addEvent(g.CROSS_PVP_HISTORY,this.onRecordList,this)},s.onAfterOpen=function(){IS(C).reqCrossPvpHistory()},s.onBeforeClose=function(){this.updateList=!1},s.onDestroy=function(){},s.onRecordList=function(e){var t=e.history_list;t.sort((function(e,t){return e.time<t.time?1:-1})),this.scrollPvpList.datas=t},i}(_));var S=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).leftName=void 0,t.rightName=void 0,t.time=void 0,t.state=void 0,t.headLeft=void 0,t.headRight=void 0,t.score=void 0,t.scoreState=void 0,t.enemyScore=void 0,t.enemyScoreState=void 0,t.enemyScoreNormal=void 0,t.selfScoreNode=void 0,t.enemyScoreNode=void 0,t.normal=void 0,t.btnGo=void 0,t.btnShare=void 0,t.successState=void 0,t.headLeftFrame=void 0,t.headRightFrame=void 0,t}t(i,e);var n=i.prototype;return n.onInit=function(){var e=this;this.leftName=d.findChildComponent(this.node,"leftName",s),this.rightName=d.findChildComponent(this.node,"rightName",s),this.score=d.findChildComponent(this.node,"score/num",s),this.time=d.findChildComponent(this.node,"time",s),this.state=d.findChildComponent(this.node,"state",a),this.scoreState=d.findChildComponent(this.node,"score/num/state",a),this.successState=d.findChildComponent(this.node,"successState",a),this.normal=d.findChild(this.node,"score/normal"),this.selfScoreNode=d.findChild(this.node,"score"),this.enemyScoreNode=d.findChild(this.node,"enemyScore"),this.enemyScore=d.findChildComponent(this.node,"enemyScore/num",s),this.enemyScoreState=d.findChildComponent(this.node,"enemyScore/num/state",a),this.enemyScoreNormal=d.findChild(this.node,"enemyScore/normal"),this.headLeftFrame=d.findChildComponent(this.node,"imgFrameLeft/imgHeadFrame",a),this.headRightFrame=d.findChildComponent(this.node,"imgFrameRight/imgHeadFrame",a),this.headLeft=d.findChildComponent(this.node,"imgFrameLeft/imgIcon",a),this.headRight=d.findChildComponent(this.node,"imgFrameRight/imgIcon",a),this.btnGo=d.findChild(this.node,"btnGo"),r.uiMirror&&this.view.loadIcon(this.btnGo.getComponent(a),"jjc","pws_ui_huifang"),this.view.addComponentCallbackListener(this.btnGo,o.EventType.CLICK,(function(){IS(C).reqCrossPvpReplay(e.data.vid),e.view.close(),uiMgr.close("PvpMainView")})),this.btnShare=d.findChild(this.node,"btnShare"),r.uiMirror&&this.view.loadIcon(this.btnShare.getComponent(a),"jjc","pws_ui_zhuanfa"),this.view.addComponentCallbackListener(this.btnShare,o.EventType.CLICK,(function(){e.data.atk_role&&e.data.def_role&&IS(m).SendShareData(v.ChatLinkType.PvpShare,e.data,null,null,l.crossPvp)}));var t=d.findChildComponent(this.node,"vs",a);this.view.loadIcon(t,"jjc","jjc_ui_vs")},n.onRender=function(e,t){var i=e.atk_role,n=e.def_role,o=!0,s=IS(u).GetRoleAttr(p.ROLE_ATTR_ID);e.def_role.id==s&&(i=e.def_role,n=e.atk_role,o=!1),this.view.loadIcon(this.successState,"jjc",o?"pws_ui_tiaozhan":"pws_ui_fangshou"),this.leftName.string=i.name,this.rightName.string=n.name,this.view.loadIcon(this.state,"gvg",e.win_id==s?"gvg_img_shengli":"gvg_img_shibai"),0==e.my_score_change?(this.score.string="",this.scoreState.node.active=!1,this.normal.active=!0):(this.score.string=e.my_score_change>0?"+"+String(e.my_score_change):String(e.my_score_change),this.scoreState.node.active=!0,this.view.loadIcon(this.scoreState,"jjc",e.my_score_change>0?"pws_ui_shangsheng":"pws_ui_xiajiang"),this.normal.active=!1),0==e.e_score_change?(this.enemyScore.string="",this.enemyScoreState.node.active=!1,this.enemyScoreNormal.active=!0):(this.enemyScore.string=e.e_score_change>0?"+"+String(e.e_score_change):String(e.e_score_change),this.enemyScoreState.node.active=!0,this.view.loadIcon(this.enemyScoreState,"jjc",e.e_score_change>0?"pws_ui_shangsheng":"pws_ui_xiajiang"),this.enemyScoreNormal.active=!1),0==e.my_score&&0==e.e_score?(this.enemyScoreNode.active=!1,this.selfScoreNode.active=!1):(this.enemyScoreNode.active=!0,this.selfScoreNode.active=!0),this.time.string=c.formatDate(new Date(1e3*e.time),"yyyy/MM/dd hh:mm:ss")+c.GetServerTimeZoneStr();var a=IS(u).GetRoleAttr(p.ROLE_ATTR_HEAD_URL);this.view.loadRemoteIcon(a,this.headLeft),this.view.loadRemoteIcon(e.e_head.url,this.headRight);var r=IS(f).curFrameId;if(r>0){var h=configAvatar_frame.getDataByKey(r);this.view.loadIcon(this.headLeftFrame,"icon_frame",h.icon),this.headLeftFrame.node.active=!0}else this.headLeftFrame.node.active=!1;var d=e.e_head.frame_id;if(d>0){this.headRightFrame.node.active=!0;var m=configAvatar_frame.getDataByKey(d);this.view.loadIcon(this.headRightFrame,"icon_frame",m.icon)}else this.headRightFrame.node.active=!1},i}(h);i._RF.pop()}}}));

