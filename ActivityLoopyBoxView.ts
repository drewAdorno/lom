System.register("chunks:///_virtual/ActivityLoopyBoxView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./AudioMgr.ts","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./SpineSkeleton.ts","./BagDefine.ts","./BagModel.ts","./ResItems.ts","./MessageView.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./HorseCarnivalDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,o,n,s,a,d,r,h,c,f,l,v,u,m,p,x,g,w,C,B,b,y,I,_,T,S,L,k;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose,o=t.regeneratorRuntime},function(t){n=t.cclegacy,s=t.Button,a=t.Label,d=t.ScrollView,r=t.Toggle,h=t.Sprite,c=t.RichText},function(t){f=t.V2},function(t){l=t.audioMgr},function(t){v=t.ItemGrid},function(t){u=t.ListItem},function(t){m=t.default},function(t){p=t.default},function(t){x=t.default},null,function(t){g=t.SpineSkeleton},function(t){w=t.BagEventDefine},function(t){C=t.BagModel},function(t){B=t.ResItems},function(t){b=t.default},function(t){y=t.default},function(t){I=t.default},function(t){_=t.ActivityEventDefine,T=t.ActivityState,S=t.ActivityType},function(t){L=t.HorseCarnivalDataCache},function(t){k=t.BaseView}],execute:function(){n._RF.push({},"325bb/lH/BEOq+rkxJHLTfU","ActivityLoopyBoxView",void 0);var G=[1919],A=(t("default",function(t){function n(){var i;return(i=t.call(this)||this).actType=void 0,i.resItems=void 0,i.rewardList=[],i.txtTips=void 0,i.txtLevel=void 0,i.txtCount=void 0,i.tipsGo=void 0,i.tipsScroll=void 0,i.curTips=0,i.tipsTimer=0,i.togAuto=void 0,i.nodeState1=void 0,i.nodeState2=void 0,i.nodeState3=void 0,i.nodeNext=void 0,i.nodeLast=void 0,i.btn1=void 0,i.btn2=void 0,i.btn3=void 0,i.btn10=void 0,i.red1=void 0,i.red2=void 0,i.red3=void 0,i.red10=void 0,i.iconCost1=void 0,i.iconCost2=void 0,i.iconCost3=void 0,i.txtCost1=void 0,i.txtCost2=void 0,i.txtCost3=void 0,i.nodeBox1=void 0,i.nodeBox2=void 0,i.nodeBox3=void 0,i.btnBox1=void 0,i.btnBox2=void 0,i.btnBox3=void 0,i.maskBox1=void 0,i.maskBox2=void 0,i.reward1=void 0,i.reward2=void 0,i.reward3=void 0,i.effBox1=void 0,i.effBox2=void 0,i.effBox3=void 0,i.timer=void 0,i.skipAnim=void 0,i.reward_list=[],i.txtLeftTime=void 0,i.deltaTime=0,i.leftTime=0,i.canUpdate=!1,i.cor1=void 0,i.cor2=void 0,i.extraReward=void 0,i.name="ActivityLoopyBoxView",i.url="ui/module/activityLoopy/ActivityLoopyBoxView",i.actType=S.LoopyBox,i}i(n,t);var c=n.prototype;return c.onInit=function(){var t=this,i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,s.EventType.CLICK,(function(){t.close()}));var o=this.findChild("view/tips");this.addComponentCallbackListener(o,s.EventType.CLICK,(function(){IS(I).ShowSysTips(t.actType)}));var n=this.findChild("view/btnGift");this.addComponentCallbackListener(n,s.EventType.CLICK,(function(){uiMgr.openView("ActivityLoopyGiftView",t.actType)}));var c=this.findChild("view/btnPre");this.addComponentCallbackListener(c,s.EventType.CLICK,(function(){uiMgr.openView("ActivityLoopyBoxPreView")}));var l=this.findChild("view/bottom/state3/btn");this.addComponentCallbackListener(l,s.EventType.CLICK,(function(){IS(y).send_box_next(t.actType)}));var u=this.findChild("view/bottom/next/btn");this.addComponentCallbackListener(u,s.EventType.CLICK,(function(){for(var i,o,n=IS(I).GetActivityInfo(t.actType),s=IS(I).getBoxInfo(t.actType),d=s.id,r=e(configBox_tower_level.getDatas());!(o=r()).done;){var h=o.value;if(n.roundCfg.group_id==h.group&&1==h.final){i=h;break}}0==s.id&&(d=i.id),configBox_tower_level.getDataByKey(d).level<=5&&t.addUIEffect("prefab/ui-effect/MX_tx_loopy_baoxiang",t.node,2,new f(0,0),1,(function(t){t.node.getComponent(g).needAnimation="idle",m.findChildComponent(t.node,"Label",a).string=GetLanguage(600002060)})),t.nodeNext.active=!1,t.updateInfo()}));var p=this.findChild("view/bottom/last/btn");this.addComponentCallbackListener(p,s.EventType.CLICK,(function(){t.nodeLast.active=!1,t.updateInfo()})),this.skipAnim=this.findChild("skipAnim"),this.addComponentCallbackListener(this.skipAnim,s.EventType.CLICK,(function(){t.SkipAnim()})),this.tipsGo=this.findChild("view/numReward/tipsScroll");var x=this.findChildComponent("view/numReward/tipsScroll/ScrollView",d);this.tipsScroll=this.addUIList(x,E),this.resItems=new B(this),this.resItems.init(G),this.txtLeftTime=this.findChildComponent("view/nodeTime/txtTime",a),this.txtTips=this.findChildComponent("view/numReward/Label",a);for(var w=1;w<=6;w++){var _=new A;_.init(this.findChild("view/numReward/item"+w),this,w),this.rewardList.push(_)}this.txtLevel=this.findChildComponent("view/bottom/level/Label",a),this.txtCount=this.findChildComponent("view/bottom/txtCount",a),this.togAuto=this.findChildComponent("view/bottom/auto",r),this.addComponentCallbackListener(this.togAuto.node,r.EventType.CLICK,(function(){IS(y).send_box_auto(t.actType)})),this.nodeState1=this.findChild("view/bottom/state1"),this.nodeState2=this.findChild("view/bottom/state2"),this.nodeState3=this.findChild("view/bottom/state3"),this.nodeNext=this.findChild("view/bottom/next"),this.nodeLast=this.findChild("view/bottom/last"),this.btn1=this.findChild("view/bottom/state1/btn1"),this.red1=this.findChild("view/bottom/state1/btn1/red"),this.iconCost1=this.findChildComponent("view/bottom/state1/btn1/icon",h),this.txtCost1=this.findChildComponent("view/bottom/state1/btn1/num",a),this.addComponentCallbackListener(this.btn1,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType),e=configBox_tower_box.getDataByKey(i.box_id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open(t.actType,1)})),this.btn2=this.findChild("view/bottom/state1/btn2"),this.red2=this.findChild("view/bottom/state1/btn2/red"),this.iconCost2=this.findChildComponent("view/bottom/state1/btn2/icon",h),this.txtCost2=this.findChildComponent("view/bottom/state1/btn2/num",a),this.addComponentCallbackListener(this.btn2,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType),e=configBox_tower_box.getDataByKey(i.box_id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open(t.actType,2)})),this.btn10=this.findChild("view/bottom/state1/btn10"),this.red10=this.findChild("view/bottom/state1/btn10/red"),this.addComponentCallbackListener(this.btn10,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType),e=configBox_tower_box.getDataByKey(i.box_id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<10*e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open_ten(t.actType)})),this.btn3=this.findChild("view/bottom/state2/btn"),this.red3=this.findChild("view/bottom/state2/btn/red"),this.iconCost3=this.findChildComponent("view/bottom/state2/btn/icon",h),this.txtCost3=this.findChildComponent("view/bottom/state2/btn/num",a),this.addComponentCallbackListener(this.btn3,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType),e=configBox_tower_level.getDataByKey(i.id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open(t.actType,0)})),this.nodeBox1=this.findChild("view/bottom/box1"),this.nodeBox2=this.findChild("view/bottom/box2"),this.nodeBox3=this.findChild("view/bottom/box3"),this.maskBox1=this.findChild("view/bottom/box1/mask"),this.maskBox2=this.findChild("view/bottom/box2/mask"),this.reward1=new v(this,this.findChild("view/bottom/box1/itemGrid")),this.reward2=new v(this,this.findChild("view/bottom/box2/itemGrid")),this.reward3=new v(this,this.findChild("view/bottom/box3/itemGrid")),this.btnBox1=this.findChild("view/bottom/box1/button"),this.addComponentCallbackListener(this.btnBox1,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType);if(1==i.type){var e=configBox_tower_box.getDataByKey(i.box_id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open(t.actType,1)}})),this.btnBox2=this.findChild("view/bottom/box2/button"),this.addComponentCallbackListener(this.btnBox2,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType);if(1==i.type){var e=configBox_tower_box.getDataByKey(i.box_id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open(t.actType,2)}})),this.btnBox3=this.findChild("view/bottom/box3/button"),this.addComponentCallbackListener(this.btnBox3,s.EventType.CLICK,(function(){var i=IS(I).getBoxInfo(t.actType);if(2==i.type){var e=configBox_tower_level.getDataByKey(i.id);IS(C).getGoodsCountByGoodsGtid(e.item[0])<e.item[1]?b.showFlyTip(GetLanguage(200069)):IS(y).send_box_open(t.actType,0)}}))},c.registerUpdateHandler=function(){this.addEvent(w.GOODS_INFO_UPDATE,this.updateResShow,this),this.addEvent(_.OnActivityBoxUpdate,this.updateInfo,this),this.addEvent(_.OnActivityBoxAutoUpdate,this.updateAuto,this),this.addEvent(_.OnActivityBoxOpen,this.onBoxOpenCallBack,this),this.addEvent(_.OnActivityBoxTenOpen,this.onBoxTenOpen,this)},c.onAfterOpen=function(){var t=this;IS(I).isBoxAnim=!1,this.effBox1=this.addUIEffect("prefab/ui-effect/MX_tb_baolulubaoxiang",m.findChild(this.nodeBox1,"eff"),-1,new f(0,0),1,(function(i){i.node.getComponent(g).scheduleOnce((function(){t.updateBoxAnim(1)}))})),this.effBox2=this.addUIEffect("prefab/ui-effect/MX_tb_baolulubaoxiang",m.findChild(this.nodeBox2,"eff"),-1,new f(0,0),1,(function(i){i.node.getComponent(g).scheduleOnce((function(){t.updateBoxAnim(2)}))})),this.effBox3=this.addUIEffect("prefab/ui-effect/MX_tb_baolulubaoxiang",m.findChild(this.nodeBox3,"eff"),-1,new f(0,0),1,(function(i){i.node.getComponent(g).scheduleOnce((function(){t.updateBoxAnim(3)}))}));var i=IS(I).GetActivityInfo(this.actType);if(i){var e,o=null!=(e=i.state_time[i.state])?e:i.state_time[T.Open];this.leftTime=o.end_time-x.serverTime,this.leftTime>0?(this.canUpdate=!0,this.txtLeftTime.string=x.formatTimeStringForSecond(this.leftTime)):this.txtLeftTime.string=GetLanguage(200026)}else this.txtLeftTime.string=GetLanguage(200026);this.updateResShow(),IS(y).send_box_info(this.actType)},c.onBeforeClose=function(){this.canUpdate=!1,this.effBox1=null,this.effBox2=null,this.effBox3=null,this.removeTimer(this.timer),this.cor1&&(coroutine.stop(this.cor1),this.cor1=null),this.cor2&&(coroutine.stop(this.cor2),this.cor2=null),this.timer=null,this.reward_list=[],this.skipAnim.active=!1,this.tipsTimer=0,this.extraReward=null},c.onDestroy=function(){},c.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=x.formatTimeStringForSecond(this.leftTime):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},c.updateResShow=function(){this.resItems.update(),this.updateRed()},c.updateRed=function(){var t=IS(C).getGoodsCountByGoodsGtid(1919);this.red1.active=t>0,this.red2.active=t>0,this.red3.active=t>0,this.red10.active=t>=10},c.updateInfo=function(){if(!IS(I).isBoxAnim){this.updateTips(),this.updateAuto();var t=IS(I).GetActivityInfo(this.actType),i=IS(I).getBoxInfo(this.actType);this.nodeNext.active=!1,this.nodeLast.active=!1;for(var o,n,s=i.id,d=e(configBox_tower_level.getDatas());!(n=d()).done;){var r=n.value;if(t.roundCfg.group_id==r.group&&1==r.final){o=r;break}}0==i.id&&(s=o.id);var h=configBox_tower_level.getDataByKey(s);this.txtTips.string=0==i.id?GetLanguage(401583):GetLanguage(401584),this.txtLevel.string=p.formatStrWithMirrorDeal(GetLanguage(200284),h.level),h.level>5?(this.rewardList[4].node.active=!1,this.rewardList[5].node.active=!0):(this.rewardList[4].node.active=!0,this.rewardList[5].node.active=!1);for(var c,l=e(this.rewardList);!(c=l()).done;){c.value.show()}if(this.txtCount.string=p.formatStr(GetLanguage(401278),i.cnt),1==i.type){this.nodeState1.active=!0,this.nodeState2.active=!1,this.nodeState3.active=!1;var v=configBox_tower_box.getDataByKey(i.box_id),u=configGoods.getDataByKey(v.item[0]);this.loadIcon(this.iconCost1,u.icon_group,u.icon),this.loadIcon(this.iconCost2,u.icon_group,u.icon),this.txtCost1.string=v.item[1],this.txtCost2.string=v.item[1],this.nodeBox1.active=!0,this.nodeBox2.active=!0,this.nodeBox3.active=!1,this.maskBox1.active=!1,this.maskBox2.active=!1,this.reward1.node.active=!1,this.reward2.node.active=!1,this.updateBoxAnim(1),this.updateBoxAnim(2)}else if(2==i.type){this.nodeState1.active=!1,this.nodeState2.active=!0,this.nodeState3.active=!1;var x=configBox_tower_level.getDataByKey(i.id),w=configGoods.getDataByKey(x.item[0]);this.loadIcon(this.iconCost3,w.icon_group,w.icon),this.txtCost3.string=x.item[1],i.getBigBox&&(i.getBigBox=!1,this.addUIEffect("prefab/ui-effect/MX_tx_loopy_baoxiang",this.node,2,new f(0,0),1,(function(t){t.node.getComponent(g).needAnimation="qiyu",m.findChildComponent(t.node,"Label",a).string=GetLanguage(600002061)}))),this.nodeBox1.active=!1,this.nodeBox2.active=!1,this.nodeBox3.active=!0,this.reward3.node.active=!1,this.updateBoxAnim(3)}else 3==i.type&&(this.nodeState1.active=!1,this.nodeState2.active=!1,this.nodeState3.active=!0,this.nodeBox1.active=!0,this.nodeBox2.active=!0,this.nodeBox3.active=!1,this.maskBox1.active=1!=i.choose,this.maskBox2.active=2!=i.choose,this.reward1.node.active=!0,this.reward2.node.active=!0,this.reward1.SetItemId(i.left_reward.gtid,i.left_reward.num),this.reward2.SetItemId(i.right_reward.gtid,i.right_reward.num),this.updateBoxAnim(1),this.updateBoxAnim(2))}},c.updateTips=function(){var t=this,i=IS(I).getBoxInfo(this.actType);this.tipsGo.active=i.lucky_list.length>0,0!=this.tipsTimer&&this.removeTimer(this.tipsTimer),this.tipsGo.active&&(this.tipsScroll.datas=i.lucky_list,this.curTips=0,this.tipsTimer=this.addTimer(1,-1,(function(){t.curTips=t.curTips+1,t.curTips==i.lucky_list.length&&(t.curTips=0);var e=0==t.curTips?.2:1;t.tipsScroll.scrollTo(t.curTips,e)})))},c.updateAuto=function(){var t=IS(I).getBoxInfo(this.actType);this.togAuto.isChecked=1==t.auto_next},c.updateBoxAnim=function(t){var i=IS(I).getBoxInfo(this.actType);if(i)if(3==t){if(2==i.type&&null!=this.effBox3){var e=this.getUIEffect(this.effBox3);if(e&&e.node){var o=e.node.getComponent(g);o.setSkin("L4"),o.setAnimation(0,"idle",!0)}}}else if(1==i.type){var n=this["effBox"+t];if(null!=n){var s=this.getUIEffect(n);if(s&&s.node){var a=s.node.getComponent(g),d=configBox_tower_box.getDataByKey(i.box_id);a.setSkin(d.shape),a.setAnimation(0,"idle",!0)}}}else if(3==i.type){var r=this["effBox"+t];if(null!=r){var h=this.getUIEffect(r);if(h&&h.node){var c=h.node.getComponent(g),f=configBox_tower_box.getDataByKey(i.box_id);c.setSkin(f.shape);var l=t==i.choose?"idle2":"idle3";c.setAnimation(0,l,!0)}}}},c.SkipAnim=function(){this.timer&&(this.removeTimer(this.timer),this.timer=null),this.cor1&&coroutine.stop(this.cor1),this.cor2&&coroutine.stop(this.cor2),this.cor1=null,this.cor2=null,this.skipAnim.active=!1,0!=this.reward_list.length&&(uiMgr.openView("GoodsGetView",this.reward_list,this.extraReward),this.reward_list=[]),IS(I).isBoxAnim=!1,this.updateInfo()},c.onBoxOpenCallBack=function(t){var i=IS(L).GetDrawReward(this.actType),e=i[1];this.extraReward=[i[0],e],this.cor1&&(coroutine.stop(this.cor1),this.cor1=null),this.cor1=coroutine.start(this.onBoxOpen(t))},c.onBoxOpen=o().mark((function t(i){var e,n,s,a,d,r,h,c,f=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.reward_list=[],this.skipAnim.active=!0,this.timer&&(this.removeTimer(this.timer),this.timer=null),l.playSound("wanshengjie_yidong"),0!=i.choose){t.next=12;break}return this.reward3.node.active=!1,null!=this.effBox3&&(e=this.getUIEffect(this.effBox3))&&e.node&&(e.node.getComponent(g).setAnimation(0,"kai2",!1),this.reward_list=[i.left_reward],this.timer=this.addTimer(.4,0,(function(){f.skipAnim.active=!1,IS(I).isBoxAnim=!1,uiMgr.openView("GoodsGetView",[i.left_reward],f.extraReward),e.node.getComponent(g).setAnimation(0,"idle2",!0),0!=IS(I).getBoxInfo(f.actType).id?(f.nodeState2.active=!1,f.nodeNext.active=!0):(f.nodeState2.active=!1,f.nodeLast.active=!0)}))),t.next=9,coroutine.wait(.2);case 9:IS(I).isBoxAnim&&(this.reward3.node.active=!0,this.reward3.SetItemId(i.left_reward.gtid,i.left_reward.num)),t.next=25;break;case 12:return this.reward1.node.active=!1,this.reward2.node.active=!1,this.maskBox1.active=!1,this.maskBox2.active=!1,null!=this.effBox1&&(n=this.getUIEffect(this.effBox1))&&n.node&&(s=n.node.getComponent(g),a=1==i.choose?"kai2":"kai1",s.setAnimation(0,a,!1)),null!=this.effBox2&&(d=this.getUIEffect(this.effBox2))&&d.node&&(r=d.node.getComponent(g),h=2==i.choose?"kai2":"kai1",r.setAnimation(0,h,!1)),c=1==i.choose?i.left_reward:i.right_reward,this.reward_list=[c],this.timer=this.addTimer(.4,0,(function(){if(f.skipAnim.active=!1,IS(I).isBoxAnim=!1,uiMgr.openView("GoodsGetView",[c],f.extraReward),null!=f.effBox1){var t=f.getUIEffect(f.effBox1);if(t&&t.node){var e=t.node.getComponent(g),o=1==i.choose?"idle2":"idle3";e.setAnimation(0,o,!0)}}if(null!=f.effBox2){var n=f.getUIEffect(f.effBox2);if(n&&n.node){var s=n.node.getComponent(g),a=2==i.choose?"idle2":"idle3";s.setAnimation(0,a,!0)}}f.updateInfo()})),t.next=23,coroutine.wait(.2);case 23:IS(I).isBoxAnim&&(this.maskBox1.active=1!=i.choose,this.maskBox2.active=2!=i.choose,this.reward1.node.active=!0,this.reward2.node.active=!0,this.reward1.SetItemId(i.left_reward.gtid,i.left_reward.num),this.reward2.SetItemId(i.right_reward.gtid,i.right_reward.num)),this.cor1=null;case 25:case"end":return t.stop()}}),t,this)})),c.onBoxTenOpen=function(t){var i=IS(L).GetDrawReward(this.actType),o=i[1]*t.box_list.length;this.extraReward=[i[0],o],this.reward_list=[],this.skipAnim.active=!0;for(var n,s=[],a=e(t.box_list);!(n=a()).done;){var d=n.value;1==d.choose||0==d.choose?s.push(d.left_reward):s.push(d.right_reward)}this.reward_list=s,this.openOneBox(0,t)},c.openOneBox=function(t,i){var e,o=this;e=t<i.box_list.length-1?function(){o.openOneBox(t+1,i)}:function(){o.skipAnim.active=!1,IS(I).isBoxAnim=!1,o.reward_list.length>0&&uiMgr.openView("GoodsGetView",o.reward_list,o.extraReward),o.reward_list=[],o.updateInfo()},this.cor2&&(coroutine.stop(this.cor2),this.cor2=null);var n=i.box_list[t];this.cor2=coroutine.start(this.doOpenTween(n,e))},c.doOpenTween=o().mark((function t(i,e){var n,s,a,d,r,h,c,f,v=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l.playSound("wanshengjie_yidong"),this.reward1.node.active=!1,this.reward2.node.active=!1,this.maskBox1.active=!1,this.maskBox2.active=!1,null!=this.effBox1&&(n=this.getUIEffect(this.effBox1))&&n.node&&(s=n.node.getComponent(g),a=1==i.choose?"kai2":"kai1",(d=configBox_tower_box.getDataByKey(i.box_id))&&s.setSkin(d.shape),s.setAnimation(0,a,!1)),null!=this.effBox2&&(r=this.getUIEffect(this.effBox2))&&r.node&&(h=r.node.getComponent(g),c=2==i.choose?"kai2":"kai1",(f=configBox_tower_box.getDataByKey(i.box_id))&&h.setSkin(f.shape),h.setAnimation(0,c,!1)),this.timer&&(this.removeTimer(this.timer),this.timer=null),this.timer=this.addTimer(.4,0,(function(){if(null!=v.effBox1){var t=v.getUIEffect(v.effBox1);if(t&&t.node){var o=t.node.getComponent(g),n=1==i.choose?"idle2":"idle3";o.setAnimation(0,n,!0)}}if(null!=v.effBox2){var s=v.getUIEffect(v.effBox2);if(s&&s.node){var a=s.node.getComponent(g),d=2==i.choose?"idle2":"idle3";a.setAnimation(0,d,!0)}}v.timer=null,e()})),t.next=11,coroutine.wait(.2);case 11:IS(I).isBoxAnim&&(this.reward1.node.active=!0,this.reward2.node.active=!0,this.maskBox1.active=1!=i.choose,this.maskBox2.active=2!=i.choose,this.reward1.SetItemId(i.left_reward.gtid,i.left_reward.num),this.reward2.SetItemId(i.right_reward.gtid,i.right_reward.num)),this.cor2=null;case 13:case"end":return t.stop()}}),t,this)})),n}(k)),function(){function t(){this.view=void 0,this.node=void 0,this.index=void 0,this.select=void 0,this.mask=void 0,this.isGet=void 0,this.itemGrid=void 0,this.itemId=0,this.num=void 0}var i=t.prototype;return i.init=function(t,i,e){this.view=i,this.node=t,this.index=6==e?5:e,this.onInit()},i.onInit=function(){var t=this;this.select=m.findChild(this.node,"img/select"),this.mask=m.findChild(this.node,"mask"),this.isGet=m.findChild(this.node,"isGet"),this.num=m.findChildComponent(this.node,"num",a);var i=m.findChild(this.node,"reward/itemGrid");i&&(this.itemGrid=new v(this.view,i));var e=m.findChild(this.node,"big");e&&this.view.addComponentCallbackListener(e,s.EventType.CLICK,(function(){0!=t.itemId&&IS(C).OpenItemTips(t.itemId,e)}))},i.show=function(){for(var t,i,o=IS(I).GetActivityInfo(this.view.actType),n=IS(I).getBoxInfo(this.view.actType),s=n.id,a=e(configBox_tower_level.getDatas());!(i=a()).done;){var d=i.value;if(o.roundCfg.group_id==d.group&&1==d.final){t=d;break}}0==n.id&&(s=t.id);for(var r,h,c=configBox_tower_level.getDataByKey(s).level,f=Math.ceil(c/5)-1,l=e(configBox_tower_level.getDatas());!(h=l()).done;){var v=h.value;if(o.roundCfg.group_id==v.group&&v.level>5*f&&v.level<=5*(f+1))if((v.level%5==0?5:v.level%5)==this.index){r=v;break}}r?(this.num.string=r.level,this.itemGrid&&this.itemGrid.SetItemId(r.grand_prize[0][0],r.grand_prize[0][1]),this.itemId=r.grand_prize[0][0],r.level==c||1==r.final&&0==n.id?this.select.active=!0:this.select.active=!1,c>r.level||0==n.id?(this.isGet.active=!0,this.mask.active=!0):(this.isGet.active=!1,this.mask.active=!1)):this.node.active=!1},t}()),E=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).txt=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){this.txt=m.findChildComponent(this.node,"txt",c)},o.onRender=function(t,i){var e=t.k,o=configGoods.getDataByKey(e).name;this.txt.string=p.formatStrWithMirrorDeal(GetLanguage(200050),t.s,o)},e}(u);n._RF.pop()}}}));

