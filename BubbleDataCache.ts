System.register("chunks:///_virtual/BubbleDataCache.ts",["cc","./TimeUtil.ts","./ObjectUtil.ts","./TitleDefine.ts"],(function(e){"use strict";var t,i,s,u;return{setters:[function(e){t=e.cclegacy},function(e){i=e.default},function(e){s=e.default},function(e){u=e.TitleEventDefine}],execute:function(){t._RF.push({},"c42e5vceX1DNrTWrQJXZ2Qv","BubbleDataCache",void 0);e("BubbleDataCache",function(){function e(){this.hasBubbleList=[],this.curBubbleId=1,this.timerList={}}var t=e.prototype;return t.clear=function(){throw new Error("Method not implemented.")},t.setBubbleInfo=function(e){for(var t=0;t<e.bubble_list.length;t++){var i=e.bubble_list[t];this.hasBubbleList[i.cfg_id]=i}this.curBubbleId=0==e.wear_id?1:e.wear_id,this.updateBubbleTime(),normalEvent.emit(u.Bubble_INFO_UPDATE)},t.updateBubbleTime=function(){var e=this;for(var t in this.timerList)normalTimer.stop(this.timerList[t]);this.timerList={};var s=function(t){var s=e.hasBubbleList[t].end_time;s>0&&s>i.serverTime&&(e.timerList[t]=normalTimer.start(1,s-i.serverTime,(function(){if(!e.hasBubbleList[t]&&e.timerList[t])return delete e.timerList[t],void normalTimer.stop(e.timerList[t]);var s=e.hasBubbleList[t].end_time;(0==s||s<=i.serverTime)&&(e.curBubbleId==Number(t)&&(e.curBubbleId=1),normalTimer.stop(e.timerList[t]),delete e.timerList[t],delete e.hasBubbleList[t],normalEvent.emit(u.Bubble_INFO_UPDATE))})))};for(var n in this.hasBubbleList)s(n)},t.updateBubbleInfo=function(e){for(var t=0;t<e.update_list.length;t++){var i=e.update_list[t];this.hasBubbleList[i.cfg_id]=i}normalEvent.emit(u.Bubble_INFO_UPDATE)},t.setCurBubbleId=function(e){this.curBubbleId=0==e?1:e,normalEvent.emit(u.Bubble_INFO_UPDATE)},t.checkHasBubble=function(e){var t;return 1==e||null!=(t=this.hasBubbleList[e])&&t},t.checkHasTime=function(e){return!!this.hasBubbleList[e]&&this.hasBubbleList[e].end_time>0},t.getBubbleTime=function(e){return this.hasBubbleList[e]?this.hasBubbleList[e].end_time:0},t.checkIsNew=function(e){return!!this.hasBubbleList[e]&&1==this.hasBubbleList[e].red_point},t.updateRedState=function(e){this.hasBubbleList[e]&&(this.hasBubbleList[e].red_point=0),normalEvent.emit(u.Bubble_INFO_UPDATE)},t.CanUnLockBubble=function(){var e=0;for(var t in this.hasBubbleList)1==this.hasBubbleList[t].red_point&&(e+=1);return e},t.checkBubbleCanShow=function(e){var t=configChat_bubble.getDataByKey(e);if(null==t)return!1;var u=t.open_time;return!!s.isEmpty(u)||i.checkOpenTime(u)},e}());t._RF.pop()}}}));

