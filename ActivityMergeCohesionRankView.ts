System.register("chunks:///_virtual/ActivityMergeCohesionRankView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./GuildPinItem.ts","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./BagModel.ts","./GuildControl.ts","./GuildDataCache.ts","./RankControl.ts","./RankDefine.ts","./RankModel.ts","./RoleDataCache.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./RankingRushDataCache.ts","./BaseView.ts"],(function(t){"use strict";var n,i,e,o,a,s,r,d,h,c,l,f,u,v,k,m,I,g,C,p,y,R,w,x;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,e=t.Button,o=t.Label,a=t.ScrollView,s=t.js,r=t.Sprite},function(t){d=t.V2},function(t){h=t.GuildPinItem},function(t){c=t.ItemGrid},function(t){l=t.ListItem},function(t){f=t.default},function(t){u=t.default},null,function(t){v=t.BagModel},function(t){k=t.default},function(t){m=t.default},function(t){I=t.default},function(t){g=t.RankDefine},function(t){C=t.RankModel},function(t){p=t.RoleDataCache},function(t){y=t.default},function(t){R=t.ActivityType},function(t){w=t.RankingRushDataCache},function(t){x=t.BaseView}],execute:function(){var L,S;i._RF.push({},"3adf8W6XyZN6b76bUUpJp5L","ActivityMergeCohesionRankView",void 0);var G=1,_=2,b="",T=((L={})[R.MergeCohesion]={1:303639,2:303640},L),M=((S={})[1]=new d(0,0),S[2]=new d(0,0),S[3]=new d(0,0),t("default",function(t){function i(){var n;return(n=t.call(this)||this).tabBtns=[],n.actType=void 0,n.curIndex=0,n.nodeReward=void 0,n.nodeRank=void 0,n.nodeTopRank=void 0,n.nodeMyRank=void 0,n.rankList=void 0,n.rewardList=void 0,n.myFlag=void 0,n.txtMyRank=void 0,n.txtMyScore=void 0,n.txtMyName=void 0,n.roleList={},n.actInfo=void 0,n.rankId=void 0,n.rankInfo=void 0,n.curRankPage=void 0,n.name="ActivityMergeCohesionRankView",n.url="ui/module/activityMergeServers/ActivityMergeCohesionRankView",n}n(i,t);var r=i.prototype;return r.onInit=function(){var t=this,n=this.findChild("imgMask");this.addComponentCallbackListener(n,e.EventType.CLICK,(function(){}));var i=this.findChild("root/btnClose");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.close()}));for(var r=function(n){var i=f.findChild(t.node,s.formatStr("root/bg/bottomBtn/item%s",n)),a={itemGo:i,normalTxt:f.findChildComponent(i,"normal/Label",o),normalGo:f.findChild(i,"normal"),selectedGo:f.findChild(i,"selected"),selectTxt:f.findChildComponent(i,"selected/Label",o),index:n};t.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.SetIndex(a.index)})),t.tabBtns[n]=a},d=1;d<=2;d++)r(d);this.nodeReward=this.findChild("root/nodeReward"),this.nodeRank=this.findChild("root/nodeRank"),this.nodeTopRank=this.findChild("root/nodeTopRank"),this.nodeMyRank=this.findChild("root/myRank"),this.txtMyRank=this.findChildComponent("root/myRank/rankNum",o),this.txtMyScore=this.findChildComponent("root/myRank/score",o),this.txtMyName=this.findChildComponent("root/myRank/name",o),this.myFlag=new h(this,f.findChild(this.node,"root/myRank/GuildPinItem"));var c=this.findChildComponent("root/nodeRank/rankList",a);this.rankList=this.addUIList(c,N),this.addComponentCallbackListener(c.node,a.EventType.SCROLL_TO_BOTTOM,(function(){if(t.curRankPage<t.rankInfo.max_page){t.curRankPage++;var n=new Array;n.push({type:t.rankId,server:1,page:t.curRankPage}),IS(I).reqRankList(n)}}));var l=this.findChildComponent("root/nodeReward/rankList",a);this.rewardList=this.addUIList(l,M,!0,0);for(var u=1;u<=3;u++){var v=new B;v.init(this.findChild("root/nodeTopRank/rank"+u),this,u),this.roleList[u]=v}},r.registerUpdateHandler=function(){this.addEvent(g.RankInfoBack,this.UpdateRankInfo,this)},r.onAfterOpen=function(){for(var t in this.actType=this.openArgs[0],this.roleList)this.roleList.hasOwnProperty(t)&&this.roleList[t].show();if(IS(p).HasGuild()){var n=IS(m).GetGuildInfo();this.txtMyName.string=n.name,this.myFlag.node.active=!0,this.myFlag.SetItem(n.guild_flag)}else this.txtMyName.string=GetLanguage(200083),this.myFlag.node.active=!1;for(var i=1;i<=2;i++){var e=this.tabBtns[i];e.normalTxt.string=GetLanguage(T[this.actType][i]),e.selectTxt.string=GetLanguage(T[this.actType][i])}this.actInfo=IS(y).GetActivityInfo(this.actType),this.rankId=this.actInfo.roundCfg.rank_id;var o=configRanktype.getDataByKey(this.rankId);b=o.prefix;var a=new Array;a.push({type:this.rankId,server:1,page:1}),this.curRankPage=1,IS(I).reqRankList(a);var s=IS(w).getRankRewardList(this.actInfo);this.rewardList.datas=s,this.tabBtns[G].itemGo.active,this.SetIndex(G)},r.onBeforeClose=function(){this.rankId=0,this.rankList.clearData(),this.curIndex>0&&(this.tabBtns[this.curIndex].normalGo.active=!0,this.tabBtns[this.curIndex].selectedGo.active=!1,this.curIndex=0)},r.onDestroy=function(){},r.SetIndex=function(t){this.curIndex!=t&&(this.curIndex>0&&(this.tabBtns[this.curIndex].selectedGo.active=!1,this.tabBtns[this.curIndex].normalGo.active=!0),this.curIndex=t,this.tabBtns[this.curIndex].normalGo.active=!1,this.tabBtns[this.curIndex].selectedGo.active=!0,this.curIndex==_?(this.nodeReward.active=!0,this.nodeRank.active=!1,this.nodeTopRank.active=!0,this.nodeMyRank.active=!0,this.rewardList.updateAll()):this.curIndex==G&&(this.nodeReward.active=!1,this.nodeRank.active=!0,this.nodeTopRank.active=!0,this.nodeMyRank.active=!0,this.rankList.updateAll()))},r.UpdateRankInfo=function(){if(this.rankInfo=IS(C).GetRankInfoByType(this.rankId),this.rankInfo){var t;this.txtMyRank.string=0!=this.rankInfo.my_info.rank?this.rankInfo.my_info.rank:GetLanguage(200037),this.txtMyScore.string=s.formatStr("%s%s",b,u.GetNumString(null!=(t=this.rankInfo.my_info.score)?t:0)),this.rankList.datas=this.rankInfo.rank_list;for(var n=1;n<=3;n++)this.roleList[n].show(this.rankInfo.rank_list[n-1])}},i}(x)),function(t){function i(){for(var n,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(n=t.call.apply(t,[this].concat(e))||this).rewardScroll=void 0,n.txtRank=void 0,n.rankIcon=void 0,n}n(i,t);var e=i.prototype;return e.onInit=function(){this.txtRank=f.findChildComponent(this.node,"rankNum",o),this.rankIcon=f.findChildComponent(this.node,"rankIcon",r);var t=f.findChildComponent(this.node,"rewardScroll",a);this.rewardScroll=this.view.addUIList(t,A,!1,0),this.rewardScroll.touchEvent=!1},e.onRender=function(t,n){this.rewardScroll.datas=t.rank_reward,this.rewardScroll.scrollView.enabled=t.rank_reward.length>=6,this.rewardScroll.touchEvent=t.rank_reward.length>=6;var i=t.rank_range[0],e=t.rank_range[1];i==e&&i<=3?(this.rankIcon.node.active=!0,this.txtRank.node.active=!1,this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+i)):(this.rankIcon.node.active=!1,this.txtRank.node.active=!0,t.show&&""!=t.show?this.txtRank.string=t.show:this.txtRank.string=s.formatStr("%s-%s",i,e))},e.onItemClick=function(){},i}(l)),N=function(t){function i(){for(var n,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(n=t.call.apply(t,[this].concat(e))||this).flag=void 0,n.txtRank=void 0,n.rankIcon=void 0,n.txtName=void 0,n.txtScore=void 0,n}n(i,t);var e=i.prototype;return e.onInit=function(){this.flag=new h(this.view,f.findChild(this.node,"GuildPinItem")),this.txtRank=f.findChildComponent(this.node,"rankNum",o),this.rankIcon=f.findChildComponent(this.node,"rankIcon",r),this.txtName=f.findChildComponent(this.node,"name",o),this.txtScore=f.findChildComponent(this.node,"score",o)},e.onRender=function(t,n){this.flag.SetItem(t.guild_flag),this.txtName.string=t.name,this.txtScore.string=b+u.GetNumString(t.score),t.rank<=3?(this.rankIcon.node.active=!0,this.txtRank.node.active=!1,this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+t.rank)):(this.rankIcon.node.active=!1,this.txtRank.node.active=!0,this.txtRank.string=t.rank)},e.onItemClick=function(){IS(k).send_29_1(this.data.belong_id)},i}(l),B=function(){function t(){this.view=void 0,this.node=void 0,this.rank=void 0,this.flag=void 0,this.txtName=void 0,this.txtScore=void 0,this.rankIcon=void 0,this.data=void 0}var n=t.prototype;return n.init=function(t,n,i){this.view=n,this.node=t,this.rank=i,this.onInit()},n.onInit=function(){var t=this;this.txtName=f.findChildComponent(this.node,"name",o),this.txtScore=f.findChildComponent(this.node,"score",o),this.flag=new h(this.view,f.findChild(this.node,"GuildPinItem")),this.view.addComponentCallbackListener(this.flag.node,e.EventType.CLICK,(function(){t.data&&IS(k).send_29_1(t.data.belong_id)})),this.rankIcon=f.findChildComponent(this.node,"rank_icon",r),this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+this.rank)},n.show=function(t){this.data=t,this.txtName.string=GetLanguage(200038),this.txtScore.string=b+"0",this.flag.node.active=!1,t&&(this.flag.node.active=!0,this.flag.SetItem(t.guild_flag),this.txtName.string=t.name,this.txtScore.string=b+u.GetNumString(t.score))},t}(),A=function(t){function i(){for(var n,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(n=t.call.apply(t,[this].concat(e))||this).itemGridNode=void 0,n.itemGrid=void 0,n.img=void 0,n}n(i,t);var o=i.prototype;return o.onInit=function(){var t=this;this.adaptiveSize=!0,this.img=f.findChildComponent(this.node,"img",r),this.itemGridNode=f.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode),this.view.addComponentCallbackListener(this.node,e.EventType.CLICK,(function(){IS(v).OpenItemTips(t.data[0],t.node)}))},o.onRender=function(t,n){var i=configGoods.getDataByKey(t[0]);if(17==i.type){this.ut.width=187,this.img.node.active=!0,this.itemGridNode.active=!1;var e=configTitle.getDataByKey(i.effect[0]);this.view.loadIcon(this.img,"icon_title",e.icon)}else this.ut.width=100,this.img.node.active=!1,this.itemGridNode.active=!0,this.itemGrid.SetItemId(t[0],t[1])},i}(l);i._RF.pop()}}}));

