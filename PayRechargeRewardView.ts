System.register("chunks:///_virtual/PayRechargeRewardView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ItemIcon.ts","./MulLanguageUtil.ts","./BagModel.ts","./MessageView.ts","./PayControl.ts","./PayDataCache.ts","./PayDefine.ts","./BaseView.ts"],(function(i){"use strict";var t,e,n,o,s,a,h,d,r,f,c,l,v,u,g,m,C,p,w,y;return{setters:[function(i){t=i.inheritsLoose},function(i){e=i.cclegacy,n=i.Button,o=i.js,s=i.Sprite,a=i.Label,h=i.ScrollView,d=i.sys},function(i){r=i.ListItem},function(i){f=i.default},function(i){c=i.default},function(i){l=i.default},null,function(i){v=i.IconAseetType},function(i){u=i.default},function(i){g=i.BagModel},function(i){m=i.default},function(i){C=i.default},function(i){p=i.default},function(i){w=i.PayEventDefine},function(i){y=i.BaseView}],execute:function(){var I,S,T;e._RF.push({},"df507jV0XNPAJWN/32jSyxd","PayRechargeRewardView",void 0);var b=((I={}).title="%s_%s_biaoti",I.ext="%s_sc_biaoqian",I.value="%s_sc_fubiaoti",I),L=["en","tr","es","pt","de","fr","ru","zh","it","ar"],_=((S={})[10101]="wuqi",S[10102]="toukui",S[10103]="mianshi",S),P=((T={})[10101]="sc_IMG_maijiaxiu01",T[10102]="sc_IMG_maijiaxiu02",T[10103]="sc_IMG_maijiaxiu03",T),x=(i("default",function(i){function e(){var t;return(t=i.call(this)||this).view1=void 0,t.view2=void 0,t.time=0,t.leftTime=-1,t.name="PayRechargeRewardView",t.url="ui/module/shop/PayRechargeRewardView",t.poolTime=3e3,t}t(e,i);var o=e.prototype;return o.onInit=function(){var i=this,t=this.findChild("imgMask");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){i.close()})),this.view1=new x,this.view1.init(this.findChild("view1"),this),this.view2=new G,this.view2.init(this.findChild("view2"),this)},o.registerUpdateHandler=function(){this.addEvent(w.PAY_INFO_UPDATE,this.updateInfo,this),this.addEvent(w.PAY_REWARD_UPDATE,this.updateInfo,this),this.addEvent(w.PAY_RECHARGE_SUCCESS,this.updateInfo,this)},o.onAfterOpen=function(){this.updateInfo()},o.onBeforeClose=function(){},o.onDestroy=function(){},o.onUpdate=function(i){if(this.time=this.time+i,this.time>1&&(this.time=0,this.leftTime>=0))if(this.leftTime=this.leftTime-1,this.leftTime>0){var t,e=l.getTimeData(this.leftTime);e[0],e[1],e[2],e[3];t=l.formatTimeStringForSecond(this.leftTime),this.view1.txtLeftTime.string=t,this.view2.txtLeftTime.string=t}else this.view1.txtLeftTime.node.active=!1,this.view2.txtLeftTime.node.active=!1,this.leftTime=-1,this.close()},o.updateInfo=function(){var i=IS(p).GetPayRechargeGift();if(null!=i){if(this.leftTime=i.end_time-l.serverTime,this.leftTime>0){this.view1.txtLeftTime.node.active=!0,this.view2.txtLeftTime.node.active=!0;var t;t=l.formatTimeStringForSecond(this.leftTime),this.view1.txtLeftTime.string=t,this.view2.txtLeftTime.string=t}else this.view1.txtLeftTime.node.active=!1,this.view2.txtLeftTime.node.active=!1,this.leftTime=-1,this.close();1==i.payCfg.show?(this.view1.node.active=!0,this.view2.node.active=!1,this.view1.updateInfo()):2==i.payCfg.show&&(this.view1.node.active=!1,this.view2.node.active=!0,this.view2.updateInfo())}else this.close()},e}(y)),function(){function i(){this.view=void 0,this.node=void 0,this.cfg=void 0,this.value=void 0,this.btnGo=void 0,this.btnReceive=void 0,this.btnPay=void 0,this.txtPrice=void 0,this.rewardScroll=void 0,this.img=void 0,this.txtDesc=void 0,this.txtLeftTime=void 0,this.imgTitle=void 0,this.imgExt=void 0,this.imgValue=void 0,this.imgRoleSprite=void 0}var t=i.prototype;return t.init=function(i,t){this.view=t,this.node=i,this.onInit()},t.getSpriteName=function(i){var t=b[i];return"title"==i?o.formatStr(t,L.includes(u.GetGurLanuage())?u.GetGurLanuage():"en",_[this.cfg.id]):o.formatStr(t,L.includes(u.GetGurLanuage())?u.GetGurLanuage():"en")},t.onInit=function(){var i=this;this.imgTitle=f.findChildComponent(this.node,"desc",s),this.imgExt=f.findChildComponent(this.node,"imgExt",s),this.imgValue=f.findChildComponent(this.node,"value/imgValue",s),this.imgRoleSprite=f.findChildComponent(this.node,"imgRole",s),this.txtLeftTime=f.findChildComponent(this.node,"nodeTime/txtLeftTime",a),this.btnGo=f.findChild(this.node,"btnGo"),this.view.addComponentCallbackListener(this.btnGo,n.EventType.CLICK,(function(){i.view.close()})),this.btnPay=f.findChild(this.node,"btnPay"),this.txtPrice=f.findChildComponent(this.node,"btnPay/Label",a),this.view.addComponentCallbackListener(this.btnPay,n.EventType.CLICK,(function(){var i=IS(p).GetPayRechargeGift();IS(p).Pay(i.payCfg.id)})),this.btnReceive=f.findChild(this.node,"btnReceive"),this.view.addComponentCallbackListener(this.btnReceive,n.EventType.CLICK,(function(){2==IS(p).GetPayGiftInfo(i.cfg.id).rewardState?m.showFlyTip(GetLanguage(200060)):IS(C).send_19_2(i.cfg.id)})),this.value=f.findChildComponent(this.node,"value/Label",a),this.img=f.findChildComponent(this.node,"img",s);var t=f.findChildComponent(this.node,"rewardScroll",h);this.rewardScroll=this.view.addUIList(t,R),this.rewardScroll.lackCenter=!0},t.updateInfo=function(){var i=IS(p).GetPayRechargeGift();1==i.payCfg.id?this.cfg=i.payCfg:2==i.rewardState&&0!=i.payCfg.next_id?this.cfg=configPay_mall.getDataByKey(i.payCfg.next_id):this.cfg=i.payCfg,this.view.loadIcon(this.imgTitle,"icon_first_recharge",this.getSpriteName("title"),null,v.ICON_SPRITE),this.view.loadIcon(this.imgExt,"icon_first_recharge",this.getSpriteName("ext"),null,v.ICON_SPRITE),this.view.loadIcon(this.imgValue,"icon_first_recharge",this.getSpriteName("value"),null,v.ICON_SPRITE),this.view.loadIcon(this.imgRoleSprite,"gift",P[this.cfg.id]),this.rewardScroll.datas=this.cfg.reward;var t=o.formatStr("%s%",1e3*this.cfg.ratio);this.value.string=c.formatStrWithMirrorDeal(GetLanguage(300117),t),this.img.node.removeAllChildren(),this.view.addUIEffect(this.cfg.pic_back,this.img.node,-1,null,1,(function(i){d.uiMirror&&(i.dir=-1)})),this.btnGo.active=!1,this.btnReceive.active=!1,this.btnPay.active=!0,this.txtPrice.string=IS(p).GetPriceString(this.cfg.cost_level)},i}()),G=function(){function i(){this.view=void 0,this.node=void 0,this.cfg=void 0,this.value=void 0,this.btnGo=void 0,this.btnReceive=void 0,this.btnPay=void 0,this.txtPrice=void 0,this.rewardScroll=void 0,this.img=void 0,this.txtDesc=void 0,this.txtLeftTime=void 0}var t=i.prototype;return t.init=function(i,t){this.view=t,this.node=i,this.onInit()},t.onInit=function(){var i=this;this.txtLeftTime=f.findChildComponent(this.node,"txtLeftTime",a),this.btnGo=f.findChild(this.node,"btnGo"),this.view.addComponentCallbackListener(this.btnGo,n.EventType.CLICK,(function(){i.view.close()})),this.btnPay=f.findChild(this.node,"btnPay"),this.txtPrice=f.findChildComponent(this.node,"btnPay/Label",a),this.view.addComponentCallbackListener(this.btnPay,n.EventType.CLICK,(function(){var i=IS(p).GetPayRechargeGift();IS(p).Pay(i.payCfg.id)})),this.btnReceive=f.findChild(this.node,"btnReceive"),this.view.addComponentCallbackListener(this.btnReceive,n.EventType.CLICK,(function(){2==IS(p).GetPayGiftInfo(i.cfg.id).rewardState?m.showFlyTip(GetLanguage(200060)):IS(C).send_19_2(i.cfg.id)})),this.value=f.findChildComponent(this.node,"value/Label",a),this.img=f.findChildComponent(this.node,"img",s),this.txtDesc=f.findChildComponent(this.node,"desc",a);var t=f.findChildComponent(this.node,"rewardScroll",h);this.rewardScroll=this.view.addUIList(t,R),this.rewardScroll.lackCenter=!0},t.updateInfo=function(){var i=IS(p).GetPayRechargeGift();1==i.payCfg.id?this.cfg=i.payCfg:2==i.rewardState&&0!=i.payCfg.next_id?this.cfg=configPay_mall.getDataByKey(i.payCfg.next_id):this.cfg=i.payCfg,this.rewardScroll.datas=this.cfg.reward,this.value.string=""+this.cfg.gem_value,this.img.node.removeAllChildren(),this.view.addUIEffect(this.cfg.pic_back,this.img.node,-1,null,1,(function(i){d.uiMirror&&(i.dir=-1)})),this.txtDesc.string=this.cfg.desc,this.btnGo.active=!1,this.btnReceive.active=!1,this.btnPay.active=!0,this.txtPrice.string=IS(p).GetPriceString(this.cfg.cost_level)},i}(),R=function(i){function e(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=i.call.apply(i,[this].concat(n))||this).imgFrame=void 0,t.imgIcon=void 0,t.txtNum=void 0,t.eff=void 0,t}t(e,i);var o=e.prototype;return o.onInit=function(){var i=this;this.imgFrame=f.findChildComponent(this.node,"imgFrame",s),this.imgIcon=f.findChildComponent(this.node,"imgIcon",s),this.txtNum=f.findChildComponent(this.node,"txtNum",a),this.view.addComponentCallbackListener(this.node,n.EventType.CLICK,(function(){IS(g).OpenItemTips(i.data[0],i.node)}))},o.onRender=function(i,t){null!=this.eff&&this.view.removeUIEffect(this.eff),0==t&&(this.eff=this.view.addUIEffect("prefab/ui-effect/MX_tx_tongyong_daojulingqu",this.node,-1));var e=i[0],n=configGoods.getDataByKey(e),o=n.quality,s=configColor.getDataByKey(o);this.txtNum.string=i[1],this.view.loadIcon(this.imgIcon,n.icon_group,n.icon),this.view.loadIcon(this.imgFrame,"icon_equip",s.path)},e}(r);e._RF.pop()}}}));

