System.register("chunks:///_virtual/HorseControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BagDefine.ts","./MessageView.ts","./ControlMgr.ts","./HorseDataChche.ts","./HorseDefine.ts"],(function(e){"use strict";var n,t,o,s,i,u,l;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy},function(e){o=e.BagEventDefine},function(e){s=e.default},function(e){i=e.controlMgr},function(e){u=e.HorseDataCache},function(e){l=e.HorseEvent}],execute:function(){t._RF.push({},"19291iH13pKD7CQUA3NRWJR","HorseControl",void 0);e("default",function(){var e=t.prototype;function t(){netManager.addEventListener("mount.mount_info_s2c",this.onHorseInfo,this),netManager.addEventListener("mount.mount_levup_s2c",this.onHorseLevelUp,this),netManager.addEventListener("mount.mount_use_s2c",this.onHorseUse,this),netManager.addEventListener("mount.mount_up_skin_s2c",this.onSkinLevelUp,this),netManager.addEventListener("mount.mount_use_skill_s2c",this.onUseSkill,this),netManager.addEventListener("mount.mount_talent_up_s2c",this.onEnable,this),normalEvent.on(o.GOODS_INFO_UPDATE,this.updateItemCheck),i.addControl(this)}return e.clear=function(){printLog("HorseControl")},e.onLogin=function(){this.reqHorseInfo()},e.onReconnect=function(){},e.updateItemCheck=function(){IS(u).checkSkinRP(),IS(u).checkUpgradeRP(),IS(u).checkEnableRP()},e.reqHorseInfo=function(){netManager.send("mount.mount_info_c2s",{})},e.reqLevelUp=function(e){netManager.send("mount.mount_levup_c2s",{type:e})},e.reqUseHorse=function(e){netManager.send("mount.mount_use_c2s",{use:e})},e.reqSkinLevelUp=function(e){netManager.send("mount.mount_up_skin_c2s",{mount_id:e})},e.reqUseSkill=function(e){netManager.send("mount.mount_use_skill_c2s",{skill_use:e})},e.reqEnable=function(e){netManager.send("mount.mount_talent_up_c2s",{type:e})},e.onHorseInfo=function(e){e.level!=IS(u).curLevel&&1!=e.level&&0!=IS(u).curLevel&&uiMgr.openView("UpgradeResultView"),null!=IS(u).skin_list&&IS(u).skin_list.length+1==e.skin_list.length&&uiMgr.openView("HorseGetView",e.use),IS(u).horse_id=e.use,IS(u).skin_list=e.skin_list,IS(u).curexp=e.exp,IS(u).curLevel=e.level,IS(u).skill_use=e.skill_use,IS(u).talent_list=e.talent_list,normalEvent.emit(l.TYPE_HORSE_CHANGE,e.use),IS(u).checkSkinRP(),IS(u).checkUpgradeRP(),IS(u).checkEnableRP()},e.onHorseLevelUp=function(e){IS(u).curexp=e.exp,normalEvent.emit(l.TYPE_HORSE_ADD_EXP)},e.onHorseUse=function(e){IS(u).horse_id=e.use,normalEvent.emit(l.TYPE_HORSE_CHANGE,e.use)},e.onSkinLevelUp=function(e){console.log(e)},e.onUseSkill=function(e){IS(u).skill_use=e.skill_use,normalEvent.emit(l.TYPE_HORSE_USE_SKILL)},e.onEnable=function(e){if(0==e.is_succ){for(var t,o=!1,i=n(IS(u).talent_list);!(t=i()).done;){var r=t.value;r.k==e.talent_id&&(r.v=e.talent_lev,o=!0)}o||IS(u).talent_list.push({k:e.talent_id,v:e.talent_lev}),uiMgr.openView("EnableResultView",e)}else s.showFlyTip(GetLanguage(200412));normalEvent.emit(l.TYPE_HORSE_ENABLE_INFO)},t}());t._RF.pop()}}}));

