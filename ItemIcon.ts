System.register("chunks:///_virtual/ItemIcon.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts"],(function(s){"use strict";var e,i,t,a,r,l,c,n,o;return{setters:[function(s){e=s.createClass},function(s){i=s.cclegacy,t=s.isValid,a=s.sys,r=s.Vec3,l=s.SpriteFrame,c=s.ImageAsset,n=s.SpriteAtlas},function(s){o=s.default}],execute:function(){var u;s("IconAseetType",void 0),i._RF.push({},"666c00F3xREybNzwrjYHL/w","ItemIcon",void 0),function(s){s[s.UI_ATLAS=0]="UI_ATLAS",s[s.ICON_SPRITE=1]="ICON_SPRITE",s[s.REMOTE=2]="REMOTE",s[s.BG_SPRITE=3]="BG_SPRITE"}(u||(u=s("IconAseetType",{})));s("ItemIcon",function(){function s(){this._url=void 0,this._atlas=void 0,this._frame=void 0,this.sprite=void 0,this._onLoadViewSuccess=void 0,this._isChange=!1,this.callback=void 0,this.isload=void 0,this.assetType=u.UI_ATLAS,this.noMirror=!1}var i=s.prototype;return i.load=function(){var s=this;if(this._isChange||!this.isload){if(this._isChange){if(this._isChange=!1,this.isload?resourceMgr.releaseResRef(this.url):(null!=this._onLoadViewSuccess&&resourceMgr.cancelLoadRes(this.url,this._onLoadViewSuccess),this._onLoadViewSuccess=null),this.assetType!=u.REMOTE){if(o.isEmpty(this._frame))return;if(o.isEmpty(this._atlas))return;this.url=""}switch(this.isload=!1,this.assetType){case u.UI_ATLAS:this._url="ui/atlas/"+this._atlas;break;case u.BG_SPRITE:this._url="ui/bg/"+this._atlas+"/"+this._frame;break;case u.ICON_SPRITE:this._url="ui/icon/"+this._atlas+"/"+this._frame+"/spriteFrame"}}if(this.url){var e=this.sprite;switch(this._onLoadViewSuccess=function(i){if(s._onLoadViewSuccess=null,t(e)){if(a.uiMirror&&!s.noMirror){var c=e.node.scale;e.node.scale=new r(-Math.abs(c.x),c.y,c.z)}if(e.spriteAtlas=null,e.spriteFrame=null,i.error||null==i.item||null==i.item.asset)s.callback=null;else if(s.url==i.item.url)if(s.isload=!0,s.assetType==u.UI_ATLAS){var n=i.item.asset;if(t(n)){var o=n.getSpriteFrame&&n.getSpriteFrame(s._frame);null!=o&&(e.spriteFrame=o,null!=s.callback&&(s.callback(e),s.callback=null))}}else{if(s.assetType==u.ICON_SPRITE)e.spriteFrame=i.item.asset;else{var h=l.createWithImage(i.item.asset);e.spriteFrame=h}null!=s.callback&&(s.callback(e),s.callback=null)}}else s.callback=null},this.assetType){case u.UI_ATLAS:resourceMgr.loadRes(this.url,n,this._onLoadViewSuccess);break;case u.REMOTE:resourceMgr.loadRemote(this.url,c,this._onLoadViewSuccess);break;case u.BG_SPRITE:case u.ICON_SPRITE:resourceMgr.loadRes(this.url,l,this._onLoadViewSuccess)}}}},i.close=function(){this.callback=null,null!=this._onLoadViewSuccess&&resourceMgr.cancelLoadRes(this.url,this._onLoadViewSuccess),this._onLoadViewSuccess=null},i.unload=function(){this.isload&&(this.isload=!1,this.close(),resourceMgr.releaseResRef(this.url))},i.forceChange=function(){this._isChange=!0},e(s,[{key:"url",get:function(){return this._url},set:function(s){this.assetType==u.REMOTE&&this._url!=s&&(this._url=s,this._isChange=!0)}},{key:"atlas",get:function(){return this._atlas},set:function(s){this.assetType!=u.REMOTE&&this._atlas!=s&&(this._atlas=s,o.isEmpty(s)?(this.close(),this.sprite&&(this.sprite.spriteFrame=null)):this._isChange=!0)}},{key:"frame",get:function(){return this._frame},set:function(s){this.assetType!=u.REMOTE&&this._frame!=s&&(this._frame=s,o.isEmpty(s)?(this.close(),this.sprite&&(this.sprite.spriteFrame=null)):this._isChange=!0)}}]),s}());i._RF.pop()}}}));

