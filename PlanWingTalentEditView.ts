System.register("chunks:///_virtual/PlanWingTalentEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./index57.ts","./ConfigGlobal.ts","./WingDataCache.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var n,e,i,o,a,l,s,c,d,f,r,u,h,C,I,v;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t.Button,o=t.UITransform,a=t.Vec3,l=t.instantiate,s=t.Label},function(t){c=t.default},null,function(t){d=t.ConfigGlobal},function(t){f=t.WingDataCache},function(t){r=t.default},function(t){u=t.RoleDataCache},function(t){h=t.RoleEventDefine},function(t){C=t.OpenFunction,I=t.PanelTabType},function(t){v=t.BaseView}],execute:function(){var p;e._RF.push({},"f472cnnGRVJcakAAVSJHY2i","PlanWingTalentEditView",void 0),function(t){t[t.BuffUnlock=0]="BuffUnlock",t[t.BuffLock=1]="BuffLock",t[t.LevelUnlockable=2]="LevelUnlockable",t[t.LevelLock=3]="LevelLock"}(p||(p={}));d.statue_tab_limit.length,t("default",function(t){function e(){var n;return(n=t.call(this)||this).infoItems=[],n.utContent=void 0,n.curPlanId=void 0,n.nodeItem=void 0,n.nodeContent=void 0,n.name="PlanWingTalentEditView",n.url="ui/module/role/PlanWingTalentEditView",n}n(e,t);var v=e.prototype;return v.onInit=function(){var t=this,n=this.findChild("imgMask");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){t.close()}));var e=this.findChild("content/btnGoTo");this.addComponentCallbackListener(e,i.EventType.CLICK,(function(){IS(u).CheckFuncOpen(C.FUNC_BACK,!0)&&(uiMgr.openView("WingView",I.Wing_Talent),t.close(),uiMgr.close("RolePlanView"))})),this.nodeContent=this.findChild("content/scroll/view/content"),this.utContent=this.nodeContent.getComponent(o),this.nodeItem=this.findChild("content/scroll/view/content/statueRoot"),this.nodeItem.active=!1;for(var a=function(n){var e=nodeInstantiate.instantiate(t.nodeItem);e.parent=t.nodeContent,e.active=!0;var a=c.findChild(e,"btnSwitch");t.addComponentCallbackListener(a,i.EventType.CLICK,(function(){IS(r).send_role_update_plan_c2s(t.curPlanId,[{k:9,v:n}])}));var l=[],d=c.findChild(e,"effectParent/effectItem");l.push({node:d,txtAttr:c.findChildComponent(d,"txtEffect",s)});c.findChild(e,"imgSpace");t.infoItems.push({nodeStatueRoot:e,utStatueRoot:e.getComponent(o),txtName:c.findChildComponent(e,"txtName",s),nodeCur:c.findChild(e,"nodeCur"),btnSwitch:a,tabId:n,attrItems:l})},l=1;l<=d.back_talent_tab_num;l++)a(l)},v.registerUpdateHandler=function(){this.addEvent(h.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(h.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this)},v.onAfterOpen=function(){this.nodeContent.setPosition(new a(0,0,0)),this.curPlanId=this.openArgs[0],this.updateContent()},v.updateContent=function(){for(var t=8,n=0,e=0;e<this.infoItems.length;e++){var i=this.updateSingleInfo(this.infoItems[e]);t+=i.height,i.isShow&&(n+=1),this.updateSelect(this.infoItems[e])}n>1&&(t+=20*(n-1)),this.utContent.height=t},v.updateSingleInfo=function(t){t.txtName.string=IS(f).GetPlanName(t.tabId),t.nodeStatueRoot.active=!0;for(var n=IS(f).GetTalentAttrList(t.tabId),e=0,i=0;i<Math.max(n.length,t.attrItems.length);i++){var o=t.attrItems[i];if(!o){var a=l(t.attrItems[0].node);a.parent=t.attrItems[0].node.parent,o={node:a,txtAttr:c.findChildComponent(a,"txtEffect",s)},t.attrItems.push(o)}var d=n[i];if(null!=d)if(e+=1,o.node.active=!0,d.attr_id){var r=configAttribute.getDataByKey(d.attr_id),u=(null==r?void 0:r.desc)||"";o.txtAttr.string=u+"+"+d.value+(1==r.num_type?"":"%")}else{var h=configSkill.getDataByKey(d.skill_id);o.txtAttr.string=h.name}else o.node.active=!1}var C=Math.floor((e+1)/2);if(C<=0)return t.utStatueRoot.height=90,{isShow:!0,height:90};var I=41*C+14*(C-1);return t.utStatueRoot.height=90+I,{isShow:!0,height:90+I}},v.updateSelect=function(t){for(var n,e=IS(u).planIdToInfo[this.curPlanId].detail,i=0;i<e.length;i++)if(9==e[i].k){n=e[i].v;break}t.nodeCur.active=t.tabId==n,t.btnSwitch.active=t.tabId!=n},v.onHomeFarmStatueInfoBack=function(){this.updateContent()},v.OnPlanInfoBack=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSelect(this.infoItems[t])},v.onPlanInfoUpdate=function(t){if(t==this.curPlanId)for(var n=0;n<this.infoItems.length;n++)this.updateSelect(this.infoItems[n])},v.onBeforeClose=function(){},v.onDestroy=function(){},e}(v));e._RF.pop()}}}));

