System.register("chunks:///_virtual/FarmHelpView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./index57.ts","./PlantDefine.ts","./PlantDataCache.ts","./PlantControl.ts","./MessageView.ts","./ObjectUtil.ts","./RoleDataCache.ts","./BaseView.ts"],(function(n){"use strict";var t,i,e,o,a,r,l,d,s,f,h,u,c,I,m,p;return{setters:[function(n){t=n.inheritsLoose},function(n){i=n.cclegacy,e=n.Button,o=n.ScrollView,a=n.Sprite,r=n.Label},function(n){l=n.ListItem},function(n){d=n.default},null,function(n){s=n.PlantEventDefine,f=n.CropState},function(n){h=n.PlantDataCache},function(n){u=n.default},function(n){c=n.default},function(n){I=n.default},function(n){m=n.RoleDataCache},function(n){p=n.BaseView}],execute:function(){i._RF.push({},"38ad7lfDGZLHbT2BzZRTTok","FarmHelpView",void 0);n("default",function(n){function i(){var t;return(t=n.call(this)||this).scroll=void 0,t.waitingFarmInfoRoleId=void 0,t.waitingFarmInfoCropId=void 0,t.name="FarmHelpView",t.url="ui/module/plant/FarmHelpView",t}t(i,n);var a=i.prototype;return a.onInit=function(){var n=this,t=this.findChild("view/btnClose");this.addComponentCallbackListener(t,e.EventType.CLICK,(function(){n.close()}));var i=this.findChild("view/btnHelp");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){0!=I.getPropertyCount(IS(h).helpList)&&IS(u).req_home_farm_robber_share_ignore_c2s()}));var a=this.findChildComponent("view/scroll",o);this.scroll=this.addUIList(a,v)},a.registerUpdateHandler=function(){this.addEvent(s.FARM_HELP_LIST,this.updateInfo,this),this.addEvent(s.ROLE_HOME_FARM_INFO_BACK,this.onRoleHomeFarmInfoBack,this)},a.onAfterOpen=function(){this.updateInfo()},a.onBeforeClose=function(){},a.onDestroy=function(){},a.updateInfo=function(){var n=[],t=IS(h).helpList;for(var i in t)t.hasOwnProperty(i)&&n.push(t[i]);n.sort((function(n,t){return n.role_id!=t.role_id?n.role_id-t.role_id:n.land_id-t.land_id})),this.scroll.datas=n},a.onRoleHomeFarmInfoBack=function(n){if(null!=this.waitingFarmInfoRoleId&&null!=this.waitingFarmInfoCropId&&n.role_id==this.waitingFarmInfoRoleId){var t=0;for(var i in n.landIdToInfo){if(n.landIdToInfo.hasOwnProperty(i))n.landIdToInfo[i].crop.id==this.waitingFarmInfoCropId&&(t=Number(i))}if(0!=t){var e=n.landIdToInfo[t];if(null==e.crop)return c.showFlyTip(GetLanguage(200190)),this.waitingFarmInfoRoleId=null,void(this.waitingFarmInfoCropId=null);if(e.crop.state!=f.STEALING)return c.showFlyTip(GetLanguage(200190)),this.waitingFarmInfoRoleId=null,void(this.waitingFarmInfoCropId=null);uiMgr.openView("FarmHelpShareDetailView",t,n),this.waitingFarmInfoRoleId=null,this.waitingFarmInfoCropId=null}}},i}(p));var v=function(n){function i(){for(var t,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(t=n.call.apply(n,[this].concat(e))||this).imgHeadFrame=void 0,t.imgIcon=void 0,t.txtName=void 0,t}t(i,n);var o=i.prototype;return o.onInit=function(){var n=this,t=d.findChild(this.node,"btnHelp");this.view.addComponentCallbackListener(t,e.EventType.CLICK,(function(){n.data.robber_id!=IS(m).GetRoleId()?(n.view.waitingFarmInfoRoleId=n.data.role_id,n.view.waitingFarmInfoCropId=n.data.crop_id,IS(u).reqFarmInfo(n.data.role_id)):c.showFlyTip(GetLanguage(200181))})),this.imgIcon=d.findChildComponent(this.node,"head/imgIcon",a),this.imgHeadFrame=d.findChildComponent(this.node,"head/imgHeadFrame",a),this.txtName=d.findChildComponent(this.node,"name",r)},o.onRender=function(n,t){this.txtName.string=n.name,this.view.loadRemoteIcon(n.head.url,this.imgIcon);var i=n.head.frame_id;if(i>0){var e=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",e.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1},i}(l);i._RF.pop()}}}));

