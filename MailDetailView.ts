System.register("chunks:///_virtual/MailDetailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./BaseView.ts","./FixMath.ts","./MulLanguageUtil.ts","./BagDefine.ts","./BagModel.ts","./MessageView.ts","./NativeToJs.ts","./MailControl.ts"],(function(t){"use strict";var i,n,e,o,a,s,l,r,d,c,h,u,g,f,m,v,p,C,x,I,_,L,y;return{setters:[function(t){i=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){e=t.cclegacy,o=t.Button,a=t.Label,s=t.ScrollView,l=t.Sprite,r=t.UITransform,d=t.RichText,c=t.js},function(t){h=t.SelectedType,u=t.ListItem},function(t){g=t.default},function(t){f=t.default},function(t){m=t.default},function(t){v=t.BaseView},function(t){p=t.FixMath},function(t){C=t.default},function(t){x=t.ItemIdDefine},function(t){I=t.BagModel},function(t){_=t.default},function(t){L=t.NativeToJs},function(t){y=t.default}],execute:function(){e._RF.push({},"c07338hAPxPXIkTI8mTZ2Qa","MailDetailView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).txtTitle=void 0,i.txtTime=void 0,i.txtContent=void 0,i.rewardBox=void 0,i.itemList=void 0,i.content=void 0,i.get_status=void 0,i.get_btn=void 0,i.textScroll=void 0,i.data=void 0,i.SIZE_BIG=320,i.SIZE_SMALL=140,i.name="MailDetailView",i.url="ui/module/mail/MailDetailView",i}i(e,t);var d=e.prototype;return d.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.onMaskClick()})),this.txtTitle=this.findChildComponent("content/box/title/txtTitle",a),this.txtTime=this.findChildComponent("content/box/title/txtTime",a),this.txtContent=this.findChildComponent("content/box/content",a),this.rewardBox=this.findChild("content/box/rewardBox");this.findChild("content/box/rewardBox/mailList");var n=this.findChildComponent("content/box/rewardBox/mailList",s);this.itemList=this.addUIList(n,S),this.itemList.selectedMode=h.SINGLE,this.get_btn=this.findChildComponent("content/box/rewardBox/btnGet",l);var e=this.findChild("content/box/rewardBox/btnGet");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){0!=t.data.is_attach?(IS(y).reqGetMailGood(t.data.id,0),t.close()):_.showFlyTip(GetLanguage(200060))})),this.get_status=this.findChildComponent("content/box/rewardBox/btnGet/Label",a),this.textScroll=this.findChildComponent("content/box/ScrollView",s),this.content=this.addUIList(this.textScroll,w),this.content.virtual=!1},d.registerUpdateHandler=function(){},d.onMaskClick=function(){this.close()},d.onAfterOpen=function(){this.data=this.openArgs[0],this.updateData()},d.onBeforeClose=function(){},d.updateData=function(){var t=1e3*this.data.send_time,i=m.ServerDate(t),e=i.getFullYear(),o=i.getMonth()+1,a=i.getDate(),s=i.getHours(),l=i.getMinutes(),d=s+"";s<10&&(d="0"+s);var c=l+"";l<10&&(c="0"+l),this.txtTime.string=e+"/"+o+"/"+a+"  "+d+":"+c+m.GetServerTimeZoneStr();var h=GetLanguage(200321),u=!1;0==this.data.is_attach&&(h=GetLanguage(200314),u=!0),this.get_btn.grayscale=u,this.get_status.string=h;var g=configMail.getDataByKey(this.data.cfg_id);null!=this.data.title.arg_list&&this.data.title.arg_list.length>0&&3==this.data.title.arg_list[0].k&&0==this.data.title.arg_list[0].v?this.txtTitle.string=this.data.title.arg_list[0].name:this.txtTitle.string=g.title;var v="";if(null!=this.data.content.arg_list&&this.data.content.arg_list.length>0){var p="%s";if(0!=this.data.content.id){var x=C.GetconfigLanguage_Text(this.data.content.id);null!=x&&(p=x.text)}v=f.format_p_lang_info(p,this.data.content,void 0,{leftTimeCallback:function(t){return t/60}})}else v=g.content;this.content.datas=[v];var I=!1;if(null!=this.data.goods_list&&this.data.goods_list.length>0){I=!0;for(var _,L=[],y=[],w=n(this.data.goods_list);!(_=w()).done;){var S=_.value;2!=S.gtid?L.push(S):y.push(S)}if(L.length>1&&L.sort((function(t,i){return configGoods.getDataByKey(t.gtid).quality>=configGoods.getDataByKey(i.gtid).quality?-1:1})),y.length>0)for(var T,b=n(y);!(T=b()).done;){var B=T.value;L.unshift(B)}this.itemList.datas=L}this.rewardBox.active=I,this.textScroll.getComponent(r).height=I?this.SIZE_SMALL:this.SIZE_BIG},d.onDestroy=function(){},e}(v));var w=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).txtContent=void 0,i}i(n,t);var e=n.prototype;return e.onInit=function(){this.txtContent=g.findChildComponent(this.node,"",d),this.txtContent.Clicked=function(t,i){L.openURL(i)}},e.onRender=function(t,i){var n=t.replace(/<on click=(\w+)/g,"<on click='$1'").replace(/param=(\S+?)\>/g,"param='$1'>");this.txtContent.string=c.formatStr("<color=#544231>%s</color>",n);var e=this.txtContent.node.getComponent(r).contentSize;g.findChildComponent(this.view.node,"content/box/ScrollView/view/content",r).contentSize=e},n}(u),S=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).imgFrame=void 0,i.imgIcon=void 0,i.txtNum=void 0,i}i(n,t);var e=n.prototype;return e.onInit=function(){var t=this;this.imgFrame=g.findChildComponent(this.node,"head/imgFrame",l),this.imgIcon=g.findChildComponent(this.node,"head/imgIcon",l),this.txtNum=g.findChildComponent(this.node,"head/num",a),this.view.addComponentCallbackListener(this.imgIcon.node,o.EventType.CLICK,(function(){IS(I).OpenItemTips(t.data.gtid,t.imgIcon.node)}))},e.onRender=function(t,i){this.data=t,t.gtid==x.FakeRechare?this.txtNum.string=c.formatStr("%s ",p.round(t.num/100)):this.txtNum.string=t.num+"";var n=configGoods.getDataByKey(t.gtid),e=configColor.getDataByKey(n.quality);this.view.loadIcon(this.imgFrame,"icon_equip",e.path),this.view.loadIcon(this.imgIcon,n.icon_group,n.icon)},e.onItemClick=function(){},n}(u);e._RF.pop()}}}));

