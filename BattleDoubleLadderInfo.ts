System.register("chunks:///_virtual/BattleDoubleLadderInfo.ts",["cc","./NodeUtil.ts","./ChapterDefine.ts","./IBattleChapterPanel.ts"],(function(t){"use strict";var e,i,n,a,s,o,r,l;return{setters:[function(t){e=t.cclegacy,i=t.Button,n=t.Sprite,a=t.Label,s=t.sys},function(t){o=t.default},function(t){r=t.ChapterEventDefine},function(t){l=t.BattleInfoType}],execute:function(){e._RF.push({},"7267dZ9AWlOBJR34vPyMpW5","BattleDoubleLadderInfo",void 0);t("BattleDoubleLadderInfo",function(){function t(t,e){this.view=void 0,this.node=void 0,this.type=void 0,this.btnExit=void 0,this.players=[],this.curSelectIndex=0,this.view=t,this.node=e,this.type=l.Mount,this.onInit()}var e=t.prototype;return e.onInit=function(){var t=this,e=o.findChildComponent(this.node,"btnExit",i);this.view.addComponentCallbackListener(e.node,i.EventType.CLICK,(function(){t.view.exitBattle(),battleMain.enterChapter(),normalEvent.emit(r.BATTLE_STATE,battleMain.data.chapterType,!1)})),this.btnExit=e;for(var n=0;n<2;n++){var a=o.findChild(this.node,"opt/player"+(n+1));this.players[n]=new d(this,a,n)}},e.onUpdate=function(t){for(var e=0;e<battleMain.playerCtrs.length;e++){battleMain.playerCtrs[e].player.isDead?(this.players[e].node.active&&(this.players[e].node.active=!1),this.curSelectIndex==e&&(this.curSelectIndex=-1)):-1==this.curSelectIndex&&this.selectPlayer(e)}},e.reset=function(){this.btnExit.enabled=!0;for(var t=0,e=0;e<this.players.length;e++){var i=this.players[e],n=battleMain.playerCtrs[e];n?(n==battleMain.showMainCtr&&(t=e),i.node.active=!0,i.setInfo(n.player.data)):i.node.active=!1}this.curSelectIndex=-1,this.selectPlayer(t)},e.onLoad=function(){this.btnExit.enabled=!1},e.selectPlayer=function(t){this.curSelectIndex!=t&&(this.players.forEach((function(t){t.setSelect(!1)})),this.players[t].setSelect(!0),this.curSelectIndex=t,battleMain.showMainCtr=battleMain.playerCtrs[t],this.view.updateSkill(),battleMain.playerCtrs.forEach((function(t){var e=battleMain.renderMgr.getHpBar(t.player);e&&e.updateUnitName()})))},t}());var d=function(){function t(t,e,r){var l=this;this.info=void 0,this.node=void 0,this.select=void 0,this.index=void 0,this.imgHead=void 0,this.txtName=void 0,this.index=r,this.info=t,this.node=e,this.select=o.findChild(e,"select"),t.view.addComponentCallbackListener(e,i.EventType.CLICK,(function(){t.selectPlayer(l.index)})),this.imgHead=o.findChildComponent(e,"head",n),this.txtName=o.findChildComponent(e,"txtName",a),s.uiMirror&&this.txtName.node.setScale(-this.txtName.node.scale.x,this.txtName.node.scale.y)}var e=t.prototype;return e.setSelect=function(t){this.select.active=t},e.setInfo=function(t){this.info.view.loadRemoteIcon(t.head.url,this.imgHead),this.txtName.string=t.name},t}();e._RF.pop()}}}));

