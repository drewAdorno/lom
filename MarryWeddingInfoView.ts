System.register("chunks:///_virtual/MarryWeddingInfoView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./MessageView.ts","./RoleDefine.ts","./MarryControl.ts","./MarryDataCache.ts","./MarryDefine.ts","./BaseView.ts"],(function(e){"use strict";var i,t,n,r,o,a,s,d,m,h,l,f,g,u,c,v,p,T,C,_,y,w;return{setters:[function(e){i=e.inheritsLoose,t=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,r=e.Button,o=e.Label,a=e.sys,s=e.Widget,d=e.RichText,m=e.HorizontalTextAlignment,h=e.js,l=e.Sprite,f=e.LabelOutline,g=e.Color},function(e){u=e.default},function(e){c=e.default},function(e){v=e.default},null,function(e){p=e.default},function(e){T=e.PlayerAttr},function(e){C=e.default},function(e){_=e.default},function(e){y=e.MarryEventDefine},function(e){w=e.BaseView}],execute:function(){n._RF.push({},"8af30L1TI1DyoGqdPgOB9s4","MarryWeddingInfoView",void 0);e("default",function(e){function t(){var i;return(i=e.call(this)||this).openTime=void 0,i.openTimeNode=void 0,i.left=void 0,i.right=void 0,i.checkWeddingBtn=void 0,i.weddingTimeNode=void 0,i.weddingTime=void 0,i.memberNum=void 0,i.enterBtnName=void 0,i.title=void 0,i.timer=void 0,i.name="MarryWeddingInfoView",i.url="ui/module/marry/MarryWeddingInfoView",i}i(t,e);var n=t.prototype;return n.onInit=function(){var e=this,i=this.findChild("imgMask");if(this.addComponentCallbackListener(i,r.EventType.CLICK,(function(){e.close()})),this.title=this.findChildComponent("title",o),this.openTimeNode=this.findChild("openTime"),this.openTime=this.findChildComponent("openTime/time/Label",o),this.left=new L(this,this.findChild("man")),this.right=new L(this,this.findChild("girl")),this.checkWeddingBtn=this.findChild("checkWeddingBtn"),this.addComponentCallbackListener(this.checkWeddingBtn,r.EventType.CLICK,(function(){uiMgr.openView("GvGRuleTips",[GetLanguage(204419)])})),this.weddingTimeNode=this.findChild("weddingTime"),this.weddingTime=this.findChildComponent("weddingTime/time",o),a.uiMirror){var t=this.findChildComponent("openTime/time",s);t.node.setScale(-1,1,1);var n=t.right;t.isAlignRight=!1,t.isAlignLeft=!0,t.left=n,n=(t=this.findChildComponent("weddingTime/time",s)).right,t.isAlignRight=!1,t.isAlignLeft=!0,t.left=n}this.memberNum=this.findChildComponent("memberNum",d);var m=this.findChild("cancelBtn");this.addComponentCallbackListener(m,r.EventType.CLICK,(function(){e.close(),uiMgr.close("MarryMapSceneView")}));var h=this.findChild("enterBtn");this.enterBtnName=this.findChildComponent("enterBtn/Label",o),this.addComponentCallbackListener(h,r.EventType.CLICK,(function(){IS(C).send_marry_scene_status_c2s()}))},n.registerUpdateHandler=function(){var e=this;this.addEvent(y.MARRY_PARTY_INFO,this.UpdateInfo,this),this.addEvent(y.MARRY_IS_CAN_ENTER,(function(i){var t=IS(_).GetMarryStateInfo();if(0==i.code)if(1==t.invitationCard)uiMgr.openView("MarryMapSceneView"),e.close();else{var n=configMarry.getDataByKey(t.party_type);configGoods.getDataByKey(n.enter_spend[0][0]);p.showBoxTip({title:GetLanguage(201066),tip:c.formatStr(GetLanguage(204301),n.enter_spend[0][1]),btnCnt:1,horizontalAlign:m.LEFT,func:function(i){"type_yes"==i&&(uiMgr.openView("MarryMapSceneView"),e.close())}})}else p.showFlyTip(configErrorInfo.getDataByKey(i.code).info)}))},n.onAfterOpen=function(){IS(C).send_marry_party_info_c2s(),this.UpdateInfo()},n.UpdateInfo=function(){var e=this,i=IS(_).GetMarryStateInfo();if(this.timer&&(this.removeTimer(this.timer),this.timer=null),i&&i.stage>0){this.enterBtnName.string=1==IS(_).GetMarrySexType()?GetLanguage(204126):GetLanguage(204127),this.title.string=1==IS(_).GetMarrySexType()?GetLanguage_UI(600000002):GetLanguage_UI(600000008),1==i.stage?(this.openTimeNode.active=!0,this.weddingTimeNode.active=!1,this.checkWeddingBtn.active=!0,this.openTime.string=v.getTimeLeft(i.stage_time-v.serverTime),this.timer=this.addTimer(1,i.stage_time-v.serverTime,(function(){i&&i.stage_time-v.serverTime>0?e.openTime.string=v.getTimeLeft(i.stage_time-v.serverTime):(e.openTime.string=v.getTimeLeft(0),e.removeTimer(e.timer),e.timer=null)}))):(this.checkWeddingBtn.active=!1,this.openTimeNode.active=!1,this.weddingTimeNode.active=!0,this.weddingTime.string=v.getTimeLeft(i.stage_time-v.serverTime),this.timer=this.addTimer(1,i.stage_time-v.serverTime,(function(){i&&i.stage_time-v.serverTime>0?e.weddingTime.string=v.getTimeLeft(i.stage_time-v.serverTime):(e.weddingTime.string=v.getTimeLeft(0),e.removeTimer(e.timer),e.timer=null)}))),i.bride_list.sort((function(e,i){return e.figure.gender<i.figure.gender?-1:1})),this.left.showItem(i.bride_list[0]),this.right.showItem(i.bride_list[1]);var t=i.guest_num,n=configMarry.getDataByKey(i.party_type);i.guest_num>=n.num_max&&(t=h.formatStr("<color=#ea3232>%s</color>",i.guest_num)),this.memberNum.string=h.formatStr("<b><color=#0e6f85>%s</color></b>",c.formatStr(GetLanguage(204125),t,n.num_max))}},n.onBeforeClose=function(){this.timer&&(this.removeTimer(this.timer),this.timer=null)},n.onDestroy=function(){},t}(w));var L=function(){function e(e,i){this.head=void 0,this.headFrame=void 0,this.name=void 0,this.nameOut=void 0,this.nameBg=void 0,this.view=void 0,this.view=e,this.head=u.findChildComponent(i,"head/image",l),this.headFrame=u.findChildComponent(i,"head/headFrame",l),this.name=u.findChildComponent(i,"name/Label",o),this.nameBg=u.findChildComponent(i,"name",l),this.nameOut=u.findChildComponent(i,"name/Label",f)}return e.prototype.showItem=function(e){var i=e.info_list.kv,n=e.info_list.ks,r={};if(null!=i)for(var o,a=t(i);!(o=a()).done;){var s=o.value;r[s.k]=s.v}if(null!=n)for(var d,m=t(n);!(d=m()).done;){var h=d.value;r[h.k]=h.s}var l=r[T.ROLE_ATTR_HEAD_FRAME_ID];if(l>0){this.headFrame.node.active=!0;var f=configAvatar_frame.getDataByKey(l);this.view.loadIcon(this.headFrame,"icon_frame",f.icon)}else this.headFrame.node.active=!1;this.view.loadRemoteIcon(r[T.ROLE_ATTR_HEAD_URL],this.head),this.name.string=r[T.ROLE_ATTR_NAME];var u=0==e.figure.gender?1:e.figure.gender;this.view.loadIcon(this.nameBg,"marry_wedding","jh_bg_name0"+u),this.nameOut.color=2==e.figure.gender?new g("#296C85"):new g("#df2253")},e}();n._RF.pop()}}}));

