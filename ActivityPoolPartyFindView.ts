System.register("chunks:///_virtual/ActivityPoolPartyFindView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./BagModel.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,a,d,s,r,c,l,h,v,f,u,m,p,y,w,C;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,a=t.ScrollView,d=t.Label},function(t){s=t.ItemGrid},function(t){r=t.ListItem},function(t){c=t.default},function(t){l=t.default},function(t){h=t.default},null,function(t){v=t.ConfigGlobal},function(t){f=t.BagModel},function(t){u=t.default},function(t){m=t.default},function(t){p=t.ActivityType,y=t.ActivityEventDefine,w=t.ActivityState},function(t){C=t.BaseView}],execute:function(){n._RF.push({},"4f7cbkOFtdHVpvp8gF81ftB","ActivityPoolPartyFindView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).rewardScroll=void 0,i.taskList=void 0,i.name="ActivityPoolPartyFindView",i.url="ui/module/activityPoolParty/ActivityPoolPartyFindView",i}i(n,t);var d=n.prototype;return d.onInit=function(){var t=this,i=this.findChild("btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()}));var e=this.findChild("view/btn");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){IS(m).ShowSysTips(p.PoolPartyEndFind)})),this.rewardScroll=this.addUIList(this.findChildComponent("view/reward/reward/rewardScroll",a),g),this.taskList=this.addUIList(this.findChildComponent("view/taskList",a),I)},d.registerUpdateHandler=function(){this.addEvent(y.OnActivityFindUpdate,this.updateInfo,this)},d.onAfterOpen=function(){IS(u).send_24_52(p.PoolPartyEndFind),this.rewardScroll.datas=v.act_search_complete_reward.find((function(t){return t[0]==p.PoolPartyEndFind}))[1]},d.onBeforeClose=function(){},d.onDestroy=function(){},d.updateInfo=function(){for(var t,i=IS(m).GetActivityInfo(p.PoolPartyEndFind),n=[],o=configMoonfestival_search.getDatas(),a=e(o);!(t=a()).done;){var d=t.value;d.type==i.type&&d.group_id==i.roundCfg.group_id&&n.push(d)}var s=IS(m).getFindInfo(p.PoolPartyEndFind);n.sort((function(t,i){var e,n,o=null!=(e=s.list[t.id])?e:0,a=null!=(n=s.list[i.id])?n:0;return o==a?t.rank_num-i.rank_num:2==o?1:2==a||1==o?-1:1==a?1:void 0})),this.taskList.datas=n,this.rewardScroll.updateAll()},n}(C));var g=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i.received=void 0,i.mask=void 0,i.canGet=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.received=c.findChild(this.node,"received"),this.mask=c.findChild(this.node,"mask"),this.canGet=c.findChild(this.node,"canGet"),this.itemGridNode=c.findChild(this.node,"itemGrid"),this.itemGrid=new s(this.view,this.itemGridNode,(function(){t.canGet.active?IS(u).send_24_53(0,p.PoolPartyEndFind):IS(f).OpenItemTips(t.data[0],t.node)}))},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1]);var e=IS(m).getFindInfo(p.PoolPartyEndFind);this.received.active=1==e.total_reward,this.mask.active=1==e.total_reward,this.canGet.active=0==e.total_reward&&IS(m).isAllFind(p.PoolPartyEndFind)},e}(r),I=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtTitle=void 0,i.txtState=void 0,i.txtDesc=void 0,i.received=void 0,i.state1=void 0,i.state2=void 0,i.state3=void 0,i.mask=void 0,i.nothing=void 0,i.rewardScroll=void 0,i}i(n,t);var o=n.prototype;return o.onInit=function(){this.txtTitle=c.findChildComponent(this.node,"title/txtTitle",d),this.txtDesc=c.findChildComponent(this.node,"txtDesc",d),this.txtState=c.findChildComponent(this.node,"state3/Label",d),this.state1=c.findChild(this.node,"state1"),this.state2=c.findChild(this.node,"state2"),this.state3=c.findChild(this.node,"state3"),this.mask=c.findChild(this.node,"mask"),this.nothing=c.findChild(this.node,"nothing"),this.rewardScroll=this.view.addUIList(c.findChildComponent(this.node,"rewardScroll",a),S)},o.onRender=function(t,i){var n;this.txtTitle.string=GetLanguage(104405)+t.rank_num,this.txtDesc.string=t.clue;for(var o,a=[],d=e(t.clue_reward);!(o=d()).done;){var s=o.value;a.push({id:t.id,reward:s})}this.rewardScroll.datas=a;var r=null!=(n=IS(m).getFindInfo(p.PoolPartyEndFind).list[t.id])?n:0;if(this.mask.active=2==r,2==r)this.state1.active=!1,this.state2.active=!0,this.state3.active=!1,this.nothing.active=!1,this.rewardScroll.node.active=!0,this.txtDesc.node.active=!0;else if(0==r){this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,this.nothing.active=!0,this.rewardScroll.node.active=!1,this.txtDesc.node.active=!1;var c=IS(m).GetActivityInfo(p.PoolPartyEndFind).state_time[w.Open].start_time+24*(this.data.open_time-1)*3600,v=h.formatDate(h.ServerDate(1e3*c),"MM.dd");this.txtState.string=l.formatStrWithMirrorDeal(GetLanguage(201369),v)}else{this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,IS(m).getCurFind(p.PoolPartyEndFind)==t.id?(this.state1.active=!0,this.state2.active=!1,this.state3.active=!1,this.nothing.active=!1,this.rewardScroll.node.active=!0,this.txtDesc.node.active=!0):(this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,this.nothing.active=!0,this.rewardScroll.node.active=!1,this.txtDesc.node.active=!1,this.txtState.string=GetLanguage(201370))}},n}(r),S=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i.received=void 0,i.mask=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.received=c.findChild(this.node,"received"),this.mask=c.findChild(this.node,"mask"),this.itemGridNode=c.findChild(this.node,"itemGrid"),this.itemGrid=new s(this.view,this.itemGridNode)},n.onRender=function(t,i){var e;this.itemGrid.SetItemId(t.reward[0],t.reward[1]);var n=null!=(e=IS(m).getFindInfo(p.PoolPartyEndFind).list[t.id])?e:0;this.received.active=2==n,this.mask.active=2==n},e}(r);n._RF.pop()}}}));

