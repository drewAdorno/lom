System.register("chunks:///_virtual/MailModel.ts",["cc","./RedPointMgr.ts","./MailDefine.ts"],(function(i){"use strict";var l,t,s;return{setters:[function(i){l=i.cclegacy},function(i){t=i.RedPointMgr},function(i){s=i.MailDefine}],execute:function(){l._RF.push({},"fb2a8iZrklDQZZUdSXxXAw0","MailModel",void 0);i("MailModel",function(){var i=l.prototype;function l(){this.mail_list=void 0,this.new_mail_list={}}return i.clear=function(){},i.onLoginCallback=function(){},i.SetMailInfo=function(i){this.mail_list=i.mail_list,this.MailRedChange()},i.NewMail=function(i){null==this.mail_list&&(this.mail_list=[]),this.new_mail_list[i.mail_info.id]=i.mail_info,this.mail_list.push(i.mail_info),this.MailRedChange()},i.DelMail=function(i){if(null!=this.mail_list){for(var l={},t=0;t<i.delete_list.length;t++)null!=this.new_mail_list[i.delete_list[t]]&&(this.new_mail_list[i.delete_list[t]]=null),l[i.delete_list[t]]=i.delete_list[t];for(var s=[],a=0;a<this.mail_list.length;a++)null==l[this.mail_list[a].id]&&s.push(this.mail_list[a]);this.mail_list=s,this.MailRedChange()}},i.ReadMail=function(i){null!=this.new_mail_list[i.mail_id]&&(this.new_mail_list[i.mail_id]=null);for(var l=0;l<this.mail_list.length;l++)if(this.mail_list[l].id==i.mail_id){this.mail_list[l].is_read=1;break}this.MailRedChange()},i.AttachMail=function(i){for(var l={},t=0;t<i.claim_list.length;t++)l[i.claim_list[t]]=i.claim_list[t],null!=this.new_mail_list[i.claim_list[t]]&&(this.new_mail_list[i.claim_list[t]]=null);for(var s=0;s<this.mail_list.length;s++)null!=l[this.mail_list[s].id]&&(this.mail_list[s].is_read=1,this.mail_list[s].is_attach=0);null!=i.goods_list&&i.goods_list.length>0&&uiMgr.openView("GoodsGetView",i.goods_list),this.MailRedChange()},i.isHaveAttach=function(){if(null==this.mail_list)return!1;for(var i=0;i<this.mail_list.length;i++)if(1==this.mail_list[i].is_attach)return!0;return!1},i.IsNewMail=function(i){return null!=this.new_mail_list[i]},i.GetMailRed=function(){if(null==this.mail_list||this.mail_list.length<=0)return IS(t).changeValue("mail_red",0),0;for(var i=0,l=0;l<this.mail_list.length;l++)1!=this.mail_list[l].is_attach&&0!=this.mail_list[l].is_read||i++;return IS(t).changeValue("mail_red",i),i},i.MailRedChange=function(){this.GetMailRed(),normalEvent.emit(s.MailRedChange)},i.GetMailList=function(i){return this.mail_list&&this.mail_list.length>1&&this.mail_list.sort((function(i,l){return i.is_read!=l.is_read?i.is_read-l.is_read:l.send_time-i.send_time})),this.mail_list},l}());l._RF.pop()}}}));

