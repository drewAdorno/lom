System.register("chunks:///_virtual/MainView_SystemTop.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./PlatformUtil.ts","./StorageUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./BaseSubView.ts","./ConfigGlobal.ts","./MulLanguageUtil.ts","./AchievementDefine.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ReturnDataCache.ts","./ReturnDefine.ts","./RouletteDefine.ts","./BagDefine.ts","./BagModel.ts","./BattlePassControl.ts","./BattlePassDataCache.ts","./BattlePassDefine.ts","./ChapterDataCache.ts","./ChatDataCache.ts","./ChatDefine.ts","./CommonDefine.ts","./GameSetting.ts","./MessageView.ts","./CrossWarControl.ts","./CrossWarDatacache.ts","./CrossWarSceneDataCache.ts","./FriendDefine.ts","./GameClubDefine.ts","./GameClubModel.ts","./LoginDataCache.ts","./MailDefine.ts","./MarryDataCache.ts","./MarryDefine.ts","./outlineDefine.ts","./outlineModel.ts","./PayDataCache.ts","./PayDefine.ts","./TitleDefine.ts","./PrivilegeDataCache.ts","./PrivilegeDefine.ts","./PvpDataCache.ts","./PvpDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./NativeToJs.ts","./SdkControl.ts","./SdkDataCache.ts","./SevenLoginDefine.ts","./TaskDataCache.ts","./MainViewModel.ts","./UIDefine.ts"],(function(t){"use strict";var e,i,n,h,o,a,s,d,c,r,f,l,u,v,R,p,m,C,g,I,b,S,w,T,P,_,y,B,k,E,L,F,D,O,U,M,A,N,G,V,x,W,K,H,j,Y,z,X,q,J,Q,Z,$,tt,et,it,nt,ht,ot,at,st,dt,ct,rt,ft,lt,ut,vt,Rt,pt,mt,Ct,gt,It,bt;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,h=t.Vec2,o=t.Sprite,a=t.Label,s=t.LabelOutline,d=t.Vec3,c=t.instantiate,r=t.isValid,f=t.Color},function(t){l=t.BYTEDANCE},function(t){u=t.RedPointType},function(t){v=t.RedPointMgr},function(t){R=t.default},function(t){p=t.PlatformUtil,m=t.PlatformAuthSetting},function(t){C=t.default},function(t){g=t.default},function(t){I=t.default},null,function(t){b=t.BaseSubView},function(t){S=t.ConfigGlobal},function(t){w=t.default},function(t){T=t.AchievementEventDefine},function(t){P=t.default},function(t){_=t.ActivityEventDefine},function(t){y=t.ReturnDataCache},function(t){B=t.ReturnEventDefine},function(t){k=t.RouletteEventDefine},function(t){E=t.BagEventDefine},function(t){L=t.BagModel},function(t){F=t.default},function(t){D=t.BattlePassDataCache},function(t){O=t.BattlePassDefine},function(t){U=t.ChapterDataCache},function(t){M=t.ChatDataCache},function(t){A=t.ChatDefine,N=t.ChatEventDefine},function(t){G=t.CommonEventDefine},function(t){V=t.default,x=t.GameSettingKey},function(t){W=t.default},function(t){K=t.default},function(t){H=t.CrossWarDataCache},function(t){j=t.CrossWarSceneDataCache},function(t){Y=t.FriendDefine},function(t){z=t.GameClubDefine},function(t){X=t.GameClubModel},function(t){q=t.LoginDataCache},function(t){J=t.MailDefine},function(t){Q=t.default},function(t){Z=t.MarryEventDefine},function(t){$=t.outlineDefine},function(t){tt=t.outlineModel},function(t){et=t.default},function(t){it=t.PayEventDefine},function(t){nt=t.TitleEventDefine},function(t){ht=t.PrivilegeDataCache},function(t){ot=t.PrivilegeEventDefine,at=t.FundEventDefine},function(t){st=t.PvpDataCache},function(t){dt=t.PvpEventDefine},function(t){ct=t.default},function(t){rt=t.RoleDataCache},function(t){ft=t.ClientData,lt=t.RoleEventDefine,ut=t.PlayerAttr,vt=t.RolePreviewState},function(t){Rt=t.NativeToJs},function(t){pt=t.default},function(t){mt=t.SdkDataCache},function(t){Ct=t.SevenLoginDefine},function(t){gt=t.TaskDataCache},function(t){It=t.MainViewModel},function(t){bt=t.OpenFunction}],execute:function(){i._RF.push({},"9db8eAPMDxIRI03XKybYb6E","MainView_SystemTop",void 0);var St=S.mainscene_left_iconlist_show,wt=S.mainscene_right_iconlist_show,Tt=t("iconIdList",[1,2,15]),Pt=(t("default",function(t){function i(){var e;return(e=t.call(this)||this).btnOfflineReward=void 0,e.btnOfflineRewardState1=void 0,e.btnOfflineRewardState2=void 0,e.btnOfflineRewardState3=void 0,e.btnOfflineRewardState4=void 0,e.vipBtn=void 0,e.btnCrossWar=void 0,e.btnAchievement=void 0,e.rightRoot=void 0,e.btnPreview=void 0,e.btnRecharge=void 0,e.imgRecharge=void 0,e.txtRecharge=void 0,e.btnRechargeTips=void 0,e.btnGameClub=void 0,e.btnRechargeGift=void 0,e.btnPush=void 0,e.btnReturn=void 0,e.btnReturnTime=void 0,e.btnReturnTimer=void 0,e.btnByteDance=void 0,e.btnPushTips=void 0,e.txtPush=void 0,e.pushTips=void 0,e.rechargeTips=void 0,e.previewIcon=void 0,e.previewName=void 0,e.previewCond=void 0,e.wechatUserInfoButton=void 0,e.btnMenu=void 0,e.btnExample=void 0,e.offline_effect=void 0,e.pushLeftTime=0,e.rechargeLeftTime=0,e.time=0,e.curPushId=0,e.pushTimer=void 0,e.rechargeTimer=void 0,e.defaultIconNum=2,e.iconList={},e.iconShowList={},e.deltaTime=0,e.btnFoldLeft=void 0,e.NodeBgFoldLeft=void 0,e.btnFoldRight=void 0,e.NodeBgFoldRight=void 0,e.btnOpenActivity=void 0,e.btnMarry=void 0,e.marryBtnName=void 0,e.marryBtnOut=void 0,e.marryTime=void 0,e.name="MainView_SystemTop",e}e(i,t);var g=i.prototype;return g.onInit=function(){var t=this;this.btnMenu=this.findChild("btnMenu"),this.btnMenu.active=!1,this.btnOfflineReward=R.findChild(this.parentView.node,"subRoots/btnOfflineReward"),this.btnOfflineRewardState1=R.findChild(this.parentView.node,"subRoots/btnOfflineReward/state1"),this.btnOfflineRewardState2=R.findChild(this.parentView.node,"subRoots/btnOfflineReward/state2"),this.btnOfflineRewardState3=R.findChild(this.parentView.node,"subRoots/btnOfflineReward/state3"),this.btnOfflineRewardState4=R.findChild(this.parentView.node,"subRoots/btnOfflineReward/state4"),this.addComponentCallbackListener(this.btnOfflineReward,n.EventType.CLICK,(function(){t.onOfflineRewardClick()})),this.btnGameClub=this.findChild("btnGameClub"),this.btnGameClub.active=!1,this.addRedPoint("GameClub_Redpoint",this.btnGameClub,new h(22,22)),this.addComponentCallbackListener(this.btnGameClub,n.EventType.CLICK,(function(){uiMgr.openView("GameClubView")})),this.checkShowBattlePass();var e=this.findChild("btnRoot/btnBattlePass");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.onOpenBattlePassView()}));var i=this.findChild("btnRoot/btnShare");i.active=!1,this.addRedPoint("GameShare_Redpoint",i,new h(22,22)),this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){IS(X).UpdateGameSettingCache(6);var t=IS(X).GetxcxOpenTag();IS(pt).openOtherXcx(t,IS(q).plat,IS(rt).GetServerId(),IS(rt).GetRoleId())}));var d=this.findChild("btnRoot/btnFaceBook"),c=this.findChild("btnRoot/btnFaceBook/bg1"),r=this.findChildComponent("btnRoot/btnFaceBook/bg",o);this.loadIcon(r,"main","zjm_ICON_sq"),c.active="ru"==w.GetGurLanuage(),this.addComponentCallbackListener(d,n.EventType.CLICK,(function(){uiMgr.openView("WelfareCenterView")}));var f=this.findChild("btnGMShow");this.addComponentCallbackListener(f,n.EventType.CLICK,(function(){1==IS(q).isWhiteIp&&netManager.send("system.system_open_gm_c2s",{})}));var l=this.findChild("btnRoot/btnPvp"),v=this.findChildComponent("btnRoot/btnPvp/bg",o);this.loadIcon(v,"main","zjm_ICON_jjc"),this.addComponentCallbackListener(l,n.EventType.CLICK,(function(){t.CheckNeedGetUserInfo()?t.GetUserInfo():uiMgr.openView("PvpMainView")}));var p=this.findChild("btnRoot/btnRankingRush");p.active=!1;var m=this.findChildComponent("btnRoot/btnRankingRush/bg",o);this.loadIcon(m,"main","zjm_ICON_cbhd"),this.addRedPoint("MainIcon/4",p,new h(20,20),u.Dot),IS(P).UpdateMainRedByGroup(4),this.addComponentCallbackListener(p,n.EventType.CLICK,(function(){uiMgr.openView("RankingRushView")})),this.btnByteDance=this.findChild("btnByteDance"),this.addComponentCallbackListener(this.btnByteDance,n.EventType.CLICK,(function(){uiMgr.openView("ByteDanceView")})),this.btnAchievement=this.findChild("btnRoot/btnAcheievement");var C=this.findChildComponent("btnRoot/btnAcheievement/bg",o);this.loadIcon(C,"main","zjm_ICON_renwutujian"),this.addComponentCallbackListener(this.btnAchievement,n.EventType.CLICK,(function(){uiMgr.openView("TaskAchievementView")})),this.InitPreviewInfo(),this.rightRoot=this.findChild("btnRightRoot"),this.imgRecharge=this.findChildComponent("btnRightRoot/btnRecharge/icon",o),this.txtRecharge=this.findChildComponent("btnRightRoot/btnRecharge/time",a),this.btnRecharge=this.findChild("btnRightRoot/btnRecharge"),this.addComponentCallbackListener(this.btnRecharge,n.EventType.CLICK,(function(){uiMgr.openView("PayRechargeRewardView")})),this.rechargeTips=this.findChildComponent("btnRightRoot/btnRecharge/tips/txtDesc",a),this.btnRechargeTips=this.findChild("btnRightRoot/btnRecharge/tips"),this.addComponentCallbackListener(this.btnRechargeTips,n.EventType.CLICK,(function(){null!=t.rechargeTimer&&t.removeTimer(t.rechargeTimer),t.btnRechargeTips.active=!1})),this.txtPush=this.findChildComponent("btnRightRoot/btnPush/time",a),this.btnPush=this.findChild("btnRightRoot/btnPush");var g=this.findChildComponent("btnRightRoot/btnPush/icon",o);this.loadIcon(g,"main","zjm_ICON_xslb"),this.addComponentCallbackListener(this.btnPush,n.EventType.CLICK,(function(){uiMgr.openView("PayPushView")})),this.pushTips=this.findChildComponent("btnRightRoot/btnPush/tips/txtDesc",a),this.btnPushTips=this.findChild("btnRightRoot/btnPush/tips"),this.addComponentCallbackListener(this.btnPushTips,n.EventType.CLICK,(function(){null!=t.pushTimer&&t.removeTimer(t.pushTimer),t.btnPushTips.active=!1})),this.btnExample=this.findChild("btnRightRoot/btnExample"),this.btnExample.active=!1,this.btnRechargeGift=this.findChild("btnRoot/btnRechargeGift");var b=this.findChildComponent("btnRoot/btnRechargeGift/bg",o);this.loadIcon(b,"main","zjm_ICON_czhl"),this.addRedPoint("recharge_gift",this.btnRechargeGift,new h(22,22)),this.addComponentCallbackListener(this.btnRechargeGift,n.EventType.CLICK,(function(){uiMgr.openView("RechargeGiftView")})),this.vipBtn=R.findChild(this.parentView.node,"subRoots/vipBtn"),this.addComponentCallbackListener(this.vipBtn,n.EventType.CLICK,(function(){IS(M).GetVipGmRed()>0?uiMgr.openView("ChatView",A.ViewType.Private):uiMgr.openView("ChatView",A.ViewType.Private,null,null,2),IS(M).ClickVipRed()})),this.addRedPoint("vip_btnRed",this.vipBtn,new h(22,22)),this.btnCrossWar=this.findChild("btnRoot/btnCrossWar");var S=this.findChildComponent("btnRoot/btnCrossWar/bg",o);this.loadIcon(S,"main","zjm_ICON_weimianzhanzheng"),this.btnCrossWar.active=!1,this.addRedPoint("MainIcon/10",this.btnCrossWar,new h(20,20),u.Dot),IS(P).UpdateMainRedByGroup(10),this.addComponentCallbackListener(this.btnCrossWar,n.EventType.CLICK,(function(){0==IS(H).serv_id||IS(H).serv_id==IS(rt).GetServerId()?uiMgr.openView("CrossWarView"):0==IS(H).scene_base?uiMgr.openView("CrossWarMapOverView"):IS(j).transferCdTime<I.serverTime?null==IS(H).pos?(uiMgr.openView("CrosswarMapSceneView"),IS(K).reqCrossWarSceneTransfer(IS(H).scene_base,{x:0,y:0})):(uiMgr.openView("CrosswarMapSceneView",2),IS(K).reqCrossWarSceneEnter(2,{x:Math.floor(IS(H).pos.x/8),y:Math.floor(IS(H).pos.y/8)})):W.showFlyTip(GetLanguage(201409))})),this.btnFoldLeft=this.findChild("btnRoot/btnFold"),this.addRedPoint("mainview_btnFoldLeft",this.btnFoldLeft,new h(22,22)),this.NodeBgFoldLeft=this.findChild("btnRoot/btnFold/imgFold"),this.btnFoldLeft.active=!1,this.addComponentCallbackListener(this.btnFoldLeft,n.EventType.CLICK,(function(){IS(It).setLeftBtnFold(IS(It).checkLeftBtnFold()?0:1),t.checkShowBtn(),t.updateFoldLeftRed(),t.initIcon()})),this.btnFoldRight=this.findChild("btnFoldRight"),this.addRedPoint("mainview_btnFoldRight",this.btnFoldRight,new h(22,22)),this.NodeBgFoldRight=this.findChild("btnFoldRight/imgFold"),this.addComponentCallbackListener(this.btnFoldRight,n.EventType.CLICK,(function(){IS(It).setRightBtnFold(IS(It).checkRightBtnFold()?0:1),t.checkShowBtn(),t.updateFoldRightRed(),t.initIcon()})),this.btnOpenActivity=this.findChild("btnRightRoot/btnOpenActivity");var T=this.findChildComponent("btnRightRoot/btnOpenActivity/bg",o);this.loadIcon(T,"icon_pre","zjm_icon_kcsq"),this.addRedPoint("mainview_btnOpenActivity",this.btnOpenActivity,new h(22,22)),this.addComponentCallbackListener(this.btnOpenActivity,n.EventType.CLICK,(function(){uiMgr.openView("ActivityOpenListView")})),this.btnMarry=this.findChild("btnRoot/btnMarry");var _=this.findChildComponent("btnRoot/btnMarry/bg",o);this.loadIcon(_,"main","zjm_ICON_jiehun"),this.marryBtnName=this.findChildComponent("btnRoot/btnMarry/name",a),this.marryBtnOut=this.findChildComponent("btnRoot/btnMarry/name",s),this.addComponentCallbackListener(this.btnMarry,n.EventType.CLICK,(function(){uiMgr.openView("MarryWeddingInfoView")})),this.btnReturn=this.findChild("btnRightRoot/returnBtn"),this.addComponentCallbackListener(this.btnReturn,n.EventType.CLICK,(function(){var t=IS(y).GetReturnInfo();t&&1==t.return_type?uiMgr.openView("ReturnActivityView"):t&&2==t.return_type&&uiMgr.openView("ReturnNewTaskTabView")})),this.btnReturnTime=this.findChildComponent("btnRightRoot/returnBtn/time",a),this.addRedPoint("return_red",this.btnReturn,new h(22,22))},g.checkShowGameClub=function(){var t=this.findChild("btnGameClub");GlobalDefine.IS_APP&&(t.active=!1)},g.checkShowShare=function(t){return!1},g.checkShowSevenLogin=function(t){},g.checkShowFaceBook=function(t){var e=this.findChild("btnRoot/btnFaceBook");return this.needHideByFold("btnFaceBook")?(e.active=!1,!!t):(e.active=!Rt.IsPreviewServer(),!0)},g.CheckNeedGetUserInfo=function(){var t=IS(rt).getClientDataByNum(ft.WXUSERINFO,"HasGetUserInfo"),e=IS(rt).GetRoleName();return!(0!=t||!e.includes(GetLanguage(200449)))},g.InitPreviewInfo=function(){this.btnPreview=this.findChild("btnRightRoot/btnPreview"),this.addComponentCallbackListener(this.btnPreview,n.EventType.CLICK,(function(){uiMgr.openView("PreviewView")})),this.previewCond=this.findChildComponent("btnRightRoot/btnPreview/des",a),this.previewIcon=this.findChildComponent("btnRightRoot/btnPreview/icon",o),this.previewName=this.findChildComponent("btnRightRoot/btnPreview/name",a)},g.registerUpdateHandler=function(){this.addEvent($.OutLineInfoBack,this.checkShowOffLineBtn,this),this.addEvent(z.ByteDanceInfoBack,this.checkShowDanceBtn,this),this.addEvent(O.BATTLE_PASS_INFO_UPDATE,this.checkShowBattlePass,this),this.addEvent(J.MailRedChange,this.UpdateMenuRed,this),this.addEvent(Y.FriendRedChange,this.UpdateMenuRed,this),this.addEvent(T.AchievementRedUpdate,this.UpdateMenuRed,this),this.addEvent(lt.ROLE_Menu_Red,this.OnRoleMenuRed,this),this.addEvent(k.ROULETTE_INFO_UPDATE,this.UpdateMenuRed,this),this.addEvent(lt.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(lt.ROLE_PREVIEW_UPDATE,this.onRolePreviewUpdate,this),this.addEvent(E.GOODS_INFO_UPDATE,this.onGoodsUpdate,this),this.addEvent(it.PAY_INFO_UPDATE,this.onPayInfoUpdate,this),this.addEvent(it.PAY_REWARD_UPDATE,this.onPayInfoUpdate,this),this.addEvent(it.PAY_RECHARGE_SUCCESS,this.onPayInfoUpdate,this),this.addEvent(Ct.SEVEN_LOGIN_INFO_UPDATE,this.UpdateMenuRed,this),this.addEvent(Ct.SEVEN_LOGIN_REWARDLIST_UPDATE,this.UpdateMenuRed,this),this.addEvent(G.MAIN_ADD_ICON,this.onAddIcon,this),this.addEvent(G.MAIN_REMOVE_ICON,this.onRemoveIcon,this),this.addEvent(G.MAIN_SET_ICON,this.onSetIcon,this),this.addEvent(lt.ROLE_SKIN_LIST,this.UpdateMenuRed,this),this.addEvent(lt.ROLE_SKIN_CHANGE,this.UpdateMenuRed,this),this.addEvent(ot.PRIVILEGE_CARD_UPDATE,this.checkRechargeGiftRedPoint,this),this.addEvent(ot.PRIVILEGE_CARD_FETCH,this.checkRechargeGiftRedPoint,this),this.addEvent(lt.ROLE_INFO_UPDATE,this.checkRechargeGiftRedPoint,this),this.addEvent(E.GOODS_BOX_UPDATE,this.checkRechargeGiftRedPoint,this),this.addEvent(at.FUND_UPDATE_INFO,this.checkRechargeGiftRedPoint,this),this.addEvent(it.PAY_REWARD_UPDATE,this.checkRechargeGiftRedPoint,this),this.addEvent(_.OnActivityRebateBox,this.checkRechargeGiftRedPoint,this),this.addEvent(lt.HIDE_LIST_UPDATE,this.onHideListUpdate,this),this.addEvent(nt.Title_INFO_UPDATE,this.UpdateMenuRed,this),this.addEvent(nt.Frame_INFO_UPDATE,this.UpdateMenuRed,this),this.addEvent(nt.Bubble_INFO_UPDATE,this.UpdateMenuRed,this),this.addEvent(N.UpdateVipBtnShowStateChange,this.UpdateVipBtn,this),this.addEvent(dt.CROSS_PVP_INFO_UPDATE,this.checkCrossPvpTips,this),this.addEvent(lt.ROLE_INFO_INIT,this.onRoleInfoInit,this),this.addEvent(G.UPDATE_FOLD_ICON_RED,this.updateFoldRightRed),this.addEvent(Ct.SEVEN_LOGIN_INFO_UPDATE,this.checkShowSevenLogin,this),this.addEvent(Ct.SEVEN_LOGIN_REWARDLIST_UPDATE,this.checkShowSevenLogin,this),this.addEvent(Z.MARRY_PARTY_INFO,this.UpdateMarry),this.addEvent(G.MAIN_ADD_ICON,this.checkShowOpenActivityBtn,this),this.addEvent(G.MAIN_REMOVE_ICON,this.checkShowOpenActivityBtn,this),this.addEvent(G.MAIN_SET_ICON,this.checkShowOpenActivityBtn,this),this.addEvent(G.UPDATE_FOLD_ICON_RED,this.updateOpenActivityRed,this),this.addEvent(B.UpdateReturnInfo,this.UpdateBtnReturn)},g.onAfterOpen=function(){this.checkShowBtn(),this.UpdateMenuRed(),this.UpdateAcievementBtn(),this.initIcon(),this.updateFoldLeftRed(),this.updateFoldRightRed(),this.updateOpenActivityRed()},g.UpdateMenuRed=function(){},g.checkShowBtn=function(){this.checkShowOffLineBtn(),this.checkShowBattlePass(),this.checkShowDailyTaskBtn(),this.checkShowPvpBtn(),this.checkShowAcievementBtn(),this.checkShowBtnPreview(),this.onPayInfoUpdate(),this.checkShowGameClub(),this.checkShowShare(),this.checkShowSevenLogin(),this.checkShowFaceBook(),this.checkShowDanceBtn(),this.checkShowRechargeGiftBtn(),this.UpdateVipBtn(),this.checkShowBtnLeftFold(),this.checkShowBtnRightFold(),this.addTimer(1,1,this.checkGetUserInfoBtn,this),this.checkFoldBgShow(),this.checkShowRankingRushBtn(),this.checkShowOpenActivityBtn(),this.UpdateMarry(),this.UpdateBtnReturn()},g.checkShowOpenActivityBtn=function(){for(var t=IS(It).getIconInfoList(),e=0;e<Tt.length;e++){if(null!=t[Tt[e]])return void(this.btnOpenActivity.active=!0)}this.btnOpenActivity.active=!1},g.updateOpenActivityRed=function(){for(var t=0,e=0;e<Tt.length;e++){var i=Tt[e];t+=IS(v).getRedNum("MainIcon/"+i)}IS(v).changeValue("mainview_btnOpenActivity",t)},g.checkFoldBgShow=function(){this.NodeBgFoldLeft.eulerAngles=IS(It).checkLeftBtnFold()?new d(180,0,180):new d(0,0,0),this.NodeBgFoldRight.eulerAngles=IS(It).checkRightBtnFold()?new d(0,0,0):new d(0,0,180)},g.initIcon=function(){var t=IS(It).getIconInfoList();for(var e in t)if(t.hasOwnProperty(e)){if(4==Number(e)){this.checkShowRankingRushBtn(!0);continue}if(10==Number(e)){this.checkShowCrossWarBtn(!0);continue}var i=t[e];this.onAddIcon(i.iconId,!1)}this.updateIconOrder()},g.onBeforeClose=function(){},g.onDestroy=function(){},g.needHideByFold=function(t,e){if(e&&(1==configMainicon.getDataByKey(e).right_button&&IS(It).checkRightBtnFold()))return!0;if(t){if(St.includes(t)&&IS(It).checkLeftBtnFold())return!0;if(wt.includes(t)&&IS(It).checkRightBtnFold())return!0}return!1},g.updateFoldLeftRed=function(){if(IS(It).checkLeftBtnFold()){var t=0;this.needHideByFold("btnPvp")&&IS(rt).CheckFuncOpen(bt.FUNC_PVP)&&(t+=IS(L).getGoodsCountByGoodsGtid(1006)>0?1:0),IS(v).changeValue("mainview_btnFoldLeft",t)}else IS(v).changeValue("mainview_btnFoldLeft",0)},g.updateFoldRightRed=function(){if(IS(It).checkRightBtnFold()){var t=0;if(this.needHideByFold("btnShare")&&this.checkShowShare(!0)&&(t+=IS(X).CheckShowGameClubRed(6)),this.needHideByFold("btnRechargeGift")){var e=IS(D).getPassInfoList(),i=!1;for(var n in e)if(e.hasOwnProperty(n)){var h,o,a,s,d=e[n].id;if(0!=(1==d?null!=(h=null==(o=configBattlepass.getDataByKey(d))?void 0:o.view)?h:0:null!=(a=null==(s=configWartoken.getDataByKey(d))?void 0:s.view)?a:0)){i=!0;break}}if(IS(mt).showrechage&&(IS(rt).CheckFuncOpen(bt.FUNC_RECHARGE_GIFT)||IS(rt).CheckFuncOpen(bt.FUNC_BATTLEPASS)&&i)){t+=IS(ht).checkAnyPrivilegeCardCanFetch()?1:0,t=(t+=ht.checkFund()?1:0)+F.checkMainRewardRP()+F.checkMainAddRewardRP()+F.checkMainTaskRP();var c=IS(et).GetPayGiftInfo(10604);t+=c&&2==c.rewardState?0:1}}this.needHideByFold("btnPreview")&&(t+=IS(rt).GetRolePreviewRed());for(var r=configMainicon.getDatas(),f=0;f<r.length;f++){if(1==r[f].right_button)t+=IS(v).getRedNum("MainIcon/"+r[f].id)}IS(v).changeValue("mainview_btnFoldRight",t)}else IS(v).changeValue("mainview_btnFoldRight",0)},g.onUpdate=function(t){if(this.deltaTime=this.deltaTime+t,this.deltaTime>=1)for(var e in this.deltaTime=0,this.iconShowList){if(this.iconShowList.hasOwnProperty(e))this.iconShowList[e].onUpdate()}if(this.time=this.time+t,this.time>1){if(this.time=0,this.pushLeftTime>=0)if(this.pushLeftTime=this.pushLeftTime-1,this.pushLeftTime>0)this.txtPush.string=I.formatTimeStringForSecondSimply(this.pushLeftTime);else{this.txtPush.node.active=!1;var i=IS(et).GetPayGiftInfo(this.curPushId);null!=i&&IS(et).DeleteGiftInfo(i)}if(this.rechargeLeftTime>=0)if(this.rechargeLeftTime=this.rechargeLeftTime-1,this.rechargeLeftTime>0){var n,h=I.getTimeData(this.rechargeLeftTime);h[0],h[1],h[2],h[3];n=I.formatTimeStringForSecondSimply(this.rechargeLeftTime),this.txtRecharge.string=n}else this.txtRecharge.node.active=!1,this.onPayInfoUpdate()}},g.onAddIcon=function(t,e){if(void 0===e&&(e=!0),4!=Number(t))if(10!=Number(t)){var i=configMainicon.getDataByKey(t);if(i)for(var n in this.addIcon(i),e&&this.updateIconOrder(),this.iconList)if(this.iconList.hasOwnProperty(n))this.iconList[n]}else this.checkShowCrossWarBtn(!0);else this.checkShowRankingRushBtn(!0)},g.onRemoveIcon=function(t){4!=Number(t)?10!=Number(t)?this.removeIcon(t):this.checkShowCrossWarBtn(!1):this.checkShowRankingRushBtn(!1)},g.onSetIcon=function(t){4!=Number(t)?10!=Number(t)?this.iconList[t]&&this.iconList[t].show():this.checkShowCrossWarBtn(!0):this.checkShowRankingRushBtn(!0)},g.updateIconOrder=function(){var t=[];for(var e in this.iconList)if(this.iconList.hasOwnProperty(e)){var i=this.iconList[e];t.push(i)}t.sort((function(t,e){var i=t.getIconCfg(),n=e.getIconCfg();return i.order-n.order}));for(var n=0;n<t.length;n++)t[n].updateOrder(n+this.defaultIconNum)},g.addIcon=function(t){var e=t.id,i=this.iconList[e];if(null==i){i=new Pt;var n=c(this.btnExample);n.name="icon_"+e,n.parent=this.rightRoot,i.init(this,n,e),t.effect,this.iconList[e]=i}null!=this.iconShowList[e]||this.needHideByFold(null,e)||1==t.hide_mainview||(i.show(),this.iconShowList[e]=i,IS(It).updateIconRedDot(e)),null!=this.iconShowList[e]&&this.needHideByFold(null,e)&&this.removeIcon(e)},g.removeIcon=function(t){var e=this.iconShowList[t];null!=e&&(e.hide(),delete this.iconShowList[t])},g.onMenuClick=function(){uiMgr.openView("MenuView")},g.checkShowOffLineBtn=function(){var t=IS(tt).GetShowTime(),e=S.online_reward_stagetime;this.btnOfflineReward.active=!this.needHideByFold("btnOfflineReward")&&(!IS(U).hasFetchPop||t>=e[0]),this.btnOfflineRewardState1.active=!1,this.btnOfflineRewardState2.active=!1,this.btnOfflineRewardState3.active=!1,this.btnOfflineRewardState4.active=!1,t<e[0]?this.btnOfflineRewardState1.active=!0:t>=e[0]&&t<e[1]?this.btnOfflineRewardState2.active=!0:t>=e[1]&&t<e[2]?this.btnOfflineRewardState3.active=!0:this.btnOfflineRewardState4.active=!0},g.onOfflineRewardClick=function(){uiMgr.openView("outlinePopView")},g.onDailyTaskClick=function(){uiMgr.openView("TaskInfoView")},g.checkShowBattlePass=function(){this.checkShowRechargeGiftBtn(),this.findChild("btnRoot/btnBattlePass").active=!1},g.checkShowDailyTaskBtn=function(){},g.onRolePreviewUpdate=function(){this.checkShowBtnPreview(),this.updateFoldRightRed()},g.onGoodsUpdate=function(t,e){1006==e&&(this.checkPVPRedPoint(),this.updateFoldLeftRed()),1014==e&&this.UpdateMenuRed()},g.checkPVPRedPoint=function(){var t=this.findChild("btnRoot/btnPvp");this.addRedPoint("MainView/btnPvp",t,new h(22,22),u.NumDot);var e=IS(L).getGoodsCountByGoodsGtid(1006);0!=e?IS(v).changeValue("MainView/btnPvp",e):IS(v).changeValue("MainView/btnPvp",0)},g.checkCrossPvpTips=function(){var t=IS(st).CrossPvpInfo;this.findChild("btnRoot/btnPvp/imgBattle").active=!1,this.findChild("btnRoot/btnPvp/imgGrading").active=!1,this.findChild("btnRoot/btnPvp/imgSign").active=!1;var e=IS(rt).CheckFuncOpen(bt.FUNC_CROSS_PVP);if(t&&e){var i=!1,n=C.get("CROSS_PVP_REMIND");if(n)I.formatDate(new Date(1e3*n),"MM/dd")!=I.formatDate(new Date(1e3*I.serverTime),"MM/dd")&&(i=!0);else i=!0;0==t.type&&0==t.is_sign||1==t.type&&i||t.type}},g.checkRechargeGiftRedPoint=function(){var t=0;t+=IS(ht).checkAnyPrivilegeCardCanFetch()?1:0,t=(t+=ht.checkFund()?1:0)+F.checkMainRewardRP()+F.checkMainAddRewardRP()+F.checkMainTaskRP();var e=IS(et).GetPayGiftInfo(10604);t+=e&&2==e.rewardState?0:1,t+=IS(ht).checkActivityRed()?1:0,IS(v).changeValue("recharge_gift",t),this.checkShowShare(),this.checkShowDanceBtn(),this.updateFoldLeftRed(),this.updateFoldRightRed()},g.onHideListUpdate=function(){this.checkShowShare(),this.updateFoldLeftRed(),this.updateFoldRightRed()},g.GetUserInfo=function(){p.getUserInfo((function(t,e,i){if(1==i){var n=new Array;n.push({k:ut.ROLE_ATTR_HEAD_URL,s:t}),n.push({k:ut.ROLE_ATTR_NAME,s:e});var h={ks:n};IS(ct).send_3_22(h),IS(ct).send_3_29(ft.WXUSERINFO,1,"HasGetUserInfo",1)}uiMgr.openView("PvpMainView")}))},g.checkGetUserInfoBtn=function(){var t=this,e=this.findChild("btnRoot/btnPvp"),i=IS(rt).getClientDataByNum(ft.WXUSERINFO,"HasGetUserInfo");if(e.active&&0==i&&0==p.hasAuthSeting(m.UserInfo)&&null==this.wechatUserInfoButton){var n=e.worldPosition.x-20,h=R.TransCocosPosToScreenPosY(e.worldPosition.y)-20;this.wechatUserInfoButton=p.createUserInfoButton(n,h,116,116),this.wechatUserInfoButton.onTap((function(e){var i,n;(IS(ct).send_3_29(ft.WXUSERINFO,1,"HasGetUserInfo",1),null!=e.encryptedData)?(p.setAuthSeting(m.UserInfo,!0),t.GetUserInfo(),null==(i=t.wechatUserInfoButton)||i.destroy()):(null==(n=t.wechatUserInfoButton)||n.destroy(),uiMgr.openView("PvpMainView"));t.wechatUserInfoButton=null}))}},g.checkShowDanceBtn=function(t){var e=this.findChild("btnByteDance");if(IS(rt).isHaveHideByType(5))e.active=!1;else{var i=IS(rt).CheckFuncOpen(bt.FUNC_DOUYIN_ENTRANCE_REWARD),n=t||IS(V).Get(x.IS_GET_DOUYIN_GUIDE_AWARD);i=i&&0==n,e.active=i&&l}},g.checkShowPvpBtn=function(){this.findChild("btnRoot/btnPvp").active=IS(rt).CheckFuncOpen(bt.FUNC_PVP)&&!this.needHideByFold("btnPvp"),this.checkPVPRedPoint(),this.checkCrossPvpTips()},g.checkShowRankingRushBtn=function(t){this.findChild("btnRoot/btnRankingRush").active=IS(rt).CheckFuncOpen(bt.FUNC_LIMITED_TIME_RANK)},g.checkShowCrossWarBtn=function(t){this.btnCrossWar.active=t&&!this.needHideByFold("btnCrossWar")},g.checkShowAcievementBtn=function(){var t=IS(rt).CheckFuncOpen(bt.FUNC_ILLSTRATED_BOOK);t=(t=t&&IS(rt).CheckFuncOpen(bt.FUNC_DAILY_TASK))&&!this.needHideByFold("btnAcheievement"),this.btnAchievement.active=t},g.checkShowRechargeGiftBtn=function(){if(r(this.btnRechargeGift)){var t=IS(D).getPassInfoList(),e=!1;for(var i in t)if(t.hasOwnProperty(i)){var n,h,o,a,s=t[i].id;if(0!=(1==s?null!=(n=null==(h=configBattlepass.getDataByKey(s))?void 0:h.view)?n:0:null!=(o=null==(a=configWartoken.getDataByKey(s))?void 0:a.view)?o:0)){e=!0;break}}this.btnRechargeGift.active=IS(mt).showrechage&&!this.needHideByFold("btnRechargeGift")&&(IS(rt).CheckFuncOpen(bt.FUNC_RECHARGE_GIFT)||IS(rt).CheckFuncOpen(bt.FUNC_BATTLEPASS)&&e),this.checkRechargeGiftRedPoint()}},g.checkShowBtnLeftFold=function(){},g.checkShowBtnRightFold=function(){this.btnFoldRight.active=IS(rt).CheckFuncOpen(bt.FUNC_MAINVIEW_RIGHT_ICONSTORAGE)},g.onRoleOpenFunctionUpdate=function(t){t==bt.FUNC_BATTLEPASS?this.checkShowBattlePass():t==bt.FUNC_DAILY_TASK?this.checkShowAcievementBtn():t==bt.FUNC_PVP?(this.checkShowPvpBtn(),this.addTimer(.1,1,this.checkGetUserInfoBtn,this)):t==bt.FUNC_ILLSTRATED_BOOK?this.checkShowAcievementBtn():t==bt.FUNC_FIRST_CHARGE?this.onPayInfoUpdate():t==bt.FUNC_FORUM?this.checkShowGameClub():t==bt.FUNC_RECHARGE_GIFT?this.checkShowRechargeGiftBtn():t==bt.FUNC_MAINVIEW_LEFT_ICONSTORAGE?this.checkShowBtnLeftFold():t==bt.FUNC_MAINVIEW_RIGHT_ICONSTORAGE?this.checkShowBtnRightFold():t==bt.FUNC_LIMITED_TIME_RANK?this.checkShowRankingRushBtn():t==bt.FUNC_SEVEN_LOGIN&&this.checkShowSevenLogin(),this.UpdateMenuRed(),this.updateFoldLeftRed(),this.updateFoldRightRed()},g.onRoleInfoInit=function(){this.checkShowBtn(),this.UpdateMenuRed(),this.UpdateAcievementBtn(),this.initIcon(),this.updateFoldLeftRed(),this.updateFoldRightRed()},g.OnRoleMenuRed=function(){this.UpdateMenuRed(),this.updateFoldLeftRed(),this.updateFoldRightRed()},g.UpdateAcievementBtn=function(){this.addRedPoint("MainTaskAndAchieve",this.btnAchievement,new h(22,22),u.Dot),IS(v).changeValue("MainTaskAndAchieve",IS(gt).GetTaskAndAchieveRed())},g.checkShowBtnPreview=function(){var t=IS(rt).GetRolePreviewList()[0];t&&t&&IS(rt).GetRolePreviewState(t.id)!=vt.Finish&&!this.needHideByFold("btnPreview")?(this.btnPreview.active=!0,this.previewCond.string=t.main_desc,this.previewName.string=t.desc,this.loadIcon(this.previewIcon,t.icon_atlas,t.icon),this.addRedPoint("preview_red",this.btnPreview,new h(30,15),u.Dot),IS(v).changeValue("preview_red",IS(rt).GetRolePreviewRed())):this.btnPreview.active=!1},g.onPayInfoUpdate=function(){var t=this;if(!IS(mt).showrechage)return this.btnRecharge.active=!1,void(this.btnPush.active=!1);if(IS(rt).CheckFuncOpen(bt.FUNC_FIRST_CHARGE)){var e=IS(et).GetPayRechargeGift();if(null==e)this.btnRecharge.active=!1;else{if(this.btnRecharge.active=!0,this.loadIcon(this.imgRecharge,"icon_pre",e.payCfg.inlet_icon),this.rechargeLeftTime=e.end_time-I.serverTime,this.rechargeLeftTime>0){this.txtRecharge.node.active=!0;var i,n=I.getTimeData(this.rechargeLeftTime);n[0],n[1],n[2],n[3];i=I.formatTimeStringForSecondSimply(this.rechargeLeftTime),this.txtRecharge.string=i}else this.txtRecharge.node.active=!1;var h="rechargeTips_"+IS(rt).GetRoleId(),o=C.get(h),a=I.serverTime;if(null!=this.rechargeTimer&&this.removeTimer(this.rechargeTimer),null==o||Number(o)+S.paydialogue_cd[0]<=a)C.set(h,a),this.btnRechargeTips.active=!1,this.rechargeTips.string=e.payCfg.txt,this.rechargeTimer=this.addTimer(S.paydialogue_cd[1],1,(function(){t.btnRechargeTips.active=!1,t.onPayInfoUpdate()}));else{var s=0;s=null==o?S.paydialogue_cd[0]:Number(o)+S.paydialogue_cd[0]-a,this.btnRechargeTips.active=!1,this.rechargeTimer=this.addTimer(s,1,(function(){t.onPayInfoUpdate()}))}}}else this.btnRecharge.active=!1;var d=IS(et).GetPushGiftList();if(d.length>0){this.btnPush.active=!this.needHideByFold("btnPush"),this.pushLeftTime=d[0].end_time-I.serverTime,this.curPushId=d[0].id,this.pushLeftTime>0?(this.txtPush.string=I.formatTimeStringForSecondSimply(this.pushLeftTime),this.txtPush.node.active=!0):this.txtPush.node.active=!1;var c="PushTips_"+IS(rt).GetRoleId(),r=C.get(c),f=I.serverTime;if(null!=this.pushTimer&&this.removeTimer(this.pushTimer),null==r||Number(r)+S.paydialogue_cd[0]<=f)C.set(c,f),this.btnPushTips.active=!1,this.pushTips.string=d[0].payCfg.txt,this.pushTimer=this.addTimer(S.paydialogue_cd[1],1,(function(){t.btnPushTips.active=!1,t.onPayInfoUpdate()}));else{var l=0;l=null==r?S.paydialogue_cd[0]:Number(r)+S.paydialogue_cd[0]-f,this.btnPushTips.active=!1,this.pushTimer=this.addTimer(l,1,(function(){t.onPayInfoUpdate()}))}}else this.btnPush.active=!1},g.onOpenBattlePassView=function(){uiMgr.openView("BattlePassMainView")},g.UpdateVipBtn=function(){var t=IS(M).GetGmBtnOpen();this.vipBtn.active=IS(M).GetGmBtnOpen(),t&&IS(v).changeValue("vip_btnRed",IS(M).GetVipBtnRed())},g.UpdateMarry=function(){var t,e,i=this,n=IS(Q).GetMarryStateInfo();n&&(t=n.stage,e=n.stage_time),this.marryTime&&(this.removeTimer(this.marryTime),this.marryTime=null),1==t?(this.marryBtnName.string=I.getTimeLeft(e-I.serverTime),e-I.serverTime>0?(this.marryBtnName.color=new f("#16ee5e"),this.marryBtnOut.color=new f("#1d1713"),this.marryTime=this.addTimer(1,e-I.serverTime,(function(){e-I.serverTime>0?i.marryBtnName.string=I.getTimeLeft(e-I.serverTime):(i.marryBtnName.string=GetLanguage(600000215),i.marryBtnName.color=new f("#fee38c"),i.marryBtnOut.color=new f("#27190b"),i.removeTimer(i.marryTime),i.marryTime=null)}))):(this.marryBtnName.color=new f("#fee38c"),this.marryBtnOut.color=new f("#27190b"),this.marryBtnName.string=GetLanguage(600000215)),this.btnMarry.active=!0):2==t?(this.marryBtnName.color=new f("#fee38c"),this.marryBtnOut.color=new f("#27190b"),this.marryBtnName.string=GetLanguage(600000215),this.btnMarry.active=!0):this.btnMarry.active=!1},g.UpdateBtnReturn=function(){var t=this;this.btnReturnTimer&&(this.removeTimer(this.btnReturnTimer),this.btnReturnTimer=null);var e=IS(y).GetReturnInfo();IS(v).changeValue("return_red",IS(y).GetReturnRed()),e&&e.return_type>0?(this.btnReturn.active=!0,this.btnReturnTimer=this.addTimer(1,e.end_time-I.serverTime,(function(){e.end_time-I.serverTime>0?t.btnReturnTime.string=I.getTimeLeft(e.end_time-I.serverTime):(t.btnReturnTime.string="",t.removeTimer(t.btnReturnTimer),t.btnReturnTimer=null)}))):this.btnReturn.active=!1},i}(b)),function(){function t(){this.view=void 0,this.node=void 0,this.iconId=void 0,this.txtName=void 0,this.txtTime=void 0,this.txtTimeBg=void 0,this.icon=void 0,this.iconCfg=void 0,this.iconInfo=void 0,this.canUpdate=!1,this.leftTime=0,this.redPointPath=void 0}var e=t.prototype;return e.init=function(t,e,i){this.view=t,this.node=e,this.iconId=i,this.onInit()},e.onInit=function(){var t=this;this.iconCfg=configMainicon.getDataByKey(this.iconId),this.txtName=R.findChildComponent(this.node,"info/name",a),this.txtTimeBg=R.findChild(this.node,"info/time/timeBg"),this.txtTime=R.findChildComponent(this.node,"info/time/time",a),this.icon=R.findChildComponent(this.node,"icon",o),this.view.addComponentCallbackListener(this.node,n.EventType.CLICK,(function(){t.iconInfo.isPre?W.showFlyTip(g.formatStrWithMirrorDeal(GetLanguage(201410),I.formatTimeForSecond(t.leftTime))):IS(It).openViewByIconId(t.iconId)})),this.txtName.string=this.iconCfg.name,this.txtName.node.active=1!=this.iconCfg.hide_name,this.view.loadIcon(this.icon,"icon_pre",this.iconCfg.icon),this.redPointPath="MainIcon/"+this.iconId,this.view.addRedPoint(this.redPointPath,this.node,new h(30,30),u.Dot)},e.show=function(){if(this.node.active=!0,this.iconInfo=IS(It).getIconInfo(this.iconId),this.leftTime=0,this.iconInfo&&(this.leftTime=this.iconInfo.leftTime),this.leftTime>0&&1!=this.iconCfg.hide_time){this.canUpdate=!0,this.txtTime.node.active=!0,this.txtTimeBg.active=!0;var t=I.getTimeData(this.leftTime),e=(t[0],t[1],t[2],t[3],"");e=this.iconInfo.isPre?g.formatStrWithMirrorDeal(GetLanguage(201411),I.formatTimeStringForSecondSimply(this.leftTime)):I.formatTimeStringForSecondSimply(this.leftTime),this.txtTime.string=e}else this.canUpdate=!1,this.txtTime.node.active=!1,this.txtTimeBg.active=!1},e.onUpdate=function(){if(this.canUpdate)if(this.leftTime=this.leftTime-1,this.leftTime>0&&1!=this.iconCfg.hide_time){var t=I.getTimeData(this.leftTime),e=(t[0],t[1],t[2],t[3],"");e=this.iconInfo.isPre?g.formatStrWithMirrorDeal(GetLanguage(201411),I.formatTimeStringForSecondSimply(this.leftTime)):I.formatTimeStringForSecondSimply(this.leftTime),this.txtTime.string=e}else this.canUpdate=!1,this.txtTime.node.active=!1,this.txtTimeBg.active=!1},e.updateOrder=function(t){this.node.setSiblingIndex(t||0)},e.hide=function(){this.node.active=!1,this.canUpdate=!1},e.getIconCfg=function(){return this.iconCfg},t}());i._RF.pop()}}}));

