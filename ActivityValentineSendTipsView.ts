System.register("chunks:///_virtual/ActivityValentineSendTipsView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./StringUtil.ts","./index57.ts","./BagModel.ts","./MessageView.ts","./ActivityControl.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,s,o,d,a,u,l,c,h,r;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,s=t.EditBox,o=t.RichText,d=t.js},function(t){a=t.ItemGrid},function(t){u=t.default},null,function(t){l=t.BagModel},function(t){c=t.default},function(t){h=t.default},function(t){r=t.BaseView}],execute:function(){var m;e._RF.push({},"5566bq6bidMrI1D2GRfFiX3","ActivityValentineSendTipsView",void 0);var f=((m={})[0]=2,m[1]=3,m);t("default",function(t){function e(){var i;return(i=t.call(this)||this).editBox=void 0,i.itemGrid_1=void 0,i.itemGrid_2=void 0,i.select_1=void 0,i.select_2=void 0,i.num_1=void 0,i.num_2=void 0,i.useNum=1,i.maxNum=void 0,i.txtDesc=void 0,i.selectId=0,i.selectType=void 0,i.name="ActivityValentineSendTipsView",i.url="ui/module/valentine/ActivityValentineSendTipsView",i}i(e,t);var r=e.prototype;return r.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("view/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var d=this.findChild("view/btnUse");this.addComponentCallbackListener(d,n.EventType.CLICK,(function(){t.UseClick()}));var u=this.findChild("view/btnAdd");this.addComponentCallbackListener(u,n.EventType.CLICK,(function(){t.changeNum(1)}));var l=this.findChild("view/btnMinus");this.addComponentCallbackListener(l,n.EventType.CLICK,(function(){t.changeNum(-1)}));var c=this.findChild("view/btnAddTen");this.addComponentCallbackListener(c,n.EventType.CLICK,(function(){t.changeNum(10)}));var h=this.findChild("view/btnMinusTen");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){t.changeNum(-10)})),this.editBox=this.findChildComponent("view/EditBox",s),this.addComponentCallbackListener(this.editBox.node,s.EventType.EDITING_DID_ENDED,(function(){var i=Number(t.editBox.string);(isNaN(i)||i<=1)&&(i=1),t.useNum=Math.floor(i),t.changeNum()})),this.itemGrid_1=new a(this,this.findChild("view/item1"),(function(){t.selectItem(0)})),this.itemGrid_2=new a(this,this.findChild("view/item2"),(function(){t.selectItem(1)})),this.select_1=this.findChild("view/select1"),this.select_2=this.findChild("view/select2"),this.txtDesc=this.findChildComponent("view/desc",o)},r.registerUpdateHandler=function(){},r.onAfterOpen=function(){var t=configTanabata_flower.getDatas();this.itemGrid_1.SetItemId(t[f[0]].id),this.itemGrid_1.SetItemNum(IS(l).getGoodsCountByGoodsGtid(t[f[0]].id),!0),this.itemGrid_2.SetItemId(t[f[1]].id),this.itemGrid_2.SetItemNum(IS(l).getGoodsCountByGoodsGtid(t[f[1]].id),!0),this.txtDesc.string="",this.selectItem(0)},r.onBeforeClose=function(){},r.onDestroy=function(){},r.selectItem=function(t){this.select_1.active=0==t,this.select_2.active=1==t;var i=configTanabata_flower.getDatas()[f[t]];this.maxNum=IS(l).getGoodsCountByGoodsGtid(i.id),this.useNum=0==this.maxNum?0:1,this.selectId=i.id,this.selectType=t,this.changeNum()},r.UseClick=function(){var t=IS(l).getGoodsCountByGoodsGtid(this.selectId);0==t||t<this.useNum?c.showFlyTip(GetLanguage(200069)):(IS(h).send_24_33(this.openArgs[0],this.selectId,this.useNum),this.close())},r.changeNum=function(t){null!=t&&(this.useNum=this.useNum+t),this.useNum=Math.min(this.maxNum,Math.max(this.useNum,1)),this.editBox.string=String(this.useNum);var i=configTanabata_flower.getDatas()[f[this.selectType]],e=d.formatStr("<outline color=#42294b width=2><color=#ffe44d>%s</color></outline>",i.giftflower_number*this.useNum),n=d.formatStr("<outline color=#42294b width=2><color=#ffe44d>%s</color></outline>",i.flower_number*this.useNum);this.txtDesc.string=u.formatStr(GetLanguage(204299),e,n)},e}(r));e._RF.pop()}}}));

