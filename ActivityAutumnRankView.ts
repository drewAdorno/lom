System.register("chunks:///_virtual/ActivityAutumnRankView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./ItemGrid.ts","./RankTitle.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./BagModel.ts","./CommonModel.ts","./FriendControl.ts","./RankControl.ts","./RankDefine.ts","./RankModel.ts","./RoleDataCache.ts","./RoleDefine.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./RankingRushDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,n,e,o,a,s,r,d,h,c,l,m,v,f,u,k,I,C,p,g,R,y,w,x,S,L,T;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t.Button,o=t.Label,a=t.Sprite,s=t.ScrollView,r=t.js,d=t.sys},function(t){h=t.V2},function(t){c=t.ItemGrid},function(t){l=t.RankTitle,m=t.TitleType},function(t){v=t.ListItem},function(t){f=t.default},function(t){u=t.default},null,function(t){k=t.BagModel},function(t){I=t.CommonModel},function(t){C=t.default},function(t){p=t.default},function(t){g=t.RankDefine},function(t){R=t.RankModel},function(t){y=t.RoleDataCache},function(t){w=t.PlayerAttr},function(t){x=t.default},function(t){S=t.ActivityType},function(t){L=t.RankingRushDataCache},function(t){T=t.BaseView}],execute:function(){var _,N,b;n._RF.push({},"919447o/FhEdbI8Hs0pm+Xm","ActivityAutumnRankView",void 0);var M=1,G=2,A="",B=((_={})[S.Autumn]={1:200035,2:200036},_[S.Childhood]={1:201373,2:201374},_[S.Halloween]={1:201375,2:201376},_[S.SevenBoss]={1:999100264,2:400198},_),E=((N={})[1]=new h(0,0),N[2]=new h(0,0),N[3]=new h(0,0),N),F={},O=((b={})[S.SevenBoss]=!0,b),D=(t("default",function(t){function n(){var i;return(i=t.call(this)||this).tabBtns=[],i.actType=void 0,i.curIndex=0,i.nodeReward=void 0,i.nodeRank=void 0,i.nodeTopRank=void 0,i.nodeMyRank=void 0,i.rankList=void 0,i.rewardList=void 0,i.txtMyRank=void 0,i.txtMyScore=void 0,i.myFrame=void 0,i.myIcon=void 0,i.txtMyName=void 0,i.txtServer=void 0,i.roleList={},i.actInfo=void 0,i.rankId=void 0,i.rankInfo=void 0,i.curRankPage=void 0,i.name="ActivityAutumnRankView",i.url="ui/module/autumn/ActivityAutumnRankView",i}i(n,t);var d=n.prototype;return d.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.close()}));var n=this.findChild("btnClose");this.addComponentCallbackListener(n,e.EventType.CLICK,(function(){t.close()}));var d=this.findChild("root/tips");this.addComponentCallbackListener(d,e.EventType.CLICK,(function(){uiMgr.openView("RankJoinServerView",t.rankId)}));for(var h=function(i){var n=f.findChild(t.node,r.formatStr("root/bg/bottomBtn/item%s",i)),a={itemGo:n,normalTxt:f.findChildComponent(n,"normal/Label",o),normalGo:f.findChild(n,"normal"),selectedGo:f.findChild(n,"selected"),selectTxt:f.findChildComponent(n,"selected/Label",o),index:i};t.addComponentCallbackListener(n,e.EventType.CLICK,(function(){t.SetIndex(a.index)})),t.tabBtns[i]=a},c=1;c<=2;c++)h(c);this.nodeReward=this.findChild("root/nodeReward"),this.nodeRank=this.findChild("root/nodeRank"),this.nodeTopRank=this.findChild("root/nodeTopRank"),this.nodeMyRank=this.findChild("root/myRank"),this.txtMyRank=this.findChildComponent("root/myRank/rankNum",o),this.txtMyScore=this.findChildComponent("root/myRank/score",o),this.txtMyName=this.findChildComponent("root/myRank/name",o),this.txtServer=this.findChildComponent("root/myRank/txtServer",o),this.myFrame=this.findChildComponent("root/myRank/imgFrame",a),this.myIcon=this.findChildComponent("root/myRank/imgFrame/imgIcon",a);var l=this.findChildComponent("root/nodeRank/rankList",s);this.rankList=this.addUIList(l,U),this.addComponentCallbackListener(l.node,s.EventType.SCROLL_TO_BOTTOM,(function(){if(t.curRankPage<t.rankInfo.max_page){t.curRankPage++;var i=new Array;i.push({type:t.rankId,server:1,page:t.curRankPage}),IS(p).reqRankList(i)}}));var m=this.findChildComponent("root/nodeReward/rankList",s);this.rewardList=this.addUIList(m,D,!0,0);for(var v=1;v<=3;v++){var u=new V;u.init(this.findChild("root/nodeTopRank/rank"+v),this,v),this.roleList[v]=u}},d.registerUpdateHandler=function(){this.addEvent(g.RankInfoBack,this.UpdateRankInfo,this)},d.onAfterOpen=function(){for(var t in this.actType=this.openArgs[0],this.roleList)this.roleList.hasOwnProperty(t)&&this.roleList[t].show();this.txtMyName.string=IS(y).GetRoleAttr(w.ROLE_ATTR_NAME),O[this.actType]?(this.txtMyName.node.setPosition(this.txtMyName.node.getPosition().x,0),this.txtServer.node.active=!1):(this.txtMyName.node.setPosition(this.txtMyName.node.getPosition().x,15),this.txtServer.node.active=!0,this.txtServer.string=r.formatStr("[s%s]",IS(y).GetRoleAttr(w.ROLE_ATTR_SERVER))),this.loadRemoteIcon(IS(y).GetRoleAttr(w.ROLE_ATTR_HEAD_URL),this.myIcon);for(var i=1;i<=2;i++){var n=this.tabBtns[i];n.normalTxt.string=GetLanguage(B[this.actType][i]),n.selectTxt.string=GetLanguage(B[this.actType][i])}this.findChild("root/tips").active=!O[this.actType],this.actInfo=IS(x).GetActivityInfo(this.actType),this.rankId=this.actInfo.roundCfg.rank_id;var e=configRanktype.getDataByKey(this.rankId);A=e.prefix;var o=new Array;o.push({type:this.rankId,server:1,page:1}),this.curRankPage=1,IS(p).reqRankList(o);var a=IS(L).getRankRewardList(this.actInfo);this.rewardList.datas=a,this.tabBtns[M].itemGo.active,this.SetIndex(M)},d.onBeforeClose=function(){this.rankId=0,this.rankList.clearData(),this.curIndex>0&&(this.tabBtns[this.curIndex].normalGo.active=!0,this.tabBtns[this.curIndex].selectedGo.active=!1,this.curIndex=0)},d.onDestroy=function(){},d.SetIndex=function(t){this.curIndex!=t&&(this.curIndex>0&&(this.tabBtns[this.curIndex].selectedGo.active=!1,this.tabBtns[this.curIndex].normalGo.active=!0),this.curIndex=t,this.tabBtns[this.curIndex].normalGo.active=!1,this.tabBtns[this.curIndex].selectedGo.active=!0,this.curIndex==G?(this.nodeReward.active=!0,this.nodeRank.active=!1,this.nodeTopRank.active=!0,this.nodeMyRank.active=!0,this.rewardList.updateAll()):this.curIndex==M&&(this.nodeReward.active=!1,this.nodeRank.active=!0,this.nodeTopRank.active=!0,this.nodeMyRank.active=!0,this.rankList.updateAll()))},d.UpdateRankInfo=function(){if(this.rankInfo=IS(R).GetRankInfoByType(this.rankId),this.rankInfo){var t;this.txtMyRank.string=0!=this.rankInfo.my_info.rank?this.rankInfo.my_info.rank:GetLanguage(200037),this.txtMyScore.string=r.formatStr("%s%s",A,u.GetNumString(null!=(t=this.rankInfo.my_info.score)?t:0));for(var i=[],n=3;n<this.rankInfo.rank_list.length;n++)i.push(this.rankInfo.rank_list[n]);this.rankList.datas=i;for(var e=1;e<=3;e++)this.roleList[e].show(this.rankInfo.rank_list[e-1])}},n}(T)),function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).rewardScroll=void 0,i.txtRank=void 0,i.rankIcon=void 0,i}i(n,t);var e=n.prototype;return e.onInit=function(){this.txtRank=f.findChildComponent(this.node,"rankNum",o),this.rankIcon=f.findChildComponent(this.node,"rankIcon",a);var t=f.findChildComponent(this.node,"rewardScroll",s);this.rewardScroll=this.view.addUIList(t,P,!1,0),this.rewardScroll.touchEvent=!1},e.onRender=function(t,i){this.rewardScroll.datas=t.rank_reward,this.rewardScroll.scrollView.enabled=t.rank_reward.length>=6,this.rewardScroll.touchEvent=t.rank_reward.length>=6;var n=t.rank_range[0],e=t.rank_range[1];n==e&&n<=3?(this.rankIcon.node.active=!0,this.txtRank.node.active=!1,this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+n)):(this.rankIcon.node.active=!1,this.txtRank.node.active=!0,t.show&&""!=t.show?this.txtRank.string=t.show:this.txtRank.string=r.formatStr("%s-%s",n,e))},e.onItemClick=function(){},n}(v)),U=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).imgFrame=void 0,i.imgIcon=void 0,i.txtRank=void 0,i.rankIcon=void 0,i.txtName=void 0,i.txtScore=void 0,i}i(n,t);var s=n.prototype;return s.onInit=function(){var t=this;this.imgFrame=f.findChildComponent(this.node,"imgFrame",a),this.imgIcon=f.findChildComponent(this.node,"imgFrame/imgIcon",a),this.txtRank=f.findChildComponent(this.node,"rankNum",o),this.rankIcon=f.findChildComponent(this.node,"rankIcon",a),this.txtName=f.findChildComponent(this.node,"name",o),this.txtScore=f.findChildComponent(this.node,"score",o),this.view.addComponentCallbackListener(this.imgFrame.node,e.EventType.CLICK,(function(){IS(C).reqOtherRoleNotice(t.data.belong_id)}))},s.onRender=function(t,i){this.view.loadRemoteIcon(t.head.url,this.imgIcon),O[this.view.actType]?this.txtName.string=t.name:this.txtName.string=r.formatStr("[s%s]",t.serv_id)+t.name,this.txtScore.string=A+u.GetNumString(t.score),t.rank<=3?(this.rankIcon.node.active=!0,this.txtRank.node.active=!1,this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+t.rank)):(this.rankIcon.node.active=!1,this.txtRank.node.active=!0,this.txtRank.string=t.rank)},s.onItemClick=function(){IS(C).reqOtherRoleNotice(this.data.info.belong_id)},n}(v),V=function(){function t(){this.view=void 0,this.node=void 0,this.rank=void 0,this.txtName=void 0,this.txtScore=void 0,this.imgFrame=void 0,this.imgIcon=void 0,this.rankIcon=void 0,this.job=void 0,this.data=void 0,this.role=void 0}var i=t.prototype;return i.init=function(t,i,n){this.view=i,this.node=t,this.rank=n,this.onInit()},i.onInit=function(){var t=this;this.job=f.findChild(this.node,"role"),this.txtName=f.findChildComponent(this.node,"name",o),this.txtScore=f.findChildComponent(this.node,"score",o),this.imgFrame=f.findChild(this.node,"imgFrame"),this.imgIcon=f.findChildComponent(this.node,"imgFrame/imgIcon",a),this.view.addComponentCallbackListener(this.imgFrame,e.EventType.CLICK,(function(){t.data&&IS(C).reqOtherRoleNotice(t.data.belong_id)}));var i=f.findChild(this.node,"role/click");this.view.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.data&&IS(C).reqOtherRoleNotice(t.data.belong_id)})),this.rankIcon=f.findChildComponent(this.node,"imgFrame/rank_icon",a),this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+this.rank)},i.show=function(t){var i;if(this.data=t,this.txtName.string=GetLanguage(200038),this.txtScore.string=null!=(i=F[this.view.actType])?i:"0",this.imgIcon.node.active=!1,null!=this.role&&(this.view.removeUnitModel(this.role),this.role=null),t){var n,e=t.figure;this.role=IS(I).AddRoleModel(this.view,e,this.job,null,.9),this.view.getUnitModel(this.role).mount=e.mount_figure,d.uiMirror&&(this.view.getUnitModel(this.role).dir=-1),this.imgIcon.node.active=!0,this.view.loadRemoteIcon(t.head.url,this.imgIcon),e.mount_figure<=0&&(this.view.getUnitModel(this.role).position=E[this.rank]),this.view.loadRemoteIcon(t.head.url,this.imgIcon),O[this.view.actType]?this.txtName.string=t.name:this.txtName.string=r.formatStr("[s%s]",t.serv_id)+t.name,this.txtScore.string=null!=(n=F[this.view.actType])?n:""+u.GetNumString(t.score,!0)}},t}(),P=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).itemGridNode=void 0,i.itemGrid=void 0,i.img=void 0,i}i(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.adaptiveSize=!0,this.img=f.findChild(this.node,"img"),this.itemGridNode=f.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode),this.view.addComponentCallbackListener(this.node,e.EventType.CLICK,(function(){IS(k).OpenItemTips(t.data[0],t.node)}))},o.onRender=function(t,i){var n=this,e=configGoods.getDataByKey(t[0]);17==e.type?(this.ut.width=187,this.img.active=!0,this.itemGridNode.active=!1,new l(this.view,this.img,(function(){IS(k).OpenItemTips(t[0],n.img)})).SetRankTitle(e.effect[0],m.NORMAL)):(this.ut.width=100,this.img.active=!1,this.itemGridNode.active=!0,this.itemGrid.SetItemId(t[0],t[1]))},n}(v);n._RF.pop()}}}));

