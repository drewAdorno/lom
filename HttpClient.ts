System.register("chunks:///_virtual/HttpClient.ts",["cc","./GameLoadingView.ts","./TimeUtil.ts","./MathUtil.ts"],(function(e){"use strict";var t,n,o,r;return{setters:[function(e){t=e.cclegacy},function(e){n=e.GameLoadingView},function(e){o=e.default},function(e){r=e.default}],execute:function(){t._RF.push({},"d31f42fmb9M9KrMZ1tPU6I3","HttpClient",void 0);var u=0,l={},s=0,i=0;e("HttpClient",function(){function e(){}return e.get=function(t,n,o){return void 0===o&&(o=3),u++,l[u]={method:"GET",url:t,reqNum:1,onMsg:n,reqTimes:o},e._request(u),u},e.post=function(t,n,o,r){return void 0===r&&(r=3),u++,l[u]={method:"POST",url:t,reqNum:1,data:n,onMsg:o,reqTimes:r},e._request(u),u},e.abort=function(e){var t=l[e];null!=t&&(t.xhs.abort(),t.onMsg=null,delete l[e])},e.abortAll=function(){for(var e in l){var t=l[e];t.xhs.abort(),t.onMsg=null}l={}},e._request=function(t){var n=l[t],o=new XMLHttpRequest;o.timeout=5e3,o.ontimeout=function(){null!=n.onMsg&&n.onMsg(102,null)},o.onerror=function(){null!=n.onMsg&&n.onMsg(101,null)},o.onreadystatechange=function(){if(4==o.readyState){var r=500;if(o.status>=200&&o.status<=400){var u=o.responseText;u&&(r=0),null!=n.onMsg&&n.onMsg(r,u)}else{if(r=o.status||r,n.reqNum++,n.reqNum<=n.reqTimes)return printLogErr("http请求失败，重试",n.reqNum,"次\n",n.url),void e._request(t);null!=n.onMsg&&n.onMsg(r,null)}e.abort(t)}},o.responseType="text",o.open(n.method,n.url,!0),o.send(n.data),n.xhs=o},e.requestUrl=function(t,u,l){var a=this;0!=s&&e.abort(s),GlobalDefine.USE_BACKCDN&&u&&"none"!=GlobalDefine.REMOTE_PATH&&"none"!=GlobalDefine.REMOTE_BAK_PATH&&(t=t.replace(GlobalDefine.REMOTE_PATH,GlobalDefine.REMOTE_BAK_PATH));var c=o.getLocalTime()+""+r.getRandomInt(1,99999999);t=t.replace("{0}",c),console.log("url "+t),s=e.get(t,(function(e,o){s=0,0==e?(console.log("geturldata :"+o),i=0,l(o)):i<3?(++i>1&&u&&(GlobalDefine.USE_BACKCDN=!0),console.log("request again "+t),a.requestUrl(t,u,l)):n.instance.showExitGameNotice("关键资源加载失败，请检查网络")}))},e}());t._RF.pop()}}}));

