System.register("chunks:///_virtual/ActivityFrogGameMainView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./UIList.ts","./RedPoint.ts","./NodeUtil.ts","./StorageUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./MessageView.ts","./RoleDataCache.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ActivityFrogControl.ts","./ActivityFrogDataCache.ts","./ActivityFrogDefine.ts","./BaseView.ts"],(function(e){"use strict";var t,i,n,o,a,l,s,d,r,c,h,m,v,g,f,u,p,L,I,S,C,T,y,G,M,_,b,w,x,A;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.Button,o=e.HorizontalTextAlignment,a=e.Vec2,l=e.Label,s=e.Sprite,d=e.ScrollView,r=e.js},function(e){c=e.audioMgr},function(e){h=e.SelectedType,m=e.ListItem},function(e){v=e.RedPointType},function(e){g=e.default},function(e){f=e.default},function(e){u=e.default},function(e){p=e.default},null,function(e){L=e.ConfigGlobal},function(e){I=e.default},function(e){S=e.RoleDataCache},function(e){C=e.default},function(e){T=e.default},function(e){y=e.ActivityType,G=e.ActivityEventDefine,M=e.ActivityState,_=e.ActivityTaskState},function(e){b=e.default},function(e){w=e.default},function(e){x=e.ActivityFrogEvent},function(e){A=e.BaseView}],execute:function(){i._RF.push({},"9e553NTTIFLBJjwJLVMqDDU","ActivityFrogGameMainView",void 0);e("default",function(e){function i(){var t;return(t=e.call(this)||this).txtTimeDesc=void 0,t.txtLeftTime=void 0,t.leftTime=0,t.deltaTime=0,t.canUpdate=!1,t.actType=void 0,t.txtTop=void 0,t.txtTopScore=void 0,t.txtDesc=void 0,t.imgHammer=void 0,t.imgChallengeSelected=void 0,t.levelList=void 0,t.btnChallenge=void 0,t.RedPoint=void 0,t.name="ActivityFrogGameMainView",t.url="ui/module/activityFrog/ActivityFrogGameMainView",t.actType=y.FrogGame,t}t(i,e);var m=i.prototype;return m.onInit=function(){var e=this,t=this.findChild("bottom/btnClose");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){e.close()}));var i=this.findChild("top/title/btnTip");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){for(var t=L.LIMITED_RANK_SYSTEM_DETAILS,i="",n=0;n<t.length;n++)t[n][0]==e.actType&&(i=GetLanguage(t[n][1]));""!=i&&I.showBoxTip({tip:i,btnCnt:1,horizontalAlign:o.LEFT})}));var r=this.findChild("btnStart");this.addComponentCallbackListener(r,n.EventType.CLICK,(function(){IS(b).send_24_128(IS(w).curMoleLevelId),IS(w).curMoleLevelId==IS(w).challengeLevelId?IS(w).curChallengeLevelStage=1:IS(w).curChallengeLevelStage=0,IS(w).updateLevelInfo()}));var c=this.findChild("content/nodeHammer");this.addComponentCallbackListener(c,n.EventType.CLICK,(function(){uiMgr.openView("ActivityFrogGameHammerView")}));var m=this.findChild("bottom/btnTask");this.addRedPoint("mole_task",m,new a(25,30),v.Dot),this.addComponentCallbackListener(m,n.EventType.CLICK,(function(){uiMgr.openView("ActivityFrogGameTaskView",y.FrogGame)})),this.RedPoint=this.findChild("bottom/btnTask/RedPoint");var g=this.findChild("bottom/btnGuide");this.addComponentCallbackListener(g,n.EventType.CLICK,(function(){uiMgr.openView("ActivityFrogGameGuideView",1)})),this.btnChallenge=this.findChild("content/nodeLevel/btnChallenge"),this.addComponentCallbackListener(this.btnChallenge,n.EventType.CLICK,(function(){IS(w).curMoleLevelId=IS(w).challengeLevelId,e.UpdateLevelList()})),this.txtTimeDesc=this.findChildComponent("top/nodeTime/txtDesc",l),this.txtLeftTime=this.findChildComponent("top/nodeTime/txtTime",l),this.imgHammer=this.findChildComponent("content/nodeHammer/imgHammer/imgCurHammer",s),this.imgChallengeSelected=this.findChildComponent("content/nodeLevel/btnChallenge/imgSelected",s),this.txtTop=this.findChildComponent("content/nodeLevel/txtTop/top1",l),this.txtTopScore=this.findChildComponent("content/nodeLevel/txtTopScore",l),this.txtDesc=this.findChildComponent("content/nodeLevel/txtDesc",l);var f=this.findChildComponent("content/nodeLevel/ScrollView",d);this.levelList=this.addUIList(f,F,!0),this.levelList.selectedMode=h.SINGLE},m.registerUpdateHandler=function(){this.addEvent(G.OnTangMoleInfoBack,this.UpdateLevelList,this),this.addEvent(G.OnTangMoleLevelUpdate,this.UpdateLevelList,this),this.addEvent(G.OnTangMoleHammerUpdate,this.UpdateHammer,this),this.addEvent(G.OnTangMoleGameStart,this.GameStart,this),this.addEvent(G.OnActivityInfoUpdate,this.updateTimeInfo,this),this.addEvent(G.OnActivityInfoTaskUpdate,this.updateRed,this)},m.onAfterOpen=function(){""==f.get("froggame"+IS(S).GetRoleId())&&(this.addTimer(1,0,(function(){uiMgr.openView("ActivityFrogGameGuideView",1)})),f.set("froggame"+IS(S).GetRoleId(),"1")),"1"==f.get("FrogGame_NewLevel_"+IS(S).GetRoleId())&&(f.set("FrogGame_NewLevel_"+IS(S).GetRoleId(),"0"),IS(T).UpdateMainRedByActType(y.Frog),normalEvent.emit(x.OnFrogGameNewLevelUpdate)),IS(b).send_24_126(),IS(C).send_24_14(y.FrogGame),this.updateTimeInfo(),this.UpdateLevelList(),this.UpdateHammer(),c.playMusic("stbyc_dds_bgm")},m.onBeforeClose=function(){this.canUpdate=!1,c.playMusic("bgm_beishangwa")},m.onDestroy=function(){},m.onUpdate=function(e){this.canUpdate&&(this.deltaTime=this.deltaTime+e,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=r.formatStr("%s",p.formatTimeStringForSecond(this.leftTime)):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},m.updateRed=function(){var e=0,t=IS(T).GetActivityInfo(y.FrogGame);if(t&&t.state!=M.Null){var i=t.task_list;for(var n in i){if(45002!=t.task_list[n].group_id)if(i.hasOwnProperty(n))i[n].state==_.CanGet&&(e+=1)}var o=t.group_task_list;for(var a in o){if(o.hasOwnProperty(a))o[a].state==_.CanGet&&(e+=1)}}this.RedPoint.active=e>0},m.UpdateLevelList=function(){(IS(w).levelTopScore[IS(w).curMoleLevelId]||0==IS(w).levelTopScore[IS(w).curMoleLevelId])&&(this.txtTopScore.string=IS(w).levelTopScore[IS(w).curMoleLevelId].toString()),IS(w).curMoleLevelId==IS(w).challengeLevelId?this.txtTop.string=GetLanguage(201715):this.txtTop.string=u.formatStrWithMirrorDeal(GetLanguage(200797),IS(w).curMoleLevelId);for(var e=[],t=configMole_level,i=function(i){if(1==t.getDataByKey(i+1).challenge_level)return IS(w).challengeLevelId=i+1,IS(w).challengeLevelStage=t.getDatas().length-i,"break";var n={isLocked:!IS(w).openLevelList.some((function(e){return e==i+1})),isSelected:i==IS(w).curMoleLevelId-1};e.push(n)},n=0;n<t.getDatas().length;n++){if("break"===i(n))break}this.levelList.datas=e,this.imgChallengeSelected.node.active=IS(w).curMoleLevelId==IS(w).challengeLevelId,this.txtDesc.node.active=IS(w).curMoleLevelId==IS(w).challengeLevelId},m.UpdateHammer=function(){var e=configMole_hammer.getDataByKey(IS(w).curMoleHammer);this.loadIcon(this.imgHammer,"act_frog_game",e.hammer_shape)},m.GameStart=function(){IS(w).updateLevelInfo(),uiMgr.openView("ActivityFrogGameView")},m.updateTimeInfo=function(e){if(e||(e=IS(T).GetActivityInfo(y.FrogGame)),e){var t,i=null!=(t=e.state_time[e.state])?t:e.state_time[M.Open];if(this.leftTime=i.end_time-p.serverTime,this.leftTime>0){var n="";e.state==M.Preview?n=GetLanguage(200763):e.state==M.Open?n=GetLanguage(200764):e.state==M.EndShow&&(n=GetLanguage(200765)),this.txtTimeDesc.string=n,this.canUpdate=!0,this.txtLeftTime.string=r.formatStr("%s",p.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}},i}(A));var F=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).id=void 0,t.imgSelected=void 0,t.imgLock=void 0,t.txtLevel=void 0,t}t(i,e);var n=i.prototype;return n.onInit=function(){this.imgSelected=g.findChildComponent(this.node,"imgSelected",s),this.imgLock=g.findChildComponent(this.node,"imgLock",s),this.txtLevel=g.findChildComponent(this.node,"txtLevel",l)},n.onRender=function(e,t){this.id=t+1,this.imgSelected.node.active=e.isSelected,this.txtLevel.string=(t+1).toString(),this.imgLock.node.active=e.isLocked},n.onItemClick=function(){this.imgLock.node.active?this.id<=IS(w).act_day?I.showFlyTip(GetLanguage(201214)):I.showFlyTip(u.formatStrWithMirrorDeal(GetLanguage(201212),this.id)):(IS(w).curMoleLevelId=this.id,normalEvent.emit(G.OnTangMoleLevelUpdate))},i}(m);i._RF.pop()}}}));

