System.register("chunks:///_virtual/ParkingDecorateDetailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./BagModel.ts","./MessageView.ts","./ParkingControl.ts","./ParkingDataCache.ts","./ParkingDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,s,r,a,d,h,l,c,f,g,u,C,v,p,I,m,_,k,S,D;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.Layout,r=t.ScrollView,a=t.Sprite,d=t.UITransform,h=t.Node,l=t.Label,c=t.js},function(t){f=t.ItemGrid},function(t){g=t.ListItem},function(t){u=t.default},function(t){C=t.default},null,function(t){v=t.IconAseetType},function(t){p=t.BagModel},function(t){I=t.default},function(t){m=t.default},function(t){_=t.ParkingDataCache},function(t){k=t.DEC_TYPE,S=t.ParkingEventDefine},function(t){D=t.BaseView}],execute:function(){n._RF.push({},"aaee2RpDVZJ3pDkpY4gSjhB","ParkingDecorateDetailView",void 0);t("default",function(t){function n(){var e;return(e=t.call(this)||this).nodeRoot=void 0,e.btnUnlock=void 0,e.nodeItem=void 0,e.nodeTop=void 0,e.attrUIList=void 0,e.attrTopUIList=void 0,e.starUIList=void 0,e.nodeUse=void 0,e.nodeCancel=void 0,e.btnUse=void 0,e.btnCancel=void 0,e.DecEffectID=void 0,e.decID=void 0,e.imgBG=void 0,e.name="ParkingDecorateDetailView",e.url="ui/module/parking/ParkingDecorateDetailView",e.poolTime=3e3,e}e(n,t);var c=n.prototype;return c.onInit=function(){var t=this,e=this.findChild("root/btnClose");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.close()})),this.nodeRoot=this.findChild("root"),this.btnUnlock=this.findChild("root/btnUnlock"),this.addComponentCallbackListener(this.btnUnlock,o.EventType.CLICK,(function(){IS(m).reqSkinUp(IS(_).type,t.decID)})),this.refreshTxtMirrorByLayout(this.findChildComponent("root/nodeShow/bgName",s)),this.refreshTxtMirrorByLayout(this.findChildComponent("root/nodeSkill/common_ui_xiaotidi",s)),this.refreshTxtMirrorByLayout(this.findChildComponent("root/nodeChange/common_ui_xiaotidi",s));var i=this.findChildComponent("root/nodeChange/ScrollView",r);this.attrUIList=this.addUIList(i,y);var n=this.findChildComponent("root/nodeTop/ScrollView",r);this.attrTopUIList=this.addUIList(n,y);var l=this.findChildComponent("root/nodeShow/ScrollView",r);this.starUIList=this.addUIList(l,w),this.nodeItem=this.findChild("root/item"),this.nodeTop=this.findChild("root/nodeTop"),this.nodeUse=this.findChild("root/nodeUse"),this.nodeCancel=this.findChild("root/nodeCancel"),this.btnUse=this.findChild("root/nodeUse/btnUse"),this.addComponentCallbackListener(this.btnUse,o.EventType.CLICK,(function(){configParking_design.getDataByKey(t.decID).position==k.TYPE_DEC?(normalEvent.emit(S.PARKING_SKIN_PREVIEW_STATUS,1),normalEvent.emit(S.PARKING_SKIN_PREVIEW_ENTER_ITEM,t.decID),t.close(),uiMgr.close("ParkingDecorateView")):IS(m).reqParkSkinUse(IS(_).type,t.decID,1)})),this.btnCancel=this.findChild("root/nodeCancel/btnCancel"),this.addComponentCallbackListener(this.btnCancel,o.EventType.CLICK,(function(){1!=configParking_design.getDataByKeys("id",t.decID,"level",0).if_initial?IS(m).reqParkSkinUse(IS(_).type,t.decID,0):I.showFlyTip(GetLanguage(201317))})),this.imgBG=this.findChildComponent("bg/bg/zq_ui_bg",a);var c=this.findChild("root/nodeSkill/ScrollView/view/content/item"),f=this.findChildComponent("root/nodeSkill/ScrollView/view/content",d);c.on(h.EventType.SIZE_CHANGED,(function(){f.height=c.getComponent(d).height}))},c.onAfterOpen=function(){this.decID=this.openArgs[0],this.refreshAll()},c.refreshAll=function(){this.refreshDecShow(),this.refreshDecAddition(),this.refreshItemNum(),this.refreshDecAttr(),this.refreshBtnStatus()},c.registerUpdateHandler=function(){this.addEvent(S.PARKING_SKIN_INFO_CHANGE,this.refreshAll,this)},c.refreshBtnStatus=function(){for(var t,e=IS(_).skin_list,n=!1,o=!1,s=i(e);!(t=s()).done;){var r=t.value;r.skin_id==this.decID&&(n=!0,0!=r.pos&&(o=!0))}for(var a,d=i(IS(_).getUsingFreeDec());!(a=d()).done;){var h=a.value;h.skin_id==this.decID&&(n=!0,0!=h.pos&&(o=!0))}this.nodeUse.active=!1,this.nodeCancel.active=!1,n&&(o?this.nodeCancel.active=!0:this.nodeUse.active=!0)},c.refreshItemNum=function(){var t=this.findChildComponent("root/nodeItem/Label",l),e=IS(p).getGoodsCountByGoodsGtid(1);t.string=""+e},c.refreshDecAddition=function(){var t=u.findChildComponent(this.nodeRoot,"nodeSkill/ScrollView/view/content/item",l),e=configParking_design.getDataByKey(this.decID);t.string=C.formatStr.apply(C,[e.desc].concat(e.desc_parm))},c.refreshDecShow=function(){var t=this.findChildComponent("root/nodeShow/icon",a),e=this.findChildComponent("root/nodeShow/bgName/txtName",l),i=IS(_).getDecUsingInfo(),n=configParking_design.getDataByKey(this.decID);if(n.position==k.TYPE_FLOOR)this.loadIcon(this.imgBG,"parking_dec",n.show_path,null,v.ICON_SPRITE),this.loadIcon(t,"parking_dec","",null,v.ICON_SPRITE);else{var o=configParking_design.getDataByKey(i[k.TYPE_FLOOR]);this.loadIcon(this.imgBG,"parking_dec",o.show_path,null,v.ICON_SPRITE),this.loadIcon(t,"parking_dec",n.show_path,null,v.ICON_SPRITE)}var s=configParking_design.getDataByKey(this.decID);e.string=s.name},c.refreshDecAttr=function(){for(var t,e,n,o,s=this.findChild("root/nodeChange/ScrollView"),r=this.findChild("root/nodeTop"),a=null!=(t=IS(_).skin_list)?t:[],d={skin_lev:0},h=i(a);!(o=h()).done;){var c=o.value;c.skin_id==this.decID&&(d=c)}var g=configParking_design.getDataByKeys("id",this.decID,"level",null!=(e=d.skin_lev)?e:0),u=configParking_design.getDataByKeys("id",this.decID,"level",(null!=(n=d.skin_lev)?n:0)+1),C=[],v=[];if(null!=g){this.starUIList.node.active=!0,1==g.if_initial&&(this.starUIList.node.active=!1);for(var I=[0,0,0,0,0],m=0;m<d.skin_lev;m++){I[m%5]+=1}this.starUIList.datas=I;var k=this.findChildComponent("root/btnUnlock/txtLabel",l);if(this.nodeItem.active=!0,this.btnUnlock.active=!0,0==d.skin_lev?k.string=GetLanguage(200101):k.string=GetLanguage(200128),null!=g.expend&&g.expend.length>0){new f(this,this.nodeItem).SetItemId(g.expend[0][0],0);var S=IS(p).getGoodsCountByGoodsGtid(g.expend[0][0]),D=g.expend[0][1];this.findChildComponent("root/item/txtNext",l).string=S+"/"+D}if(null!=u){for(m=0;m<g.own_attrs.length;m++){var y=configAttribute.getDataByKey(g.own_attrs[m][0]),w={show_type:y.show_type,name:y.desc,base:g.own_attrs[m][1],next:u.own_attrs[m][1]};C.push(w)}this.attrUIList.datas=C,s.active=!0,r.active=!1}else{for(m=0;m<g.own_attrs.length;m++){var x=configAttribute.getDataByKey(g.own_attrs[m][0]),U={show_type:x.show_type,name:x.desc,base:g.own_attrs[m][1]};v.push(U)}this.attrTopUIList.datas=v,s.active=!1,r.active=!0,this.nodeItem.active=!1,this.btnUnlock.active=!1,this.nodeTop.active=!0}}},c.onBeforeClose=function(){},c.onDestroy=function(){},n}(D));var y=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).txtAttrName=void 0,e.txtAttrBase=void 0,e.txtAttrNext=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.txtAttrName=u.findChildComponent(this.node,"txtEffect",l),this.txtAttrBase=u.findChildComponent(this.node,"txtBase",l),this.txtAttrNext=u.findChildComponent(this.node,"txtNext",l)},n.onRender=function(t,e){this.txtAttrName.string=t.name+":",2==t.show_type?(this.txtAttrBase.string=c.formatStr("%s%",C.GetNumString(t.base/100)),this.txtAttrNext.string=c.formatStr("%s%",C.GetNumString(t.next/100))):3==t.show_type?(this.txtAttrBase.string=C.GetNumString(Math.floor(t.base/100)/100),this.txtAttrNext.string=C.GetNumString(Math.floor(t.next/100)/100)):(this.txtAttrBase.string=C.GetNumString(t.base),this.txtAttrNext.string=C.GetNumString(t.next))},n.onItemClick=function(){},i}(g),w=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).imgOne=void 0,e.imgTwo=void 0,e.imgThree=void 0,e.imgDark=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.imgOne=u.findChild(this.node,"one"),this.imgTwo=u.findChild(this.node,"two"),this.imgThree=u.findChild(this.node,"three"),this.imgDark=u.findChild(this.node,"dark")},n.onRender=function(t,e){this.imgDark.active=0==t,this.imgOne.active=1==t,this.imgTwo.active=2==t,this.imgThree.active=3==t},i}(g);n._RF.pop()}}}));

