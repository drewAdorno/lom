System.register("chunks:///_virtual/GameClubView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./RedPointMgr.ts","./NodeUtil.ts","./PlatformUtil.ts","./StringUtil.ts","./TimeUtil.ts","./BaseView.ts","./ConfigGlobal.ts","./MathUtil.ts","./BagModel.ts","./RoleControl.ts","./RoleDataCache.ts","./SdkControl.ts","./GameClubControl.ts","./GameClubDefine.ts","./GameClubModel.ts"],(function(t){"use strict";var i,e,n,a,o,s,l,d,h,c,r,u,_,m,f,g,p,C,b,v,y,I,G,w,S,B,L;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Sprite,a=t.Button,o=t.ScrollView,s=t.Layout,l=t.Label,d=t.js,h=t.Vec2},function(t){c=t.SelectedType,r=t.ListItem},function(t){u=t.RedPointMgr},function(t){_=t.default},function(t){m=t.PlatformUtil},function(t){f=t.default},function(t){g=t.default},function(t){p=t.ViewEvent,C=t.BaseView},function(t){b=t.ConfigGlobal},function(t){v=t.default},function(t){y=t.BagModel},function(t){I=t.default},function(t){G=t.RoleDataCache},function(t){w=t.default},function(t){S=t.default},function(t){B=t.GameClubDefine},function(t){L=t.GameClubModel}],execute:function(){e._RF.push({},"bb6f7av2BJPdIQ0rNLpV75j","GameClubView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).panel2_item_list=void 0,i.panel2_item_list_layout=void 0,i.panel4_task_list=void 0,i.panel2_get_btn_gray=void 0,i.panel2_get_btn_txt=void 0,i.panel3_day_list=[],i.panel_list=[],i.other_panel_list=[],i.btn_list=[],i.btn_list2=[],i.url_bg_list=[],i.btn_list_go=void 0,i.bg_other=void 0,i.title=void 0,i.title1=void 0,i.select_index=0,i.select_index2=0,i.topnode=void 0,i.panel3_all_day=void 0,i.wechatGameClubButton=void 0,i.name="GameClubView",i.url="ui/module/gameclub/GameClubView",i}i(e,t);var r=e.prototype;return r.onInit=function(){for(var t=this,i=function(i){t.panel_list[i]=t.findChild("root/content/panel"+i);var e=t.findChild("root/content/btn_list/btn"+i),n={};n.btn=e,t.addRedPoint("GameClub_Redpoint"+i,e,new h(22,22)),n.select=t.findChild("root/content/btn_list/btn"+i+"/select_bg"),t.btn_list[i]=n,t.addComponentCallbackListener(e,a.EventType.CLICK,(function(){t.SelectTab(i)}))},e=1;e<=4;e++)i(e);for(var d=function(i){var e={},n=t.findChild("root/content/btn_list2/btn"+i);e.btn=n,t.addRedPoint("GameClub_clickRedpoint"+i,n,new h(65,22)),e.select=t.findChild("root/content/btn_list2/btn"+i+"/select_bg"),e.select.active=!1,t.btn_list2[i]=e,t.addComponentCallbackListener(n,a.EventType.CLICK,(function(){t.SelectTab2(i)}))},r=1;r<=5;r++)d(r);for(var u=1;u<=5;u++){var m={};1==u?(this.other_panel_list[u]=this.findChild("root/content/panel"+u),m.s_bg=this.findChildComponent("root/content/panel1/bg2",n),m.d_bg=this.findChild("root/content/panel1/bg1")):(m.s_bg=this.findChildComponent("root/content/panel1"+(u-1)+"/bg2",n),m.d_bg=this.findChild("root/content/panel1"+(u-1)+"/bg1"),this.other_panel_list[u]=this.findChild("root/content/panel1"+(u-1))),this.url_bg_list[u]=m}this.title=this.findChild("root/content/title"),this.title1=this.findChild("root/content/title1"),this.btn_list_go=this.findChild("root/content/btn_list"),this.bg_other=this.findChild("root/content/bg_other");var f=this.findChild("root/content/btnClose");this.addComponentCallbackListener(f,a.EventType.CLICK,(function(){t.onMaskClick()})),this.topnode=this.findChild("root/content/btn/toppos");var g=this.findChildComponent("root/content/panel2/item_list",o);this.panel2_item_list=this.addUIList(g,x),this.panel2_item_list.selectedMode=c.SINGLE,this.panel2_item_list_layout=this.findChildComponent("root/content/panel2/item_list/view/content",s);var p=this.findChild("root/content/panel2/get_btn");this.panel2_get_btn_txt=this.findChildComponent("root/content/panel2/get_btn/gray/Label",l),this.addComponentCallbackListener(p,a.EventType.CLICK,(function(){IS(S).reqGameClubGetRewardInfo(1,1)})),this.panel2_get_btn_gray=this.findChild("root/content/panel2/get_btn/gray");for(var C=function(i){var e=t.findChild("root/content/panel3/list/item"+i),o=_.findChild(e,"select_bg"),s=_.findChildComponent(e,"Label",l),d=_.findChildComponent(e,"item/head/imgFrame",n),h=_.findChildComponent(e,"item/head/imgIcon",n),c=_.findChildComponent(e,"item/head/num",l),r=_.findChild(e,"red"),u=_.findChild(e,"state3");t.addComponentCallbackListener(e,a.EventType.CLICK,(function(){IS(S).reqGameClubGetRewardInfo(2,t.panel3_day_list[i].info.id)}));var m={go:e,select_bg:o,day:s,imgFrame:d,imgIcon:h,txtNum:c,red:r,state3:u,info:null};m.select_bg.active=!1,m.red.active=!1,m.state3.active=!1,t.panel3_day_list[i]=m},b=1;b<=6;b++)C(b);this.panel3_all_day=this.findChildComponent("root/content/panel3/title1/value",l);var v=this.findChildComponent("root/content/panel4/item_list",o);this.panel4_task_list=this.addUIList(v,k),this.panel4_task_list.selectedMode=c.SINGLE},r.onMaskClick=function(){this.close()},r.onAfterOpen=function(){for(var t=1;t<=5;t++)null!=this.btn_list[t]&&(this.btn_list[t].select.active=!1),null!=this.panel_list[t]&&(this.panel_list[t].active=!1);this.select_index=0,this.SelectTab2(1),IS(w).getGameClubData(),this.showGameClubBtn(),this.updateData(),IS(S).reqGameClubInfo();for(var i=g.getLocalTime()+""+v.getRandomInt(1,99999999),e=1;e<=5;e++)this.url_bg_list[e].s_bg.node.active=!1,this.url_bg_list[e].d_bg.active=!0;if(!IS(G).isHaveHideByType(2))for(var n=1;n<=5;n++){var a=d.formatStr("https://fnapi.4399sy.com/cms/sypt/images/mxdzz/sqbanner%d.jpg?%s",n,i);this.url_bg_list[n].s_bg.node.active=!0,this.loadRemoteIcon(a,this.url_bg_list[n].s_bg,(function(){}),!1)}},r.showGameClubBtn=function(){if(null==this.wechatGameClubButton){IS(I).send_3_30(4,0);var t=this.topnode.worldPosition.x,i=_.TransCocosPosToScreenPosY(this.topnode.worldPosition.y);this.wechatGameClubButton=m.createGameClubButton(t,i,232,73)}},r.onBeforeClose=function(){null!=this.wechatGameClubButton&&(this.wechatGameClubButton.destroy(),this.wechatGameClubButton=null)},r.registerUpdateHandler=function(){this.addEvent(B.GameClubInfoBack,this.updateData,this),this.addEvent(p.ViewOpen,this.needClose,this)},r.needClose=function(t){"GameClubView"!=t&&"GoodsGetView"!=t&&"ItemTipsView"!=t&&this.close()},r.updateData=function(){configForum_checkin.getDatas();for(var t=1;t<=6;t++){var i=configForum_checkin.getDataByKey(t);if(null!=this.panel3_day_list[t]&&null!=i){this.panel3_day_list[t].txtNum.string=i.reward[0][1]+"";var e=configGoods.getDataByKey(i.reward[0][0]),n=configColor.getDataByKey(e.quality);this.loadIcon(this.panel3_day_list[t].imgFrame,"icon_equip",n.path),this.loadIcon(this.panel3_day_list[t].imgIcon,e.icon_group,e.icon),this.panel3_day_list[t].day.string=f.formatStrWithMirrorDeal(GetLanguage(200319),i.condition[0][1]),this.panel3_day_list[t].select_bg.active=!1,this.panel3_day_list[t].red.active=!1,this.panel3_day_list[t].state3.active=!1,this.panel3_day_list[t].info=i;var a=IS(L).GetGameClubInfoByConfigId(2,i.id);null!=a&&(1==a.status?(this.panel3_day_list[t].select_bg.active=!0,this.panel3_day_list[t].red.active=!0):2==a.status&&(this.panel3_day_list[t].state3.active=!0))}}var o=0,s=IS(L).GetGameClubTaskByCondition(2);null!=s&&(o=s.v),this.panel3_all_day.string=o+"";for(var l=b.forum_first_reward,d=[],h=0;h<l.length;h++){var c={gtid:l[h][0],num:l[h][1]};d.push(c)}this.panel2_item_list.datas=d,1==d.length&&(this.panel2_item_list_layout.paddingLeft=150);IS(L).GetGameClubTaskByCondition(2);var r=!0,u=IS(L).GetGameClubInfoByConfigId(1,1);u&&2==u.status?this.panel2_get_btn_txt.string=GetLanguage(200314):u&&1==u.status?r=!1:this.panel2_get_btn_txt.string=GetLanguage(200321),this.panel2_get_btn_gray.active=r;for(var _=configForum_task.getDatas(),m=[],g=0;g<_.length;g++)if(1==_[g].view){var p=IS(L).GetGameClubInfoByConfigId(3,_[g].id),C=p&&p.status||0,v=C+1e3*_[g].id;1==C?v=C+10*_[g].id:2==C&&(v=C+1e4*_[g].id),m.push({sort:v,status:C,info:_[g]})}m.sort((function(t,i){return t.sort<i.sort?-1:1})),this.panel4_task_list.datas=m,this.updateRed(),this.updateClickRed()},r.updateRed=function(){IS(u).changeValue("GameClub_Redpoint2",IS(L).GetRedBySelectType(1)),IS(u).changeValue("GameClub_Redpoint3",IS(L).GetRedBySelectType(2)),IS(u).changeValue("GameClub_Redpoint4",IS(L).GetRedBySelectType(3))},r.updateClickRed=function(){for(var t=1;t<=5;t++)IS(u).changeValue("GameClub_clickRedpoint"+t,IS(L).CheckShowGameClubRed(t))},r.onDestroy=function(){},r.SelectTab=function(t){for(var i=1;i<=4;i++)this.panel_list[i].active=!1,this.btn_list[i].select.active=!1;for(var e=1;e<=5;e++)this.other_panel_list[e].active=!1;this.select_index=t,null!=this.panel_list[this.select_index]&&(this.panel_list[this.select_index].active=!0),null!=this.btn_list[this.select_index]&&(this.btn_list[this.select_index].select.active=!0)},r.SelectTab2=function(t){for(var i=1;i<=4;i++)this.panel_list[i].active=!1;for(var e=1;e<=5;e++)this.other_panel_list[e].active=!1,this.btn_list2[e].select.active=!1;this.select_index2=t,null!=this.other_panel_list[this.select_index2]&&(this.other_panel_list[this.select_index2].active=!0),null!=this.btn_list2[this.select_index2]&&(this.btn_list2[this.select_index2].select.active=!0),this.title1.active=2==this.select_index2,this.title.active=2!=this.select_index2,IS(L).UpdateGameSettingCache(t),this.updateClickRed(),1==t?(this.SelectTab(0==this.select_index?1:this.select_index),this.btn_list_go.active=!0,this.bg_other.active=!1):(this.btn_list_go.active=!1,this.bg_other.active=!0)},e}(C));var x=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).imgFrame=void 0,i.imgIcon=void 0,i.txtNum=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.imgFrame=_.findChildComponent(this.node,"head/imgFrame",n),this.imgIcon=_.findChildComponent(this.node,"head/imgIcon",n),this.txtNum=_.findChildComponent(this.node,"head/num",l),this.view.addComponentCallbackListener(this.imgIcon.node,a.EventType.CLICK,(function(){IS(y).OpenItemTips(t.data.gtid,t.imgIcon.node)}))},o.onRender=function(t,i){this.data=t,this.txtNum.string=t.num+"";var e=configGoods.getDataByKey(t.gtid),n=configColor.getDataByKey(e.quality);this.view.loadIcon(this.imgFrame,"icon_equip",n.path),this.view.loadIcon(this.imgIcon,e.icon_group,e.icon)},o.onItemClick=function(){},e}(r),k=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).item1=void 0,i.item2=void 0,i.txtdesc=void 0,i.gray=void 0,i.grayLab=void 0,i.get_btn=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this,i=_.findChild(this.node,"item1"),e=_.findChildComponent(this.node,"item1/head/imgFrame",n),o=_.findChildComponent(this.node,"item1/head/imgIcon",n),s=_.findChildComponent(this.node,"item1/head/num",l);this.item1={itemGo:i,imgFrame:e,imgIcon:o,txtNum:s};var d=_.findChild(this.node,"item2"),h=_.findChildComponent(this.node,"item2/head/imgFrame",n),c=_.findChildComponent(this.node,"item2/head/imgIcon",n),r=_.findChildComponent(this.node,"item2/head/num",l);this.item2={itemGo:d,imgFrame:h,imgIcon:c,txtNum:r},this.txtdesc=_.findChildComponent(this.node,"desc",l),this.get_btn=_.findChild(this.node,"btnBlue"),this.gray=_.findChild(this.node,"btnBlue/gray"),this.grayLab=_.findChildComponent(this.node,"btnBlue/gray/Label",l),this.view.addComponentCallbackListener(this.get_btn,a.EventType.CLICK,(function(){t.onBtnClick()}))},o.onRender=function(t,i){this.data=t.info;var e=IS(L).GetGameClubTaskByCondition(this.data.condition[0][0]),n=e&&e.v||0;this.txtdesc.string=d.formatStr("%s(%s/%s)",this.data.desc,n,this.data.condition[0][1]),this.gray.active=n<this.data.condition[0][1],this.grayLab.string=GetLanguage(200321);var a=IS(L).GetGameClubInfoByConfigId(3,this.data.id);a&&2==a.status?(this.grayLab.string=GetLanguage(200314),this.gray.active=!0):a&&1==a.status?this.gray.active=!1:this.gray.active=!0;this.data.reward;if(this.item2.itemGo.active=!1,this.data.reward.length>1){this.item2.itemGo.active=!0;var o=configGoods.getDataByKey(this.data.reward[1][0]),s=configColor.getDataByKey(o.quality);this.view.loadIcon(this.item2.imgFrame,"icon_equip",s.path),this.view.loadIcon(this.item2.imgIcon,o.icon_group,o.icon),this.item2.txtNum.string=this.data.reward[1][1]+""}var l=configGoods.getDataByKey(this.data.reward[0][0]),h=configColor.getDataByKey(l.quality);this.view.loadIcon(this.item1.imgFrame,"icon_equip",h.path),this.view.loadIcon(this.item1.imgIcon,l.icon_group,l.icon),this.item1.txtNum.string=this.data.reward[0][1]+""},o.onBtnClick=function(){IS(S).reqGameClubGetRewardInfo(3,this.data.id)},e}(r);e._RF.pop()}}}));

