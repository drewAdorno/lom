System.register("chunks:///_virtual/LowModeView.ts",["cc","./BattleData.ts","./CameraMgr.ts","./NodeUtil.ts","./TimeUtil.ts","./NativeToJs.ts","./GameSetting.ts"],(function(t){"use strict";var i,e,s,o,n,a,h,r,c,d,l,g,m,p,u,f,C;return{setters:[function(t){i=t.cclegacy,e=t.sys,s=t.find,o=t.Sprite,n=t.Label,a=t.Slider,h=t.UITransform,r=t.Size,c=t.game,d=t.isValid,l=t.Prefab},function(t){g=t.ChapterType},function(t){m=t.cameraMgr},function(t){p=t.default},function(t){u=t.default},function(t){f=t.NativeToJs},function(t){C=t.default}],execute:function(){i._RF.push({},"86a3faPbgBBPYbFl8R9JjfR","LowModeView",void 0);var v=["","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ"],U=[[999000441,0],[999000444,0],[999000448,0],[999000442,1],[999000442,2],[999000442,3],[999000445,1],[999000445,2],[999000445,3],[999000445,4],[999000449,1],[999000449,2],[999000449,3],[999000449,4],[999000449,5],[999000449,6],[999000449,7],[999000449,8],[999000449,9],[999000449,10],[999000447,1],[999000447,2],[999000447,3],[999000447,4],[999000447,5],[999000447,6],[999000447,7],[999000447,8],[999000447,9],[999000447,10],[999000446,1],[999000446,2],[999000446,3],[999000446,4],[999000446,5],[999000446,6],[999000446,7],[999000446,8],[999000446,9],[999000446,10],[999000443,1],[999000443,2],[999000443,3],[999000443,4],[999000443,5],[999000443,6],[999000443,7],[999000443,8],[999000443,9],[999000443,10],[999000556,1],[999000556,2],[999000556,3],[999000556,4],[999000556,5],[999000556,6],[999000556,7],[999000556,8],[999000556,9],[999000556,10],[999000557,1],[999000557,2],[999000557,3],[999000557,4],[999000557,5],[999000557,6],[999000557,7],[999000557,8],[999000557,9],[999000557,10]];t("default",function(){function t(){var t=this;this.node=void 0,this.isShow=!1,this.nodeUIRoot=void 0,this.nodeBattleRoot=void 0,this.charge=void 0,this.txtCharge=void 0,this.txtTime=void 0,this.txtChapter=void 0,this.curChapterId=void 0,this.sliderUnlock=void 0,this.sliderBar=void 0,this.gostList=[],this.gostHitList=[],this.checkTimer=-1,this.action1=void 0,this.action2=void 0,this.action3_1=void 0,this.action3_2=void 0,this.action3_3=void 0,this.battery_time=0,this.action4=void 0,resourceMgr.loadRes("ui/module/common/LowModeView",l,(function(i){t.node=nodeInstantiate.instantiate(i.item.asset),t.onInit()}))}var i=t.prototype;return i.clear=function(){this.node.destroy()},i.onInit=function(){this.node.setScale(e.uiMirror?-1:1,1,1),this.nodeUIRoot=s("UIRoot"),this.nodeBattleRoot=s("BattleRoot"),this.charge=p.findChildComponent(this.node,"charge/Bar",o),this.txtCharge=p.findChildComponent(this.node,"charge/txtCharge",n),this.txtTime=p.findChildComponent(this.node,"content/txtTime",n),this.txtChapter=p.findChildComponent(this.node,"content/title/txtChapter",n),this.sliderUnlock=p.findChildComponent(this.node,"content/sliderUnlock",a),this.sliderBar=p.findChildComponent(this.sliderUnlock.node,"Bar",o);for(var t=0;t<4;t++)this.gostList[t]=p.findChild(this.sliderUnlock.node,"gost/"+t),this.gostList[t].active=!0;for(var i=0;i<3;i++)this.gostHitList[i]=p.findChild(this.sliderUnlock.node,"gostHit/"+i),this.gostHitList[i].active=!1;this.sliderUnlock.node.on("slide",this.sliderCallback,this),this.action1=p.findChild(this.node,"content/sliderUnlock/action_slider"),this.action2=p.findChild(this.node,"content/sliderUnlock/Handle/action_run"),this.action3_1=p.findChild(this.node,"content/sliderUnlock/action_gui_1"),this.action3_2=p.findChild(this.node,"content/sliderUnlock/action_gui_2"),this.action3_3=p.findChild(this.node,"content/sliderUnlock/action_gui_3"),this.action4=p.findChild(this.node,"content/sliderUnlock/Handle/action_idle")},i.sliderCallback=function(){var t=582*this.sliderUnlock.progress;this.sliderBar.node.getComponent(h).contentSize=new r(t,92),this.gostList[0].active=this.sliderUnlock.progress<=.2,this.gostList[1].active=this.sliderUnlock.progress<=.3,this.gostList[2].active=this.sliderUnlock.progress<=.45,this.gostList[3].active=this.sliderUnlock.progress<=.62,this.gostHitList[0].active=this.sliderUnlock.progress>=.2,this.gostHitList[1].active=this.sliderUnlock.progress>=.354,this.gostHitList[2].active=this.sliderUnlock.progress>=.65,this.action1.active=!0,this.action2.active=!0,this.action4.active=!1,this.isShow&&this.sliderUnlock.progress>=.85&&(this.node.removeFromParent(),IS(C).setLowMode(!1),m.uiCamera.enabled=!0,this.isShow=!1,uiMgr.openFullScreenNum.delete("LowModeView"),-1!=this.checkTimer&&(normalTimer.stop(this.checkTimer),this.checkTimer=-1),e.os==e.OS.IOS?c.frameRate=45:c.frameRate=60)},i.onUpdate=function(){this.UpdateTime(),this.curChapterId!=chapterDataCache.curChapterId&&this.reset(),this.battery_time>60&&(this.battery_time=this.battery_time-60,f.GetBatteryRate()),this.battery_time=this.battery_time+5,this.showCharge()},i.UpdateTime=function(){if(d(this.txtTime)){var t,i,e=new Date(1e3*u.getLocalTime()),s=e.getHours(),o=e.getMinutes();i=s<10?"0"+s:s,t=o<10?"0"+o:o,this.txtTime.string=i+":"+t}},i.show=function(){var t=this;this.isShow||(this.isShow=!0,-1!=this.checkTimer&&normalTimer.stop(this.checkTimer),this.checkTimer=normalTimer.start(5,-1,(function(){t.onUpdate()})),f.GetBatteryRate(),c.frameRate=30,this.node.parent=this.nodeUIRoot.parent,this.sliderUnlock.progress=0,this.sliderBar.node.getComponent(h).contentSize=new r(0,92),m.uiCamera.enabled=!1,IS(C).setLowMode(!0),this.gostHitList[0].active=!1,this.gostHitList[1].active=!1,this.gostHitList[2].active=!1,this.action1.active=!1,this.action2.active=!1,this.action4.active=!0,this.UpdateTime(),this.reset(),this.onUpdate(),uiMgr.openFullScreenNum.add("LowModeView"))},i.showCharge=function(){d(this.charge)&&(this.charge.fillRange=Math.min(Number(f.BatteryRate)/100,1),this.txtCharge.string=Math.floor(parseInt(f.BatteryRate))+"%")},i.reset=function(){if(chapterDataCache.chapterType==g.Main){this.curChapterId=chapterDataCache.curChapterId;var t=chapterDataCache.getChapterConfig(chapterDataCache.curChapterId),i=U[t.level-1];this.txtChapter.string=""+GetLanguage_UI(i[0])+v[i[1]]+"  "+t.chapter+" - "+t.section+" "}},t}());i._RF.pop()}}}));

