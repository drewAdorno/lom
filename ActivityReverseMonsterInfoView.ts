System.register("chunks:///_virtual/ActivityReverseMonsterInfoView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./index57.ts","./BagDefine.ts","./BagModel.ts","./ResItems.ts","./MessageView.ts","./ActivityDefine.ts","./ActivityReverseControl.ts","./ActivityReverseDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,s,n,o,a,r,h,d,c,u,v,l,f;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,s=t.Button,n=t.Label,o=t.Sprite},function(t){a=t.V2},null,function(t){r=t.BagEventDefine},function(t){h=t.BagModel},function(t){d=t.ResItems},function(t){c=t.default},function(t){u=t.ActivityEventDefine},function(t){v=t.default},function(t){l=t.default},function(t){f=t.BaseView}],execute:function(){i._RF.push({},"04284Tge51LpajuaIjyecxD","ActivityReverseMonsterInfoView",void 0);var g=[1086];t("default",function(t){function i(){var e;return(e=t.call(this)||this).resItems=void 0,e.nodeModel=void 0,e.txtName=void 0,e.txtCD=void 0,e.btnLeft=void 0,e.btnRight=void 0,e.attrs=[],e.txtSkill=void 0,e.txtCost=void 0,e.imgCost=void 0,e.btnBuy=void 0,e.btnWear=void 0,e.btnRemove=void 0,e.monsterList=[],e.maxPage=0,e.curPage=0,e.monsterId=0,e.model=void 0,e.oprateType=0,e.name="ActivityReverseMonsterInfoView",e.url="ui/module/reverse/ActivityReverseMonsterInfoView",e}e(i,t);var f=i.prototype;return f.onInit=function(){var t=this,e=this.findChild("btnClose");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){t.close()})),this.resItems=new d(this),this.resItems.init(g),this.nodeModel=this.findChild("view/modelRoot"),this.txtName=this.findChildComponent("view/bgName/txtName",n),this.txtCD=this.findChildComponent("view/cd/Label",n),this.txtSkill=this.findChildComponent("view/skill/scroll/view/content/desc",n);for(var i=1;i<=5;i++){var a=this.findChildComponent("view/attr/attr"+i+"/txtValue",n);this.attrs.push(a)}this.btnLeft=this.findChild("view/btnLeft"),this.addComponentCallbackListener(this.btnLeft,s.EventType.CLICK,(function(){t.switchPage(-1)})),this.btnRight=this.findChild("view/btnRight"),this.addComponentCallbackListener(this.btnRight,s.EventType.CLICK,(function(){t.switchPage(1)})),this.imgCost=this.findChildComponent("view/oprate/btnBuy/cost/imgIcon",o),this.txtCost=this.findChildComponent("view/oprate/btnBuy/cost/txtNum",n),this.btnBuy=this.findChild("view/oprate/btnBuy"),this.addComponentCallbackListener(this.btnBuy,s.EventType.CLICK,(function(){if(0!=t.monsterId){var e=configReversion_war_chess.getDataByKey(t.monsterId),i=IS(l).getOpenDay();if(e.unlock_day-i>0)c.showFlyTip(GetLanguage(202018));else{if(e.spend.length>0)if(IS(h).getGoodsCountByGoodsGtid(e.spend[0][0])<e.spend[0][1])return void c.showFlyTip(GetLanguage(200069));IS(v).send_24_112(t.monsterId)}}})),this.btnWear=this.findChild("view/oprate/btnWear"),this.addComponentCallbackListener(this.btnWear,s.EventType.CLICK,(function(){var e=IS(l).getEmptyPos();if(null!=e)return IS(v).send_24_113([{k:e,v:t.monsterId}]),void t.close();var i=uiMgr.getOpenView("ActivityReverseQueueView");i&&i.selectWear(t.monsterId),t.close()})),this.btnRemove=this.findChild("view/oprate/btnRemove"),this.addComponentCallbackListener(this.btnRemove,s.EventType.CLICK,(function(){var e=IS(l).monsterEquipPos(t.monsterId);IS(v).send_24_113([{k:e,v:0}]),t.close()}))},f.registerUpdateHandler=function(){this.addEvent(u.OnActivityReverseUpdate,this.updateInfo,this),this.addEvent(r.GOODS_INFO_UPDATE,this.updateResShow,this)},f.onAfterOpen=function(){var t,e=this;this.updateResShow(),this.monsterId=this.openArgs[0],this.oprateType=this.openArgs[1],this.monsterList=IS(l).getMonsterList(),this.maxPage=this.monsterList.length;var i=(null!=(t=this.monsterList.findIndex((function(t){return t.id==e.monsterId})))?t:0)+1;this.setPage(i)},f.onBeforeClose=function(){this.curPage=0,this.maxPage=0,this.monsterId=0,this.monsterList=[]},f.onDestroy=function(){},f.updateResShow=function(){this.resItems.update()},f.setPage=function(t){if(this.curPage!=t){this.curPage=t;var e=this.monsterList[t-1];this.monsterId=e.id,this.updateSwitchBtn(),this.updateInfo()}},f.updateSwitchBtn=function(){this.maxPage>1?(this.btnLeft.active=this.curPage>1,this.btnRight.active=this.curPage<this.maxPage):(this.btnLeft.active=!1,this.btnRight.active=!1)},f.switchPage=function(t){if(t>0){if(this.curPage>=this.maxPage)return}else if(this.curPage<=1)return;var e=this.curPage+t;this.setPage(e)},f.updateInfo=function(){var t=configReversion_war_chess.getDataByKey(this.monsterId);if(this.txtName.string=t.name,this.txtCD.string=t.maxCd/1e3,this.txtSkill.string=t.desc,t.spend.length>0){var e=configGoods.getDataByKey(t.spend[0][0]);this.loadIcon(this.imgCost,e.icon_group,e.icon),this.txtCost.string=t.spend[0][1]}var i=configUnit.getDataByKey(t.unitId),s=configUnitModel.getDataByKey(i.model);this.model&&this.removeUIEffect(this.model);var n=new a(0,t.adjust_location||0);this.model=this.addUIEffect(s.path,this.nodeModel,-1,n,t.scaling),this.attrs[0].string=i.hp,this.attrs[1].string=String(Math.floor(i.att_speed/100)/100),this.attrs[2].string=i.att,this.attrs[3].string=t.range,this.attrs[4].string=t.speed;var o=1==IS(l).getInfo().monster_list[this.monsterId];this.btnBuy.active=!o;var r=IS(l).monsterEquipPos(this.monsterId);this.btnWear.active=2==this.oprateType&&o&&!r,this.btnRemove.active=2==this.oprateType&&o&&r},i}(f));i._RF.pop()}}}));

