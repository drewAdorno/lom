System.register("chunks:///_virtual/FrameDataCache.ts",["cc","./TimeUtil.ts","./ObjectUtil.ts","./TitleDefine.ts"],(function(t){"use strict";var e,i,r,s;return{setters:[function(t){e=t.cclegacy},function(t){i=t.default},function(t){r=t.default},function(t){s=t.TitleEventDefine}],execute:function(){e._RF.push({},"6e815Fg4NBNbK+sbBk4Ch80","FrameDataCache",void 0);t("FrameDataCache",function(){function t(){this.hasTitleList={},this.curFrameId=1,this.timerList={}}var e=t.prototype;return e.clear=function(){throw new Error("Method not implemented.")},e.setFrameInfo=function(t){this.hasTitleList={};for(var e=0;e<t.head_frame_list.length;e++){var i=t.head_frame_list[e];this.hasTitleList[i.cfg_id]=i}this.curFrameId=t.current_head_frame,this.updateTitleTime(),normalEvent.emit(s.Frame_INFO_UPDATE)},e.updateTitleTime=function(){var t=this;for(var e in this.timerList)normalTimer.stop(this.timerList[e]);this.timerList={};var r=function(e){var r=t.hasTitleList[e].end_time;r>0&&r>i.serverTime&&(t.timerList[e]=normalTimer.start(1,r-i.serverTime,(function(){if(!t.hasTitleList[e]&&t.timerList[e])return delete t.timerList[e],void normalTimer.stop(t.timerList[e]);var r=t.hasTitleList[e].end_time;(0==r||r<=i.serverTime)&&(t.curFrameId==Number(e)&&(t.curFrameId=0),normalTimer.stop(t.timerList[e]),delete t.timerList[e],delete t.hasTitleList[e],normalEvent.emit(s.Frame_INFO_UPDATE))})))};for(var a in this.hasTitleList)r(a)},e.setCurFrameId=function(t){this.curFrameId=t,normalEvent.emit(s.Frame_INFO_UPDATE)},e.checkHas=function(t){var e;return null!=(e=this.hasTitleList[t])&&e},e.checkHasTime=function(t){return!!this.hasTitleList[t]&&this.hasTitleList[t].end_time>0},e.getFrameTime=function(t){return this.hasTitleList[t]?this.hasTitleList[t].end_time:0},e.checkIsNew=function(t){return!!this.hasTitleList[t]&&1==this.hasTitleList[t].red_point},e.updateRedState=function(t){this.hasTitleList[t]&&(this.hasTitleList[t].red_point=0),normalEvent.emit(s.Frame_INFO_UPDATE)},e.CanUnLockFrame=function(){var t=0;for(var e in this.hasTitleList)1==this.hasTitleList[e].red_point&&(t+=1);return t},e.checkFrameCanShow=function(t){var e=configAvatar_frame.getDataByKey(t);if(null==e)return!1;var s=e.open_time;return!!r.isEmpty(s)||i.checkOpenTime(s)},t}());e._RF.pop()}}}));

