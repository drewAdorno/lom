System.register("chunks:///_virtual/ChapterCoinCC.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BattleData.ts","./index94.ts","./MetaAttrib.ts","./EnumDefine.ts","./EventDefine.ts","./V2.ts","./AudioMgr.ts","./MathUtil.ts","./ChapterDefine.ts","./DungeonControl.ts","./MessageView.ts","./ChapterNormal.ts"],(function(t){"use strict";var n,e,i,o,a,r,u,s,c,l,f,p,h,d;return{setters:[function(t){n=t.inheritsLoose,e=t.regeneratorRuntime},function(t){i=t.cclegacy},function(t){o=t.ChapterType},null,function(t){a=t.AttribDefine},function(t){r=t.UnityType},function(t){u=t.EventDefine},function(t){s=t.V2},function(t){c=t.audioMgr},function(t){l=t.default},function(t){f=t.ChapterEventDefine},function(t){p=t.default},function(t){h=t.default},function(t){d=t.ChapterNormal}],execute:function(){i._RF.push({},"fcd5bFPwABDXKDyB73ilNtl","ChapterCoinCC",void 0);var C=new s(0,0);t("ChapterCoinCC",function(t){function i(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).bossUnit=void 0,n.oldHp=0,n}n(i,t);var s=i.prototype;return s.init=function(){battleEvent.on(u.UnitHpChange,this.onHpChange,this)},s.getConfig=function(t){return configCoin_chapter.getDataByKey(t)},s.start=function(){t.prototype.start.call(this),c.playMusic("bgm_shendengxiaotou")},s.endResult=e().mark((function t(n,i,a){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,coroutine.wait(1);case 2:c.playMusic("battle"),battleMain.enterChapter(),0==i&&battleMain.checkCheat()&&(i=1,h.showBoxTip({tip:GetLanguage(200998),btnCnt:1,func:function(t){},ensure:GetLanguage(200129)})),battleMain.curRecord&&battleMain.curRecord.manual?IS(p).reqDungeonBattleResult(o.Coin,n,i,1,battleMain.curRecord.collects):IS(p).reqDungeonBattleResult(o.Coin,n,i),normalEvent.emit(f.BATTLE_STATE,o.Coin,!1),battleMain.toResult(n,o.Coin,i,a);case 8:case"end":return t.stop()}}),t)})),s.toResult=function(t,n){void 0===n&&(n=!1);this.battleMain;var e=this.config;coroutine.start(this.endResult(e.id,t,n),"battle")},s.onAddMonster=function(t){t.config.type==r.NotHurtBoss&&(this.bossUnit=t,this.oldHp=t.data.currenHp)},s.onHpChange=function(t){if(this.bossUnit==t&&t.data.currenHp<this.oldHp&&(this.oldHp-t.data.currenHp)/t.data.getAttribByInt(a.hp)*100>=5){this.oldHp=t.data.currenHp;var n=battleMain.renderMgr.allocEffect(60001);C.set(t.position),C.add2f(l.random(-100,100),l.random(-50,50)),n.position=C}},i}(d));i._RF.pop()}}}));

