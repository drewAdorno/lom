System.register("chunks:///_virtual/SkillModel.ts",["cc","./StringUtil.ts","./TimeUtil.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./BagModel.ts","./MessageView.ts","./SkillDataCache.ts"],(function(t){"use strict";var i,e,l,n,r,o,s,a;return{setters:[function(t){i=t.cclegacy},function(t){e=t.default},function(t){l=t.default},function(t){n=t.ConfigGlobal},function(t){r=t.default},function(t){o=t.BagModel},function(t){s=t.default},function(t){a=t.SkillDataCache}],execute:function(){i._RF.push({},"6bc49NcMgZBKYKinOK1r6x8","SkillModel",void 0);var u=n.skill_system;t("SkillModel",function(){var t=i.prototype;function i(){}return t.clear=function(){},t.getActiveSkillList=function(){for(var t=new Array,i=1;i<=6;i++){var e=IS(a).activePosIdToInfo[i];r.isEmpty(e)?t.push({pos_id:i,skill_id:-1,skill_lv:0}):t.push(e)}return t.sort((function(t,i){return t.pos_id<i.pos_id?-1:1})),t},t.getPassiveSkillList=function(){for(var t=[],i=IS(a).passiveSkillList,e=0;e<i.length;e++){var l=i[e],n=configSkill.getDataByKey(l.skill_id);null!=n?3!=n.type&&4!=n.type&&5!=n.type||t.push(l):printLogErr("没有技能配置"+l.skill_id)}return t},t.checkPosUnlock=function(t){return!r.isEmpty(IS(a).activePosIdToInfo[t])},t.getActiveSkillByPos=function(t){return IS(a).activePosIdToInfo[t]},t.getSkillWearPos=function(t){for(var i in IS(a).activePosIdToInfo){if(IS(a).activePosIdToInfo[i].skill_id==t)return i}return 0},t.getEmptyPosList=function(){var t,i=[];for(var e in IS(a).activePosIdToInfo){var l=IS(a).activePosIdToInfo[e];if(0==l.skill_id)t=l.pos_id,0!=configSkill_pos.getDataByKey(t).type&&i.push(t)}return i},t.getEmptyPos=function(){return this.getEmptyPosList()[0]},t.getSystemSkillInfoBySkillId=function(t){return IS(a).systemSkillIdToInfo[t]},t.tryShowPosLockTips=function(t){var i=configSkill_pos.getDataByKey(t);s.showFlyTip(i.desc)},t.checkSkillCanUpgrade=function(t){var i=this.getSystemSkillInfoBySkillId(t);if(r.isEmpty(i))return!1;if(!this.checkSkillCanShow(t))return!1;var e=i.skill_lv,l=configSkill_level.getDataByKeys("id",t,"level",e+1);if(r.isEmpty(l))return!1;for(var n=l.expend||[],s=0;s<n.length;s++)if(IS(o).getGoodsCountByGoodsGtid(n[s][0])<n[s][1])return!1;return!0},t.getSkillAttrs=function(){return IS(a).skillIdToAttr},t.getSkillAttrInfoByCfgId=function(t){return IS(a).skillIdToAttr[t]},t.getSkillAttrByAttrId=function(t,i){var e=this.getSkillAttrInfoByCfgId(t);return r.isEmpty(e)?0:e[i]||0},t.getSkillFactAttrValue=function(t,i,e){var l=t;l=l+this.getSkillAttrByAttrId(i,e)+this.getSkillAttrByAttrId(0,e);var n=configAttribute.getDataByList("group",e);if(null==n||n.length<=0)return l;for(var r=0;r<n.length;r++)l*=1+(this.getSkillAttrByAttrId(i,n[r].id)+this.getSkillAttrByAttrId(0,n[r].id))/1e4;return l},t.getCurTab=function(){return IS(a).curTab},t.getCurTabInfo=function(){return this.getTabInfo(IS(a).curTab)},t.getTabInfo=function(t){if(null!=t)return IS(a).tabToInfo[t]},t.getTabName=function(t){var i=this.getTabInfo(t),l=i&&i.name;return l&&""!=l||(l=e.formatStrWithMirrorDeal(GetLanguage(200488),GetLanguage(200662+t))),l},t.checkHasSkillByQuality=function(t){for(var i=0;i<u.length;i++){var e=u[i],l=this.getSystemSkillInfoBySkillId(e);if(null!=l&&!(l.skill_lv<=0)){var n=configSkill.getDataByKey(l.skill_id);if(null!=n&&n.quality==t)return!0}}return!1},t.checkAnySkillCompose=function(){for(var t=0;t<u.length;t++)if(this.checkSkillCanCompose(u[t]))return!0;return!1},t.checkSkillCanCompose=function(t){var i=this.getSystemSkillInfoBySkillId(t);if(r.isEmpty(i))return!1;if(!this.checkSkillCanShow(t))return!1;var e=i.skill_lv,l=configSkill_level.getDataByKeys("id",t,"level",e+1);if(!r.isEmpty(l))return!1;var n=configSkill_level.getDataByKeys("id",t,"level",e).expend[0][0],s=configMix.getDataByKey(n);if(null==s)return!1;var a=s.cost;if(!a||0==a)return!1;var u=s.quality+1;return!!this.checkHasSkillByQuality(u)&&IS(o).getGoodsCountByGoodsGtid(n)>=a},t.getAllComposeSkill=function(){for(var t=[],i=0;i<u.length;i++){var e=this.getSkillComposeNum(u[i]);0!=e.v&&t.push(e)}return t},t.getSkillComposeNum=function(t){var i=this.getSystemSkillInfoBySkillId(t);if(r.isEmpty(i))return{k:0,v:0};var e=i.skill_lv,l=configSkill_level.getDataByKeys("id",t,"level",e+1);if(!r.isEmpty(l))return{k:0,v:0};var n=configSkill_level.getDataByKeys("id",t,"level",e).expend[0][0],s=configMix.getDataByKey(n);if(null==s)return{k:n,v:0};var a=s.cost;if(!a||0==a)return{k:n,v:0};var u=s.quality+1;if(!this.checkHasSkillByQuality(u))return{k:n,v:0};var f=IS(o).getGoodsCountByGoodsGtid(n);return{k:n,v:Math.floor(f/a)}},t.checkSkillCanShow=function(t){var i=configSkill.getDataByKey(t);if(null==i)return!1;var e=i.open_time;return!!r.isEmpty(e)||l.checkOpenTime(e)},i}());i._RF.pop()}}}));

