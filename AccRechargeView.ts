System.register("chunks:///_virtual/AccRechargeView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./MessageView.ts","./MainViewModel.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,s,a,o,c,r,h,d,l,f,u,v,m,L,g,p,T,C,b,y,I,G;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,s=t.Button,a=t.sys,o=t.HorizontalTextAlignment,c=t.Label,r=t.ScrollView,h=t.ProgressBar,d=t.js},function(t){l=t.ItemGrid},function(t){f=t.ListItem},function(t){u=t.default},function(t){v=t.default},null,function(t){m=t.default},function(t){L=t.MainViewModel},function(t){g=t.default},function(t){p=t.default},function(t){T=t.ActivityState,C=t.ActivityEventDefine,b=t.ActivityType,y=t.ActivityTaskState},function(t){I=t.PanelTabType},function(t){G=t.BaseView}],execute:function(){n._RF.push({},"e1bffzHSWNL3I1fMkE4r+lK","AccRechargeView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).taskList=void 0,i.infoList=void 0,i.curIndex=void 0,i.tabList=[],i.txtLeftTime=void 0,i.deltaTime=0,i.leftTime=0,i.canUpdate=!1,i.titleList=[],i.name="AccRechargeView",i.url="ui/module/activity/AccRechargeView",i}i(n,t);var h=n.prototype;return h.onInit=function(){var t=this,i=this.findChild("btnClose");this.addComponentCallbackListener(i,s.EventType.CLICK,(function(){t.onCloseClick()}));var e=this.findChild("bg/btnRule");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){m.showBoxTip({title:GetLanguage(201066),tip:GetLanguage(201067),btnCnt:1,horizontalAlign:a.uiMirror?o.RIGHT:o.LEFT})}));var n=this.findChildComponent("view/tip/content/txtTips",c);n.string=GetLanguage(201087),a.uiMirror&&(n.horizontalAlign=o.RIGHT);var h=this.findChildComponent("view/taskList",r);this.taskList=this.addUIList(h,R,!0),this.curIndex=null,this.tabList=[];for(var d=function(i){t.findChild("tab/content/item"+i);var e={itemGo:t.findChild("tab/content/item"+i),normalSelect:t.findChild("tab/content/item"+i+"/normal"),select:t.findChild("tab/content/item"+i+"/selected"),red:t.findChild("tab/content/item"+i+"/red"),index:1};t.addComponentCallbackListener(e.itemGo,s.EventType.CLICK,(function(){t.RefreshSelectActivity(i)})),t.tabList[i]=e},l=0;l<3;l++)d(l);this.titleList=[];for(var f=0;f<3;f++)this.titleList[f]=this.findChild("title/item"+f),this.titleList[f].active=!1;this.txtLeftTime=this.findChildComponent("view/timeCount/txtTime",c),a.uiMirror&&this.txtLeftTime.node.setScale(1,1,1)},h.onCloseClick=function(){this.close()},h.RefreshSelectActivity=function(t){if(printLogErr("RefreshSelectActivity",t),this.curIndex!=t){for(var i,e=0;e<3;e++)this.titleList[e].active=e==t;for(var n=0;n<this.tabList.length;n++)this.tabList[n].normalSelect.active=t!=n,this.tabList[n].select.active=t==n;this.curIndex=t;var s=null!=(i=this.infoList[t].state_time[this.infoList[t].state])?i:this.infoList[t].state_time[T.Open];this.leftTime=s.end_time-v.serverTime,this.leftTime>0?(this.canUpdate=!0,this.txtLeftTime.string=v.formatTimeStringForSecond(this.leftTime)):this.txtLeftTime.string=GetLanguage(200026),this.RefreshScroll()}},h.RefreshScroll=function(){var t=[];for(var i in this.taskList.datas=t,this.infoList[this.curIndex].task_list)this.infoList[this.curIndex].task_list.hasOwnProperty(i)&&t.push(this.infoList[this.curIndex].task_list[i]);t.sort((function(t,i){return 1==t.state&&1!=i.state?-1:1!=t.state&&1==i.state?1:t.state!=i.state?t.state-i.state:t.id-i.id})),this.taskList.datas=t,this.taskList.scrollTo(0)},h.registerUpdateHandler=function(){this.addEvent(C.OnActivityInfoTaskUpdate,this.OnTaskUpdate,this),this.addEvent(C.OnActivityInfoUpdate,this.OnTaskUpdate,this),this.addEvent(C.OnActivityTaskReward,this.OnTaskUpdate,this)},h.onAfterOpen=function(){IS(g).send_24_14(b.AccRechargeDaily),IS(g).send_24_14(b.AccRechargeTotal),IS(g).send_24_14(b.AccRechargeDay),this.infoList=[],this.infoList[0]=IS(p).GetActivityInfo(b.AccRechargeDaily),this.infoList[1]=IS(p).GetActivityInfo(b.AccRechargeTotal),this.infoList[2]=IS(p).GetActivityInfo(b.AccRechargeDay),this.tabList[0].red.active=IS(p).GetTaskRedNum(b.AccRechargeDaily)>0,this.tabList[1].red.active=IS(p).GetTaskRedNum(b.AccRechargeTotal)>0,this.tabList[2].red.active=IS(p).GetTaskRedNum(b.AccRechargeDay)>0,this.curIndex=null;for(var t,i=-1,n=e(this.infoList.entries());!(t=n()).done;){var s=t.value,a=s[0];s[1]?(this.tabList[a].itemGo.active=!0,-1==i&&(i=a)):this.tabList[a].itemGo.active=!1}this.RefreshSelectActivity(i)},h.onBeforeClose=function(){},h.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=v.formatTimeStringForSecond(this.leftTime):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},h.onDestroy=function(){},h.OnTaskUpdate=function(){this.tabList[0].red.active=IS(p).GetTaskRedNum(b.AccRechargeDaily)>0,this.tabList[1].red.active=IS(p).GetTaskRedNum(b.AccRechargeTotal)>0,this.tabList[2].red.active=IS(p).GetTaskRedNum(b.AccRechargeDay)>0,this.taskList.updateAll(),this.RefreshScroll()},n}(G));var R=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).txtDesc=void 0,i.btnGet=void 0,i.received=void 0,i.btnGotoRecharge=void 0,i.pb=void 0,i.schedule=void 0,i.rewardScroll=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this,i=this.view;this.txtDesc=u.findChildComponent(this.node,"txtDesc",c),this.pb=u.findChildComponent(this.node,"ProgressBar",h),this.schedule=u.findChildComponent(this.node,"ProgressBar/schedule",c),this.received=u.findChild(this.node,"received"),this.btnGotoRecharge=u.findChild(this.node,"btnGotoRecharge"),this.view.addComponentCallbackListener(this.btnGotoRecharge,s.EventType.CLICK,(function(){IS(L).TryJumpToMainViewPanel(I.Main_Shop,I.Shop_Limit,[0])&&(i.close(),uiMgr.close("ActivityOpenListView"))})),this.btnGet=u.findChild(this.node,"btnGet"),this.view.addComponentCallbackListener(this.btnGet,s.EventType.CLICK,(function(){IS(g).send_24_15(i.infoList[i.curIndex].activityCfg.type,t.data.task_id,t.data.group_id)}));var e=u.findChildComponent(this.node,"ScrollView",r);this.rewardScroll=i.addUIList(e,S),this.rewardScroll.virtual=!1},n.onRender=function(t,i){this.txtDesc.string=t.cfg.desc,this.rewardScroll.datas=t.cfg.reward;var e=25==t.cfg.condition[0];this.schedule.string=d.formatStr("%s/%s",e?t.count/100:t.count,e?t.cfg.condition[2]/100:t.cfg.condition[2]),this.pb.progress=t.count/t.cfg.condition[2],t.state==y.CanGet?(this.received.active=!1,this.btnGotoRecharge.active=!1,this.btnGet.active=!0):t.state==y.HadGet?(this.received.active=!0,this.btnGotoRecharge.active=!1,this.btnGet.active=!1):(this.received.active=!1,this.btnGotoRecharge.active=!0,this.btnGet.active=!1)},e}(f),S=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.itemGridNode=u.findChild(this.node,"itemGrid"),this.itemGrid=new l(this.view,this.itemGridNode)},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1])},e}(f);n._RF.pop()}}}));

