System.register("chunks:///_virtual/GvGFightInfoView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts","./TimeUtil.ts","./BaseView.ts","./MessageView.ts","./RoleDataCache.ts","./GvGControl.ts","./GvGDataCache.ts","./GvGDefine.ts","./GvGModel.ts"],(function(t){"use strict";var i,e,n,o,s,h,a,r,d,m,f,c,u,g,l,v,C,G;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.Label,s=t.Sprite,h=t.HorizontalTextAlignment,a=t.sys,r=t.Layout,d=t.js},function(t){m=t.default},function(t){f=t.default},function(t){c=t.BaseView},function(t){u=t.default},function(t){g=t.RoleDataCache},function(t){l=t.default},function(t){v=t.GvGDataCache},function(t){C=t.GvGEventDefine},function(t){G=t.GvGModel}],execute:function(){e._RF.push({},"e26fayFRGlH3oMVR0Cb42d9","GvGFightInfoView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).txtTitle=void 0,i.txtNameMine=void 0,i.txtNameEnemy=void 0,i.txtServerMine=void 0,i.txtServerEnemy=void 0,i.txtFightPowerMine=void 0,i.txtFightPowerEnemy=void 0,i.imgHeadMine=void 0,i.imgHeadEnemy=void 0,i.curFightInfo=void 0,i.txtTime=void 0,i.road=void 0,i.time=0,i.curEndTime=void 0,i.hasReq=!1,i.name="GvGFightInfoView",i.url="ui/module/gvg/GvGFightInfoView",i}i(e,t);var c=e.prototype;return c.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.onMaskClick()})),this.txtTitle=this.findChildComponent("content/title/txtTitle",o),this.txtNameMine=this.findChildComponent("content/name1/txtName",o),this.txtNameEnemy=this.findChildComponent("content/name2/txtName",o),this.txtServerMine=this.findChildComponent("content/name1/txtServer",o),this.txtServerEnemy=this.findChildComponent("content/name2/txtServer",o),this.txtFightPowerMine=this.findChildComponent("content/fightPower1/txtFightPower",o),this.txtFightPowerEnemy=this.findChildComponent("content/fightPower2/txtFightPower",o),this.imgHeadMine=this.findChildComponent("content/imgHead1",s),this.imgHeadEnemy=this.findChildComponent("content/imgHead2",s),this.txtTime=this.findChildComponent("content/time/txtTime",o);var e=this.findChild("content/btnTip");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){u.showBoxTip({tip:GetLanguage(201857),btnCnt:1,horizontalAlign:h.LEFT})})),a.uiMirror&&(this.loadIcon(this.findChildComponent("content/imgVs",s),"farm","zy_ui_vs"),this.dealMirrorLayout(this.findChildComponent("content/time",r)),this.dealMirrorLayout(this.findChildComponent("content/name1",r)),this.dealMirrorLayout(this.findChildComponent("content/name2",r)))},c.registerUpdateHandler=function(){this.addEvent(C.GVG_FIGHT_INFO_BACK,this.onGvGFightInfoBack,this),this.addEvent(C.GVG_ROAD_INFO_UPDATE,this.onGvGRoadInfoUpdate,this)},c.onMaskClick=function(){this.close()},c.onAfterOpen=function(){this.road=this.openArgs[0];var t="";switch(this.road){case 1:t=GetLanguage(200387);break;case 2:t=GetLanguage(200388);break;case 3:t=GetLanguage(200389)}this.txtTitle.string=t,IS(l).reqGvGFightInfo(this.road)},c.updateFightInfo=function(){if(this.curFightInfo){this.curEndTime=this.curFightInfo.end_time;var t=this.curFightInfo.player,i=this.curFightInfo.enemy_player;this.txtNameMine.string=t.name,this.txtNameEnemy.string=i.name,this.txtServerMine.node.active=1==IS(v).ifCross,this.txtServerEnemy.node.active=1==IS(v).ifCross,1==IS(v).ifCross&&(this.txtServerMine.string=d.formatStr("[s%s]",IS(g).GetServerId()),this.txtServerEnemy.string=d.formatStr("[s%s]",IS(v).enemyServerId)),this.txtFightPowerMine.string=d.formatStr("%s%s",GetLanguage_UI(999000196),m.GetNumString(t.power)),this.txtFightPowerEnemy.string=d.formatStr("%s%s",GetLanguage_UI(999000196),m.GetNumString(i.power)),this.loadRemoteIcon(t.head.url,this.imgHeadMine),this.loadRemoteIcon(i.head.url,this.imgHeadEnemy)}},c.onUpdate=function(t){this.time=this.time+t,this.time>=1&&(this.updateTime(),this.time=0)},c.updateTime=function(){if(this.curEndTime){var t=this.curEndTime-f.serverTime;this.txtTime.string=f.formatTimeForSecond(Math.max(0,t)),t<=0&&!this.hasReq&&(IS(l).reqGvGFightInfo(this.road),this.hasReq=!0)}},c.onBeforeClose=function(){this.curFightInfo=null,this.time=0,this.hasReq=!1},c.onDestroy=function(){},c.onGvGFightInfoBack=function(t){this.hasReq=!1,this.curFightInfo=t,this.updateFightInfo()},c.onGvGRoadInfoUpdate=function(t){t==this.road&&(2==IS(G).getRoadInfo(this.road).status?this.updateFightInfo():this.close())},e}(c));e._RF.pop()}}}));

