System.register("chunks:///_virtual/ReturnNewChargeView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./MessageView.ts","./MainViewModel.ts","./RoleDataCache.ts","./ReturnControl.ts","./ReturnDataCache.ts","./ReturnDefine.ts","./UIDefine.ts","./BaseSubView.ts"],(function(e){"use strict";var t,n,i,a,o,s,r,h,c,d,l,g,f,u,v,I,y;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e.Label,a=e.Button,o=e.RichText,s=e.ProgressBar,r=e.js},function(e){h=e.default},function(e){c=e.default},null,function(e){d=e.default},function(e){l=e.MainViewModel},function(e){g=e.RoleDataCache},function(e){f=e.default},function(e){u=e.ReturnDataCache},function(e){v=e.ReturnEventDefine},function(e){I=e.PanelTabType},function(e){y=e.BaseSubView}],execute:function(){n._RF.push({},"29e39fGeVhE65UIS6iQTR+T","ReturnNewChargeView",void 0);e("default",function(e){function n(){var t;return(t=e.call(this)||this).chargeDes=void 0,t.chargeTotalMoney=void 0,t.bangId=0,t.bandBtn=void 0,t.chargeTaskItemList=[],t.chargeTaskItemInfo=[{type:1,des:GetLanguage(204738),cfg:function(e){return configBack_level_rebate.getDataByKey(e)},getMoney:0,totalMoney:0,rewardState:!1,curTaskId:0,clickFunc:function(){t.parentView.close()}},{type:2,des:GetLanguage(204747),cfg:function(e){return configBack_pay_rebate.getDataByKey(e)},getMoney:0,totalMoney:0,rewardState:!1,curTaskId:0,clickFunc:function(){IS(l).TryJumpToMainViewPanel(I.Main_Shop,I.Shop_Limit),t.parentView.close()}}],t.name="ReturnNewChargeView",t.url="ui/module/return/ReturnNewChargeView",t.poolTime=3e3,t}t(n,e);var o=n.prototype;return o.onInit=function(){this.chargeDes=this.findChildComponent("container/chargeDes/des",i),this.chargeTotalMoney=this.findChildComponent("container/chargeDes/money",i),this.bandBtn=this.findChild("container/chargeDes/btnBang"),this.addComponentCallbackListener(this.bandBtn,a.EventType.CLICK,(function(){uiMgr.openView("ReturnBindOldRoleView")}));for(var e=0;e<this.chargeTaskItemInfo.length;e++){var t=new p(this,this.findChild("container/content/"+(e+1)));this.chargeTaskItemList.push(t)}},o.onAfterOpen=function(){IS(f).send_return_act_rebate_info_c2s(),this.refreshInfo()},o.registerUpdateHandler=function(){this.addEvent(v.UpdateReturnChargeInfo,this.refreshInfo)},o.refreshInfo=function(){var e=IS(u).GetActChargeInfo();if(e){this.bangId=e.role_id,this.chargeTaskItemInfo[0].curTaskId=e.level_id,this.chargeTaskItemInfo[1].curTaskId=e.charge_id,this.chargeTaskItemInfo[0].totalMoney=e.level_total,this.chargeTaskItemInfo[1].totalMoney=e.charge_total,this.chargeTaskItemInfo[0].getMoney=e.level_get,this.chargeTaskItemInfo[1].getMoney=e.charge_get,e.role_id>1?(e.level_id>0&&(this.chargeTaskItemInfo[0].rewardState=IS(u).GetActChargeRewardState(configBack_level_rebate.getDataByKey(e.level_id))),e.charge_id>0&&(this.chargeTaskItemInfo[1].rewardState=IS(u).GetActChargeRewardState(configBack_pay_rebate.getDataByKey(e.charge_id))),this.chargeDes.string=GetLanguage(204739),this.chargeTotalMoney.node.active=!0,this.chargeTotalMoney.string=((e.charge_total+e.level_total)/100).toString(),this.bandBtn.active=!1):(this.chargeDes.string=GetLanguage(204740),this.chargeTotalMoney.node.active=!1,this.bandBtn.active=!0);for(var t=0;t<this.chargeTaskItemList.length;t++)this.chargeTaskItemList[t].Refresh(this.chargeTaskItemInfo[t])}},o.onBeforeClose=function(){},o.onDestroy=function(){},n}(y));var p=function(){function e(e,t){var n=this;this.btnGet=void 0,this.btnGoto=void 0,this.view=void 0,this.node=void 0,this.totalMoney=void 0,this.taskDes=void 0,this.rewardMoney=void 0,this.ProgressBar=void 0,this.schedule=void 0,this.full=void 0,this.data=void 0,this.view=e,this.node=t,this.btnGoto=h.findChild(this.node,"gotoBtn"),this.view.addComponentCallbackListener(this.btnGoto,a.EventType.CLICK,(function(){n.view.bangId<=1?d.showFlyTip(GetLanguage(104398)):n.data.clickFunc()})),this.totalMoney=h.findChildComponent(this.node,"progeress/totalMoney",i),this.taskDes=h.findChildComponent(this.node,"progeress/taskDes",o),this.rewardMoney=h.findChildComponent(this.node,"progeress/rewardMoney",i),this.ProgressBar=h.findChildComponent(this.node,"progeress/ProgressBar",s),this.schedule=h.findChildComponent(this.node,"progeress/ProgressBar/schedule",i),this.full=h.findChild(this.node,"progeress/full"),this.btnGet=h.findChild(this.node,"btnGet"),this.view.addComponentCallbackListener(this.btnGet,a.EventType.CLICK,(function(){IS(f).send_return_act_rebate_reward_c2s(n.data.type)}))}return e.prototype.Refresh=function(e){if(this.data=e,e.curTaskId>0){this.ProgressBar.node.active=!0,this.taskDes.node.active=!0,this.full.active=!1;var t=e.cfg(e.curTaskId),n=0,i=0;1==e.type?(n=IS(g).GetLevel(),i=t.level):(n=IS(u).GetActChargeInfo().charge,i=t.number),n>i&&(n=i);var a=r.formatStr("<color=fb414e>%s</color>/%s",n,i);n>=i?(a=r.formatStr("%s/%s",n,i),this.btnGoto.active=!1,this.btnGet.active=!0):(this.btnGoto.active=!0,this.btnGet.active=!1),this.taskDes.string=r.formatStr("<b><color=#805133>%s</color></b>",c.formatStrWithMirrorDeal(e.des,a)),this.ProgressBar.progress=n/i,this.schedule.string=n+"/"+i,this.rewardMoney.node.active=!0}else this.ProgressBar.node.active=!1,this.taskDes.node.active=!1,this.full.active=!0,this.btnGoto.active=!1,this.btnGet.active=!1,this.rewardMoney.node.active=!1;this.view.bangId>0?(this.totalMoney.string=(e.totalMoney/100).toString(),this.rewardMoney.string=(e.getMoney/100).toString()):(this.full.active=!1,this.rewardMoney.string="????",this.totalMoney.string="????",this.btnGoto.active=!0,this.btnGet.active=!1)},e}();n._RF.pop()}}}));

