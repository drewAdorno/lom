System.register("chunks:///_virtual/SeasonTreasureListView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./BagModel.ts","./SeasonDataCache.ts","./SeasonDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var i,e,n,o,s,a,r,l,d,h,c,u,f,v,p,g,m,C,I,S;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.ScrollView,s=t.Button,a=t.Label,r=t.Sprite,l=t.LabelOutline,d=t.Color,h=t.sys,c=t.RichText},function(t){u=t.ListItem},function(t){f=t.default},function(t){v=t.default},null,function(t){p=t.IconAseetType},function(t){g=t.BagModel},function(t){m=t.SeasonDataCache},function(t){C=t.SeasonShipEventDefind,I=t.TREASURE_QUALITY_TO_INFO},function(t){S=t.BaseSubView}],execute:function(){n._RF.push({},"5c0deS744dLZKJgCq4y5fHe","SeasonTreasureListView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).scroll=void 0,i.btnOwn=void 0,i.btnAll=void 0,i.nodeNone=void 0,i.name="SeasonTreasureListView",i.url="ui/module/season/SeasonTreasureListView",i.poolTime=0,i}i(n,t);var a=n.prototype;return a.onInit=function(){var t=this,i=this.findChildComponent("root/nodeScroll/scrollList",o);this.scroll=this.addUIList(i,y,!0,0),this.btnOwn=this.findChild("root/nodeScroll/content/own"),this.addComponentCallbackListener(this.btnOwn,s.EventType.CLICK,(function(){t.switchBtn(1)})),this.btnAll=this.findChild("root/nodeScroll/content/all"),this.addComponentCallbackListener(this.btnAll,s.EventType.CLICK,(function(){t.switchBtn(2)})),this.nodeNone=this.findChild("root/nodeScroll/nodeNone")},a.registerUpdateHandler=function(){this.addEvent(C.TYPE_TREASURE_LIST_UPDATE,this.updateInfo,this)},a.onAfterOpen=function(){this.switchBtn(1)},a.switchBtn=function(t){f.findChild(this.btnOwn,"selected").active=1==t,f.findChild(this.btnAll,"selected").active=2==t,1==t?this.showScrollItem(1):2==t&&this.showScrollItem(2)},a.showScrollItem=function(t){this.nodeNone.active=!1;var i=[];if(1==t){for(var n,o=e(IS(m).treasureList);!(n=o()).done;){var s=n.value,a=configSeason_treasure.getDataByKeys("id",s.id,"level",0);if(s&&1==s.state)i.push(a);else{var r=a.cost[0];IS(g).getGoodsCountByGoodsGtid(r[0])>0&&i.push(a)}}0==i.length&&(this.nodeNone.active=!0,this.scroll.node.active=!1)}else 2==t&&(this.scroll.node.active=!0,i=configSeason_treasure.getDataByList("level",0));for(var l,d=[],h=[],c=[],u=e(i);!(l=u()).done;){var f=l.value;1==f.type?d.push(f):2==f.type?h.push(f):3==f.type&&c.push(f)}var v=[];c.length>0&&(c.sort((function(t,i){return t.id-i.id})),v.push({title:GetLanguage(204605),info:c,quality:3})),h.length>0&&(h.sort((function(t,i){return t.id-i.id})),v.push({title:GetLanguage(204604),info:h,quality:2})),d.length>0&&(d.sort((function(t,i){return t.id-i.id})),v.push({title:GetLanguage(204603),info:d,quality:1})),this.scroll.datas=v},a.onBeforeClose=function(){},a.onDestroy=function(){},a.updateInfo=function(){this.scroll.updateAll(),IS(m).checkTreasureListRP()},n}(S));var y=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtTitle=void 0,i.imgTitleBG=void 0,i.scroll=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.adaptiveSize=!0,this.txtTitle=f.findChildComponent(this.node,"title/Label",a),this.imgTitleBG=f.findChildComponent(this.node,"title",r);var t=f.findChildComponent(this.node,"scroll",o);this.scroll=this.view.addUIList(t,L,!1,0),this.scroll.touchEvent=!1},n.onRender=function(t,i){this.txtTitle.string=t.title,this.txtTitle.node.getComponent(l).color=new d(I[t.quality].color),this.view.loadIcon(this.imgTitleBG,"season_treasure",I[t.quality].titleBG);var e=300*Math.ceil(t.info.length/2);this.scroll.height=e,this.scroll.datas=t.info,this.ut.height=80+e,h.uiMirror&&this.txtTitle.node.setScale(1,1,1)},e}(u),L=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).imgBg=void 0,i.imgIcon=void 0,i.imgNameBg=void 0,i.txtName=void 0,i.nodeUnlock=void 0,i.starUIList=void 0,i.nodeLock=void 0,i.pieceIcon=void 0,i.pieceNum=void 0,i.rp=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.imgBg=f.findChildComponent(this.node,"img1",r),this.imgIcon=f.findChildComponent(this.node,"icon",r),this.imgNameBg=f.findChildComponent(this.node,"name/bg",r),this.txtName=f.findChildComponent(this.node,"name/name",a),this.rp=f.findChild(this.node,"rp"),this.nodeUnlock=f.findChild(this.node,"nodeUnlock");var i=f.findChildComponent(this.node,"nodeUnlock/ScrollView",o);this.starUIList=this.view.addUIList(i,w,!1,0),this.nodeLock=f.findChild(this.node,"nodeLock"),this.pieceIcon=f.findChildComponent(this.node,"nodeLock/icon",r),this.pieceNum=f.findChildComponent(this.node,"nodeLock/Label",c),this.view.addComponentCallbackListener(this.node,s.EventType.CLICK,(function(){uiMgr.openView("SeasonTreasureDetailView",t.data.id)}))},n.onRender=function(t,i){this.view.loadIcon(this.imgBg,"season_treasure",I[t.type].itemBG),this.view.loadIcon(this.imgNameBg,"season_treasure",I[t.type].nameBG),this.view.loadIcon(this.imgIcon,"season_equip",t.icon,null,p.ICON_SPRITE),this.txtName.string=t.name,this.txtName.node.getComponent(l).color=new d(I[t.type].color);var e=IS(m).getTreasureInfoById(this.data.id);if(e&&1==e.state){if(this.nodeUnlock.active=!0,this.nodeLock.active=!1,this.refreshStar(e.star),configSeason_treasure.getDataByKeys("id",t.id,"level",e.star+1)){var n=configSeason_treasure.getDataByKeys("id",t.id,"level",e.star).cost[0];IS(g).getGoodsCountByGoodsGtid(n[0])>=n[1]?this.rp.active=!0:this.rp.active=!1}else this.rp.active=!1}else{this.nodeUnlock.active=!1,this.nodeLock.active=!0;var o=configSeason_treasure.getDataByKeys("id",t.id,"level",e.star).cost[0];this.view.loadIcon(this.pieceIcon,"icon_item",o[0]);var s,a,r=IS(g).getGoodsCountByGoodsGtid(o[0]);r>=o[1]?(this.rp.active=!0,s="#5aff42",a="#27720d"):(this.rp.active=!1,s="#ff1f1f",a="#891000"),this.pieceNum.string=v.formatStr("<b><outline color=##1 width=2><color=##2>##3</color></outline>/##4</b>",a,s,r,o[1])}},n.refreshStar=function(t){for(var i=[0,0,0,0,0],e=0;e<t;e++){i[e%5]+=1}this.starUIList.datas=i},e}(u),w=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).imgOne=void 0,i.imgTwo=void 0,i.imgThree=void 0,i.imgDark=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.imgOne=f.findChild(this.node,"one"),this.imgTwo=f.findChild(this.node,"two"),this.imgThree=f.findChild(this.node,"three"),this.imgDark=f.findChild(this.node,"dark")},n.onRender=function(t,i){this.imgDark.active=0==t,this.imgOne.active=1==t,this.imgTwo.active=2==t,this.imgThree.active=3==t},n.onItemClick=function(){},e}(u);n._RF.pop()}}}));

