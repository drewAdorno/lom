System.register("chunks:///_virtual/PlanDetailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ConfigGlobal.ts","./MessageView.ts","./EquipDefine.ts","./PetDefine.ts","./SkillDefine.ts","./StatueControl.ts","./StatueDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./PlanDetailContent.ts","./UIDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var n,e,i,a,l,o,s,c,d,h,u,f,r,P,C,p,S,I,v,m,E,D,b;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t.Button,a=t.Label,l=t.Color,o=t.js,s=t.LabelOutline,c=t.Sprite},function(t){d=t.default},function(t){h=t.default},null,function(t){u=t.ConfigGlobal},function(t){f=t.default},function(t){r=t.EquipEventDefine},function(t){P=t.PetEventDefine},function(t){C=t.SKILLEventDefine},function(t){p=t.default},function(t){S=t.StatueEventDefine},function(t){I=t.default},function(t){v=t.RoleDataCache},function(t){m=t.RoleEventDefine},function(t){E=t.PlanDetailContent},function(t){D=t.OpenFunction},function(t){b=t.BaseSubView}],execute:function(){e._RF.push({},"0d276vuQVZDwaWyGAeAqi5n","PlanDetailView",void 0);var T=u.suit_tab_limit,_=T.length;t("default",function(t){function e(){var n;return(n=t.call(this)||this).btnSwitch=void 0,n.nodeIsCurTab=void 0,n.curPlanId=void 0,n.nodeContent=void 0,n.nodeNoPlan=void 0,n.txtCurPlan=void 0,n.nodeSelectPlanMask=void 0,n.nodePlanDown=void 0,n.nodePlanUp=void 0,n.nodeSelectPlan=void 0,n.selectItems=[],n.indexToPlanId={},n.btnSelectPlan=void 0,n.isSelect=!1,n.planDetail=void 0,n.name="PlanDetailView",n.url="ui/module/role/PlanDetailView",n}n(e,t);var u=e.prototype;return u.onInit=function(){var t=this;this.btnSwitch=this.findChild("content/btnSwitch"),this.addComponentCallbackListener(this.btnSwitch,i.EventType.CLICK,(function(){IS(I).send_role_choose_plan_c2s(t.curPlanId)})),this.nodeContent=this.findChild("content"),this.nodeNoPlan=this.findChild("noPlan"),this.nodeIsCurTab=this.findChild("content/changeState"),this.btnSelectPlan=this.findChild("btnCurPlan"),this.addComponentCallbackListener(this.btnSelectPlan,i.EventType.CLICK,(function(){t.setSelectPlanActive(!t.isSelect)})),this.txtCurPlan=this.findChildComponent("btnCurPlan/txtPlan",a),this.nodeSelectPlanMask=this.findChild("maskSelectPlan"),this.addComponentCallbackListener(this.nodeSelectPlanMask,i.EventType.CLICK,(function(){t.setSelectPlanActive(!1)})),this.nodePlanDown=this.findChild("btnCurPlan/imgDown"),this.nodePlanUp=this.findChild("btnCurPlan/imgUp"),this.nodeSelectPlan=this.findChild("planSelect");var n=this.findChild("content/btnRename");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){uiMgr.openView("TabRenameView",t.curPlanId,"plan")}));for(var e=function(n){var e=t.findChild(o.formatStr("planSelect/selectItem%s",n));if(n>_-1)return e.active=!1,"continue";e.active=!0,t.addComponentCallbackListener(e,i.EventType.CLICK,(function(){t.clickSelectPlan(n)})),t.selectItems.push({node:e,nodeLock:d.findChild(e,"lock"),txtName:d.findChildComponent(e,"txtPlan",a),outlineName:d.findChildComponent(e,"txtPlan",s),imgBg:d.findChildComponent(e,"imgBg",c)})},l=1;l<=4;l++)e(l);this.planDetail=new E(this,this.findChild("content/scroll/view/PlanDetailContent")),this.planDetail.init()},u.setSelectPlanActive=function(t){this.nodePlanDown.active=!t,this.nodePlanUp.active=t,this.nodeSelectPlan.active=t,this.nodeSelectPlanMask.active=t,this.isSelect=t},u.registerUpdateHandler=function(){this.addEvent(m.PLAN_NAME_CHANGE,this.updateCurName,this),this.addEvent(m.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(m.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this),this.addEvent(m.PLAN_SELECT_CHANGE,this.onPlanSelectChange,this),this.addEvent(r.EQUIP_LIST_UPDATE,this.updateEquipShow,this),this.addEvent(m.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(C.SKILL_TAB_INFO_UPDATE,this.onSkillTabInfoUpdate,this),this.addEvent(P.PET_TAB_INFO_UPDATE,this.onPetTabInfoUpdate,this),this.addEvent(S.HOME_FARM_STATUE_INFO_BACK,this.onHomeFarmStatueInfoBack,this)},u.onAfterOpen=function(){this.curPlanId=IS(v).curPlan,this.setSelectPlanActive(!1),this.updateContent(),IS(p).reqStatueInfo()},u.updateContent=function(){this.nodeContent.active=0!=this.curPlanId,this.nodeNoPlan.active=0==this.curPlanId,this.btnSelectPlan.active=0!=this.curPlanId,0!=this.curPlanId?(this.updateIndexToPlan(),this.updatePlanItems(),this.updateCurName(),this.showContent(),this.updateUsePlan()):this.setSelectPlanActive(!1)},u.updateIndexToPlan=function(){for(var t=1,n=1;n<=_;n++)n!=this.curPlanId&&(this.indexToPlanId[t]=n,t+=1)},u.updatePlanItems=function(){for(var t=0;t<this.selectItems.length;t++){var n=t+1,e=this.indexToPlanId[n],i=this.selectItems[t];i.txtName.string=IS(v).getPlanName(e);var a=IS(v).checkPlanUnlock(e);i.nodeLock.active=!a,i.imgBg.grayScale=!a,i.outlineName.color=a?new l(60,42,28):new l(59,59,59)}},u.updateCurName=function(){this.txtCurPlan.string=IS(v).getPlanName(this.curPlanId)},u.updateUsePlan=function(){this.nodeIsCurTab.active=IS(v).curPlan==this.curPlanId,this.btnSwitch.active=IS(v).curPlan!=this.curPlanId},u.showContent=function(){this.planDetail.showContent(this.curPlanId)},u.updateEquipShow=function(){this.planDetail.updateEquipShow()},u.onRoleOpenFunctionUpdate=function(t){t==D.FUNC_EQUIP_SKIN&&this.planDetail.updateEquipShow(),t==D.FUNC_LEGACY&&this.showContent()},u.onSkillTabInfoUpdate=function(t){this.planDetail.tryUpdateTabSkill(t)},u.onPetTabInfoUpdate=function(t){this.planDetail.tryUpdateTabPet(t)},u.onHomeFarmStatueInfoBack=function(t){this.planDetail.curStatueInfo=t,this.showContent()},u.onBeforeClose=function(){this.isSelect=!1},u.onDestroy=function(){},u.OnPlanInfoBack=function(){this.updateContent()},u.onPlanInfoUpdate=function(t){t==this.curPlanId&&(this.updateCurName(),this.showContent())},u.onPlanSelectChange=function(){this.updateUsePlan()},u.clickSelectPlan=function(t){var n=this.indexToPlanId[t];if(IS(v).checkPlanUnlock(n))this.curPlanId=n,this.setSelectPlanActive(!1),this.updateContent();else{for(var e=0,i=0;i<_;i++)if(T[i][0]==n){e=T[i][1];break}f.showFlyTip(h.formatStrWithMirrorDeal(GetLanguage(201091),e))}},e}(b));e._RF.pop()}}}));

