System.register("chunks:///_virtual/ByteArray.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,e;return{setters:[function(t){i=t.createClass},function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"c23c33jZk5KWrxnpN+nOBxR","ByteArray",void 0);var n=1,s=1,r=2,o=4,a=1,h=2,f=4,u=4,d=8;t("ByteArray",function(){function t(t,i){void 0===i&&(i=0),this.littleEndian=!1,this.bufferExtSize=0,this.data=void 0,this._bytes=void 0,this._position=void 0,this.write_position=void 0,this.EOF_byte=-1,this.EOF_code_point=-1,i<0&&(i=0),this.bufferExtSize=i;var e,n=0;if(t){var s;if(t instanceof Uint8Array?(s=t,n=t.length):(n=t.byteLength,s=new Uint8Array(t)),0==i)e=new Uint8Array(n);else e=new Uint8Array((1+(n/i|0))*i);e.set(s)}else e=new Uint8Array(i);this.write_position=n,this._position=0,this._bytes=e,this.data=new DataView(e.buffer)}var e=t.prototype;return e._validateBuffer=function(t){if(this.data.byteLength<t){var i,e=this.bufferExtSize;if(0==e)i=new Uint8Array(t);else i=new Uint8Array((1+(t/e>>0))*e);i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},e.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},e.readBoolean=function(){if(this.validate(n))return!!this._bytes[this.position++]},e.readByte=function(){if(this.validate(s))return this.data.getInt8(this.position++)},e.readBytes=function(t){if(void 0===t&&(t=-1),0==t)return new Uint8Array;var i=this._position,e=this.write_position-i;if(!(e<0)){if(-1==t)t=e;else if(t>e)return void console.error("1025");var n=new Uint8Array(t);return n.set(this._bytes.subarray(i,i+t),0),this.position+=t,n}console.error("1025")},e.uncompress=function(){var t=new Zlib.Inflate(this._bytes).decompress();this._bytes=t,this.write_position=t.length,this._position=0,this.data=new DataView(this._bytes.buffer)},e.compress=function(){var t=new Zlib.Deflate(this._bytes).compress();this._bytes=t,this.write_position=t.length,this._position=0,this.data=new DataView(this._bytes.buffer)},e.readDouble=function(){if(this.validate(d)){var t=this.data.getFloat64(this._position,this.littleEndian);return this.position+=d,t}},e.readFloat=function(){if(this.validate(u)){var t=this.data.getFloat32(this._position,this.littleEndian);return this.position+=u,t}},e.readInt=function(){if(this.validate(o)){var t=this.data.getInt32(this._position,this.littleEndian);return this.position+=o,t}},e.readLong=function(){if(this.validate(o)){var t=function(t,i){for(var e=t[i+0]>>7,n=0,s=1,r=0;r<8;r++){var o=t[i+(7-r)];n+=(e?255^o:o)*s,s*=256}return e?-1-n:n}(this.bytes,this._position);return this.position+=d,t}},e.readShort=function(){if(this.validate(r)){var t=this.data.getInt16(this._position,this.littleEndian);return this.position+=r,t}},e.readUByte=function(){if(this.validate(a))return this._bytes[this.position++]},e.readUInt=function(){if(this.validate(f)){var t=this.data.getUint32(this._position,this.littleEndian);return this.position+=f,t}},e.readUShort=function(){if(this.validate(h)){var t=this.data.getUint16(this._position,this.littleEndian);return this.position+=h,t}},e.readString=function(){var t=this.readUShort();return t>0?this.readUTFBytes(t):""},e.readUTFBytes=function(t){if(this.validate(t)){var i=this.data,e=new Uint8Array(i.buffer,i.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(e)}},e.writeBoolean=function(t){this.validateBuffer(n),this._bytes[this.position++]=+t},e.writeByte=function(t){this.validateBuffer(s),this._bytes[this.position++]=255&t},e.writeBytes=function(t,i,e){var n;void 0===i&&(i=0),void 0===e&&(e=0),i<0||e<0||(n=0==e?t.length-i:Math.min(t.length-i,e))>0&&(this.validateBuffer(n),this._bytes.set(t.subarray(i,i+n),this._position),this.position=this._position+n)},e.writeLong=function(t){this.validateBuffer(d),this._bytes.set(function(t){var i=[],e=t<0;e&&(t=-1-t);for(var n=0;n<8;n++){var s=t%256;t=(t-s)/256,i[7-n]=e?255^s:s}return i}(t),this._position),this.position+=d},e.writeDouble=function(t){this.validateBuffer(d),this.data.setFloat64(this._position,t,this.littleEndian),this.position+=d},e.writeFloat=function(t){this.validateBuffer(u),this.data.setFloat32(this._position,t,this.littleEndian),this.position+=u},e.writeInt=function(t){this.validateBuffer(o),this.data.setInt32(this._position,t,this.littleEndian),this.position+=o},e.writeShort=function(t){this.validateBuffer(r),this.data.setInt16(this._position,t,this.littleEndian),this.position+=r},e.writeUInt=function(t){this.validateBuffer(f),this.data.setUint32(this._position,t,this.littleEndian),this.position+=f},e.writeUShort=function(t){this.validateBuffer(h),this.data.setUint16(this._position,t,this.littleEndian),this.position+=h},e.writeString=function(t){var i=this.encodeUTF8(t),e=i.length;this.validateBuffer(h+e),this.data.setUint16(this._position,e,this.littleEndian),this.position+=h,this._writeUint8Array(i,!1)},e.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},e._writeUint8Array=function(t,i){void 0===i&&(i=!0);var e=this._position,n=e+t.length;i&&this.validateBuffer(n),this.bytes.set(t,e),this.position=n},e.validate=function(t){var i=this._bytes.length;if(i>0&&this._position+t<=i)return!0},e.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},e.encodeUTF8=function(t){for(var i=0,e=this.stringToCodePoints(t),n=[];e.length>i;){var s=e[i++];if(this.inRange(s,55296,57343))console.error("range error!{0}",s);else if(this.inRange(s,0,127))n.push(s);else{var r=void 0,o=void 0;for(this.inRange(s,128,2047)?(r=1,o=192):this.inRange(s,2048,65535)?(r=2,o=224):this.inRange(s,65536,1114111)&&(r=3,o=240),n.push(this.div(s,Math.pow(64,r))+o);r>0;){var a=this.div(s,Math.pow(64,r-1));n.push(128+a%64),r-=1}}}return new Uint8Array(n)},e.decodeUTF8=function(t){for(var i,e=!1,n=0,s="",r=0,o=0,a=0,h=0;t.length>n;){var f=t[n++];if(f==this.EOF_byte)i=0!=o?this.decoderError(e):this.EOF_code_point;else if(0==o)this.inRange(f,0,127)?i=f:(this.inRange(f,194,223)?(o=1,h=128,r=f-192):this.inRange(f,224,239)?(o=2,h=2048,r=f-224):this.inRange(f,240,244)?(o=3,h=65536,r=f-240):this.decoderError(e),r*=Math.pow(64,o),i=null);else if(this.inRange(f,128,191))if(a+=1,r+=(f-128)*Math.pow(64,o-a),a!==o)i=null;else{var u=r,d=h;r=0,o=0,a=0,h=0,i=this.inRange(u,d,1114111)&&!this.inRange(u,55296,57343)?u:this.decoderError(e,f)}else r=0,o=0,a=0,h=0,n--,i=this.decoderError(e,f);null!==i&&i!==this.EOF_code_point&&(i<=65535?i>0&&(s+=String.fromCharCode(i)):(i-=65536,s+=String.fromCharCode(55296+(i>>10&1023)),s+=String.fromCharCode(56320+(1023&i))))}return s},e.decoderError=function(t,i){return i||65533},e.inRange=function(t,i,e){return i<=t&&t<=e},e.div=function(t,i){return Math.floor(t/i)},e.stringToCodePoints=function(t){for(var i=[],e=0,n=t.length;e<t.length;){var s=t.charCodeAt(e);if(this.inRange(s,55296,57343))if(this.inRange(s,56320,57343))i.push(65533);else if(e==n-1)i.push(65533);else{var r=t.charCodeAt(e+1);if(this.inRange(r,56320,57343)){var o=1023&s,a=1023&r;e+=1,i.push(65536+(o<<10)+a)}else i.push(65533)}else i.push(s);e+=1}return i},i(t,[{key:"readAvailable",get:function(){return this.write_position-this._position}},{key:"buffer",get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var i,e=t.byteLength,n=new Uint8Array(t),s=this.bufferExtSize;0==s?i=new Uint8Array(e):i=new Uint8Array((1+(e/s|0))*s);i.set(n),this.write_position=e,this._bytes=i,this.data=new DataView(i.buffer)}},{key:"rawBuffer",get:function(){return this.data.buffer}},{key:"bytes",get:function(){return this._bytes}},{key:"dataView",get:function(){return this.data},set:function(t){this.buffer=t.buffer}},{key:"position",get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)}},{key:"length",get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)}},{key:"bytesAvailable",get:function(){return this.data.byteLength-this._position}}]),t}());e._RF.pop()}}}));

