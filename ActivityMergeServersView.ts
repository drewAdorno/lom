System.register("chunks:///_virtual/ActivityMergeServersView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./RedPoint.ts","./RedPointMgr.ts","./TimeUtil.ts","./index57.ts","./BattlePassDefine.ts","./MessageView.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ActivityMergeServersDataCache.ts","./ActivityMergeServersDefine.ts","./BaseView.ts"],(function(e){"use strict";var t,i,r,n,s,a,o,d,g,v,h,f,m,c,l,u,p,S,T;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,r=e.Label,n=e.Button,s=e.Vec2,a=e.js},function(e){o=e.audioMgr},function(e){d=e.RedPointType},function(e){g=e.RedPointMgr},function(e){v=e.default},null,function(e){h=e.BattlePassDefine},function(e){f=e.default},function(e){m=e.default},function(e){c=e.ActivityType,l=e.ActivityState,u=e.ActivityEventDefine},function(e){p=e.default},function(e){S=e.ActivityMergeServersEvent},function(e){T=e.BaseView}],execute:function(){i._RF.push({},"856344fmUhKi7PEfpnJmAc1","ActivityMergeServersView",void 0);e("default",function(e){function i(){var t;return(t=e.call(this)||this).txtTimeDesc=void 0,t.txtLeftTime=void 0,t.leftTime=0,t.deltaTime=0,t.canUpdate=!1,t.name="ActivityMergeServersView",t.url="ui/module/activityMergeServers/ActivityMergeServersView",t.fullScreen=!0,t}t(i,e);var T=i.prototype;return T.onInit=function(){var e=this;this.txtTimeDesc=this.findChildComponent("nodeTime/txtDesc",r),this.txtLeftTime=this.findChildComponent("nodeTime/txtTime",r);var t=this.findChild("view/btnClose");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){e.close()}));var i=this.findChild("view/btnLogin");this.addRedPoint("merge_servers_login",this.findChild("view/btnLogin/img"),new s(110,25),d.Dot),this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersLogin);if(e&&e.state==l.Open)uiMgr.openView("ActivityMergeServersLoginView");else if(e&&e.state==l.Preview){var t=e.state_time[l.Open].start_time-v.serverTime;f.showFlyTip(a.formatStr(GetLanguage(201410),v.formatTimeStringForSecond(t)))}else f.showFlyTip(GetLanguage(200026))}));var o=this.findChild("view/btnFriend");this.addRedPoint("merge_servers_friend",this.findChild("view/btnFriend/img"),new s(110,25),d.Dot),this.addComponentCallbackListener(o,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersFriend);if(e&&e.state==l.Open)uiMgr.openView("ActivityMergeServersFriendView");else if(e&&e.state==l.Preview){var t=e.state_time[l.Open].start_time-v.serverTime;f.showFlyTip(a.formatStr(GetLanguage(201410),v.formatTimeStringForSecond(t)))}else f.showFlyTip(GetLanguage(200026))}));var g=this.findChild("view/btnRecharge");this.addRedPoint("merge_servers_recharge",this.findChild("view/btnRecharge/img"),new s(110,25),d.Dot),this.addComponentCallbackListener(g,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersRecharge);if(e&&e.state==l.Open)uiMgr.openView("ActivityMergeServersRechargeView");else if(e&&e.state==l.Preview){var t=e.state_time[l.Open].start_time-v.serverTime;f.showFlyTip(a.formatStr(GetLanguage(201410),v.formatTimeStringForSecond(t)))}else f.showFlyTip(GetLanguage(200026))}));var h=this.findChild("view/btnLottery");this.addRedPoint("merge_servers_lottery",this.findChild("view/btnLottery/img"),new s(110,25),d.Dot),this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersLottery);if(e&&e.state==l.Open)uiMgr.openView("ActivityMergeServersLotteryView",c.MergeServersLottery);else if(e&&e.state==l.Preview){var t=e.state_time[l.Open].start_time-v.serverTime;f.showFlyTip(a.formatStr(GetLanguage(201410),v.formatTimeStringForSecond(t)))}else f.showFlyTip(GetLanguage(200026))}));var u=this.findChild("view/btnMarry");this.addComponentCallbackListener(u,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersMarry);if(e&&e.state==l.Open)uiMgr.openView("ActivityMergeServersMarryView",c.MergeServersMarry);else if(e&&e.state==l.Preview){var t=e.state_time[l.Open].start_time-v.serverTime;f.showFlyTip(a.formatStr(GetLanguage(201410),v.formatTimeStringForSecond(t)))}else f.showFlyTip(GetLanguage(200026))}));var p=this.findChild("view/btnPass");this.addRedPoint("merge_servers_pass",this.findChild("view/btnPass/img"),new s(110,25),d.Dot),this.addComponentCallbackListener(p,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersPass);if(e&&e.state==l.Open)uiMgr.openView("ActivityMergeServersPassView");else if(e&&e.state==l.Preview){var t=e.state_time[l.Open].start_time-v.serverTime;f.showFlyTip(a.formatStr(GetLanguage(201410),v.formatTimeStringForSecond(t)))}else f.showFlyTip(GetLanguage(200026))}));var S=this.findChild("view/btnTask");this.addRedPoint("merge_servers_task",S,new s(25,30),d.Dot),this.addComponentCallbackListener(S,n.EventType.CLICK,(function(){var e=IS(m).GetActivityInfo(c.MergeServersLottery);e&&e.state==l.Open?uiMgr.openView("ActivityMergeServersTaskView",c.MergeServersLottery):e&&e.state==l.Preview?f.showFlyTip(GetLanguage(200086)):f.showFlyTip(GetLanguage(200026))}))},T.registerUpdateHandler=function(){this.addEvent(u.OnActivityInfoUpdate,this.updateInfo,this),this.addEvent(u.OnActivityInfoTaskUpdate,this.updateRed,this),this.addEvent(u.OnActivityInfoUpdate,this.updateRed,this),this.addEvent(u.OnLoginSignUpdate,this.updateRed,this),this.addEvent(u.OnActivityLotteryUpdate,this.updateRed,this),this.addEvent(u.OnActivityLotteryReawrdUpdate,this.updateRed,this),this.addEvent(S.OnMergeGuildInfoUpdate,this.updateRed,this),this.addEvent(h.BATTLE_PASS_INFO_UPDATE,this.updateRed,this)},T.onAfterOpen=function(){o.playMusic("hefu_mainbgm"),this.updateRed();var e=IS(m).GetActivityInfo(c.MergeServers);if(e){var t,i=null!=(t=e.state_time[e.state])?t:e.state_time[l.Open];if(this.leftTime=i.end_time-v.serverTime,this.leftTime>0){var r="";e.state==l.Preview?r=GetLanguage(200763):e.state==l.Open?r=GetLanguage(200764):e.state==l.EndShow&&(r=GetLanguage(200765)),this.txtTimeDesc.string=r,this.canUpdate=!0,this.txtLeftTime.string=a.formatStr("%s",v.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}else this.txtTimeDesc.string=GetLanguage(200765),this.txtLeftTime.string=GetLanguage(200026)},T.onBeforeClose=function(){o.playMusic("battle"),this.canUpdate=!1},T.onDestroy=function(){},T.onUpdate=function(e){this.canUpdate&&(this.deltaTime=this.deltaTime+e,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=a.formatStr("%s",v.formatTimeStringForSecond(this.leftTime)):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},T.updateRed=function(){IS(g).changeValue("merge_servers_task",IS(m).GetTaskRedNum(c.MergeServersLottery)),IS(g).changeValue("merge_servers_friend",IS(m).GetTaskRedNum(c.MergeServersFriend)),IS(g).changeValue("merge_servers_login",IS(p).GetLoginRedNum()),IS(g).changeValue("merge_servers_pass",IS(p).getPassRedNum()),IS(g).changeValue("merge_servers_lottery",IS(p).getLotteryRed()),IS(g).changeValue("merge_servers_recharge",IS(m).GetTaskRedNum(c.MergeServersRecharge)+IS(p).GetGuildRed())},T.updateInfo=function(e){if(e.type==c.MergeServers&&e.state!=l.Null){var t,i=null!=(t=e.state_time[e.state])?t:e.state_time[l.Open];if(this.leftTime=i.end_time-v.serverTime,this.leftTime>0){var r="";e.state==l.Preview?r=GetLanguage(200763):e.state==l.Open?r=GetLanguage(200764):e.state==l.EndShow&&(r=GetLanguage(200765)),this.txtTimeDesc.string=r,this.canUpdate=!0,this.txtLeftTime.string=a.formatStr("%s",v.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}},i}(T));i._RF.pop()}}}));

