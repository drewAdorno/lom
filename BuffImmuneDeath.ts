System.register("chunks:///_virtual/BuffImmuneDeath.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ObjectPool.ts","./FixMath.ts","./Buff.ts","./MetaAttrib.ts","./EnumDefine.ts"],(function(t){"use strict";var e,i,n,r,u,o,a;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){n=t.ObjectPool},function(t){r=t.FixMath},function(t){u=t.Buff},function(t){o=t.AttribDefine},function(t){a=t.HealthType}],execute:function(){i._RF.push({},"1416fbR4iJHJ4+uzFED83Ki","BuffImmuneDeath",void 0);var c=t("BuffImmuneDeath",function(t){function i(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._value=void 0,e._cd=0,e._triggerHp=0,e._triggerNum=0,e._immune=!1,e}e(i,t);var n=i.prototype;return n.onBegin=function(){},n.loadEffect=function(){this._cd<=0||t.prototype.loadEffect.call(this)},n.onUpdate=function(t){if(this.owner.data.immuneDeath=this._immune,this._immune){if(this._cd=Math.max(r.round(this._cd-t),0),this._immune=this._cd>0,this._cd<=0&&null!=this.effect)this.runner.battleMain.renderMgr.freeEffect(this.effect),this.effect=null;if(this._cd<=0&&this._value>0){var e=r.roundInt(this.owner.data.getAttribByInt(o.hp)*this._value);this.runner.healthTarget(this.owner,e,a.Treat)}}},n.checkTarget=function(t){this._triggerNum<=0||(this._cd>0||r.round(t/this.owner.data.getAttrib(o.hp))<=this._triggerHp&&(this._triggerNum--,this._cd=this.config.param3,this.owner.data.immuneDeath=!0,this._immune=!0))},n.onDestroy=function(){this._cd=0,this._immune=!1,this.owner.data.immuneDeath=!1},i.alloc=function(t){var e=i._pool.alloc();return e.config=t,e._value=r.round(t.param1/1e4),e._triggerHp=r.round(t.param2/1e4),e._triggerNum=t.param4,e},i}(u));c._pool=new n(c,20),i._RF.pop()}}}));

