System.register("chunks:///_virtual/SeasonWantedView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigSeason_kv.ts","./SLGMapData.ts","./CommonModel.ts","./SeasonDefine.ts","./SeasonSceneControl.ts","./SeasonSceneDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,a,h,d,r,l,u,c,f,p,v,m,g,S,C;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.Label,a=t.RichText,h=t.Sprite,d=t.sys},function(t){r=t.V2},function(t){l=t.default},function(t){u=t.default},function(t){c=t.default},null,function(t){f=t.ConfigSeason_kv},function(t){p=t.SLGMapData},function(t){v=t.CommonModel},function(t){m=t.SeasonEventDefine},function(t){g=t.default},function(t){S=t.SeasonSceneDataCache},function(t){C=t.BaseView}],execute:function(){n._RF.push({},"138f3Cqkf9Ks78TRuwBvNFR","SeasonWantedView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).wantedList=[],i.updateTimer=0,i.txtDesc=void 0,i.name="SeasonWantedView",i.url="ui/module/season/scene-view/SeasonWantedView",i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this,i=this.findChild("content/bg/btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()}));for(var e=0;e<3;e++){var n=this.findChild("content/mid/node"+(e+1)),a=new y(this,n);this.wantedList.push(a)}this.txtDesc=this.findChildComponent("content/top/desc",s)},n.registerUpdateHandler=function(){this.addEvent(m.SEASON_WANTED_INFO_UPDATE,this.updateInfo,this)},n.onAfterOpen=function(){this.updateInfo()},n.updateInfo=function(){for(var t,i,e,n=this,o=null!=(t=IS(S).bountyInfo)?t:{},s=null!=(i=o.bounty_list)?i:[],a=0;a<3;a++){var h=this.wantedList[a];s.length>=a+1?h.show(a,s[a]):h.show(a,null)}this.updateTimer&&this.removeTimer(this.updateTimer),s.length>0&&(this.updateTimer=this.addTimer(1,-1,(function(){for(var t=0;t<3;t++){var i=n.wantedList[t];s.length>=t+1?i.show(t,s[t]):i.show(t,null)}}))),this.txtDesc.string=u.formatStr(GetLanguage(104468),null!=(e=o.bounty_score)?e:0)},n.onBeforeClose=function(){},n.onDestroy=function(){},e}(C));var y=function(){function t(t,i){var e=this;this.view=void 0,this.nodeNone=void 0,this.playerEmpty=void 0,this.shipEmpty=void 0,this.playerModel=void 0,this.shipModel=void 0,this.txtName=void 0,this.txtDesc=void 0,this.btnLoacte=void 0,this.data=void 0,this.playerid=void 0,this.shipip=void 0,this.figure=void 0,this.view=t,this.playerEmpty=l.findChild(i,"empty"),this.shipEmpty=l.findChild(i,"icon/empty"),this.playerModel=l.findChild(i,"model"),this.shipModel=l.findChild(i,"icon/model"),this.txtName=l.findChildComponent(i,"name",a),this.txtDesc=l.findChildComponent(i,"desc",s),this.btnLoacte=l.findChild(i,"btnLocate"),this.view.addComponentCallbackListener(this.btnLoacte,o.EventType.CLICK,(function(){var t=p.getCRToIndex(e.data.pos.x,e.data.pos.y);IS(g).reqLocate(t),e.view.close()}));var n=l.findChildComponent(i,"bg",h);this.view.loadIcon(n,"season_wanted","dhh_icon_xuanshang02"),d.uiMirror&&this.view.loadIcon(this.shipEmpty.getComponent(h),"season_wanted","dhh_icon_wenhao")}return t.prototype.show=function(t,i){if(!i)return this.figure=null,this.btnLoacte.active=!1,this.playerEmpty.active=!0,this.shipEmpty.active=!0,this.view.removeShipModel(this.shipip),this.view.removeUnitModel(this.playerid),this.txtName.string=GetLanguage(200038),void(this.txtDesc.string=GetLanguage(205366));this.data=i,this.btnLoacte.active=!0,this.playerEmpty.active=!1,this.shipEmpty.active=!1,this.txtName.string=u.formatStr(GetLanguage(205365),i.serv_id,i.role_name);var n=f.SEASON_BOUNTY_BATTLESCORE[t][1],o=f.SEASON_DEFEAT_BOUNTY[t][1],s=c.getTimeLeft(i.time-c.serverTime);if(this.txtDesc.string=u.formatStr(GetLanguage(205367),n,i.kill_num,s,o),this.figure!=i.figure){this.view.removeShipModel(this.shipip),this.view.removeUnitModel(this.playerid),this.figure=i.figure;var a=i.figure;a.artifact_figure=0,a.mount_figure=0,this.playerid=IS(v).AddRoleModel(this.view,a,this.playerModel);for(var h,d=f.SEASON_INITIAL_ATTR,l=d[0][1],p=d[1][1],m=d[2][1],g=d[3][1],S=e(a.skin_list);!(h=S()).done;){var C=h.value;3==C.k?l=C.v:4==C.k?p=C.v:5==C.k?m=C.v:6==C.k&&(g=C.v)}this.shipip=this.view.addShipModel({shipId:l,flag:p,ram:g,parent:this.shipModel,gunId:m},r.ZERO,.2)}},t}();n._RF.pop()}}}));

