System.register("chunks:///_virtual/ActivityStrategyEquipDetailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./index57.ts","./ItemIcon.ts","./ObjectUtil.ts","./EquipModel.ts","./EquipEditView.ts","./ActivityDefine.ts","./ActivityStrategyDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,r,s,a,u,l,d,c,h,f,m,p,g,C,v,I;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.math,o=t.UITransform,r=t.Button,s=t.Label,a=t.Sprite,u=t.RichText,l=t.js,d=t.Color},function(t){c=t.default},null,function(t){h=t.IconAseetType},function(t){f=t.default},function(t){m=t.EquipModel},function(t){p=t.carrerTypeToName,g=t.attrToIndex},function(t){C=t.ActivityEventDefine},function(t){v=t.default},function(t){I=t.BaseView}],execute:function(){e._RF.push({},"444c0KpfgpKvJ95fFM37FdV","ActivityStrategyEquipDetailView",void 0);n.Vec3,n.Vec2,t("default",function(t){function e(){var i;return(i=t.call(this)||this).equipItem=void 0,i.nodeContent=void 0,i.utContent=void 0,i.nodeSpeAttr=void 0,i.utSpeAttr=void 0,i.nodeSuit=void 0,i.txtRebuildCost=void 0,i.location=void 0,i.name="ActivityStrategyEquipDetailView",i.url="ui/module/ActivityStrategy/ActivityStrategyEquipDetailView",i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.nodeContent=this.findChild("content"),this.utContent=this.nodeContent.getComponent(o);var i=this.findChild("imgMask");this.addComponentCallbackListener(i,r.EventType.CLICK,(function(){t.close()})),this.nodeSpeAttr=this.findChild("content/info/detail/speAttr"),this.utSpeAttr=this.nodeSpeAttr.getComponent(o),this.nodeSuit=this.findChild("content/info/detail/suit");var e=this.findChild("content/info/detail/rebuild");this.addComponentCallbackListener(e,r.EventType.CLICK,(function(){t.onRebuildClick()})),this.txtRebuildCost=this.findChildComponent("content/info/detail/rebuild/rebuildParent/txtCost",s),this.equipItem={imgFrame:this.findChildComponent("content/info/head/imgFrame",a),imgIcon:this.findChildComponent("content/info/head/imgIcon",a),txtLevel:this.findChildComponent("content/info/txtLevel",s),txtName:this.findChildComponent("content/info/txtName",s),txtCarrer:this.findChildComponent("content/info/txtCarrer",s),txtSuit:this.findChildComponent("content/info/detail/suit/txtSuit",u),AttrItmes:{normalAttrItems:[],speAttrItems:[]}};for(var n=0;n<4;n++){var d=this.findChild(l.formatStr("content/info/detail/attr/baseAttrItem%s",n+1)),h={txtName:c.findChildComponent(d,"txtName",s),txtValue:c.findChildComponent(d,"txtValue",s),imgFlag:null,node:d};if(this.equipItem.AttrItmes.normalAttrItems.push(h),n<=1){var f=this.findChild(l.formatStr("content/info/detail/speAttr/speAttrItem%s",n+1)),m={txtName:c.findChildComponent(f,"txtName",s),txtValue:c.findChildComponent(f,"txtValue",s),txtDesc:c.findChildComponent(f,"txtDesc",s),node:f};this.equipItem.AttrItmes.speAttrItems.push(m)}}},n.registerUpdateHandler=function(){this.addEvent(C.OnStrategyEquipUpdate,this.OnStrategyEquipUpdate,this)},n.onAfterOpen=function(){this.location=this.openArgs[0]||0,this.showEquipInfo()},n.showEquipInfo=function(){if(0!=this.location){var t=IS(v).getEquipByLocation(this.location);if(null!=t){var i=IS(m).getEquipNameShowByEquipConfigId(t.config_id,!0);this.equipItem.txtName.string=i.name,this.equipItem.txtName.color=i.color;var e=configEquipment.getDataByKey(t.config_id);this.loadIcon(this.equipItem.imgIcon,e.atlas,e.icon,null,h.ICON_SPRITE),this.loadIcon(this.equipItem.imgFrame,"icon_equip",configColor.getDataByKey(e.quality).path),this.equipItem.txtLevel.string=l.formatStr("Lv.%s",t.equip_lv);var n=e.wearable||0;if(0==n)this.equipItem.txtCarrer.string="";else{this.equipItem.txtCarrer.string=p[n];var o=IS(v).job,r=configJobs.getDataByKey(o).type;this.equipItem.txtCarrer.color=r==n?new d(77,65,49):new d(191,67,67)}this.txtRebuildCost.string=String(IS(v).getCurEquipRebuildCostNum());var s,a,u=t.base_attr;u.sort((function(t,i){return g[t.k]<g[i.k]?-1:1}));for(var c=0;c<4;c++){var C=this.equipItem.AttrItmes.normalAttrItems[c],I=u[c];if(f.isEmpty(I))C.node.active=!1;else{C.node.active=!0,s=I.k,a=I.v;var y=configAttribute.getDataByKey(s);C.txtName.string=y.name,C.txtValue.string=3==y.show_type?String(Math.floor(a/100)/100):String(a)}}for(var S=t.rand_attr||[],q=0;q<2;q++){var x=this.equipItem.AttrItmes.speAttrItems[q],A=S[q];if(f.isEmpty(A))x.node.active=!1;else{x.node.active=!0,s=A.k,a=A.v;var E=configAttribute.getDataByKey(s);x.txtName.string=E.name,x.txtValue.string=l.formatStr("%s%",100*a/1e4),x.txtDesc.string=E.desc}}this.nodeSpeAttr.active=S.length>0||!1;var b=S.length>0?52*S.length+26:0;this.utSpeAttr.height=52*S.length+26;var D=e.suitId;this.nodeSuit.active=0!=D||!1;var V=0;if(0!=D){var w=configEquipment_suit.getDataByList("suit_id",D);V=w.length;for(var B,N="",L=IS(v).getEquipWearCountBySuitId(D),_=0;_<w.length;_++){var k=w[_];_>0&&(N=l.formatStr("%s\n",N));var F=l.formatStr("%s(%s/%s):%s",k.name,L,k.num,k.desc);B=L>=k.num?"#FDF9B8":"#908474",F=l.formatStr("<color=%s>%s</color>",B,F),N=l.formatStr("%s%s",N,F)}this.equipItem.txtSuit.string=N}var R=V>0?22*V+20:0;this.utContent.height=350+b+R}}else self.close()},n.OnStrategyEquipUpdate=function(t){t==this.location&&this.showEquipInfo()},n.onBeforeClose=function(){this.location=0},n.onDestroy=function(){},n.onRebuildClick=function(){uiMgr.openView("ActivityStrategyEquipAttrView",this.location)},e}(I));e._RF.pop()}}}));

