System.register("chunks:///_virtual/BattleChapterMainPanel.ts",["cc","./NodeUtil.ts","./TimeUtil.ts","./ChapterControl.ts","./IBattleChapterPanel.ts"],(function(t){"use strict";var e,i,a,n,h,o,s,r,d,p,c,l;return{setters:[function(t){e=t.cclegacy,i=t.ProgressBar,a=t.Label,n=t.UITransform,h=t.Sprite,o=t.Node,s=t.Vec3,r=t.Button},function(t){d=t.default},function(t){p=t.default},function(t){c=t.default},function(t){l=t.BattleInfoType}],execute:function(){e._RF.push({},"d4789Q68H5M2bCIAWjqTgIa","BattleChapterMainPanel",void 0);var C=[0,.2,.5,.8,1],f=["","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ"],m=[[999000441,0],[999000444,0],[999000448,0],[999000442,1],[999000442,2],[999000442,3],[999000445,1],[999000445,2],[999000445,3],[999000445,4],[999000449,1],[999000449,2],[999000449,3],[999000449,4],[999000449,5],[999000449,6],[999000449,7],[999000449,8],[999000449,9],[999000449,10],[999000447,1],[999000447,2],[999000447,3],[999000447,4],[999000447,5],[999000447,6],[999000447,7],[999000447,8],[999000447,9],[999000447,10],[999000446,1],[999000446,2],[999000446,3],[999000446,4],[999000446,5],[999000446,6],[999000446,7],[999000446,8],[999000446,9],[999000446,10],[999000443,1],[999000443,2],[999000443,3],[999000443,4],[999000443,5],[999000443,6],[999000443,7],[999000443,8],[999000443,9],[999000443,10],[999000556,1],[999000556,2],[999000556,3],[999000556,4],[999000556,5],[999000556,6],[999000556,7],[999000556,8],[999000556,9],[999000556,10],[999000557,1],[999000557,2],[999000557,3],[999000557,4],[999000557,5],[999000557,6],[999000557,7],[999000557,8],[999000557,9],[999000557,10]],u=(t("BattleChapterMainPanel",function(){function t(t,e){this.view=void 0,this.node=void 0,this.infoType=l.Main,this.pbPart=void 0,this.points=[],this.nodeTime=void 0,this.pbTime=void 0,this.txtTime=void 0,this.nodeUnlimited=void 0,this.txtChapter=void 0,this.chapterTime=0,this.node=e,this.view=t,this.onInit()}var e=t.prototype;return e.reset=function(){var t=chapterDataCache.getChapterConfig(battleMain.data.chapterId),e=m[t.level-1];this.txtChapter.string=GetLanguage_UI(e[0])+" "+f[e[1]]+"  "+t.chapter+" - "+t.section+" ",this.updatePart()},e.onInit=function(){this.pbPart=d.findChildComponent(this.node,"pbPart",i);for(var t=1;t<=5;++t)this.points[t-1]=new u(d.findChild(this.pbPart.node,"point"+t),t);this.pbPart.progress=0,this.nodeTime=d.findChild(this.node,"time"),this.pbTime=d.findChildComponent(this.nodeTime,"pbTime",i),this.txtTime=d.findChildComponent(this.nodeTime,"txtTime",a),this.txtChapter=d.findChildComponent(this.node,"title/txtChapter",a);var e=this.txtChapter.node.getComponent(n),p=d.findChildComponent(this.nodeTime,"Sprite",h);this.view.loadIcon(p,"battle","zxgq_ui_shijian"),this.nodeUnlimited=d.findChild(this.node,"unlimited");var l=d.findChild(this.nodeUnlimited,"txtLimit");e.node.on(o.EventType.SIZE_CHANGED,(function(){l.position=new s(e.width/2+20,-23,0)}));var C=d.findChild(this.nodeUnlimited,"btnBoss");this.view.addComponentCallbackListener(C,r.EventType.CLICK,(function(){IS(c).reqChapterBoss();var t=chapterDataCache.getChapterConfig(battleMain.data.chapterId),e=chapterDataCache.getChapterConfigInfo(t.id).getDataByList("index",t.index),i=e[e.length-1];battleMain.enterChapter(i.bossModel)}))},e.updateChapter=function(t){var e=chapterDataCache.getChapterConfig(t);1==e.part_type&&(this.nodeUnlimited.active=!1);for(var i=chapterDataCache.getChapterConfigInfo(e.id).getDataByList("index",e.index),a=1;a<=5;++a){var n=-1;a<e.part&&(n=1),a==e.part&&(n=2),1==i[a-1].part_type&&(n=3),this.points[a-1].setState(n)}this.pbPart.progress=C[e.part-1]},e.updateTime=function(){this.chapterTime!=Math.floor(battleMain.chapter.chapterTime)&&(this.chapterTime=Math.floor(battleMain.chapter.chapterTime),this.txtTime.string=p.formatTimeForSecond(this.chapterTime)),this.pbTime.progress=battleMain.chapter.chapterTime/battleMain.chapter.maxChapterTime},e.updateChapterType=function(){0==battleMain.data.chapterMode?(this.nodeUnlimited.active=!1,this.pbPart.node.active=!0,this.updateChapter(battleMain.data.chapterId)):(this.nodeUnlimited.active=!0,this.pbPart.node.active=!1)},e.updatePart=function(){battleMain.chapter.timeModel?(this.nodeTime.active=!0,this.updateTime()):this.nodeTime.active=!1,this.updateChapterType()},e.onUpdate=function(t){battleMain.chapter.timeModel&&this.updateTime()},t}()),function(){function t(t,e){this.node=void 0,this.index=void 0,this.states=[],this.node=t,this.index=e;for(var i=1;i<=3;i++)this.states.push(d.findChild(t,"state"+i))}return t.prototype.setState=function(t){if(-1!=t){this.node.active=!0;for(var e=0;e<this.states.length;e++)this.states[e].active=t==e+1}else this.node.active=!1},t}());e._RF.pop()}}}));

