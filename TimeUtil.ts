System.register("chunks:///_virtual/TimeUtil.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts"],(function(e){"use strict";var t,r,a,o;return{setters:[function(e){t=e.createClass},function(e){r=e.cclegacy,a=e.js},function(e){o=e.default}],execute:function(){r._RF.push({},"67214ZuRY1JzJ6+icecxkKI","TimeUtil",void 0);var n=8,i=0,g=8,u=0,f=0;e("default",function(){function e(){}return e.GetServerTimeZoneStr=function(){return n>0?"(UTC+"+n+")":"(UTC"+n+")"},e.getTimestamp=function(){return(new Date).getTime()},e.getDate=function(){return(new Date).toLocaleDateString()},e.getLocalTime=function(){var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return Math.floor((t+36e5*n)/1e3)},e.ServerDate=function(e){var t=new Date,r=(t.getTime(),t.getTimezoneOffset()/60*-1);return new Date(e+36e5*(n-r))},e.getServerDateByLocalStr=function(e){var t=new Date(e),r=t.getTimezoneOffset()/60*-1;return new Date(t.getTime()+36e5*(r-n))},e.getTimeOpenDay=function(t){var r=e.ServerDate(1e3*t),o=a.formatStr("%s/%s/%s %s:%s:%s",r.getFullYear(),r.getMonth()+1,r.getDate(),0,0,0),n=e.getServerDateByLocalStr(o).getTime()/1e3,i=e.serverTime-n;return Math.floor(i/86400+1)},e.getLocalTimeToUTC8=function(e,t,r,o,i,g){var u=a.formatStr("%s/%s/%s %s:%s:%s",e,t>9?t:"0"+t,r>9?r:"0"+r,o>9?o:"0"+o,i>9?i:"0"+i,g>9?g:"0"+g),f=new Date(u),s=f.getTime(),l=f.getTimezoneOffset()/60*-1;return new Date(s+36e5*(l-n)).getTime()/1e3},e.getServerOpenTimeToUTC8=function(t,r,a,o){var n=e.serverOpenTime+24*(t-1)*3600,i=new Date(1e3*n);return e.getLocalTimeToUTC8(i.getFullYear(),i.getMonth()+1,i.getDate(),r,a,o)},e.checkOpenTime=function(t){var r=t[0];if(1==r){var a=t[1][0],o=t[1][1],n=e.getLocalTimeToUTC8(a[0],a[1],a[2],o[0],o[1],o[2]);return e.serverTime>=n}if(2==r){var i=t[1],g=t[2],u=e.serverOpenTime+24*(i-1)*3600,f=new Date(1e3*u),s=e.getLocalTimeToUTC8(f.getFullYear(),f.getMonth()+1,f.getDate(),g[0],g[1],g[2]);return e.serverTime>=s}},e.checkCloseTime=function(t){var r=this.getActivityTime(t);return e.serverTime<=r},e.getActivityTime=function(t){var r=t[0];if(1==r){var a=t[1][0],o=t[1][1];return e.getLocalTimeToUTC8(a[0],a[1],a[2],o[0],o[1],o[2])}if(2==r){var n=t[1],i=t[2],g=e.serverOpenTime+24*(n-1)*3600,u=new Date(1e3*g);return e.getLocalTimeToUTC8(u.getFullYear(),u.getMonth()+1,u.getDate(),i[0],i[1],i[2])}},e.checkInTimeRange=function(t,r){var a=this.ServerDate(1e3*e.lastServerTime),o=(a.getDay()+6)%7,n=new Date(a.getFullYear(),a.getMonth(),a.getDate()-o+(t[0]+6)%7);n.setHours(t[1],t[2],t[3]);var i=this.getLocalTimeToUTC8(n.getFullYear(),n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()),g=i+e.getSecondsDifference(t,r);return e.lastServerTime>i&&e.lastServerTime<g},e.getSecondsDifference=function(e,t){var r=86400,a=e[0],o=e[1],n=e[2],i=e[3],g=t[0],u=(7===g?0:g)*r+3600*t[1]+60*t[2]+t[3]-((7===a?0:a)*r+3600*o+60*n+i);return u<0&&(u+=604800),u},e.getTimeData=function(e){return[Math.floor(e%60),Math.floor(e/60)%60,Math.floor(e/3600)%24,Math.floor(e/86400)]},e.getTargetTimestamp=function(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0);var a=new Date((new Date).toLocaleDateString()).getTime();return new Date(a+1e3*(3600*e+60*t+r)).getTime()},e.getTargetTimestampByServer=function(t,r,a){void 0===t&&(t=0),void 0===r&&(r=0),void 0===a&&(a=0);var o=new Date(1e3*e.serverTime);return o.setHours(t),o.setMinutes(r),o.setSeconds(a),o.getTime()},e.msToHMS=function(e,t,r){void 0===t&&(t=":"),void 0===r&&(r=!0);var a=Math.floor(e/36e5),o=Math.floor((e-36e5*a)/6e4),n=Math.floor((e-36e5*a-6e4*o)/1e3);return""+(0!==a||r?a.toString().padStart(2,"0")+":":"")+o.toString().padStart(2,"0")+t+n.toString().padStart(2,"0")},e.formatTimeForMillisecond=function(e){var t=Math.floor(e/1e3%60),r=Math.floor(e/1e3/60%60),a=Math.floor(e/1e3/60/60);return(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)+":"+(a<10?"0"+a:a)},e.formatTimestampToMonthTime=function(e){return this.formatDate(new Date(1e3*e),"MM/dd hh:mm:ss")},e.formatTimeToMS=function(e){if(e<=0)return"00:00";var t=Math.floor(e%60),r=Math.floor(e/60%60);return(r<10?"0"+r:r)+":"+(t<10?"0"+t:t)},e.formatTimeForSecond=function(e){if(e<=0)return"00:00:00";var t=Math.floor(e%60),r=Math.floor(e/60%60),a=Math.floor(e/3600),o=t<10?"0"+t:t,n=r<10?"0"+r:r,i="";return a>0&&(i=a<10?"0"+a:String(a),i+=":"),""+i+n+":"+o},e.formatTimeStringForSecond=function(e){if(e<=0)return GetLanguage(200001);var t=Math.floor(e%60),r=Math.floor(e/60)%60,a=Math.floor(e/3600)%24,n=Math.floor(e/86400);return n>0?o.formatStrWithMirrorDeal(GetLanguage(200002),n,a,r,t):a>0?o.formatStrWithMirrorDeal(GetLanguage(200003),a,r,t):r>0?o.formatStrWithMirrorDeal(GetLanguage(200004),r,t):t>0?o.formatStrWithMirrorDeal(GetLanguage(200005),t):GetLanguage(200001)},e.formatTimeStringForSecondSimply=function(e){if(e<=0)return GetLanguage(200001);var t=Math.floor(e%60),r=Math.floor(e/60)%60,o=Math.floor(e/3600)%24,n=Math.floor(e/86400);return n>0?a.formatStr("%s%s %s%s",n,GetLanguage(999000592),o,GetLanguage(999000593)):o>0?a.formatStr("%s%s %s%s",o,GetLanguage(999000593),r,GetLanguage(999000594)):r>0?a.formatStr("%s%s %s%s",r,GetLanguage(999000594),t,GetLanguage(999000595)):t>0?a.formatStr("%s%s",t,GetLanguage(999000595)):GetLanguage(200001)},e.formatActivityTimeStringForSecond=function(e){if(e<=0)return GetLanguage(200001);var t=Math.floor(e%60),r=Math.floor(e/60)%60,n=Math.floor(e/3600)%24,i=Math.floor(e/86400);return i>0?o.formatStrWithMirrorDeal(GetLanguage(200006),i,n):n>0?a.formatStr("%s:%s:%s",n,r,t):GetLanguage(200001)},e.formatENTimeStringForSecond=function(e){if(e<=0)return GetLanguage(200001);var t=Math.floor(e%60),r=Math.floor(e/60)%60,n=Math.floor(e/3600)%24,i=Math.floor(e/86400),g=n<10?"0"+n:n,u=r<10?"0"+r:r,f=t<10?"0"+t:t;return i>0?o.formatStrWithMirrorDeal(GetLanguage_UI(300287),i,g,u,f):a.formatStr("%s:%s:%s",g,u,f)},e.getDateDiff=function(e){var t=this.serverTime-e;if(t<60)return GetLanguage(200007);var r=Math.floor(t/31104e3);return r>0?o.formatStrWithMirrorDeal(GetLanguage(200008),r):(r=Math.floor(t/2592e3))>0?o.formatStrWithMirrorDeal(GetLanguage(200009),r):(r=Math.floor(t/604800))>0?o.formatStrWithMirrorDeal(GetLanguage(200010),r):(r=Math.floor(t/86400))>0?o.formatStrWithMirrorDeal(GetLanguage(200011),r):(r=Math.floor(t/3600))>0?o.formatStrWithMirrorDeal(GetLanguage(200012),r):(r=Math.floor(t/60))>0?o.formatStrWithMirrorDeal(GetLanguage(200013),r):void 0},e.getDateDiffAfter=function(e){var t=e-this.serverTime;if(t<60)return GetLanguage(200007);var r=Math.floor(t/31104e3);return r>0?o.formatStrWithMirrorDeal(GetLanguage(200014),r):(r=Math.floor(t/2592e3))>0?o.formatStrWithMirrorDeal(GetLanguage(200015),r):(r=Math.floor(t/604800))>0?o.formatStrWithMirrorDeal(GetLanguage(200016),r):(r=Math.floor(t/86400))>0?o.formatStrWithMirrorDeal(GetLanguage(200017),r):(r=Math.floor(t/3600))>0?o.formatStrWithMirrorDeal(GetLanguage(200018),r):(r=Math.floor(t/60))>0?o.formatStrWithMirrorDeal(GetLanguage(200019),r):void 0},e.formatDate=function(e,t){var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?""+r[a]:("00"+r[a]).substr((""+r[a]).length)));return t},e.getDay=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},e.isNewDay=function(t){var r=e.ServerDate(t),a=e.ServerDate(e.serverTime),o=r.getFullYear(),n=r.getMonth(),i=r.getDate(),g=a.getFullYear(),u=a.getMonth(),f=a.getDate();return g>o||(u>n||f>i)},e.isNowValid=function(e,t){var r=new Date(e),a=new Date(t),o=!1;if(r.getDate()+""!="NaN"&&a.getDate()+""!="NaN"){var n=new Date;o=n<a&&n>r}return o},e.getDeltaDays=function(t,r){var a=e.ServerDate(t),o=e.ServerDate(r),n=a.getFullYear(),i=a.getMonth()+1,g=a.getDate(),u=o.getFullYear(),f=o.getMonth()+1,s=o.getDate();t=new Date(n+"/"+i+"/"+g+" GMT+0800").getTime();var l=(r=new Date(u+"/"+f+"/"+s+" GMT+0800").getTime())-t;return Math.floor(l/864e5)},e.getServerOpenDay=function(){var t=e.ServerDate(1e3*this.serverOpenTime),r=a.formatStr("%s/%s/%s %s:%s:%s",t.getFullYear(),t.getMonth()+1,t.getDate(),0,0,0),o=e.getServerDateByLocalStr(r).getTime()/1e3,n=e.serverTime-o;return Math.floor(n/86400+1)},e.getNextDayTime=function(){var t=e.ServerDate(1e3*this.serverTime),r=a.formatStr("%s/%s/%s %s:%s:%s",t.getFullYear(),t.getMonth()+1,t.getDate(),0,0,0);return e.getServerDateByLocalStr(r).getTime()/1e3+86400},e.getTimeLeft=function(t,r){if(!(t<0)){var a=Math.floor(t/3600)%24,n=Math.floor(t/86400);return n>0?o.formatStrWithMirrorDeal(GetLanguage(200006),n,a):e.formatTimeForSecond(t)}r&&r()},e.getFutureDateByDayTime=function(t,r){var o=e.ServerDate(1e3*this.serverTime),n=a.formatStr("%s/%s/%s %s:%s:%s",o.getFullYear(),o.getMonth()+1,o.getDate(),0,0,0),i=e.getServerDateByLocalStr(n).getTime()/1e3,g=o.getDay(),u=t%7,f=-1,s=3600*r[0]+60*r[1]+r[2];if(u-g>0)f=u-g;else if(u-g<0)f=6-g+u+1;else{var l=3600*o.getHours()+60*o.getMinutes()+o.getSeconds();l<s?f=0:l>s&&(f=7)}var m=i+60*f*60*24+s,h=e.ServerDate(1e3*m);return a.formatStr("%s/%s/%s %s:%s",h.getFullYear(),h.getMonth()+1,h.getDate(),h.getHours(),h.getMinutes())},t(e,null,[{key:"serverTimeZone",get:function(){return n},set:function(e){e&&(n=e)}},{key:"serverOpenTime",get:function(){return i},set:function(e){i=e}},{key:"serverTime",get:function(){var e=this.getLocalTime();return 0==u&&(u=this.getLocalTime()),g+(e-u)},set:function(e){g=e,u=this.getLocalTime()}},{key:"heartTime",get:function(){return f},set:function(e){f=e,this.serverTime=e}},{key:"lastServerTime",get:function(){return g}}]),e}());r._RF.pop()}}}));

