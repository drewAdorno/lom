System.register("chunks:///_virtual/CrossWarOutlinePopView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./BaseView.ts","./RoleDataCache.ts","./CrossWarControl.ts","./CrossWarDatacache.ts","./CrossWarDefine.ts"],(function(t){"use strict";var e,i,n,o,r,s,a,d,h,c,l,f,m,u,C,v,p;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,r=t.ScrollView,s=t.Label,a=t.Sprite,d=t.sys},function(t){h=t.ListItem},function(t){c=t.default},function(t){l=t.default},function(t){f=t.default},function(t){m=t.BaseView},function(t){u=t.RoleDataCache},function(t){C=t.default},function(t){v=t.CrossWarDataCache},function(t){p=t.CrossWarEventDefine}],execute:function(){n._RF.push({},"49cb4BJjoNF6bEujko/37xT","CrossWarOutlinePopView",void 0);t("default",function(t){function n(){var e;return(e=t.call(this)||this).scrollEquipList=void 0,e.timeTxt=void 0,e.awardList=[],e.name="CrossWarOutlinePopView",e.url="ui/module/crosswar/CrossWarOutlineView",e.poolTime=3e3,e}e(n,t);var h=n.prototype;return h.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.onMaskClick()}));var i=this.findChild("content/btnStart");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){IS(C).reqCrossWarGetIdelReward()}));var n=this.findChildComponent("content/scrollEquipList",r);this.scrollEquipList=this.addUIList(n,g),this.timeTxt=this.findChildComponent("content/timeTxt/time",s);for(var h=1;h<3;h++){var c={node:this.findChild("content/icon_bg"+h),icon:this.findChildComponent("content/icon_bg"+h+"/icon",a),rate:this.findChildComponent("content/icon_bg"+h+"/rateTxt",s),award:this.findChildComponent("content/icon_bg"+h+"/awardTxt",s)};this.awardList.push(c)}d.uiMirror&&this.findChild("content/timeTxt").setScale(1,1,1)},h.registerUpdateHandler=function(){this.addEvent(p.CROSS_WAR_IDLE_REWARD_REFRESH,this.refreshAwardItem,this)},h.onMaskClick=function(){this.close()},h.onAfterOpen=function(){this.addTimer(1,-1,this.refreshIdleTime,this),this.updateData()},h.onBeforeClose=function(){},h.onDestroy=function(){},h.refreshAwardItem=function(){for(var t,e=IS(v).las_reward_time,n=configCross_war_kv.getDataByKey(4).value,o=Math.max(Math.min(f.serverTime-e,n[2]),0),r=IS(u).GetPowerInfoByID(0),s=[],a=configCross_war_idle_reward.getDatas(),d=i(a);!(t=d()).done;){var h=t.value;if(r>=h.power[0]&&r<=h.power[1]){s=h.reward;break}if(r>=h.power[0]&&0==h.power[1]){s=h.reward;break}}if(s.length>0)for(var c=0;c<this.awardList.length;c++){var m=this.awardList[c];m.node.active=!1,s.length>c&&s[c]&&(m.node.active=!0,this.loadIcon(m.icon,"icon_item",s[c][0]+""),m.rate.string=s[c][1]+"/m",m.award.string=l.GetNumString(s[c][1]*Math.floor(o/n[0])))}else for(c=0;c<this.awardList.length;c++)this.awardList[c].node.active=!1},h.refreshIdleTime=function(){var t=IS(v).las_reward_time,e=configCross_war_kv.getDataByKey(4).value,i=Math.max(Math.min(f.serverTime-t,e[2]),0),n=f.formatTimeForSecond(i);this.timeTxt.string=n,i%60==0&&this.refreshAwardItem()},h.updateData=function(){this.refreshIdleTime(),this.refreshAwardItem(),this.scrollEquipList.datas=IS(v).report_list},n}(m));var g=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).nodeWin=void 0,e.nodeLose=void 0,e.imgHeadFrame=void 0,e.imgIcon=void 0,e.txtServ=void 0,e.txtName=void 0,e.loseTime=void 0,e.txtTime=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.nodeWin=c.findChild(this.node,"nodeWin"),this.nodeLose=c.findChild(this.node,"nodeLose"),this.imgHeadFrame=c.findChildComponent(this.node,"imgHeadFrame",a),this.imgIcon=c.findChildComponent(this.node,"imgIcon",a),this.loseTime=c.findChildComponent(this.node,"nodeLose/txtResult",s),this.txtServ=c.findChildComponent(this.node,"txtServ",s),this.txtName=c.findChildComponent(this.node,"txtName",s),this.txtTime=c.findChildComponent(this.node,"txtTime",s)},n.onRender=function(t,e){this.txtServ.string="[s"+t.serv_id+"]",this.txtName.string=t.name,this.nodeWin.active=1==t.result,this.nodeLose.active=2==t.result,this.txtTime.string=f.getDateDiff(t.time),this.loseTime.string="-"+Math.floor(t.reduce_time/60)+"min",this.view.loadRemoteIcon(t.head.url,this.imgIcon);var i=t.head.frame_id;if(i>0){this.imgHeadFrame.node.active=!0;var n=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",n.icon)}else this.imgHeadFrame.node.active=!1},i}(h);n._RF.pop()}}}));

