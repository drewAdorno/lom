System.register("chunks:///_virtual/PlayerClosetView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RankTitle.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ItemIcon.ts","./UIUnitModelObj.ts","./ArtifactControl.ts","./ArtifactDataCache.ts","./ArtifactDefine.ts","./MessageView.ts","./EquipControl.ts","./EquipDataCache.ts","./EquipDefine.ts","./EquipModel.ts","./HorseControl.ts","./HorseDataChche.ts","./HorseDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./WingControl.ts","./WingDataCache.ts","./WingDefine.ts","./BubbleControl.ts","./BubbleDataCache.ts","./FrameDataCache.ts","./HeadFrameControl.ts","./TitleControl.ts","./TitleDataCache.ts","./TitleDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,s,l,c,r,h,d,u,f,S,b,I,m,v,p,g,y,C,T,L,w,_,G,k,D,q,R,E,B,A,N,M,W,U,F,x,H,K,P,z,O,j,V,J,Y,Q,Z;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.UITransform,a=t.ScrollView,s=t.Sprite,l=t.Label,c=t.sys,r=t.RichText,h=t.Vec3,d=t.Layout,u=t.Color,f=t.LabelGradient,S=t.LabelOutline,b=t.Size,I=t.js},function(t){m=t.RankTitle,v=t.TitleType},function(t){p=t.ListItem},function(t){g=t.default},function(t){y=t.default},function(t){C=t.default},null,function(t){T=t.IconAseetType},function(t){L=t.UIUnitModelObj},function(t){w=t.default},function(t){_=t.ArtifactDataCache},function(t){G=t.ArtifactEvent},function(t){k=t.default},function(t){D=t.default},function(t){q=t.EquipDataCache},function(t){R=t.EquipEventDefine},function(t){E=t.EquipModel},function(t){B=t.default},function(t){A=t.HorseDataCache},function(t){N=t.HorseEvent},function(t){M=t.default},function(t){W=t.RoleDataCache},function(t){U=t.RoleEventDefine,F=t.PlayerAttr},function(t){x=t.default},function(t){H=t.WingDataCache},function(t){K=t.WingEvent},function(t){P=t.default},function(t){z=t.BubbleDataCache},function(t){O=t.FrameDataCache},function(t){j=t.default},function(t){V=t.default},function(t){J=t.TitleDataCache},function(t){Y=t.TitleEventDefine},function(t){Q=t.OpenFunction},function(t){Z=t.BaseView}],execute:function(){i._RF.push({},"a2ab2NBxUlEOLStx9TyqZem","PlayerClosetView",void 0);var X=0,$=1,tt=2,et=3,it=0,nt=1,ot=2,at=0,st=1,lt=(t("default",function(t){function i(){var e;return(e=t.call(this)||this).SubTabType={Fashinon:{ListShowType:1,ShowType:X,WearState:st,GetList:function(){for(var t=configSkin.getDataByList("type",2),e=[],i=0;i<t.length;i++)if(t[i].condition&&t[i].condition[0]){if(!IS(W).checkSkinCanShow(t[i].id))continue;var n=configGoods.getDataByKey(t[i].condition[0][0]),o=configColor.getDataByKey(n.quality);e.push({id:t[i].id,icon:t[i].icon,iconAtlas:"player",colorBg:o.path,name:t[i].name})}return e},GetState:function(t){var e=IS(W).GetUsedSkinList(),i=IS(W).GetSkinList(),n=it;return null==i[2][t]?IS(W).CanUnLockSkin(t)&&(n=it):(n=nt,e[2]==t&&(n=ot)),n},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.dressId=t,i},WearSendProto:function(t){var e=IS(W).GetUsedSkinList(),i=IS(W).GetSkinList();if(e[2]==t)IS(M).send_3_17(9);else if(t>0&&9!=t){if(null==i[2][t])return void k.showFlyTip(GetLanguage(200535));IS(M).send_3_17(t)}},ReqInfoFromServ:function(){IS(M).send_3_16()}},Job:{IconSize:new b(82,82),ListShowType:1,ShowType:X,WearState:at,GetList:function(){for(var t=IS(W).GetJob(),e=[];0!=t;){var i=configJobs.getDataByKey(t),n=i.job_icon.split("#"),o=IS(W).GetRoleAttr(F.ROLE_ATTR_GENDER),a="";a=1==n.length?i.job_icon:0==o||1==o?n[1]:n[2],e.push({id:i.id,icon:a,iconAtlas:"player",name:i.name}),t=i.front_job}return e.reverse(),e},GetState:function(t){return IS(W).GetRoleAttr(F.ROLE_ATTR_STYLE)==t?ot:nt},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.job=t,i},WearSendProto:function(t){IS(M).send_3_9(t)},ReqInfoFromServ:function(){IS(M).send_3_16()}},HairColor:{IconSize:new b(77,77),IconType:s.Type.SLICED,ListShowType:1,ShowType:X,WearState:at,GetList:function(){for(var t=configSkin.getDataByList("type",1),e=[],i=0;i<t.length;i++)e.push({id:t[i].id,icon:t[i].icon,iconAtlas:"player",name:t[i].name});return e},GetState:function(t){var e=IS(W).GetUsedSkinList(),i=IS(W).GetSkinList(),n=it;return null==i[1][t]?IS(W).CanUnLockSkin(t)&&(n=it):(n=nt,e[1]==t&&(n=ot)),n},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.color=t,i},WearSendProto:function(t){IS(M).send_3_17(t)},ReqInfoFromServ:function(){IS(M).send_3_16()}},Weapon:{NotSort:!0,ListShowType:1,ShowType:X,WearState:at,GetList:function(){return e.GetEquipList(1)},GetState:function(t){return e.GetEquipState(1,t)},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.weapon=e.getShowEquipByLocation(1,t),i.shenqi=0,i},WearSendProto:function(t){IS(D).reqEquipFigure(1,t)}},Artifact:{ListShowType:1,ShowType:X,WearState:st,GetList:function(){for(var t=[],e=configArtifact.getDatas(),i=0;i<e.length;i++)if(IS(_).checkArtifactCanShow(e[i].id)){var n=configColor.getDataByKey(e[i].quality);t.push({id:e[i].id,icon:e[i].icon_small,iconAtlas:"icon_item",colorBg:n.path,name:e[i].name})}return t},GetState:function(t){var e=IS(_).getAllArtifactState(t);return{1:it,2:nt,3:nt,4:ot,5:it}[e]},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.shenqi=t,i},WearSendProto:function(t){4==IS(_).getAllArtifactState(t)?IS(w).reqUseArtifact(0):IS(w).reqUseArtifact(t)},ReqInfoFromServ:function(){IS(M).send_3_16()}},HeadSkin:{NotSort:!0,ListShowType:1,ShowType:X,WearState:at,GetList:function(){return e.GetEquipList(2)},GetState:function(t){return e.GetEquipState(2,t)},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.ornaments=e.getShowEquipByLocation(2,t),i},WearSendProto:function(t){IS(D).reqEquipFigure(2,t)}},FaceSkin:{NotSort:!0,ListShowType:1,ShowType:X,WearState:at,GetList:function(){return e.GetEquipList(3)},GetState:function(t){return e.GetEquipState(3,t)},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.face=e.getShowEquipByLocation(3,t),i},WearSendProto:function(t){IS(D).reqEquipFigure(3,t)}},Title:{IconScale:2.3,ListShowType:2,ShowType:et,WearState:st,GetList:function(){for(var t=[],e=configTitle.getDatas(),i=0;i<e.length;i++)if(IS(J).checkTitleCanShow(e[i].id)){var n=configGoods.getDataByKey(e[i].item_id),o=!0;1==e[i].preview&&(o=IS(J).checkHasTitle(e[i].id)),o&&t.push({time:IS(J).getTitleTime(e[i].id),id:e[i].id,icon:e[i].icon,iconAtlas:"icon_title",name:n.name})}return t},GetState:function(t){var e=IS(J).curTitleId,i=IS(J).checkHasTitle(t);return e==t?ot:i?nt:it},WearSendProto:function(t){var e=IS(J).checkHasTitle(t),i=IS(J).curTitleId;e&&(i!=t?IS(V).send_42_2(t):IS(V).send_42_2(0))},ReqInfoFromServ:function(){IS(V).send_42_1()},CheckNewItem:function(t){IS(J).checkIsNew(t)&&IS(V).send_42_3(t)},GetWayDes:function(t){return configTitle.getDataByKey(t).get_way},GetRed:function(t){return t?!!IS(J).checkIsNew(t):IS(J).CanUnLockTitle()>0?1:0}},HeadFrame:{IconScale:1.5,ListShowType:1,IconSize:new b(80,80),ShowType:$,WearState:st,GetList:function(){for(var t=[],e=configAvatar_frame.getDatas(),i=0;i<e.length;i++)if(IS(O).checkFrameCanShow(e[i].id)){var n=configGoods.getDataByKey(e[i].item_id),o=!0;1==e[i].preview&&(o=IS(O).checkHas(e[i].id)),o&&t.push({time:IS(O).getFrameTime(e[i].id),id:e[i].id,icon:e[i].icon,iconAtlas:"icon_frame",name:n.name})}return t},GetState:function(t){var e=IS(O).curFrameId,i=IS(O).checkHas(t);return e==t?ot:i?nt:it},WearSendProto:function(t){var e=IS(O).checkHas(t),i=IS(O).curFrameId;e&&(i!=t?IS(j).send_47_2(t):IS(j).send_47_2(0))},ReqInfoFromServ:function(){IS(j).send_47_1()},CheckNewItem:function(t){IS(O).checkIsNew(t)&&IS(j).send_47_3(t)},GetWayDes:function(t){return configAvatar_frame.getDataByKey(t).get_way},GetRed:function(t){return t?!!IS(O).checkIsNew(t):IS(O).CanUnLockFrame()>0?1:0}},Bubble:{IconScale:1,ListShowType:2,ShowType:tt,WearState:at,GetList:function(){for(var t=[],e=configChat_bubble.getDatas(),i=0;i<e.length;i++)if(IS(z).checkBubbleCanShow(e[i].id)){var n=1==e[i].id?new b(260,111):new b(326,160),o=1==e[i].id?new b(260,111):new b(326,160);t.push({time:IS(z).getBubbleTime(e[i].id),id:e[i].id,icon:e[i].icon,iconAtlas:"chat",name:e[i].name,showSize:n,listSize:o,fontColor:new u("#"+e[i].text_color)})}return t},GetState:function(t){var e=IS(z).curBubbleId,i=IS(z).checkHasBubble(t);return e==t?ot:i?nt:it},WearSendProto:function(t){var e=IS(z).checkHasBubble(t),i=IS(z).curBubbleId;e&&(i!=t?IS(P).send_52_2(t):IS(P).send_52_2(0))},ReqInfoFromServ:function(){IS(P).send_52_1()},CheckNewItem:function(t){IS(z).checkIsNew(t)&&IS(P).send_52_4(t)},GetWayDes:function(t){return configChat_bubble.getDataByKey(t).get_way},GetRed:function(t){return t?!!IS(z).checkIsNew(t):IS(z).CanUnLockBubble()>0?1:0}},Mount:{ListShowType:1,ShowType:X,WearState:st,GetList:function(){for(var t=[],e=configMount_level.getDatas(),i={},n=0;n<e.length;n++)if(e[n].unlock>0&&!i[e[n].unlock]){i[e[n].unlock]=!0;var o=configMount.getDataByKey(e[n].unlock),a=configColor.getDataByKey(o.quality);t.push({id:o.id,icon:o.icon_small,name:o.name,iconAtlas:"icon_item",colorBg:a.path})}for(var s=configMount_skin.getDataByList("skin_level",0),l=0;l<s.length;l++){var c=configMount.getDataByKey(s[l].mount_id),r=configColor.getDataByKey(c.quality);IS(A).checkHorseCanShow(s[l].mount_id)&&t.push({id:c.id,icon:c.icon_small,name:c.name,iconAtlas:"icon_item",colorBg:r.path})}return t},GetState:function(t){var e=IS(A).getAllHorseState(t);return{1:it,2:nt,3:nt,4:ot,5:it}[e]},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.mount=t,i},WearSendProto:function(t){4==IS(A).getAllHorseState(t)?IS(B).reqUseHorse(0):IS(B).reqUseHorse(t)}},Wing:{ListShowType:1,IconSize:new b(74,74),ShowType:X,WearState:st,GetList:function(){for(var t=[],e=configBack_decoration.getDatas(),i=0;i<e.length;i++){var n=e[i],o=configColor.getDataByKey(n.quality);IS(H).checkWingCanShow(n.id)&&t.push({id:n.id,icon:n.icon_small,name:n.name,iconAtlas:"icon_item",colorBg:o.path})}return t},GetState:function(t){var e=IS(H).getAllWingState(t);return{1:it,2:nt,3:nt,4:ot,5:it}[e]},GetSkinInfo:function(t){var i=e.GetDefaultRoleData();return i.wing=t,i},WearSendProto:function(t){4==IS(H).getWingState(t)?IS(x).send_wing_use_c2s(0):IS(x).send_wing_use_c2s(t)}}},e.tabItemDefine=[{id:0,name:GetLanguage(201421),subTabList:[{id:0,name:GetLanguage(201422),type:e.SubTabType.Fashinon},{id:1,name:GetLanguage(201423),type:e.SubTabType.Job},{id:2,name:GetLanguage(201424),type:e.SubTabType.HairColor}]},{id:1,name:GetLanguage(201425),subTabList:[{id:0,name:GetLanguage(201425),type:e.SubTabType.Weapon},{id:1,name:GetLanguage(201426),type:e.SubTabType.Artifact}]},{id:2,name:GetLanguage(201427),subTabList:[{id:0,name:GetLanguage(201428),type:e.SubTabType.HeadSkin},{id:1,name:GetLanguage(201429),type:e.SubTabType.FaceSkin}]},{id:3,name:GetLanguage(201430),subTabList:[{id:0,name:GetLanguage(201431),type:e.SubTabType.Title},{id:1,name:GetLanguage(201432),type:e.SubTabType.HeadFrame},{id:2,name:GetLanguage(201433),type:e.SubTabType.Bubble}]},{id:4,name:GetLanguage(201434),subTabList:[{id:0,name:GetLanguage(201435),type:e.SubTabType.Mount},{id:1,name:GetLanguage(201436),type:e.SubTabType.Wing,IsOpen:function(){return IS(W).CheckFuncOpen(Q.FUNC_BACK)}}]}],e.tabItemList=[],e.tabSubItemList=[],e.subItemListTrans=void 0,e.mainType=null,e.subType=null,e.showType=void 0,e.selectInfo=void 0,e.scroll1=void 0,e.scroll2=void 0,e.nodeModelRoot=void 0,e.skinModel=void 0,e.roleIcon=void 0,e.bubbleIcon=void 0,e.bubbleIconTrans=void 0,e.bubbleLabel=void 0,e.titleNode=void 0,e.titleIcon=void 0,e.titleTxt=void 0,e.playerName=void 0,e.time=void 0,e.timer=void 0,e.confirmBtn=void 0,e.lockDes=void 0,e.confirmBtnTxt=void 0,e.isNotChange=void 0,e.cacheRoleData=void 0,e.name="PlayerClosetView",e.url="ui/module/player/PlayerClosetView",e}e(i,t);var d=i.prototype;return d.onInit=function(){var t=this,e=this.findChild("btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.onCloseClick()}));for(var i=function(e){var i=t.tabItemDefine[e];t.findChildComponent("view/tabList/btnList/btn"+(e+1)+"/selected/name",l).string=i.name,t.findChildComponent("view/tabList/btnList/btn"+(e+1)+"/normal/name",l).string=i.name,t.addComponentCallbackListener(t.findChild("view/tabList/btnList/btn"+(e+1)),n.EventType.CLICK,(function(){t.SelectTab(e)}));var o={red:t.findChild("view/tabList/btnList/btn"+(e+1)+"/red"),selected:t.findChild("view/tabList/btnList/btn"+(e+1)+"/selected"),normal:t.findChild("view/tabList/btnList/btn"+(e+1)+"/normal")};t.tabItemList.push({info:i,item:o})},h=0;h<this.tabItemDefine.length;h++)i(h);this.subItemListTrans=this.findChildComponent("view/tabSubList",o);for(var d=function(e){var i={node:t.findChild("view/tabSubList/btnList/btn"+(e+1)),red:t.findChild("view/tabSubList/btnList/btn"+(e+1)+"/red"),selected:t.findChild("view/tabSubList/btnList/btn"+(e+1)+"/selected"),name:t.findChildComponent("view/tabSubList/btnList/btn"+(e+1)+"/name",l),selectedName:t.findChildComponent("view/tabSubList/btnList/btn"+(e+1)+"/selected/name",l)};t.addComponentCallbackListener(t.findChild("view/tabSubList/btnList/btn"+(e+1)),n.EventType.CLICK,(function(){t.SelectSubTab(e)})),t.tabSubItemList.push(i)},u=0;u<3;u++)d(u);var f=this.findChildComponent("view/scroll1",a);this.scroll1=this.addUIList(f,lt);var S=this.findChildComponent("view/scroll2",a);this.scroll2=this.addUIList(S,ct),this.nodeModelRoot=this.findChild("view/role"),this.roleIcon=this.findChildComponent("view/roleIcon",s),this.bubbleIcon=this.findChildComponent("view/bubble",s),this.bubbleIconTrans=this.findChildComponent("view/bubble",o),this.bubbleLabel=this.findChildComponent("view/bubble/txt",l),c.uiMirror&&this.bubbleLabel.node.setScale(1,1,1),this.titleNode=g.findChild(this.node,"view/title"),this.titleIcon=g.findChildComponent(this.node,"view/title/icon",s),this.titleTxt=g.findChildComponent(this.node,"view/title/icon/txt",l),this.playerName=this.findChildComponent("view/name/txt",l),this.time=this.findChildComponent("view/time",r),this.lockDes=this.findChildComponent("view/lockDes",l),this.confirmBtn=this.findChild("view/confirmBtn"),this.addComponentCallbackListener(this.confirmBtn,n.EventType.CLICK,(function(){t.isNotChange||t.showType.WearSendProto(t.selectInfo.id)})),this.confirmBtnTxt=this.findChildComponent("view/confirmBtn/Label",l)},d.onCloseClick=function(){this.close()},d.registerUpdateHandler=function(){this.addEvent(U.ROLE_SKIN_LIST,this.RefreshInfo,this),this.addEvent(U.ROLE_INFO_UPDATE,this.RefreshInfo,this),this.addEvent(U.ROLE_SKIN_CHANGE,this.RefreshInfo,this),this.addEvent(Y.Title_INFO_UPDATE,this.RefreshInfo,this),this.addEvent(Y.Frame_INFO_UPDATE,this.RefreshInfo,this),this.addEvent(Y.Bubble_INFO_UPDATE,this.RefreshInfo,this),this.addEvent(R.EQUIP_FIGURE_UPDATE,this.RefreshInfo,this),this.addEvent(U.ROLE_SKIN_CHANGE,this.RefreshInfo,this),this.addEvent(N.TYPE_HORSE_CHANGE,this.RefreshInfo,this),this.addEvent(G.TYPE_ARTIFACT_CHANGE,this.RefreshInfo,this),this.addEvent(K.TYPE_WING_CHANGE,this.RefreshInfo,this)},d.onAfterOpen=function(){this.mainType=null,this.subType=null,this.SelectTab(0)},d.SelectTab=function(t){if(this.mainType!=t){this.mainType=t,this.subType=null;for(var e=0;e<this.tabItemList.length;e++){var i=this.tabItemList[e].item;i.selected.active=this.mainType==e,i.normal.active=this.mainType!=e}this.SelectSubTab(0)}},d.SelectSubTab=function(t){if(this.subType!=t){this.subType=t;for(var e=this.tabItemDefine[this.mainType].subTabList,i=0;i<this.tabSubItemList.length;i++){var n=this.tabSubItemList[i];e[i]?(n.node.active=!0,n.selected.active=this.subType==i,n.name.string=e[i].name,n.selectedName.string=e[i].name):n.node.active=!1}this.subItemListTrans.width=195*e.length;var o=this.tabItemDefine[this.mainType].subTabList[this.subType];this.showType=o.type,this.selectInfo=null;var a=this.showType,s=a.GetList();a.NotSort||s.sort((function(t,e){var i=a.GetState(t.id),n=a.GetState(e.id),o=i==nt||i==ot;return o!=(n==nt||n==ot)?o?-1:1:t.id<e.id?-1:1}));for(var l=0,c=0;c<s.length;c++){var r=s[c];if(a.GetState(r.id)==ot){l=c;break}}1==a.ListShowType?(this.scroll1.scrollView.node.active=!0,this.scroll2.scrollView.node.active=!1,this.scroll1.scrollView.scrollToTop(),this.scroll1.datas=s):(this.scroll1.scrollView.node.active=!1,this.scroll2.scrollView.node.active=!0,this.scroll2.scrollView.scrollToTop(),this.scroll2.datas=s),a.ReqInfoFromServ&&a.ReqInfoFromServ(),a.ShowType==X?(this.nodeModelRoot.active=!0,this.roleIcon.node.active=!1,this.bubbleIcon.node.active=!1,this.titleNode.active=!1):(null!=this.skinModel&&(this.removeUnitModel(this.skinModel),this.skinModel=null),this.nodeModelRoot.active=!1,a.ShowType==tt?(this.bubbleIcon.node.active=!0,this.roleIcon.node.active=!1,this.titleNode.active=!1):a.ShowType==et?(this.bubbleIcon.node.active=!1,this.roleIcon.node.active=!1,this.titleNode.active=!0):(this.roleIcon.node.active=!0,this.titleNode.active=!1,this.bubbleIcon.node.active=!1,a.IconScale?this.roleIcon.node.scale=new h(a.IconScale,a.IconScale,a.IconScale):this.roleIcon.node.scale=h.ONE)),this.cacheRoleData=null,this.SetSelectData(s[l])}},d.SetSelectData=function(t){if(!this.selectInfo||t.id!=this.selectInfo.id){this.selectInfo=t;var e=this.showType;e.CheckNewItem&&e.CheckNewItem(t.id),this.RefreshInfo()}},d.RefreshInfo=function(){var t=this;if(this.selectInfo){var e=this.showType;1==e.ListShowType?this.scroll1.updateAll():this.scroll2.updateAll(),this.timer&&(this.removeTimer(this.timer),this.timer=null),this.playerName.string=this.selectInfo.name,this.isNotChange=!1;var i=e.GetState(this.selectInfo.id);if(i!=it?(this.confirmBtn.active=!0,this.lockDes.node.active=!1,e.WearState==at?(this.confirmBtnTxt.string=i==ot?GetLanguage(200549):GetLanguage(200550),this.isNotChange=i==ot):this.confirmBtnTxt.string=i==ot?GetLanguage(201449):GetLanguage(200550)):(this.lockDes.node.active=!0,e.GetWayDes?this.lockDes.string=e.GetWayDes(this.selectInfo.id):this.lockDes.string=GetLanguage(201439),this.confirmBtn.active=!1),e.ShowType==X){var n=e.GetSkinInfo(this.selectInfo.id);this.RefreshModel(n),this.time.node.active=!1}else{var o=this.roleIcon;if(e.ShowType==tt&&(o=this.bubbleIcon,this.bubbleIconTrans.contentSize=this.selectInfo.showSize,this.bubbleLabel.color=this.selectInfo.fontColor),e.ShowType==et)new m(this,this.titleNode).SetRankTitle(this.selectInfo.id,v.NORMAL);if(this.loadIcon(o,this.selectInfo.iconAtlas,this.selectInfo.icon),this.selectInfo.time&&this.selectInfo.time>0&&this.selectInfo.time>C.serverTime){this.time.node.active=!0;var a="",s=this.selectInfo.time-C.serverTime,l=function(){s=t.selectInfo.time-C.serverTime;var e=Math.floor(s/3600)%24,i=Math.floor(s/86400);a=i>0?y.formatStrWithMirrorDeal(GetLanguage(200006),i,e):C.formatENTimeStringForSecond(s),a=I.formatStr("<color=#3ff125>%s</color>",a),t.time.string=I.formatStr("<b><outline width = 2 color=#181b1f>%s%s</outline></b>",GetLanguage(201440),a),s<=0&&t.timer&&(t.removeTimer(t.timer),t.timer=null)};l(),s>0&&(this.timer=this.addTimer(1,s,l))}else this.time.node.active=!1}this.UpdateRed()}},d.RefreshModel=function(t){if(this.cacheRoleData){var e=!0;for(var i in this.cacheRoleData)if(t[i]!=this.cacheRoleData[i]){e=!1;break}if(e)return}null!=this.skinModel&&(this.removeUnitModel(this.skinModel),this.skinModel=null),this.cacheRoleData=t;var n=1.3,o=L.getModelId(t.job,t.dressId,t.gender),a=configUnitModel.getDataByKey(o);a&&a.skin_scale>0&&(n=a.skin_scale),this.skinModel=this.addUnitModel(t,null,n),c.uiMirror&&(this.getUnitModel(this.skinModel).dir=-1)},d.UpdateRed=function(){for(var t=0;t<this.tabItemDefine.length;t++){for(var e=0,i=this.tabItemDefine[t].subTabList,n=0;n<i.length;n++){var o=i[n].type,a=0;o.GetRed&&(a=o.GetRed()),a>0?(t==this.mainType&&(this.tabSubItemList[n].red.active=!0),e++):t==this.mainType&&(this.tabSubItemList[n].red.active=!1)}this.tabItemList[t].item.red.active=e>0}},d.onBeforeClose=function(){this.timer&&(this.removeTimer(this.timer),this.timer=null)},d.onDestroy=function(){},d.GetEquipList=function(t){for(var e,i=IS(W).GetJob(),n=configJobs.getDataByKey(i).transmog_list||[],o={},a=0;a<n.length;a++)o[n[a]]=!0;var s=configEquipment.getDatas(),l=t,c=[],r={};for(var h in s){var d=s[h];1!=d.is_hide&&(d.part==l&&1==o[d.job]&&(r[d.icon]?d.id<r[d.icon]&&(r[d.icon]=d.id):r[d.icon]=d.id))}for(var u in IS(q).equipCidToGot){var f=configEquipment.getDataByKey(Number(u));r[f.icon]&&(r[f.icon]=Number(u))}for(var S in r){var b=r[S],I=configEquipment.getDataByKey(b),m=configColor.getDataByKey(I.quality),v=!0;if(1==I.preview)v=0!=I.id&&IS(E).checkEquipGot(I.id);v&&c.push({id:I.id,icon:I.icon,name:I.name,iconAtlas:I.atlas,colorBg:m.path,iconType:T.ICON_SPRITE})}c.sort((function(t,e){var i=IS(E).checkEquipGot(t.id);return i!=IS(E).checkEquipGot(e.id)?1==i?-1:1:t.id<e.id?-1:1}));var p=((e={})[1]="zjm_ui_wuqi",e[2]="zjm_ui_goushi",e[3]="zjm_ui_mianshi",e);return 1!=l&&c.unshift({id:-1,icon:p[t],iconAtlas:"equip",colorBgAtlas:"icon_equip",name:GetLanguage(200267),colorBg:"zjm_ui_pinzhikuangwu"}),c.unshift({id:0,name:GetLanguage(200266),icon:"zbhh_ui_guding",iconAtlas:"equip",colorBg:"zjm_ui_pinzhikuangbai"}),c},d.GetEquipState=function(t,e){var i=0!=e&&!IS(E).checkEquipGot(e)||!1;return-1==e&&(i=!1),i?it:e==IS(E).getEquipFigureByLocation(t)?ot:nt},d.GetDefaultRoleData=function(){return{job:IS(W).GetTypeUsedSkin(0),dressId:IS(W).GetTypeUsedSkin(2)||0,gender:IS(W).GetRoleAttr(F.ROLE_ATTR_GENDER),weapon:IS(E).getShowEquipCfgIdByLocation(1),ornaments:IS(E).getShowEquipCfgIdByLocation(2),face:IS(E).getShowEquipCfgIdByLocation(3),color:IS(W).GetTypeUsedSkin(1),mount:IS(A).horse_id,shenqi:IS(_).artifact_id,wing:IS(H).wing_id,parent:this.nodeModelRoot}},d.getShowEquipByLocation=function(t,e){return-1==e?0:0!=e?e:IS(E).getWearEquipCfgIdByLocation(t)},i}(Z)),function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).qualityItem=void 0,e.normalItem=void 0,e.qualityBg=void 0,e.qualityIcon=void 0,e.qualityDress=void 0,e.qualityIconTrans=void 0,e.qualityNormalBg=void 0,e.bg=void 0,e.icon=void 0,e.iconTrans=void 0,e.dress=void 0,e.red=void 0,e.select=void 0,e.timesp=void 0,e.lock=void 0,e}e(i,t);var a=i.prototype;return a.onInit=function(){var t=this;this.view.addComponentCallbackListener(this.node,n.EventType.CLICK,(function(){t.onItemClick()})),this.qualityItem=g.findChild(this.node,"qualityItem"),this.normalItem=g.findChild(this.node,"normalItem"),this.red=g.findChild(this.node,"red"),this.qualityDress=g.findChild(this.node,"qualityItem/dress"),this.view.loadIcon(g.findChildComponent(this.node,"qualityItem/dress/icon",s),"player","grxx_ui_gouxuan"),this.qualityBg=g.findChildComponent(this.node,"qualityItem/quality",s),this.qualityNormalBg=g.findChildComponent(this.node,"qualityItem/bg",s),this.qualityIcon=g.findChildComponent(this.node,"qualityItem/icon",s),this.qualityIconTrans=g.findChildComponent(this.node,"qualityItem/icon",o),this.bg=g.findChildComponent(this.node,"normalItem/bg",s),this.dress=g.findChild(this.node,"normalItem/dress"),this.view.loadIcon(g.findChildComponent(this.node,"normalItem/dress/icon",s),"player","grxx_ui_gouxuan"),this.icon=g.findChildComponent(this.node,"normalItem/icon",s),this.iconTrans=g.findChildComponent(this.node,"normalItem/icon",o),this.select=g.findChild(this.node,"selected"),this.timesp=g.findChild(this.node,"timesp"),this.view.dealMirrorLayout(this.timesp.getComponent(d)),this.lock=g.findChild(this.node,"lock")},a.onRender=function(t,e){var i,n=this.view.showType,o=n.GetState(t.id),a=this.icon,l=this.dress,c=this.iconTrans,r=this.bg;t.colorBg?(r=this.qualityNormalBg,a=this.qualityIcon,l=this.qualityDress,c=this.qualityIconTrans,this.qualityBg.grayscale=o==it,this.qualityItem.active=!0,this.normalItem.active=!1,this.view.loadIcon(this.qualityBg,null!=(i=t.colorBgAtlas)?i:"icon_equip",t.colorBg)):(this.normalItem.active=!0,this.qualityItem.active=!1);l.active=o==ot,this.lock.active=o==it,r.grayscale=o==it,a.grayscale=o==it,n.GetRed?this.red.active=n.GetRed(t.id):this.red.active=!1;var h=this.view.selectInfo;this.select.active=h.id==t.id,this.view.loadIcon(a,t.iconAtlas,t.icon,null,t.iconType),this.timesp.active=t.time&&t.time>0,n.IconType&&(a.type=n.IconType),n.IconSize?(a.sizeMode=s.SizeMode.CUSTOM,c.contentSize=n.IconSize):a.sizeMode=s.SizeMode.TRIMMED},a.onItemClick=function(){this.view.SetSelectData(this.data)},i}(p)),ct=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).qualityBg=void 0,e.icon=void 0,e.dress=void 0,e.bg=void 0,e.select=void 0,e.timesp=void 0,e.lock=void 0,e.red=void 0,e.bubble=void 0,e.bubbleTrans=void 0,e.bubbleTxt=void 0,e.titleNode=void 0,e.titleIcon=void 0,e.titleTxt=void 0,e}e(i,t);var a=i.prototype;return a.onInit=function(){var t=this;this.view.addComponentCallbackListener(this.node,n.EventType.CLICK,(function(){t.onItemClick()})),this.red=g.findChild(this.node,"red"),this.dress=g.findChild(this.node,"dress"),this.view.loadIcon(g.findChildComponent(this.node,"dress/icon",s),"player","grxx_ui_gouxuan"),this.icon=g.findChildComponent(this.node,"icon",s),this.bg=g.findChildComponent(this.node,"bg",s),this.select=g.findChild(this.node,"selected"),this.timesp=g.findChild(this.node,"timesp"),this.view.dealMirrorLayout(this.timesp.getComponent(d)),this.lock=g.findChild(this.node,"lock"),this.bubble=g.findChildComponent(this.node,"bubble",s),this.bubbleTrans=g.findChildComponent(this.node,"bubble",o),this.bubbleTxt=g.findChildComponent(this.node,"bubble/txt",l),c.uiMirror&&this.bubbleTxt.node.setScale(2,2,1),this.titleNode=g.findChild(this.node,"title"),this.titleIcon=g.findChildComponent(this.node,"title/icon",s),this.titleTxt=g.findChildComponent(this.node,"title/icon/Label",l)},a.onRender=function(t,e){var i=this.icon,n=this.dress,o=this.view.showType,a=o.GetState(t.id);if(n.active=a==ot,this.lock.active=a==it,this.bg.grayscale=a==it,this.select.active=this.view.selectInfo.id==t.id,this.timesp.active=t.time&&t.time>0,o.GetRed?this.red.active=o.GetRed(t.id):this.red.active=!1,o.ShowType==tt)i=this.bubble,this.icon.node.active=!1,this.titleNode.active=!1,this.bubble.node.active=!0,this.bubble.grayscale=a==it,this.bubbleTxt.color=a==it?new u("#969696"):t.fontColor,this.bubbleTrans.contentSize=t.listSize;else if(o.ShowType==et){i=this.bubble,this.icon.node.active=!1,this.bubble.node.active=!1,this.titleNode.active=!0,new m(this.view,this.titleNode).SetRankTitle(t.id,v.NORMAL),this.titleIcon.grayscale=a==it,a==it&&(this.titleTxt.node.getComponent(f).color1=new u("#969696"),this.titleTxt.node.getComponent(f).color2=new u("#969696"),this.titleTxt.node.getComponent(S).color=new u("#000000"))}else this.icon.grayscale=a==it,this.bubble.node.active=!1,this.titleNode.active=!1,this.icon.node.active=!0;this.view.loadIcon(i,t.iconAtlas,t.icon)},a.onItemClick=function(){this.view.SetSelectData(this.data)},i}(p);i._RF.pop()}}}));

