System.register("chunks:///_virtual/JobSelectView_3.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./NodeUtil.ts","./StorageUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./MessageView.ts","./EquipModel.ts","./MainViewModel.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(i){"use strict";var e,t,o,n,s,l,a,c,r,d,h,u,f,g,p,m,v,S,k,C,b,I,y;return{setters:[function(i){e=i.inheritsLoose},function(i){t=i.cclegacy,o=i.Button,n=i.Sprite,s=i.js,l=i.Toggle,a=i.sys,c=i.Layout,r=i.Label},function(i){d=i.audioMgr},function(i){h=i.default},function(i){u=i.default},function(i){f=i.default},null,function(i){g=i.IconAseetType},function(i){p=i.ConfigGlobal},function(i){m=i.default},function(i){v=i.EquipModel},function(i){S=i.MainViewModel},function(i){k=i.default},function(i){C=i.RoleDataCache},function(i){b=i.PlayerAttr},function(i){I=i.PanelTabType},function(i){y=i.BaseView}],execute:function(){t._RF.push({},"e4025n90xdI4Yz959wUg2lk","JobSelectView_3",void 0);i("default",function(i){function t(){var e;return(e=i.call(this)||this).togNode=void 0,e.togSkip=void 0,e.curSelectJob=0,e.imgFrame1=void 0,e.imgIcon1=void 0,e.imgFrame2=void 0,e.imgIcon2=void 0,e.passiveList=[],e.jobItems=[],e.name="JobSelectView_3",e.url="ui/module/role/JobSelectView_3",e}e(t,i);var r=t.prototype;return r.onInit=function(){var i=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){i.close()}));var t=this.findChild("Button");this.addComponentCallbackListener(t,o.EventType.CLICK,(function(){i.onJobClick()})),this.imgFrame1=h.findChildComponent(this.node,"skill/active/skill1",n),this.imgIcon1=h.findChildComponent(this.node,"skill/active/icon1",n),this.imgFrame2=h.findChildComponent(this.node,"skill/active/skill2",n),this.imgIcon2=h.findChildComponent(this.node,"skill/active/icon2",n),this.addComponentCallbackListener(this.imgFrame1.node,o.EventType.CLICK,(function(){var e=configJobs.getDataByKey(IS(C).GetJob()),t=configSkill.getDataByKey(e.skill[0][1][0]),o=IS(C).GetLevel(),n=configSkill_level.getDataByKeys("id",t.id,"level",o);uiMgr.openView("JobSkillTipsView",f.formatStr.apply(f,[n.desc].concat(n.desc_parm)),i.imgFrame1.node)})),this.addComponentCallbackListener(this.imgFrame2.node,o.EventType.CLICK,(function(){var e=configJobs.getDataByKey(i.curSelectJob),t=configSkill.getDataByKey(e.skill[0][1][0]),o=IS(C).GetLevel(),n=configSkill_level.getDataByKeys("id",t.id,"level",o);uiMgr.openView("JobSkillTipsView",f.formatStr.apply(f,[n.desc].concat(n.desc_parm)),i.imgFrame2.node)}));for(var r=function(e){var t=h.findChild(i.node,s.formatStr("skill/passive/item%s",e+1)),l={node:t,frame:h.findChildComponent(t,"frame",n),icon:h.findChildComponent(t,"icon",n),up:h.findChild(t,"up"),skillId:0,skillLev:0};i.addComponentCallbackListener(t,o.EventType.CLICK,(function(){var i=configSkill_level.getDataByKeys("id",l.skillId,"level",l.skillLev);uiMgr.openView("JobSkillTipsView",f.formatStr.apply(f,[i.desc].concat(i.desc_parm)),l.node)})),i.passiveList.push(l)},d=0;d<5;d++)r(d);for(var g=0;g<2;g++){var p=this.findChild(s.formatStr("job_%s",g)),m=new _;m.init(p,this,g),this.jobItems.push(m)}var v=this.findChildComponent("job_1/nameSelectBg/Sprite/Sprite",n);this.loadIcon(v,"job","zj_ui_xuanze"),this.togNode=this.findChild("tog"),this.togSkip=this.findChildComponent("tog/toggleSkip",l),this.addComponentCallbackListener(this.togSkip.node,l.EventType.TOGGLE,(function(){i.togSkip.isChecked?u.set("SkipJobAnim","1"):u.set("SkipJobAnim","0")})),a.uiMirror&&this.dealMirrorLayout(this.togNode.getComponent(c))},r.onJobClick=function(){var i=this,e=IS(C).GetLevel(),t=IS(C).GetJob(),o=configJobs.getDataByKey(t).change_times,n=p.transfer_job_level;if(5==o&&e>=n[o]&&IS(C).awakeAllPos()){var s=IS(C).GetJob(),l=IS(v).getShowEquipCfgIdByLocation(1),a=configJobs.getDataByKey(this.curSelectJob),c=IS(C).GetTypeUsedSkin(1),r=f.formatStrWithMirrorDeal(GetLanguage(200579),a.name);m.showBoxTip({tip:r,title:GetLanguage(200048),func:function(e){if("type_yes"==e){if(IS(k).send_3_6(i.curSelectJob),i.close(),d.playSound("common_evolution"),i.togNode.active&&i.togSkip.isChecked)return;uiMgr.openView("JobEffectView",s,l,i.curSelectJob,c)}}})}else IS(S).TryJumpToMainViewPanel(I.Main_Role,I.Role_Awake),this.close()},r.registerUpdateHandler=function(){},r.onAfterOpen=function(){var i=IS(C).GetJob(),e=configJobs.getDataByKey(i);this.curSelectJob=e.job_change[0],this.jobItems[0].show(i),this.jobItems[1].show(this.curSelectJob),this.updateSkill();var t=IS(C).GetRoleId();(""==u.get("JobSelectRecord"+t,!1)?[]:u.get("JobSelectRecord"+t,!0))[e.change_times]?(this.togNode.active=!0,this.togSkip.isChecked="1"==u.get("SkipJobAnim")):this.togNode.active=!1},r.onBeforeClose=function(){},r.onDestroy=function(){},r.updateSkill=function(){var i=configJobs.getDataByKey(IS(C).GetJob()),e=configSkill.getDataByKey(i.skill[0][1][0]);this.loadIcon(this.imgFrame1,"icon_skill",s.formatStr("common_ICON_jinengkuang0%s",e.quality)),this.loadIcon(this.imgIcon1,"icon_skill",e.icon);var t=configJobs.getDataByKey(this.curSelectJob),o=configSkill.getDataByKey(t.skill[0][1][0]);this.loadIcon(this.imgFrame2,"icon_skill",s.formatStr("common_ICON_jinengkuang0%s",o.quality)),this.loadIcon(this.imgIcon2,"icon_skill",o.icon);for(var n=0;n<5;n++){var l=this.passiveList[n];if(n<t.passive_skill.length){l.levLimit=t.passive_skill[n][0],l.skillId=t.passive_skill[n][1][0],l.skillLev=t.passive_skill[n][1][1],l.up.active=t.passive_skill[n][1][0]!=i.passive_skill[n][1][0]||t.passive_skill[n][1][1]!=i.passive_skill[n][1][1];var a=configSkill.getDataByKey(l.skillId);this.loadIcon(l.frame,"icon_skill",s.formatStr("common_ICON_jinengkuang0%s",a.quality)),this.loadIcon(l.icon,"icon_skill",a.icon,null,g.ICON_SPRITE)}}},t}(y));var _=function(){function i(){this.view=void 0,this.node=void 0,this.index=void 0,this.job=void 0,this.txtName=void 0,this.icon=void 0}var e=i.prototype;return e.init=function(i,e,t){this.view=e,this.node=i,this.index=t,this.onInit()},e.onInit=function(){this.txtName=h.findChildComponent(this.node,"name",r),this.icon=h.findChildComponent(this.node,"icon",n)},e.show=function(i){this.node.active=!0,this.job=i;var e=configJobs.getDataByKey(this.job),t=IS(C).GetRoleAttr(b.ROLE_ATTR_GENDER);this.txtName.string=e.name,2==t&&e.change_times>=5?(this.view.loadIcon(this.icon,"icon_job",s.formatStr("job_%s_2",this.job),null,g.ICON_SPRITE),this.icon.node.setPosition(a.uiMirror?-e.position[2]:e.position[2],e.position[3],0)):(this.view.loadIcon(this.icon,"icon_job",s.formatStr("job_%s",this.job),null,g.ICON_SPRITE),this.icon.node.setPosition(a.uiMirror?-e.position[0]:e.position[0],e.position[1],0)),this.icon.node.setScale(a.uiMirror?-e.scale:e.scale,e.scale,e.scale)},i}();t._RF.pop()}}}));

