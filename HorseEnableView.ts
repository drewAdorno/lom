System.register("chunks:///_virtual/HorseEnableView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./index57.ts","./BagModel.ts","./MessageView.ts","./HorseControl.ts","./HorseDataChche.ts","./HorseDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var e,n,o,i,s,r,a,h,l,d,f,c,u,C;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,i=t.Button,s=t.Vec2,r=t.sys,a=t.Label},function(t){h=t.default},null,function(t){l=t.BagModel},function(t){d=t.default},function(t){f=t.default},function(t){c=t.HorseDataCache},function(t){u=t.HorseEvent},function(t){C=t.BaseSubView}],execute:function(){o._RF.push({},"39da8i78GZK9oNXfGqzyiRJ","HorseEnableView",void 0);var g=1025;t("default",function(t){function o(){var e;return(e=t.call(this)||this).nodeRoot=void 0,e.btnOne=void 0,e.btnTen=void 0,e.horseEffectID=0,e.is_top=!1,e.showID=IS(c).horse_id,e.name="HorseEnableView",e.url="ui/module/horse/HorseEnableView",e.poolTime=3e3,e}e(o,t);var C=o.prototype;return C.onInit=function(){var t=this;this.nodeRoot=this.findChild("root");var e=this.findChild("root/nodeItem");this.addComponentCallbackListener(e,i.EventType.CLICK,(function(){})),this.btnOne=this.findChild("root/nodeChange/btnOne"),this.addComponentCallbackListener(this.btnOne,i.EventType.CLICK,(function(){t.onClickOne()})),this.btnTen=this.findChild("root/nodeChange/btnTen"),this.addComponentCallbackListener(this.btnTen,i.EventType.CLICK,(function(){t.onClickTen()})),this.addRedPoint("horse_enable_active",this.btnTen,new s(100,30)),IS(c).checkEnableRP()},C.registerUpdateHandler=function(){this.addEvent(u.TYPE_HORSE_CHANGE,this.refreshShow,this),this.addEvent(u.TYPE_HORSE_ENABLE_INFO,this.refreshShow,this)},C.onAfterOpen=function(){this.showID=IS(c).horse_id,0==this.showID&&(this.showID=Math.ceil(IS(c).curLevel/10)),this.refreshHorseShow(),this.refreshTalentInfo(),this.refreshItemNum()},C.refreshShow=function(){this.refreshTalentInfo(),this.refreshItemNum()},C.refreshHorseShow=function(){var t=this.findChild("root/nodeShow/icon"),e=configMount.getDataByKey(this.showID);null!=e&&(this.removeUIEffect(this.horseEffectID),this.horseEffectID=this.addUIEffect(e.path,t,-1,null,1,(function(t){r.uiMirror&&(t.dir=-1)})))},C.onClickOne=function(){var t=IS(c).getTotalLevel(),e=configMount_abilitycost.getDataByKey(t).cost[0][1];IS(l).getGoodsCountByGoodsGtid(g)<e?(uiMgr.openView("ItemGetWayView",g),d.showFlyTip(GetLanguage(200069))):IS(f).reqEnable(0)},C.onClickTen=function(){var t=IS(c).getTotalLevel(),e=configMount_abilitycost.getDataByKey(t).cost[0][1];IS(l).getGoodsCountByGoodsGtid(g)<e?(uiMgr.openView("ItemGetWayView",g),d.showFlyTip(GetLanguage(200069))):IS(f).reqEnable(1)},C.refreshItemNum=function(){this.refreshAttrChange();var t=this.findChildComponent("root/nodeItem/Label",a),e=IS(l).getGoodsCountByGoodsGtid(g);t.string=""+e,IS(c).checkEnableRP()},C.refreshAttrChange=function(){if(!this.is_top){for(var t,e=h.findChildComponent(this.nodeRoot,"nodeChange/txtLevel",a),o=h.findChildComponent(this.nodeRoot,"nodeChange/txtRate",a),i=IS(c).talent_list,s=0,r=n(i);!(t=r()).done;){var d=t.value;d.k;s+=d.v}var f=configMount_abilitycost.getDatas();if(!(s>=f[f.length-1].total_level)){e.string="Lv."+s;var u=configMount_abilitycost.getDataByKey(s);o.string=u.success_rate/100+"%";var C=h.findChild(this.btnOne,"txtNum"),v=h.findChild(this.btnOne,"txtRed"),I=IS(l).getGoodsCountByGoodsGtid(g),b=u.cost[0][1];C.getComponent(a).string=b+"",v.getComponent(a).string=b+"",v.active=I<b,C.active=I>=b}}},C.refreshTalentInfo=function(){for(var t=IS(c).talent_list,e=0,o=1;o<4;o++){var i=this.findChild("root/nodeSkill/node"+o);if(!i)return;for(var s,r=h.findChildComponent(i,"txtLevel",a),l=h.findChildComponent(i,"bg/txtRate",a),d=h.findChildComponent(i,"bg/txtDesc",a),f=0,u=n(t);!(s=u()).done;){var C=s.value,g=C.k,v=C.v;if(g==o){f=v;break}}r.string=""+f;var I=configMount_ability.getDataByKeys("id",o,"level",f).value_plus;l.string="+"+I[0][1]/100+"%",d.string=configAttribute.getDataByKey(I[0][0]).desc,e+=f}var b=this.findChild("root/nodeChange"),p=this.findChild("root/nodeTop"),y=configMount_abilitycost.getDatas();e>=y[y.length-1].total_level?(h.findChildComponent(p,"txtLevel",a).string="Lv."+e,b.active=!1,p.active=!0,this.is_top=!0):(b.active=!0,p.active=!1,this.is_top=!1)},C.onBeforeClose=function(){},C.onDestroy=function(){},o}(C));o._RF.pop()}}}));

