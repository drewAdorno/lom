System.register("chunks:///_virtual/NoticeView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLoadingView.ts","./UIList.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./MathUtil.ts","./HttpClient.ts","./LoginControl.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var n,e,i,o,s,a,c,r,l,d,u,h,f,p,g,m,v,x,C;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t.ScrollView,o=t.Button,s=t.Node,a=t.UITransform,c=t.Vec3,r=t.RichText,l=t.Label,d=t.isValid},function(t){u=t.GameLoadingView},function(t){h=t.ListItem},function(t){f=t.default},function(t){p=t.default},null,function(t){g=t.default},function(t){m=t.HttpClient},function(t){v=t.default},function(t){x=t.ViewType},function(t){C=t.BaseView}],execute:function(){e._RF.push({},"6a61fHabZhM6aaQnOOZZVQQ","NoticeView",void 0);t("NoticeView",function(t){function e(){var n;return(n=t.call(this)||this)._httpRequstId=0,n.startPos=new c(0,0,0),n.noticeScroll=void 0,n.txtData=[],n.name="NoticeView",n.url="ui/module/notice/NoticeView",n.poolTime=3e3,n}n(e,t);var r=e.prototype;return r.onInit=function(){var t=this;this.node.parent=uiMgr.pNodes[x.TopView];var n=this.findChildComponent("ScrollView",i);this.noticeScroll=this.addUIList(n,y),this.noticeScroll.virtual=!1;var e=this.findChild("btnClose");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.close()}));var s=this.findChild("imgMask");this.addComponentCallbackListener(s,o.EventType.CLICK,(function(){t.close()}));var a=IS(v).getLoginArea(),c=configTrans_language.getDataByKey(u.instance.curlaguage).language_t,r="xxjzz-cdnres.joynetgamestudio.com/cdnconfig_{0}/serverlists/announcement/xxjzz_"+a+"_"+c+"_announcement.txt";GlobalDefine.SERVER_LIST_TYPE<=1&&(r="xxjzz-cdnres.joynetgamestudio.com/cdnconfig_{0}/serverlists/announcement/xxjzz_mix_ustest_"+c+"_announcement.txt");var l=p.getLocalTime()+""+g.getRandomInt(1,99999999);-1==(r=r.replace("{0}",l)).indexOf("http")&&(r="https://"+r),this._httpRequstId=m.get(r,(function(n,e){if(t._httpRequstId=0,0==n){var i=JSON.parse(e);t.txtData=i.data,t.getDataAndSort()}})),this.initScrollBarHandle()},r.initScrollBarHandle=function(){var t=this.findChild("handle"),n=this.findChild("scrollBar/bar"),e=this.findChildComponent("ScrollView",i);t.on(s.EventType.TOUCH_START,(function(t){this.startPos=t.getLocation()}),this),t.on(s.EventType.TOUCH_MOVE,(function(t){var i=t.getLocation().y-this.startPos.y,o=e.content.getComponent(a).contentSize,s=e.content.position,r=new c(s.x,Math.max(Math.min(s.y-i*o.y/780,o.y-780),0));if(s.y!=r.y){var l=n.position;n.position=new c(l.x,l.y+i),e.content.position=r}this.startPos=t.getLocation()}),this)},r.onAfterOpen=function(){this.getDataAndSort()},r.getDataAndSort=function(){this.txtData.sort((function(t,n){return t.key1>n.key1?1:t.key1<n.key1?-1:t.title>n.title?1:-1})),this.noticeScroll.datas=this.txtData},r.registerUpdateHandler=function(){},r.onBeforeClose=function(){},r.onDestroy=function(){},e}(C));var y=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).txtDesc=void 0,n.txtTitle=void 0,n.listening=!1,n}n(e,t);var i=e.prototype;return i.onInit=function(){this.adaptiveSize=!0,this.txtDesc=f.findChildComponent(this.node,"item",r),this.txtTitle=f.findChildComponent(this.node,"title",l)},i.onRender=function(t,n){var e=this;d(this.txtDesc)&&d(this.txtDesc.node)&&!this.listening&&(this.txtDesc.node.on(s.EventType.SIZE_CHANGED,(function(){var t=e.txtDesc.node.getComponent(a).height;f.findChildComponent(e.node,"",a).height=t+100})),this.listening=!0),this.txtTitle.string=t.title,this.txtDesc.string=t.content},e}(h);e._RF.pop()}}}));

