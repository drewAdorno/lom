System.register("chunks:///_virtual/ActivityPoolPartyTurnView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./AudioMgr.ts","./ItemGrid.ts","./UIList.ts","./UIRichText.ts","./NodeUtil.ts","./StorageUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./SpineSkeleton.ts","./FixMath.ts","./BagDefine.ts","./BagModel.ts","./RoleDefine.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./HorseCarnivalControl.ts","./HorseCarnivalDataCache.ts","./ActivityPoolPartyDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,r,a,s,d,c,h,l,u,f,p,g,m,v,w,y,C,T,_,G,S,L,I,k,R,D,x,V,b,M,j,N;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose,n=t.regeneratorRuntime},function(t){o=t.cclegacy,r=t.Button,a=t.Sprite,s=t.Label,d=t.ScrollView,c=t.RichText,h=t.Layout,l=t.Toggle,u=t.sys},function(t){f=t.V2},function(t){p=t.audioMgr},function(t){g=t.ItemGrid},function(t){m=t.ListItem},function(t){v=t.UIRichText},function(t){w=t.default},function(t){y=t.default},function(t){C=t.default},function(t){T=t.default},null,function(t){_=t.SpineSkeleton},function(t){G=t.FixMath},function(t){S=t.BagEventDefine},function(t){L=t.BagModel},function(t){I=t.RoleEventDefine},function(t){k=t.default},function(t){R=t.ActivityType,D=t.ActivityEventDefine,x=t.ActivityState},function(t){V=t.default},function(t){b=t.HorseCarnivalDataCache},function(t){M=t.default},function(t){j=t.ViewEvent,N=t.BaseView}],execute:function(){var A,P,B,O,E,K;o._RF.push({},"0d49bgSgz1HAYOlh/2Yi2BB","ActivityPoolPartyTurnView",void 0);var U=((A={})[1]="yc_cj_sj01",A[2]="yc_cj_sq01",A[3]="yc_cj_zq01",A[4]="yc_cj_sz02",A),W=((P={})[1]=699,P[2]=1e3,P[3]=500,P[4]=350,P),q=((B={})[40020]="yc_cj_sq01",B[40018]="yc_cj_sq03",B),F={},H=((O={})[1]=5,O[2]=6,O[3]=8,O[4]=7,O),z=["ArtifactGetView","HorseGetView","PlayerSkinGetView","FateNewView","GoodsGetView2","WingGetView"],X=((E={})[1]="yc_cj_lvqiu",E[2]="yc_cj_lvqiu",E[3]="yc_cj_lanqiu",E[4]="yc_cj_ziqiu",E[5]="yc_cj_huangqiu",E[6]="yc_cj_chengqiu",E[7]="yc_cj_hongqiu",E[8]="yc_cj_hongqiu",E[9]="yc_cj_hongqiu",E[10]="yc_cj_hongqiu",E),J=((K={})[1]="lv",K[2]="lv",K[3]="lan",K[4]="zi",K[5]="huang",K[6]="cheng",K[7]="hong",K[8]="hong",K[9]="hong",K[10]="hong",K),Y=(t("default",function(t){function o(){var e;return(e=t.call(this)||this).actType=void 0,e.nodeResParent=void 0,e.nodeResItem=void 0,e.nodeRolling=void 0,e.rollEff=void 0,e.bgEff=void 0,e.turnEff=void 0,e.resItems=void 0,e.redSelect=void 0,e.btnGift=void 0,e.btnStore=void 0,e.togSkip=void 0,e.skipAnim=void 0,e.iconTen=void 0,e.iconOne=void 0,e.txtOne=void 0,e.txtTen=void 0,e.redOne=void 0,e.redTen=void 0,e.txtNumReward=void 0,e.numScroll=void 0,e.tipsGo=void 0,e.tipsScroll=void 0,e.imgPreview=void 0,e.preDescNum=void 0,e.preDescGet=void 0,e.onlyRewardNum=0,e.iconRewardOne=void 0,e.iconRewardTen=void 0,e.txtRewardOne=void 0,e.txtRewardTen=void 0,e.preViewCount=0,e.refreshTimer=void 0,e.curTips=0,e.tipsTimer=0,e.txtLeftTime=void 0,e.deltaTime=0,e.leftTime=0,e.canUpdate=!1,e.jackpot=0,e.jackpotType=0,e.curIndex=0,e.finalIndex=0,e.reward_list=[],e.actionTime=1,e.moveTween=void 0,e.rewardList=[],e.waitRewardList=[],e.rewardNum=12,e.extraReward=void 0,e.name="ActivityPoolPartyTurnView",e.url="ui/module/activityPoolParty/ActivityPoolPartyTurnView",e.poolTime=3e3,e.fullScreen=!0,e.actType=R.PoolPartyTurn,e}e(o,t);var g=o.prototype;return g.onInit=function(){var t=this;this.initResShow(),this.btnStore=this.findChild("root/bottomBtn/btnStore"),this.addComponentCallbackListener(this.btnStore,r.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyStoreView",R.PoolParty)})),this.btnGift=this.findChild("root/bottomBtn/btnGift"),this.addComponentCallbackListener(this.btnGift,r.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyGiftView",t.actType)}));var e=this.findChild("root/btnClose");this.addComponentCallbackListener(e,r.EventType.CLICK,(function(){t.close()}));var i=this.findChild("root/btnShow/btnShow");this.addComponentCallbackListener(i,r.EventType.CLICK,(function(){uiMgr.openView("SlumberPartyTipsView",i,t.actType)}));var n=this.findChild("root/btnSelect");this.redSelect=this.findChild("root/btnSelect/red"),this.addComponentCallbackListener(n,r.EventType.CLICK,(function(){uiMgr.openView("ActivityPoolPartyTurnTipsView",t.actType)}));var o=this.findChild("root/turn/img/nodeTips/btnTips");this.addComponentCallbackListener(o,r.EventType.CLICK,(function(){IS(k).ShowSysTips(t.actType)})),this.nodeRolling=this.findChild("root/turn/img/nodeRolling"),this.imgPreview=this.findChildComponent("root/turn/img/imgPreview",a),this.preDescNum=this.findChild("root/turn/img/preDesc/num"),this.preDescGet=this.findChild("root/turn/img/preDesc/get"),this.addComponentCallbackListener(this.imgPreview.node,r.EventType.CLICK,(function(){t.onClickPreview()})),this.txtLeftTime=this.findChildComponent("root/top/nodeTime/txtTime",s),this.txtNumReward=this.findChildComponent("root/numReward/num",s);var u=this.findChildComponent("root/numReward/ScrollView",d);this.numScroll=this.addUIList(u,Y),this.tipsGo=this.findChild("root/top/tips");var f=this.findChildComponent("root/top/tips/ScrollView",d);this.tipsScroll=this.addUIList(f,Q),this.iconOne=this.findChildComponent("root/btnOne/icon",a),this.iconTen=this.findChildComponent("root/btnTen/icon",a),this.txtOne=this.findChildComponent("root/btnOne/num",c),this.txtTen=this.findChildComponent("root/btnTen/num",c),this.redOne=this.findChild("root/btnOne/red"),this.redTen=this.findChild("root/btnTen/red"),this.iconRewardOne=this.findChildComponent("root/btnOne/back/iconBack",a),this.iconRewardTen=this.findChildComponent("root/btnTen/back/iconBack",a),this.txtRewardOne=this.findChildComponent("root/btnOne/back/numBack",s),this.txtRewardTen=this.findChildComponent("root/btnTen/back/numBack",s);var p=this.findChild("root/btnOne");this.addComponentCallbackListener(p,r.EventType.CLICK,(function(){t.onLottery(1)}));var g=this.findChild("root/btnTen");this.addComponentCallbackListener(g,r.EventType.CLICK,(function(){t.onLottery(2)})),this.dealMirrorLayout(this.findChildComponent("root/btnOne/back",h)),this.dealMirrorLayout(this.findChildComponent("root/btnTen/back",h)),this.togSkip=this.findChildComponent("root/toggleSkip",l),this.addComponentCallbackListener(this.togSkip.node,l.EventType.TOGGLE,(function(){t.togSkip.isChecked?y.set("SkipSpringTurnAnim","1"):y.set("SkipSpringTurnAnim","0")})),this.skipAnim=this.findChild("skipAnim"),this.addComponentCallbackListener(this.skipAnim,r.EventType.CLICK,(function(){t.SkipAnim()})),this.adjustMirrorNode(this.findChild("root/toggleSkip/Checkmark"));for(var m=function(){var e=t.findChild("root/turn/itemRoll/itemGrid"+v),i={node:e,index:v,item_id:0,cfg_id:0,imgFram:w.findChildComponent(e,"imgFrame",a),imgIcon:w.findChildComponent(e,"imgIcon",a),num:w.findChildComponent(e,"num",s),select:w.findChild(e,"select"),light:w.findChild(e,"light"),limit:w.findChild(e,"nodeLimit"),only:w.findChild(e,"nodeOnly"),eff:null};t.addComponentCallbackListener(e,r.EventType.CLICK,(function(){0!=i.item_id&&IS(L).OpenItemTips(i.item_id,e)})),t.rewardList.push(i)},v=0;v<this.rewardNum;v++)m();this.adjustMirrorNode(this.iconOne.node),this.adjustMirrorNode(this.iconTen.node),this.adjustMirrorNode(this.findChild("root/turn/img/preDesc/get/img2")),this.adjustMirrorNode(this.findChild("root/bottomBtn/btnGift/img")),this.adjustMirrorNode(this.findChild("root/bottomBtn/btnStore/img"))},g.initResShow=function(){var t=this;this.nodeResParent=this.findChild("resRoot"),this.nodeResItem=this.findChild("resRoot/resItem"),this.nodeResItem.active=!1;var e=[IS(b).GetCost(this.actType)[0]];this.resItems=new Array;for(var i=function(i){var n=nodeInstantiate.instantiate(t.nodeResItem),o=e[i];t.addComponentCallbackListener(n,r.EventType.CLICK,(function(){IS(L).OpenItemTips(o,w.findChild(n,"txtNum"))})),n.parent=t.nodeResParent,n.active=!0;var d=w.findChildComponent(n,"imgIcon",a),c=configGoods.getDataByKey(o);t.loadIcon(d,"icon_item",c.icon),t.resItems.push({node:n,txtNum:w.findChildComponent(n,"txtNum",s),goodsGtid:o})},n=0;n<e.length;n++)i(n)},g.registerUpdateHandler=function(){this.addEvent(D.OnHorseCarnivalUpdate,this.updateInfo,this),this.addEvent(D.OnHorseCarnivalReward,this.updateReward,this),this.addEvent(D.OnHorseCarnivalLottery,this.updateLotteryResult,this),this.addEvent(S.GOODS_INFO_UPDATE,this.updateResShow,this),this.addEvent(I.ROLE_RES_UPDATE,this.updateResShow,this),this.addEvent(j.ViewClose,this.onViewClose,this)},g.onAfterOpen=function(){var t,e=this;this.rollEff=null,this.bgEff=null,this.turnEff=null,this.updateResShow(),IS(V).send_24_16(this.actType),this.togSkip.isChecked="1"==y.get("SkipSpringTurnAnim"),this.skipAnim.active=!1,this.nodeRolling.active=!1;var i=IS(k).GetActivityInfo(this.actType),n=null!=(t=i.state_time[i.state])?t:i.state_time[x.Open];this.leftTime=n.end_time-T.serverTime,this.leftTime>0?(this.canUpdate=!0,this.txtLeftTime.string=T.formatTimeStringForSecond(this.leftTime)):this.txtLeftTime.string=GetLanguage(200026);var o=IS(b).GetCost(this.actType),r=configGoods.getDataByKey(o[0]);this.loadIcon(this.iconOne,r.icon_group,r.icon),this.loadIcon(this.iconTen,r.icon_group,r.icon);var a=IS(b).GetDrawReward(this.actType),s=configGoods.getDataByKey(a[0]);this.loadIcon(this.iconRewardOne,s.icon_group,s.icon),this.loadIcon(this.iconRewardTen,s.icon_group,s.icon),this.txtRewardOne.string=C.formatStrWithMirrorDeal(GetLanguage(700030178),a[1]),this.txtRewardTen.string=C.formatStrWithMirrorDeal(GetLanguage(700030178),10*a[1]);var d=configMount_draw_cumulative_times.getDatas(),h=[];for(var l in d)if(d.hasOwnProperty(l)){var u=d[l];u.type==i.type&&u.group_id==i.roundCfg.group_id&&h.push(u)}this.numScroll.datas=h;var p=configMount_draw.getDatas(),g=[];for(var m in p)if(p.hasOwnProperty(m)){var v=p[m];v.type==i.type&&v.group_id==i.roundCfg.group_id&&g.push(v)}g.sort((function(t,e){return t.id-e.id}));for(var w=function(t){var i=g[t],n=e.rewardList[i.order-1];n.item_id=i.reward[0],n.num.string=i.reward[1],n.cfg_id=i.id;var o=configGoods.getDataByKey(n.item_id);e.loadIcon(n.imgIcon,o.icon_group,o.icon),e.loadIcon(n.imgFram,"act_poolparty_turn",X[o.quality]),n.limit&&(n.limit.active=!1),n.only&&(n.only.active=!1),n.select.active=!1,n.light.active=!1,n.eff&&e.removeUIEffect(n.eff),n.eff=e.addUIEffect("prefab/ui-effect/MX_tx_yongchipaidui",n.select,-1,new f(0,-30),.8,(function(t){t.node.getComponent(_).needAnimation=J[o.quality]}))},G=0;G<g.length;G++)w(G);this.clearTimer();var S=function(){var t;e.preViewCount=4==e.preViewCount?1:e.preViewCount+1;var i=H[e.preViewCount],n=e.rewardList[i].item_id,o=null!=(t=q[n])?t:U[e.preViewCount];if(e.loadIcon(e.imgPreview,"act_poolparty_turn",o),1!=e.preViewCount){var r=W[e.preViewCount];e.preDescNum.active=!0,e.preDescGet.active=!1;var a=C.formatStrWithMirrorDeal(GetLanguage(700030172),GetLanguage(400187));e.findChildComponent("root/turn/img/preDesc/num/num",c).string=C.formatStr(a,C.formatStrWithMirrorDeal(GetLanguage(700030173),r))}else if(e.onlyRewardNum>0){e.preDescNum.active=!0,e.preDescGet.active=!1;var s=C.formatStrWithMirrorDeal(GetLanguage(700030172),GetLanguage(400205));e.findChildComponent("root/turn/img/preDesc/num/num",c).string=C.formatStr(s,C.formatStrWithMirrorDeal(GetLanguage(700030173),e.onlyRewardNum))}else e.preDescNum.active=!1,e.preDescGet.active=!0;var d=IS(b).getInfo(e.actType),h=e.findChildComponent("root/turn/img/preDesc/jackPotNum",c);if(1!=e.preViewCount&&null!=i){var l,u=null!=(l=d.guaranteed_list[e.rewardList[i].cfg_id])?l:0;u>0?(h.node.active=!0,h.string=h.string=C.formatStr(C.formatStrWithMirrorDeal(GetLanguage(700030175),GetLanguage(400202)),u)):h.node.active=!1}else h.node.active=!1};S(),this.refreshTimer=this.addTimer(5,-1,S)},g.clearTimer=function(){null!=this.refreshTimer&&(this.removeTimer(this.refreshTimer),this.refreshTimer=null)},g.onBeforeClose=function(){this.canUpdate=!1,this.curIndex=0,this.tipsTimer=0;for(var t=0;t<this.rewardList.length;t++)this.rewardList[t].select.active=!1,this.rewardList[t].light.active=!1;this.jackpot=0,this.jackpotType=0,this.waitRewardList=[],this.extraReward=null,this.clearTimer(),coroutine.stopGroup("ActTurn")},g.onDestroy=function(){for(var t=0;t<this.resItems.length;t++)this.resItems[t].node.destroy();this.resItems={}},g.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=T.formatTimeStringForSecond(this.leftTime):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},g.updateResShow=function(){for(var t=0;t<this.resItems.length;t++)this.resItems[t].txtNum.string=C.GetNumString(IS(L).getGoodsCountByGoodsGtid(this.resItems[t].goodsGtid));var e,i,n=IS(b).GetCost(this.actType),o=IS(L).getGoodsCountByGoodsGtid(n[0]);this.redOne.active=o>=n[1],this.redTen.active=o>=10*n[1],o>=n[1]?(i="#5aff42",e="#27720d"):(i="#ff1f1f",e="#891000"),this.txtOne.string=C.formatStrWithMirrorDeal(GetLanguage(700030176),e,i,n[1]),o>=10*n[1]?(i="#5aff42",e="#27720d"):(i="#ff1f1f",e="#891000"),this.txtTen.string=C.formatStrWithMirrorDeal(GetLanguage(700030176),e,i,10*n[1])},g.updateInfo=function(){var t=this,e=IS(b).getInfo(this.actType);this.tipsGo.active=e.lucky_list.length>0,0!=this.tipsTimer&&this.removeTimer(this.tipsTimer),this.tipsGo.active&&(this.tipsScroll.datas=e.lucky_list,this.curTips=0,this.tipsTimer=this.addTimer(1,-1,(function(){t.curTips=t.curTips+1,t.curTips==e.lucky_list.length&&(t.curTips=0);var i=0==t.curTips?.2:1;t.tipsScroll.scrollTo(t.curTips,i)}))),this.redSelect.active=IS(M).GetTurnSelectRed()>0,this.updateReward()},g.updateReward=function(){var t=this,e=IS(b).getInfo(this.actType);this.txtNumReward.string=e.count+"",this.numScroll.updateAll();var n=C.formatStrWithMirrorDeal(GetLanguage(700030177),IS(b).getInfo(this.actType).remain_draw),o=C.formatStrWithMirrorDeal(GetLanguage(700030172),C.formatStr(GetLanguage(999300100),n)),r=C.formatStrWithMirrorDeal(GetLanguage(700030172),C.formatStrWithMirrorDeal(GetLanguage(999300100),IS(b).getInfo(this.actType).remain_draw));this.findChildComponent("root/turn/img/nodeTips/drawNum",v).string=u.uiMirror?r:o;for(var a,d=i(this.rewardList);!(a=d()).done;){var h,l=a.value,p=configMount_draw.getDataByKey(l.cfg_id);if(p.num){l.limit.active=!0;var g=IS(b).getInfo(this.actType),m=w.findChildComponent(l.limit,"Node",s);if(m.string=C.formatStrWithMirrorDeal(GetLanguage(400014),p.num),g.get_drop.length>0)for(var y,T=i(g.get_drop);!(y=T()).done;){var G=y.value,S=G.k,L=G.v;S==l.cfg_id&&(m.string=C.formatStrWithMirrorDeal(GetLanguage(400014),p.num-L))}}if(5==p.quality){l.only.active=!0;var I=p.guaranteed-e.count;this.onlyRewardNum=I}if(p.reward_replace.length>0){var k,R,D=null!=(k=null==(R=e.choose_list[l.cfg_id])?void 0:R[1])?k:0;if(D>0){5==p.quality&&(l.only.active=!1,this.onlyRewardNum=0);for(var x,V=i(p.reward_replace);!(x=V()).done;){var M=x.value;M[0]==D&&function(){l.num.string=M[1][1],l.item_id=M[1][0];var e=configGoods.getDataByKey(l.item_id);t.loadIcon(l.imgIcon,e.icon_group,e.icon),t.loadIcon(l.imgFram,"act_poolparty_turn",X[e.quality]),l.eff&&t.removeUIEffect(l.eff),l.eff=t.addUIEffect("prefab/ui-effect/MX_tx_yongchipaidui",l.select,-1,new f(0,-30),.8,(function(t){t.node.getComponent(_).needAnimation=J[e.quality]}))}()}}}var j=H[this.preViewCount],N=this.rewardList[j].item_id,A=null!=(h=q[N])?h:U[this.preViewCount];if(this.loadIcon(this.imgPreview,"act_poolparty_turn",A),1==this.preViewCount)if(this.onlyRewardNum>0){this.preDescNum.active=!0,this.preDescGet.active=!1;var P=C.formatStrWithMirrorDeal(GetLanguage(700030172),GetLanguage(400205));this.findChildComponent("root/turn/img/preDesc/num/num",c).string=C.formatStr(P,C.formatStrWithMirrorDeal(GetLanguage(700030173),this.onlyRewardNum))}else this.preDescNum.active=!1,this.preDescGet.active=!0;var B=this.findChildComponent("root/turn/img/preDesc/jackPotNum",c);if(1!=this.preViewCount&&null!=j){var O,E=null!=(O=e.guaranteed_list[this.rewardList[j].cfg_id])?O:0;E>0?(B.node.active=!0,B.string=C.formatStr(C.formatStrWithMirrorDeal(GetLanguage(700030175),GetLanguage(400202)),E)):B.node.active=!1}else B.node.active=!1}},g.onClickPreview=function(){var t=F[this.preViewCount];null!=t&&uiMgr.openView("PlayerSkinLookView",t,!0)},g.onLottery=function(t){var e=IS(b).GetCost(this.actType),i=e[0],n=e[1];2==t&&(n*=10),IS(L).getGoodsCountByGoodsGtid(i)>=n?IS(V).send_24_17(this.actType,t):uiMgr.openView("ActivityPoolPartyGiftView",this.actType)},g.updateLotteryResult=function(t){var e=this;if(t.act_type==this.actType){this.nodeRolling.active=!1;var i=IS(b).GetDrawReward(this.actType),n=1==t.type?i[1]:10*i[1];if(this.extraReward=[i[0],n],this.checkJackpot(t.drop_id_list),this.togSkip.isChecked)0!=this.jackpot?(this.openTypeView(this.jackpot,this.jackpotType),this.waitRewardList=t.reward_list,this.jackpot=0,this.jackpotType=0):(uiMgr.openView("GoodsGetView",t.reward_list,this.extraReward),this.extraReward=null);else{var o=t.drop_id_list[t.drop_id_list.length-1];this.finalIndex=configMount_draw.getDataByKey(o).order-1,this.reward_list=t.reward_list,this.skipAnim.active=!0,this.nodeRolling.active=!0,coroutine.stopGroup("ActTurn"),1==t.drop_id_list.length?coroutine.start(this.doLotteryTween(this.finalIndex,(function(){for(var i=0;i<e.rewardList.length;i++)e.rewardList[i].select.active=!1,e.rewardList[i].light.active=!1;e.rewardList[e.finalIndex].select.active=!0,e.rewardList[e.finalIndex].light.active=!0,e.curIndex=e.finalIndex,0!=e.jackpot?(e.waitRewardList=t.reward_list,e.openTypeView(e.jackpot,e.jackpotType),e.jackpot=0,e.jackpotType=0):(uiMgr.openView("GoodsGetView",t.reward_list,e.extraReward),e.extraReward=null),e.skipAnim.active=!1,e.nodeRolling.active=!1})),"ActTurn"):this.lotteryNext(0,t)}}},g.lotteryNext=function(t,e){var i,n=this,o=configMount_draw.getDataByKey(e.drop_id_list[t]).order-1;i=t<e.drop_id_list.length-1?function(){n.curIndex=o,n.lotteryNext(t+1,e)}:function(){for(var t=0;t<n.rewardList.length;t++)n.rewardList[t].select.active=!1,n.rewardList[t].light.active=!1;n.rewardList[o].select.active=!0,n.rewardList[o].light.active=!0,n.curIndex=o,0!=n.jackpot?(n.waitRewardList=e.reward_list,n.openTypeView(n.jackpot,n.jackpotType),n.jackpot=0,n.jackpotType=0):(uiMgr.openView("GoodsGetView",e.reward_list,n.extraReward),n.extraReward=null),n.skipAnim.active=!1,n.nodeRolling.active=!1,coroutine.stopGroup("ActTurn")},coroutine.start(this.doLotteryTween(o,i),"ActTurn")},g.doLotteryTween=n().mark((function t(e,i){var o,r,a,s,d;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null!=this.moveTween&&this.moveTween.stop(),p.playSound("common_guguji"),o=2*this.rewardNum+e-this.curIndex,r=0;case 4:if(!(r<=o)){t.next=14;break}for(a=G.round(o*(r/o)),s=Math.floor((a+this.curIndex)%this.rewardNum),d=0;d<this.rewardList.length;d++)this.rewardList[d].select.active=!1,this.rewardList[d].light.active=!1;return this.rewardList[s].select.active=!0,t.next=11,coroutine.wait(.1);case 11:r++,t.next=4;break;case 14:return t.next=16,coroutine.wait(.5);case 16:i();case 17:case"end":return t.stop()}}),t,this)})),g.SkipAnim=function(){null!=this.moveTween&&this.moveTween.stop();for(var t=0;t<this.rewardList.length;t++)this.rewardList[t].select.active=!1,this.rewardList[t].light.active=!1;this.rewardList[this.finalIndex].select.active=!0,this.rewardList[this.finalIndex].light.active=!0,this.curIndex=this.finalIndex,0!=this.jackpot?(this.waitRewardList=this.reward_list,this.openTypeView(this.jackpot,this.jackpotType),this.jackpot=0,this.jackpotType=0):(uiMgr.openView("GoodsGetView",this.reward_list,this.extraReward),this.extraReward=null),this.skipAnim.active=!1,this.nodeRolling.active=!1,coroutine.stopGroup("ActTurn")},g.checkJackpot=function(t){this.jackpot=0,this.jackpotType=0;for(var e,n=i(t);!(e=n()).done;){var o=e.value,r=configMount_draw.getDataByKey(o);if(r.goods_type)if(r.reward_replace.length>0){var a,s,d=null!=(a=null==(s=IS(b).getInfo(this.actType).choose_list[r.id])?void 0:s[1])?a:0;if(d>0)for(var c,h=i(r.reward_replace);!(c=h()).done;){var l=c.value;if(l[0]==d&&r.goods_type)return this.jackpot=l[1][0],this.jackpotType=r.goods_type,!0}else if(r.goods_type)return this.jackpot=r.reward[0],this.jackpotType=r.goods_type,!0}else if(r.goods_type)return this.jackpot=r.reward[0],this.jackpotType=r.goods_type,!0}return!1},g.onViewClose=function(t){this.waitRewardList.length<=0||z.includes(t)&&(uiMgr.openView("GoodsGetView",this.waitRewardList,this.extraReward),this.extraReward=null,this.waitRewardList=[])},g.openTypeView=function(t,e){switch(e){case 1:return void uiMgr.openView("ArtifactGetView",configGoods.getDataByKey(t).effect[0],!0);case 2:return void uiMgr.openView("HorseGetView",configGoods.getDataByKey(t).effect[0],!0);case 3:return void uiMgr.openView("PlayerSkinGetView",configGoods.getDataByKey(t).effect[0],!0);case 4:return void uiMgr.openView("FateNewView",configGoods.getDataByKey(t).effect[0]);case 5:switch(configGoods.getDataByKey(t).type){case 28:uiMgr.openView("ArtifactGetView",configGoods.getDataByKey(t).effect[0],!0);break;case 27:uiMgr.openView("HorseGetView",configGoods.getDataByKey(t).effect[0],!0);break;case 11:uiMgr.openView("PlayerSkinGetView",configGoods.getDataByKey(t).effect[0],!0);break;case 12:uiMgr.openView("FateNewView",configGoods.getDataByKey(t).effect[0]);break;case 32:uiMgr.openView("WingGetView",configGoods.getDataByKey(t).effect[0],!0);break;default:uiMgr.openView("GoodsGetView2",t)}}},o}(N)),function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).txtDesc=void 0,e.itemGridNode=void 0,e.effNode=void 0,e.itemGrid=void 0,e.isReward=void 0,e.eff=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.txtDesc=w.findChildComponent(this.node,"desc",c),this.itemGridNode=w.findChild(this.node,"itemGrid"),this.effNode=w.findChild(this.node,"eff"),this.itemGrid=new g(this.view,this.itemGridNode,(function(){var e=t.view,i=IS(b).getInfo(e.actType);!t.isReward&&i.count>=t.data.cumulative_times?IS(V).send_24_18(e.actType,t.data.id):IS(L).OpenItemTips(t.data.reward[0],t.itemGridNode)}))},n.onRender=function(t,e){this.data=t,this.itemGrid.SetItemId(t.reward[0],t.reward[1]);var i=this.view,n=IS(b).getInfo(i.actType);this.isReward=n.gotReward[t.id],this.view.removeUIEffect(this.eff),this.isReward?this.txtDesc.string=C.formatStrWithMirrorDeal(GetLanguage(700030179),GetLanguage(200314)):n.count>=t.cumulative_times?(this.txtDesc.string=C.formatStrWithMirrorDeal(GetLanguage(700030179),GetLanguage(200732)),this.eff=this.view.addUIEffect("prefab/ui-effect/MX_tx_tongyong_daojulingqu",this.effNode,-1)):this.txtDesc.string=C.formatStrWithMirrorDeal(GetLanguage(700030180),n.count,t.cumulative_times)},i}(m)),Q=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).txt=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){this.txt=w.findChildComponent(this.node,"txt",c)},n.onRender=function(t,e){var i=configGoods.getDataByKey(t.k).name;this.txt.string=C.formatStrWithMirrorDeal(GetLanguage(200050),t.s,i)},i}(m);o._RF.pop()}}}));

