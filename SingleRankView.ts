System.register("chunks:///_virtual/SingleRankView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./CommonModel.ts","./FriendControl.ts","./FrameDataCache.ts","./RoleDataCache.ts","./RoleDefine.ts","./BaseView.ts"],(function(n){"use strict";var i,e,t,a,r,o,s,d,h,l,m,k,c,f,g,u,v,_;return{setters:[function(n){i=n.inheritsLoose},function(n){e=n.cclegacy,t=n.Button,a=n.Sprite,r=n.Label,o=n.ScrollView,s=n.sys},function(n){d=n.V2},function(n){h=n.SelectedType,l=n.ListItem},function(n){m=n.default},function(n){k=n.default},null,function(n){c=n.CommonModel},function(n){f=n.default},function(n){g=n.FrameDataCache},function(n){u=n.RoleDataCache},function(n){v=n.PlayerAttr},function(n){_=n.BaseView}],execute:function(){e._RF.push({},"36809JpG3tCxquZSHug2cQn","SingleRankView",void 0);n("default",function(n){function e(){var i;return(i=n.call(this)||this).rankList=void 0,i.rank1Name=void 0,i.rank1Score=void 0,i.rank1Icon=void 0,i.rank1Head=void 0,i.rank1HeadFrame=void 0,i.rank2Name=void 0,i.rank2Score=void 0,i.rank2Icon=void 0,i.rank2Head=void 0,i.rank2HeadFrame=void 0,i.rank3Name=void 0,i.rank3Score=void 0,i.rank3Icon=void 0,i.rank3Head=void 0,i.rank3HeadFrame=void 0,i.meRankIcon=void 0,i.imgHeadFrame=void 0,i.meRankIndex=void 0,i.meNoRank=void 0,i.meRankScore=void 0,i.meRankName=void 0,i.rank1Role=void 0,i.rank2Role=void 0,i.rank3Role=void 0,i.Rank1Job=void 0,i.Rank2Job=void 0,i.Rank3Job=void 0,i.pos1=new d,i.pos2=new d,i.pos3=new d,i.rank_info_list=void 0,i.name="SingleRankView",i.url="ui/module/guildwar/SingleRankView",i.poolTime=3e3,i}i(e,n);var l=e.prototype;return l.onInit=function(){var n=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,t.EventType.CLICK,(function(){n.close()}));var e=this.findChild("content/btnClose");this.addComponentCallbackListener(e,t.EventType.CLICK,(function(){n.close()})),this.loadIcon(this.findChildComponent("content/mainRank/rank1/imgFrame/rank_icon",a),"friend","hy_ICON_paiming01"),this.loadIcon(this.findChildComponent("content/mainRank/rank2/imgFrame/rank_icon",a),"friend","hy_ICON_paiming02"),this.loadIcon(this.findChildComponent("content/mainRank/rank3/imgFrame/rank_icon",a),"friend","hy_ICON_paiming03"),this.rank1Name=this.findChildComponent("content/mainRank/rank1/name",r),this.rank1Score=this.findChildComponent("content/mainRank/rank1/score",r),this.rank1Icon=this.findChild("content/mainRank/rank1/imgFrame"),this.rank1Head=this.findChildComponent("content/mainRank/rank1/imgFrame/frame/imgIcon",a),this.rank1HeadFrame=this.findChildComponent("content/mainRank/rank1/imgFrame/frame/imgHeadFrame",a),this.addComponentCallbackListener(this.rank1Icon,t.EventType.CLICK,(function(){IS(f).reqOtherRoleNotice(n.rank_info_list[0].role_id)})),this.Rank1Job=this.findChild("content/mainRank/rank1/role");var s=this.findChild("content/mainRank/rank1/role/click");this.addComponentCallbackListener(s,t.EventType.CLICK,(function(){IS(f).reqOtherRoleNotice(n.rank_info_list[0].role_id)})),this.rank2Name=this.findChildComponent("content/mainRank/rank2/name",r),this.rank2Score=this.findChildComponent("content/mainRank/rank2/score",r),this.rank2Icon=this.findChild("content/mainRank/rank2/imgFrame"),this.rank2Head=this.findChildComponent("content/mainRank/rank2/imgFrame/frame/imgIcon",a),this.rank2HeadFrame=this.findChildComponent("content/mainRank/rank2/imgFrame/frame/imgHeadFrame",a),this.addComponentCallbackListener(this.rank2Icon,t.EventType.CLICK,(function(){IS(f).reqOtherRoleNotice(n.rank_info_list[1].role_id)}));var d=this.findChild("content/mainRank/rank2/role/click");this.addComponentCallbackListener(d,t.EventType.CLICK,(function(){IS(f).reqOtherRoleNotice(n.rank_info_list[1].role_id)})),this.Rank2Job=this.findChild("content/mainRank/rank2/role"),this.rank3Name=this.findChildComponent("content/mainRank/rank3/name",r),this.rank3Score=this.findChildComponent("content/mainRank/rank3/score",r),this.rank3Icon=this.findChild("content/mainRank/rank3/imgFrame"),this.addComponentCallbackListener(this.rank3Icon,t.EventType.CLICK,(function(){IS(f).reqOtherRoleNotice(n.rank_info_list[2].role_id)}));var l=this.findChild("content/mainRank/rank3/role/click");this.addComponentCallbackListener(l,t.EventType.CLICK,(function(){IS(f).reqOtherRoleNotice(n.rank_info_list[2].role_id)})),this.Rank3Job=this.findChild("content/mainRank/rank3/role"),this.rank3Head=this.findChildComponent("content/mainRank/rank3/imgFrame/frame/imgIcon",a),this.rank3HeadFrame=this.findChildComponent("content/mainRank/rank3/imgFrame/frame/imgHeadFrame",a);this.findChild("content/mainRank/rankList");var m=this.findChildComponent("content/mainRank/rankList",o);this.rankList=this.addUIList(m,C),this.rankList.selectedMode=h.SINGLE,this.meRankIcon=this.findChildComponent("content/mainRank/meRank/imgFrame/frame/imgIcon",a),this.imgHeadFrame=this.findChildComponent("content/mainRank/meRank/imgFrame/frame/imgHeadFrame",a),this.meRankName=this.findChildComponent("content/mainRank/meRank/name",r),this.meRankIndex=this.findChildComponent("content/mainRank/meRank/rank",r),this.meNoRank=this.findChild("content/mainRank/meRank/no_rank"),this.meRankScore=this.findChildComponent("content/mainRank/meRank/score",r),this.pos1.set(0,-35),this.pos2.set(0,-15),this.pos3.set(0,-15)},l.onAfterOpen=function(){this.refreshTop3(),this.refreshMyRank()},l.registerUpdateHandler=function(){},l.refreshTop3=function(){var n=this.openArgs[0],i=n.rank_list;if(this.rank_info_list=i,this.rank1Name.string=GetLanguage(200038),this.rank1Score.string="",this.rank1Icon.active=!1,this.rank2Name.string=GetLanguage(200038),this.rank2Score.string="",this.rank2Icon.active=!1,this.rank3Name.string=GetLanguage(200038),this.rank3Score.string="",this.rank3Icon.active=!1,this.rank1HeadFrame.node.active=!1,this.rank2HeadFrame.node.active=!1,this.rank3HeadFrame.node.active=!1,null!=this.rank1Role&&(this.removeUnitModel(this.rank1Role),this.rank1Role=null),null!=this.rank2Role&&(this.removeUnitModel(this.rank2Role),this.rank2Role=null),null!=this.rank3Role&&(this.removeUnitModel(this.rank3Role),this.rank3Role=null),i&&i.length>0){for(var e=n.rank_list[0].figure,t=e.skin_list||[],a=e.hair_figure>0&&e.hair_figure||6,r=e.equip_list.length>0&&IS(c).GetKvListByK(e.equip_list,0)||0,o=e.equip_list.length>1&&IS(c).GetKvListByK(e.equip_list,1)||0,d=e.equip_list.length>2&&IS(c).GetKvListByK(e.equip_list,2)||0,h=0,l=0;l<t.length;l++)2==t[l].k&&(h=t[l].v);var m=e.gender||1;this.rank1Role=this.addUnitModel({job:e.job_figure||1001,dressId:h,gender:m,parent:this.Rank1Job,color:a,weapon:r,ornaments:o,face:d,mount:e.mount_figure||0,shenqi:e.artifact_figure||0}),s.uiMirror&&(this.getUnitModel(this.rank1Role).dir=-1),this.getUnitModel(this.rank1Role).mount=e.mount_figure,this.loadRemoteIcon(n.rank_list[0].role_head.url,this.rank1Head),this.rank1Icon.active=!0,this.rank1Name.string=n.rank_list[0].role_name,this.rank1Score.string=s.uiMirror?k.GetNumString(n.rank_list[0].value):GetLanguage(200380)+k.GetNumString(n.rank_list[0].value);var f=n.rank_list[0].role_head.frame_id;if(f>0){this.rank1HeadFrame.node.active=!0;var g=configAvatar_frame.getDataByKey(f);this.loadIcon(this.rank1HeadFrame,"icon_frame",g.icon)}else this.rank1HeadFrame.node.active=!1}if(i&&i.length>1){for(var u=n.rank_list[1].figure,v=u.skin_list||[],_=u.hair_figure>0&&u.hair_figure||6,C=u.equip_list.length>0&&IS(c).GetKvListByK(u.equip_list,0)||0,R=u.equip_list.length>1&&IS(c).GetKvListByK(u.equip_list,1)||0,p=u.equip_list.length>2&&IS(c).GetKvListByK(u.equip_list,2)||0,I=0,F=0;F<v.length;F++)2==v[F].k&&(I=v[F].v);var S=u.gender||1;this.rank2Role=this.addUnitModel({job:u.job_figure||1001,dressId:I,gender:S,parent:this.Rank2Job,color:_,weapon:C,ornaments:R,face:p,mount:u.mount_figure||0,shenqi:u.artifact_figure||0}),s.uiMirror&&(this.getUnitModel(this.rank2Role).dir=-1),this.getUnitModel(this.rank2Role).mount=u.mount_figure,this.loadRemoteIcon(n.rank_list[1].role_head.url,this.rank2Head),this.rank2Icon.active=!0,this.rank2Name.string=n.rank_list[1].role_name,this.rank2Score.string=s.uiMirror?k.GetNumString(n.rank_list[1].value):GetLanguage(200380)+k.GetNumString(n.rank_list[1].value);var L=n.rank_list[1].role_head.frame_id;if(L>0){this.rank2HeadFrame.node.active=!0;var H=configAvatar_frame.getDataByKey(L);this.loadIcon(this.rank2HeadFrame,"icon_frame",H.icon)}else this.rank2HeadFrame.node.active=!1}if(i&&i.length>2){for(var y=n.rank_list[2].figure,N=y.hair_figure>0&&y.hair_figure||6,K=y.equip_list.length>0&&IS(c).GetKvListByK(y.equip_list,0)||0,b=y.equip_list.length>1&&IS(c).GetKvListByK(y.equip_list,1)||0,G=y.equip_list.length>2&&IS(c).GetKvListByK(y.equip_list,2)||0,q=y.skin_list||[],M=0,w=0;w<q.length;w++)2==q[w].k&&(M=q[w].v);var B=y.gender||1;this.rank3Role=this.addUnitModel({job:y.job_figure||1001,dressId:M,gender:B,parent:this.Rank3Job,color:N,weapon:K,ornaments:b,face:G,mount:y.mount_figure,shenqi:y.artifact_figure||0}),s.uiMirror&&(this.getUnitModel(this.rank3Role).dir=-1),this.getUnitModel(this.rank3Role).mount=y.mount_figure,this.loadRemoteIcon(n.rank_list[2].role_head.url,this.rank3Head),this.rank3Icon.active=!0,this.rank3Name.string=n.rank_list[2].role_name,this.rank3Score.string=s.uiMirror?k.GetNumString(n.rank_list[2].value):GetLanguage(200380)+k.GetNumString(n.rank_list[2].value);var U=n.rank_list[2].role_head.frame_id;if(U>0){this.rank3HeadFrame.node.active=!0;var x=configAvatar_frame.getDataByKey(U);this.loadIcon(this.rank3HeadFrame,"icon_frame",x.icon)}else this.rank3HeadFrame.node.active=!1}for(var T=new Array,A=0;A<n.rank_list.length;A++)A>2&&T.push({info:n.rank_list[A]});this.rankList.datas=T},l.refreshMyRank=function(){var n=this.openArgs[0].my_rank;this.meNoRank.active=n.rank<=0,n.rank>0?this.meRankIndex.string=n.rank+"":this.meRankIndex.string="";var i=IS(u).GetRoleAttr(v.ROLE_ATTR_HEAD_URL);this.loadRemoteIcon(i,this.meRankIcon);var e=IS(g).curFrameId;if(e>0){var t=configAvatar_frame.getDataByKey(e);this.loadIcon(this.imgHeadFrame,"icon_frame",t.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1;this.meRankName.string=n.role_name,this.meRankScore.string=s.uiMirror?k.GetNumString(n.value):GetLanguage(200380)+k.GetNumString(n.value)},l.onBeforeClose=function(){},l.onDestroy=function(){},e}(_));var C=function(n){function e(){for(var i,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(i=n.call.apply(n,[this].concat(t))||this).imgFrame=void 0,i.imgHeadFrame=void 0,i.imgIcon=void 0,i.txtScore=void 0,i.txtRank=void 0,i.txtName=void 0,i.btnHead=void 0,i.pri=void 0,i}i(e,n);var o=e.prototype;return o.onInit=function(){var n=this;this.imgFrame=m.findChildComponent(this.node,"imgFrame",a),this.imgIcon=m.findChildComponent(this.node,"imgFrame/frame/imgIcon",a),this.imgHeadFrame=m.findChildComponent(this.node,"imgFrame/frame/imgHeadFrame",a),this.txtScore=m.findChildComponent(this.node,"score",r),this.txtRank=m.findChildComponent(this.node,"rank",r),this.txtName=m.findChildComponent(this.node,"name",r),this.btnHead=m.findChild(this.node,"imgFrame"),this.view.addComponentCallbackListener(this.btnHead,t.EventType.CLICK,(function(){n.onItemClick()}))},o.onRender=function(n,i){var e=GetLanguage(200380);this.data=n,this.view.loadRemoteIcon(n.info.role_head.url,this.imgIcon),this.txtRank.string=n.info.rank,this.txtScore.string=s.uiMirror?k.GetNumString(n.info.value):e+k.GetNumString(n.info.value),this.txtName.string=n.info.role_name;var t=n.info.role_head.frame_id;if(t>0){this.imgHeadFrame.node.active=!0;var a=configAvatar_frame.getDataByKey(t);this.view.loadIcon(this.imgHeadFrame,"icon_frame",a.icon)}else this.imgHeadFrame.node.active=!1},o.onItemClick=function(){IS(f).reqOtherRoleNotice(this.data.info.role_id)},e}(l);e._RF.pop()}}}));

