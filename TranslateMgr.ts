System.register("chunks:///_virtual/TranslateMgr.ts",["cc","./GameLoadingView.ts","./CommonDefine.ts","./NativeToJs.ts","./TimeUtil.ts"],(function(t){"use strict";var a,e,s,n,i;return{setters:[function(t){a=t.cclegacy},function(t){e=t.GameLoadingView},function(t){s=t.CommonEventDefine},function(t){n=t.NativeToJs},function(t){i=t.default}],execute:function(){a._RF.push({},"8d059Aj1tVP9rRZgCzwhiR+","TranslateMgr",void 0);t("TranslateMgr",function(){function t(){this.translateDict={},this.translatingDict={},this.TranslateState={None:0,Translating:1,Success:2,Fail:3},this.TranslateShowState={ShowTranslate:1,ShowOriText:2},this.TranslateMaxTime=10}var a=t.prototype;return a.clear=function(){},a.SetTranslateText=function(t,a,e,n){var r=this.GetTranslateText(t,a);if(r){if(r.showState=this.TranslateShowState.ShowTranslate,r.state==this.TranslateState.Success)return void normalEvent.emit(s.UpdateTranslateResult,r);if(r.state==this.TranslateState.Translating&&i.serverTime-r.startTime<=this.TranslateMaxTime)return}this.translateDict[t]||(this.translateDict[t]={});var l={key1:t,key2:a,text:e,extraInfo:n,state:this.TranslateState.Translating,showState:this.TranslateShowState.ShowOriText};this.translateDict[t][a]=l,this.Translate(l)},a.Translate=function(t){t.startTime=i.serverTime;var a=t.key1+"_"+t.key2;t.translatingKey=a,this.translatingDict[a]=t;var s=t.text,r=e._instance.curlaguage;"zh"==r?r="zh_cn":"tw"==r?r="zh_tw":"vi"==r&&(r="vn"),n.translate(a,s,r)},a.CallBackTranslateInfo=function(t){var a=this.translatingDict[t.key];a&&("1"==t.code?(a.state=this.TranslateState.Success,a.finishText=t.result):a.state=this.TranslateState.Fail,a.showState=this.TranslateShowState.ShowTranslate,normalEvent.emit(s.UpdateTranslateResult,a),delete this.translatingDict[t.key])},a.ChangeShowState=function(t,a,e){var n=this.GetTranslateInfo(t,a);if(n&&n.showState!=e){if(e==this.TranslateShowState.ShowTranslate&&n.state!=this.TranslateState.Success)return;n.showState=e,normalEvent.emit(s.UpdateTranslateResult,n)}},a.GetTranslateInfo=function(t,a){if(this.translateDict[t])return this.translateDict[t][a]},a.GetTranslateState=function(t,a){return this.translateDict[t]&&this.translateDict[t][a]&&this.translateDict[t][a].state||this.TranslateState.None},a.GetTranslateText=function(t,a){if(this.translateDict[t])return this.translateDict[t][a]&&this.translateDict[t][a].finishText},a.ClearTranslateByKey1=function(t){delete this.translateDict[t]},a.ClearTranslateByKey=function(t,a){this.translateDict[t]&&delete this.translateDict[t][a]},a.ClearTranslateByKeyList=function(t){for(var a in t)for(var e in t[a])if(this.translateDict[a]&&this.translateDict[a][e]){var s=this.translateDict[a][e].translatingKey;this.translatingDict[s]&&delete this.translatingDict[s],delete this.translateDict[a][e]}},t}());a._RF.pop()}}}));

