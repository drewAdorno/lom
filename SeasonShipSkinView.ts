System.register("chunks:///_virtual/SeasonShipSkinView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./ItemIcon.ts","./ObjectUtil.ts","./SeasonControl.ts","./SeasonDataCache.ts","./SeasonDefine.ts","./BaseView.ts"],(function(e){"use strict";var i,t,s,n,h,r,o,a,l,c,d,u,p,S,f,v,I,b;return{setters:[function(e){i=e.inheritsLoose,t=e.createForOfIteratorHelperLoose},function(e){s=e.cclegacy,n=e.UITransform,h=e.Button,r=e.ScrollView,o=e.sys,a=e.Label,l=e.Sprite},function(e){c=e.V2},function(e){d=e.ListItem},function(e){u=e.default},null,function(e){p=e.IconAseetType},function(e){S=e.default},function(e){f=e.default},function(e){v=e.SeasonDataCache},function(e){I=e.SeasonShipEventDefind},function(e){b=e.BaseView}],execute:function(){s._RF.push({},"2df464LxK1NFYQHtN/4uC5u","SeasonShipSkinView",void 0);var g=[[204085,101]],C=[[204160,102],[204161,103],[204162,104]],T=(e("default",function(e){function s(){var i;return(i=e.call(this)||this).tabUIList=void 0,i.ItemUIList=void 0,i.btnType1=void 0,i.btnType2=void 0,i.bgTab=void 0,i.curSelType=1,i.curSelTab=1,i.curSelID=0,i.tempFigure=void 0,i.selFigure=void 0,i.iconShip=void 0,i.btnUse=void 0,i.btnCancel=void 0,i.shipid=void 0,i.rpList={},i.name="SeasonShipSkinView",i.url="ui/module/season/SeasonShipSkinView",i}i(s,e);var a=s.prototype;return a.onInit=function(){var e=this;this.bgTab=this.findChildComponent("content/tabBG",n),this.btnUse=this.findChild("content/btnUse"),this.addComponentCallbackListener(this.btnUse,h.EventType.CLICK,(function(){var i=0;1==e.curSelType?i=3:2==e.curSelType&&(1==e.curSelTab?i=4:2==e.curSelTab?i=5:3==e.curSelTab&&(i=6)),IS(f).reqShipFigure(i,e.curSelID)})),this.btnCancel=this.findChild("content/btnCancel");var i=this.findChild("content/btnClose");this.addComponentCallbackListener(i,h.EventType.CLICK,(function(){e.close()}));var t=this.findChildComponent("content/scrollTab",r);this.tabUIList=this.addUIList(t,T),this.tabUIList.lackCenter=!0;var s=this.findChildComponent("content/scroll1",r);this.ItemUIList=this.addUIList(s,m),this.btnType1=this.findChild("content/bottomBtn/item1"),this.addComponentCallbackListener(this.btnType1,h.EventType.CLICK,(function(){e.curSelType=1,e.curSelTab=1,e.refreshTypeShow()})),this.btnType2=this.findChild("content/bottomBtn/item2"),this.addComponentCallbackListener(this.btnType2,h.EventType.CLICK,(function(){e.curSelType=2,e.refreshTypeShow()})),this.iconShip=this.findChild("content/nodeShip"),o.uiMirror&&this.iconShip.setScale(-1,1,1)},a.registerUpdateHandler=function(){this.addEvent(I.TYPE_SHIP_FIGURE_CHANGE_UPDATE,this.refreshShipModel,this)},a.onAfterOpen=function(){this.tempFigure=IS(v).getShipShowFigureInfo();for(var e,i=0,s=0,n=0,h=0,r=IS(v).figure_list,o=t(r);!(e=o()).done;){var a=e.value;3==a.k&&0!=a.v?i=a.v:4==a.k&&0!=a.v?s=a.v:5==a.k&&0!=a.v?n=a.v:6==a.k&&0!=a.v&&(h=a.v)}this.selFigure={shipId:i,flag:s,gunId:n,ram:h},this.curSelID=this.selFigure.shipId,this.refreshTypeShow(),this.showShipModel()},a.refreshRedShow=function(){var e=this,i={},s=IS(v).book_new;s=s.filter((function(i){return i!=e.curSelID}));for(var n,h=t(s);!(n=h()).done;){var r=n.value,o=configSeason_ship_appearance.getDataByKey(r);o&&(i[o.part]||(i[o.part]=[]),i[o.part].push(r))}IS(v).book_new=s,this.rpList=i,IS(v).checkShipSkinRP()},a.refreshTypeShow=function(){this.refreshRedShow();var e=u.findChild(this.btnType1,"normal"),i=u.findChild(this.btnType1,"selected"),t=u.findChild(this.btnType2,"normal"),s=u.findChild(this.btnType2,"selected"),n=u.findChild(this.btnType1,"red"),h=u.findChild(this.btnType2,"red");e.active=1!=this.curSelType,i.active=1==this.curSelType,t.active=2!=this.curSelType,s.active=2==this.curSelType,n.active=!S.isEmpty(this.rpList[101]),h.active=!S.isEmpty(this.rpList[102])||!S.isEmpty(this.rpList[103])||!S.isEmpty(this.rpList[104]),this.refreshTabShow(this.curSelTab)},a.refreshTabShow=function(e){this.curSelTab=e,1==this.curSelType?(this.tabUIList.datas=g,this.bgTab.width=195*g.length):2==this.curSelType&&(this.tabUIList.datas=C,this.bgTab.width=195*C.length),this.refreshItemShow(),this.refreshBtnShow()},a.setCurSel=function(e){switch(e){case 101:this.curSelID=this.selFigure.shipId;break;case 102:this.curSelID=this.selFigure.flag;break;case 103:this.curSelID=this.selFigure.gunId;break;case 104:this.curSelID=this.selFigure.ram}},a.refreshItemShow=function(){var e=0;1==this.curSelType?e=g[this.curSelTab-1][1]:2==this.curSelType&&(e=C[this.curSelTab-1][1]),this.setCurSel(e);for(var i,s=configSeason_ship_appearance.getDataByList("part",e),n=[],h=[],r=t(s);!(i=r()).done;){var o=i.value;n.includes(o.icon)||(n.push(o.icon),h.push(o))}h.sort((function(e,i){var t=IS(v).equip_books.includes(e.id)?2:1;return(IS(v).equip_books.includes(i.id)?2:1)-t})),h.unshift({id:0}),this.ItemUIList.datas=h},a.refreshBtnShow=function(){var e=IS(v).figure_list;if(0==this.curSelID){var i=0;1==this.curSelType?i=3:2==this.curSelType&&(1==this.curSelTab?i=4:2==this.curSelTab?i=5:3==this.curSelTab&&(i=6));for(var s,n=!1,h=t(e);!(s=h()).done;){var r=s.value;if(r.k==i&&0!=r.v){n=!0;break}}return this.btnUse.active=n,void(this.btnCancel.active=!n)}var o=!1,a=!1;IS(v).equip_books.includes(this.curSelID)&&(a=!0);for(var l,c=t(e);!(l=c()).done;){if(l.value.v==this.curSelID){o=!0;break}}this.btnCancel.active=a&&o,this.btnUse.active=a&&!o},a.refreshShipModel=function(){1==this.curSelType?(this.tempFigure.shipId=0!=this.curSelID?this.curSelID:IS(v).getShipShowFigureInfo().shipId,this.selFigure.shipId=this.curSelID):2==this.curSelType&&(1==this.curSelTab?(this.tempFigure.flag=0!=this.curSelID?this.curSelID:IS(v).getShipShowFigureInfo().flag,this.selFigure.flag=this.curSelID):2==this.curSelTab?(this.tempFigure.gunId=0!=this.curSelID?this.curSelID:IS(v).getShipShowFigureInfo().gunId,this.selFigure.gunId=this.curSelID):3==this.curSelTab&&(this.tempFigure.ram=0!=this.curSelID?this.curSelID:IS(v).getShipShowFigureInfo().ram,this.selFigure.ram=this.curSelID)),this.ItemUIList.updateAll(),this.showShipModel(),this.refreshTypeShow()},a.showShipModel=function(){this.shipid&&this.removeShipModel(this.shipid);var e=this.tempFigure;this.shipid=this.addShipModel({shipId:e.shipId,flag:e.flag,ram:e.ram,parent:this.iconShip,gunId:e.gunId},c.ZERO,.4)},a.onBeforeClose=function(){this.curSelType=1,this.curSelTab=1,this.curSelID=0},a.onDestroy=function(){},s}(b)),function(e){function t(){for(var i,t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return(i=e.call.apply(e,[this].concat(s))||this).txtName=void 0,i.txtNameSel=void 0,i.nodeSel=void 0,i.red=void 0,i}i(t,e);var s=t.prototype;return s.onInit=function(){var e=this;this.txtName=u.findChildComponent(this.node,"name",a),this.txtNameSel=u.findChildComponent(this.node,"selected/name",a),this.nodeSel=u.findChild(this.node,"selected"),this.red=u.findChild(this.node,"red"),this.view.addComponentCallbackListener(this.node,h.EventType.CLICK,(function(){e.view.refreshTabShow(e.index+1)}))},s.onRender=function(e,i){this.txtName.string=GetLanguage(e[0]),this.txtNameSel.string=GetLanguage(e[0]);var t=this.view;this.nodeSel.active=t.curSelTab==i+1,this.red.active=!S.isEmpty(t.rpList[e[1]])},t}(d)),m=function(e){function s(){for(var i,t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return(i=e.call.apply(e,[this].concat(s))||this).qualityBg=void 0,i.icon=void 0,i.dress=void 0,i.bg=void 0,i.select=void 0,i.timesp=void 0,i.lock=void 0,i.red=void 0,i.none=void 0,i}i(s,e);var n=s.prototype;return n.onInit=function(){var e=this;this.view.addComponentCallbackListener(this.node,h.EventType.CLICK,(function(){e.onItemClick()})),this.none=u.findChild(this.node,"none"),this.red=u.findChild(this.node,"red"),this.dress=u.findChild(this.node,"dress"),this.icon=u.findChildComponent(this.node,"icon",l),this.bg=u.findChildComponent(this.node,"bg",l),this.select=u.findChild(this.node,"selected"),this.timesp=u.findChild(this.node,"timesp"),this.lock=u.findChild(this.node,"lock"),this.view.addComponentCallbackListener(this.node,h.EventType.CLICK,(function(){var i=e.view;i.curSelID!=e.data.id&&(i.curSelID=e.data.id,i.refreshShipModel())})),o.uiMirror&&(this.view.loadIcon(this.none.getComponent(l),"equip","zbhh_ui_guding"),this.view.loadIcon(u.findChildComponent(this.node,"dress/icon",l),"player","grxx_ui_gouxuan"))},n.onRender=function(e,i){this.red.active=IS(v).book_new.includes(e.id);var s=this.view,n=IS(v).figure_list;if(this.select.active=s.curSelID==e.id,0==e.id){var h=0;1==s.curSelType?h=3:2==s.curSelType&&(1==s.curSelTab?h=4:2==s.curSelTab?h=5:3==s.curSelTab&&(h=6));for(var r,o=!0,a=t(n);!(r=a()).done;){var l=r.value;if(l.k==h&&0!=l.v){o=!1;break}}return this.dress.active=o,this.none.active=!0,this.lock.active=!1,this.icon.node.active=!1,void(this.bg.grayscale=!1)}this.none.active=!1;var c=!1,d=!1;IS(v).equip_books.includes(e.id)&&(d=!0);for(var u,S=t(n);!(u=S()).done;){if(u.value.v==e.id){c=!0;break}}this.dress.active=c,this.lock.active=!d,this.bg.grayscale=!d,this.icon.grayscale=!d,this.timesp.active=e.time&&e.time>0,this.icon.node.active=!0,this.view.loadIcon(this.icon,e.atlas,e.icon,null,p.ICON_SPRITE)},s}(d);s._RF.pop()}}}));

