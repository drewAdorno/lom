System.register("chunks:///_virtual/FundView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./RedPointMgr.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./BagDefine.ts","./BagModel.ts","./PayDataCache.ts","./PayDefine.ts","./PrivilegeControl.ts","./PrivilegeDataCache.ts","./PrivilegeDefine.ts","./BaseView.ts"],(function(i){"use strict";var t,e,n,d,o,a,s,l,r,c,u,h,f,m,C,g,I,v,y,_,p,w,B,L;return{setters:[function(i){t=i.inheritsLoose},function(i){e=i.cclegacy,n=i.ScrollView,d=i.Button,o=i.Label,a=i.Vec2,s=i.sys,l=i.Sprite,r=i.ProgressBar},function(i){c=i.ItemGrid},function(i){u=i.SelectedType,h=i.ListItem},function(i){f=i.RedPointMgr},function(i){m=i.default},function(i){C=i.default},null,function(i){g=i.ItemIdDefine},function(i){I=i.BagModel},function(i){v=i.default},function(i){y=i.PayEventDefine},function(i){_=i.default},function(i){p=i.PrivilegeDataCache},function(i){w=i.FundType,B=i.FundEventDefine},function(i){L=i.BaseView}],execute:function(){e._RF.push({},"94877BY/rBF5729diUsHpRN","FundView",void 0);i("default",function(i){function e(){var t;return(t=i.call(this)||this).imgBGMain=void 0,t.imgBGLamp=void 0,t.scrollItemList=void 0,t.scrollItem=void 0,t.fund_id=0,t.txtPrice=void 0,t.txtPrice1=void 0,t.btnBuy=void 0,t.btnBuy1=void 0,t.name="FundView",t.url="ui/module/recharge/FundView",t.poolTime=3e3,t}t(e,i);var s=e.prototype;return s.onInit=function(){var i=this;this.scrollItem=this.findChildComponent("root/content/ScrollView",n),this.scrollItemList=this.addUIList(this.scrollItem,k),this.scrollItemList.selectedMode=u.SINGLE;var t=this.findChild("root/content/btnClose");this.addComponentCallbackListener(t,d.EventType.CLICK,(function(){i.onCloseClick()}));var e=this.findChild("root/content/ScrollView/imgColumnLeft/icon");this.addComponentCallbackListener(e,d.EventType.CLICK,(function(){i.onBuyClick()}));var s=this.findChild("root/content/ScrollView/imgColumnMid/icon");this.addComponentCallbackListener(s,d.EventType.CLICK,(function(){i.onBuyClick1()})),this.txtPrice=this.findChildComponent("root/content/ScrollView/imgColumnLeft/btnBuy/Label",o),this.btnBuy=this.findChild("root/content/ScrollView/imgColumnLeft/btnBuy"),this.addComponentCallbackListener(this.btnBuy,d.EventType.CLICK,(function(){i.onBuyClick()})),this.txtPrice1=this.findChildComponent("root/content/ScrollView/imgColumnMid/btnBuy/Label",o),this.btnBuy1=this.findChild("root/content/ScrollView/imgColumnMid/btnBuy"),this.addComponentCallbackListener(this.btnBuy1,d.EventType.CLICK,(function(){i.onBuyClick1()}));var l=this.findChild("root/content/bottom/btnGet");IS(f).addRedPoint("recharge_gift/Fund"+this.fund_id,l,new a(100,30)),this.addComponentCallbackListener(l,d.EventType.CLICK,(function(){IS(_).reqAllCanGet(i.fund_id)})),this.imgBGMain=this.findChild("root/content/top/imgBgMain"),this.imgBGLamp=this.findChild("root/content/top/imgBgLamp")},s.onAfterOpen=function(){this.fund_id=this.openArgs[0];var i=this.findChild("root/content/bottom/btnGet");IS(f).addRedPoint("recharge_gift/Fund"+this.fund_id,i,new a(100,30)),1==this.fund_id?(this.imgBGMain.active=!0,this.imgBGLamp.active=!1):(this.imgBGMain.active=!1,this.imgBGLamp.active=!0),this.updateRewardList(),this.onUpdateNormalView(),p.checkRewardRP(this.fund_id)>=0?this.scrollItemList.scrollTo(p.checkRewardRP(this.fund_id)):this.scrollItemList.scrollTo(p.checkRewardRoll(this.fund_id))},s.updateScrollInfo=function(){this.updateRewardList(),this.onUpdateNormalView()},s.updateRewardList=function(){var i=configFund_reward.getDataByList("id",this.fund_id).length,t=Array.from({length:i},(function(i,t){return t+1}));for(var e in this.scrollItemList.datas=t,w)IS(f).changeValue("recharge_gift/Fund"+e,0);p.checkRewardRP(this.fund_id)>=0?IS(f).changeValue("recharge_gift/Fund"+this.fund_id,1):IS(f).changeValue("recharge_gift/Fund"+this.fund_id,0)},s.registerUpdateHandler=function(){this.addEvent(B.FUND_INIT_FINISH,this.updateScrollInfo,this),this.addEvent(B.FUND_UPDATE_INFO,this.updateRewardList,this),this.addEvent(y.PAY_RECHARGE_SUCCESS,this.updateScrollInfo,this)},s.onUpdateNormalView=function(){this.findChild("root/content/bottom/btnBuy").active=!1;var i=configFund.getDataByKey(this.fund_id),t=IS(p).getFundInfoByFundID(this.fund_id);t?(this.btnBuy.active=!t.pay_status,this.btnBuy1.active=!t.pay_status_2,this.txtPrice.string=IS(v).GetPriceString(configPay_mall.getDataByKey(i.gift_id).cost_level),this.txtPrice1.string=IS(v).GetPriceString(configPay_mall.getDataByKey(i.mid_gift_id).cost_level)):(this.btnBuy.active=!0,this.btnBuy1.active=!0)},s.onCloseClick=function(){this.close()},s.onBuyClick=function(){if(1!=IS(p).getFundInfoByFundID(this.fund_id).pay_status){var i=configFund.getDataByKey(this.fund_id).gift_id,t=configPay_mall.getDataByKey(i);IS(I).getGoodsCountByGoodsGtid(g.FakeRechare)>=t.price?uiMgr.openView("FundBuyView",this.fund_id):IS(v).Pay(i)}},s.onBuyClick1=function(){if(1!=IS(p).getFundInfoByFundID(this.fund_id).pay_status_2){var i=configFund.getDataByKey(this.fund_id).mid_gift_id,t=configPay_mall.getDataByKey(i);IS(I).getGoodsCountByGoodsGtid(g.FakeRechare)>=t.price?uiMgr.openView("FundBuyView",this.fund_id,!0):IS(v).Pay(i)}},s.onBeforeClose=function(){},s.onDestroy=function(){},e}(L));var k=i("BPItem",function(i){function e(){for(var t,e=arguments.length,n=new Array(e),d=0;d<e;d++)n[d]=arguments[d];return(t=i.call.apply(i,[this].concat(n))||this).itemIndex=void 0,t.fund_id=void 0,t.gradeLabel=void 0,t}t(e,i);var n=e.prototype;return n.onInit=function(){var i=this;this.gradeLabel=m.findChildComponent(this.node,"pbExp/txtLabel",o);var t=m.findChild(this.node,"imgColumnLeft/nodeLock/btnLock");this.view.addComponentCallbackListener(t,d.EventType.CLICK,(function(){i.onBuyClick()}));var e=m.findChild(this.node,"imgColumnMid/nodeLock/btnLock");this.view.addComponentCallbackListener(e,d.EventType.CLICK,(function(){i.onBuyClick1()}));var n=m.findChild(this.node,"imgColumnLeft/mask");this.view.addComponentCallbackListener(n,d.EventType.CLICK,(function(){i.onBuyClick()}));var a=m.findChild(this.node,"imgColumnMid/mask");this.view.addComponentCallbackListener(a,d.EventType.CLICK,(function(){i.onBuyClick1()})),s.uiMirror&&(this.view.loadIcon(m.findChildComponent(this.node,"imgColumnLeft/nodeItem0/nodeGotIt",l),"zl","zl_ICOM__yilingqu"),this.view.loadIcon(m.findChildComponent(this.node,"imgColumnLeft/nodeItem1/nodeGotIt",l),"zl","zl_ICOM__yilingqu"),this.view.loadIcon(m.findChildComponent(this.node,"imgColumnLeft/nodeItem2/nodeGotIt",l),"zl","zl_ICOM__yilingqu"),this.view.loadIcon(m.findChildComponent(this.node,"imgColumnMid/nodeItem0/nodeGotIt",l),"zl","zl_ICOM__yilingqu"),this.view.loadIcon(m.findChildComponent(this.node,"imgColumnMid/nodeItem1/nodeGotIt",l),"zl","zl_ICOM__yilingqu"),this.view.loadIcon(m.findChildComponent(this.node,"imgColumnRight/imgGotIt",l),"zl","zl_ICOM__yilingqu"))},n.onRender=function(i,t){var e=this,n=this.view;this.fund_id=n.fund_id,this.itemIndex=i,this.data=configFund_reward.getDataByKeys("id",this.fund_id,"level",i),this.gradeLabel.string=C.formatStrWithMirrorDeal(GetLanguage(200333),this.data.condition[2]);for(var d=IS(p).getFundInfoByFundID(this.fund_id),o=function(i){var t=m.findChild(e.node,"imgColumnLeft/nodeItem"+i);if(1==e.data.high_reward.length&&1==i)return t.active=!1,"break";t.active=!0,new c(e.view,t,(function(){1==d.high_reward[e.itemIndex-1].status?IS(_).reqFundReward(e.fund_id,e.itemIndex,2):IS(I).OpenItemTips(e.data.high_reward[i][0],t)})).SetItemId(e.data.high_reward[i][0],e.data.high_reward[i][1])},a=0;a<3;a++){if("break"===o(a))break}for(var s=function(i){var t=m.findChild(e.node,"imgColumnMid/nodeItem"+i);if(1==e.data.mid_reward.length&&1==i)return t.active=!1,"break";t.active=!0,new c(e.view,t,(function(){1==d.mid_reward[e.itemIndex-1].status?IS(_).reqFundReward(e.fund_id,e.itemIndex,3):IS(I).OpenItemTips(e.data.mid_reward[i][0],t)})).SetItemId(e.data.mid_reward[i][0],e.data.mid_reward[i][1])},l=0;l<2;l++){if("break"===s(l))break}var r=m.findChild(this.node,"imgColumnRight/nodeItem");new c(this.view,r,(function(){1==d.free_reward[e.itemIndex-1].status?IS(_).reqFundReward(e.fund_id,e.itemIndex,1):IS(I).OpenItemTips(e.data.free_reward[0][0],r)})).SetItemId(this.data.reward[0][0],this.data.reward[0][1]),this.checkItemState(),this.refreshProgress()},n.checkItemState=function(){var i=m.findChild(this.node,"imgColumnLeft/nodeItem0/nodeCanGet"),t=m.findChild(this.node,"imgColumnLeft/nodeItem0/nodeGotIt"),e=m.findChild(this.node,"imgColumnLeft/nodeItem1/nodeCanGet"),n=m.findChild(this.node,"imgColumnLeft/nodeItem1/nodeGotIt"),d=m.findChild(this.node,"imgColumnLeft/nodeItem2/nodeCanGet"),o=m.findChild(this.node,"imgColumnLeft/nodeItem2/nodeGotIt"),a=m.findChild(this.node,"imgColumnMid/nodeItem0/nodeCanGet"),s=m.findChild(this.node,"imgColumnMid/nodeItem0/nodeGotIt"),l=m.findChild(this.node,"imgColumnMid/nodeItem1/nodeCanGet"),r=m.findChild(this.node,"imgColumnMid/nodeItem1/nodeGotIt"),c=m.findChild(this.node,"imgColumnRight/imgCanGet"),u=m.findChild(this.node,"imgColumnRight/imgGotIt"),h=IS(p).getFundInfoByFundID(this.fund_id);if(t.active=!1,i.active=!1,n.active=!1,e.active=!1,o.active=!1,d.active=!1,h.pay_status)switch(m.findChild(this.node,"imgColumnLeft/nodeLock").active=!1,m.findChild(this.node,"imgColumnLeft/mask").active=!1,h.high_reward[this.itemIndex-1].status){case 0:break;case 1:i.active=!0,e.active=!0,d.active=!0;break;case 2:t.active=!0,n.active=!0,o.active=!0}else m.findChild(this.node,"imgColumnLeft/nodeLock").active=!0,m.findChild(this.node,"imgColumnLeft/mask").active=!0;if(a.active=!1,s.active=!1,l.active=!1,r.active=!1,h.pay_status_2)switch(m.findChild(this.node,"imgColumnMid/nodeLock").active=!1,m.findChild(this.node,"imgColumnMid/mask").active=!1,h.mid_reward[this.itemIndex-1].status){case 0:break;case 1:a.active=!0,l.active=!0;break;case 2:s.active=!0,r.active=!0}else m.findChild(this.node,"imgColumnMid/nodeLock").active=!0,m.findChild(this.node,"imgColumnMid/mask").active=!0;switch(u.active=!1,c.active=!1,h.free_reward[this.itemIndex-1].status){case 0:break;case 1:c.active=!0;break;case 2:u.active=!0}},n.refreshProgress=function(){var i=m.findChildComponent(this.node,"pbExp",r),t=IS(p).getFundInfoByFundID(this.fund_id),e=IS(p).getFundProcessByID(this.fund_id),n=configFund_reward.getDataByKeys("id",this.fund_id,"level",this.itemIndex),d=n.condition[2],o=e,a=configFund_reward.getDataByKeys("id",this.fund_id,"level",this.itemIndex-1);a&&(d=n.condition[2]-a.condition[2],o-=a.condition[2]),t.lev==this.itemIndex-1?i.progress=o/d-.3:t.lev==this.itemIndex?i.progress=.7+o/d:t.lev>this.itemIndex?i.progress=1:i.progress=0},n.onBuyClick=function(){var i=configFund.getDataByKey(this.fund_id).gift_id,t=configPay_mall.getDataByKey(i);IS(I).getGoodsCountByGoodsGtid(g.FakeRechare)>=t.price?uiMgr.openView("FundBuyView",this.fund_id):IS(v).Pay(i)},n.onBuyClick1=function(){var i=configFund.getDataByKey(this.fund_id).mid_gift_id,t=configPay_mall.getDataByKey(i);IS(I).getGoodsCountByGoodsGtid(g.FakeRechare)>=t.price?uiMgr.openView("FundBuyView",this.fund_id,!0):IS(v).Pay(i)},e}(h));e._RF.pop()}}}));

