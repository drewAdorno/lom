System.register("chunks:///_virtual/ArtifactRefinedView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./RedPointMgr.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ObjectUtil.ts","./MessageView.ts","./ArtifactDataCache.ts","./ArtifactDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var e,n,i,o,r,a,s,d,f,h,c,l,u,m,g,v,C,p,S,A,x,I;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t.ScrollView,r=t.RichText,a=t.sys,s=t.Layout,d=t.Button,f=t.HorizontalTextAlignment,h=t.Vec2,c=t.Label,l=t.js,u=t.Sprite},function(t){m=t.ListItem},function(t){g=t.RedPointMgr},function(t){v=t.default},function(t){C=t.default},null,function(t){p=t.default},function(t){S=t.default},function(t){A=t.ArtifactDataCache},function(t){x=t.ArtifactEvent},function(t){I=t.BaseSubView}],execute:function(){i._RF.push({},"babdcWB1IBM04MemcwZHHAd","ArtifactRefinedView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).nodeNone=void 0,e.nodeInfo=void 0,e.curselPos=void 0,e.posToStone=void 0,e.attrScroll=void 0,e.txtDesc=void 0,e.name="ArtifactRefinedView",e.url="ui/module/artifact/ArtifactRefinedView",e.poolTime=3e3,e}e(i,t);var l=i.prototype;return l.onInit=function(){var t=this;this.nodeNone=this.findChild("root/nodeChange/nodeNone"),this.nodeInfo=this.findChild("root/nodeChange/nodeInfo");var e=this.findChildComponent("root/nodeChange/nodeInfo/ScrollView",o);this.attrScroll=this.addUIList(e,N),this.txtDesc=this.findChildComponent("root/nodeChange/nodeInfo/txtDesc",r),a.uiMirror&&this.dealMirrorLayout(this.findChildComponent("root/nodeChange/nodeInfo/common_ui_xiaotidi",s));var n=this.findChild("root/nodeShow/btnRule");this.addComponentCallbackListener(n,d.EventType.CLICK,(function(){S.showBoxTip({tip:GetLanguage(201808),title:GetLanguage(201384),btnCnt:1,horizontalAlign:a.uiMirror?f.RIGHT:f.LEFT})}));var i=this.findChild("root/nodeChange/btnChange");IS(g).addRedPoint("artifact_refined_active/btnChange",i,new h(90,30)),this.addComponentCallbackListener(i,d.EventType.CLICK,(function(){uiMgr.openView("ArtifactGemView",t.curselPos,1)})),this.initStoneShow()},l.initStoneShow=function(){var t=this;this.posToStone=[];for(var e=function(e){var n=t.findChild("root/nodeShow/nodeStone/stone"+e);t.posToStone[e]={imgIcon:v.findChildComponent(n,"icon",u),imgFrame:v.findChildComponent(n,"frame",u),sel:v.findChild(n,"sel"),red:v.findChild(n,"red"),txtNum:v.findChildComponent(n,"bg/num",c),bgNum:v.findChild(n,"bg"),index:e},t.addComponentCallbackListener(n,d.EventType.CLICK,(function(){t.curselPos=e;var i=IS(A).pos_list[t.curselPos];i&&0!=i?uiMgr.openView("ArtifactInfoTipsView",i,n,1):uiMgr.openView("ArtifactGemView",t.curselPos,1)}))},n=1;n<7;n++)e(n)},l.onAfterOpen=function(){IS(A).checkGemRP(),this.refreshStoneShow(),this.refreshStoneInfo()},l.registerUpdateHandler=function(){this.addEvent(x.TYPE_ARTIFACT_GEM_INFO_UPDATE,this.refreshShow,this)},l.refreshShow=function(){IS(A).checkGemRP(),this.refreshStoneShow(),this.refreshStoneInfo()},l.refreshStoneShow=function(){for(var t in this.posToStone){var e=this.posToStone[t],i=IS(A).pos_list[t],o=IS(A).getStoneInfoByID(i);if(e.red.active=!1,o){var r=configArtifact_gemquality.getDataByKey(o.quality);this.loadIcon(e.imgFrame,"icon_gem",r.frame);var a=configArtifact_gemsets.getDataByKey(o.suit);this.loadIcon(e.imgIcon,"icon_gem",a.icon),o.lv>0?(e.bgNum.active=!0,e.txtNum.string="Lv."+o.lv):e.bgNum.active=!1}else{this.loadIcon(e.imgFrame,"icon_gem",""),this.loadIcon(e.imgIcon,"icon_gem",""),e.txtNum.string="";for(var s,d=n(IS(A).gem_list);!(s=d()).done;){if(s.value.pos==Number(t)){e.red.active=!0;break}}}}},l.refreshStoneInfo=function(){var t=IS(A).getAllGemAttr();this.attrScroll.datas=t,this.txtDesc.node.active=!1;var e=IS(A).getStoneSuitInfo();for(var n in e)if(e[n]>=4){this.txtDesc.string="<b><color=544231>"+(GetLanguage(201496)+configArtifact_gemsets.getDataByKey(n).bonus4_desc)+"</color></b>",this.txtDesc.node.active=!0;break}this.nodeNone.active=!1,this.nodeInfo.active=!0,p.isEmpty(e)&&(this.nodeInfo.active=!1,this.nodeNone.active=!0)},l.onBeforeClose=function(){},l.onDestroy=function(){},i}(I)),t("ArtifactGemAttrItem",function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).txtBaseName=void 0,e.txtBaseAttr=void 0,e.txtMainName=void 0,e.txtMainAttr=void 0,e.nodeMain=void 0,e}e(n,t);var i=n.prototype;return i.onInit=function(){this.txtBaseName=v.findChildComponent(this.node,"txtBaseName",c),this.txtBaseAttr=v.findChildComponent(this.node,"txtBaseAttr",c),this.txtMainName=v.findChildComponent(this.node,"nodeMain/txtMainName",c),this.txtMainAttr=v.findChildComponent(this.node,"nodeMain/txtMainAttr",c),this.nodeMain=v.findChild(this.node,"nodeMain")},i.onRender=function(t,e){this.nodeMain.active=1==t.type;var n=configAttribute.getDataByKey(t.info.k);if(this.txtBaseName.string=n.name,this.txtMainName.string=n.name,1!=t.type){var i=IS(A).getGemAttrColor(t.info.k,t.info.v);this.txtBaseName.color=i,this.txtBaseAttr.color=i}var o=n.show_type;2==o?(this.txtBaseAttr.string="+"+l.formatStr("%s%",C.GetNumString(t.info.v/100)),this.txtMainAttr.string="+"+l.formatStr("%s%",C.GetNumString(t.info.v/100))):3==o?(this.txtBaseAttr.string="+"+C.GetNumString(Math.floor(t.info.v/100)/100),this.txtMainAttr.string="+"+C.GetNumString(Math.floor(t.info.v/100)/100)):(this.txtBaseAttr.string="+"+C.GetNumString(t.info.v),this.txtMainAttr.string="+"+C.GetNumString(t.info.v)),1==t.type&&(this.txtBaseAttr.string="",this.txtBaseName.string="")},n}(m));var N=t("GemAttrItem",function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).txtBaseName=void 0,e.txtBaseAttr=void 0,e}e(n,t);var i=n.prototype;return i.onInit=function(){this.txtBaseName=v.findChildComponent(this.node,"txtBaseName",c),this.txtBaseAttr=v.findChildComponent(this.node,"txtBaseAttr",c)},i.onRender=function(t,e){var n=configAttribute.getDataByKey(t.attr);this.txtBaseName.string=n.name;var i=n.show_type;this.txtBaseAttr.string=2==i?"+"+l.formatStr("%s%",C.GetNumString(t.value/100)):3==i?"+"+C.GetNumString(Math.floor(t.value/100)/100):"+"+C.GetNumString(t.value)},n}(m));i._RF.pop()}}}));

