System.register("chunks:///_virtual/SlaveSearchView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ObjectUtil.ts","./FriendControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./SlaveControl.ts","./SlaveDefine.ts","./SlaveModel.ts","./BaseSubView.ts"],(function(t){"use strict";var e,i,n,o,s,a,h,r,d,l,c,f,u,v,m,S,C,p,g,I,L,R;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.ScrollView,s=t.Label,a=t.Button,h=t.UITransform,r=t.js,d=t.Sprite,l=t.Layout},function(t){c=t.ListItem},function(t){f=t.default},function(t){u=t.default},function(t){v=t.default},null,function(t){m=t.default},function(t){S=t.default},function(t){C=t.RoleDataCache},function(t){p=t.PlayerAttr},function(t){g=t.default},function(t){I=t.SlaveEventDefine},function(t){L=t.SlaveModel},function(t){R=t.BaseSubView}],execute:function(){n._RF.push({},"dfb6dCqueNAz6HLLb4ms1GL","SlaveSearchView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).scrollList=void 0,e.curInfo=void 0,e.time=0,e.name="SlaveSearchView",e.url="ui/module/slave/SlaveSearchView",e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this.findChildComponent("scroll",o);this.scrollList=this.addUIList(t,w)},n.registerUpdateHandler=function(){this.addEvent(I.SLAVE_SEARCH_INFO_BACK,this.onSlaveSearchInfoBack,this),this.addEvent(I.SLAVE_SEARCH_INFO_REFRESH,this.onSlaveSearchInfoRefresh,this)},n.onAfterOpen=function(){this.time=0,this.trySetParent(),IS(g).reqCaptureSlaveSearch(0)},n.onBeforeClose=function(){this.curInfo=null,this.time=0},n.onDestroy=function(){},n.onUpdate=function(t){null!=this.time&&(this.time=this.time+t,this.time>=1&&(this.time=0,this.scrollList.items.forEach((function(t,e,i){t.updateTimeShow()}))))},n.onUpdateSpaceList=function(){this.scrollList.datas=[this.curInfo.null_list,this.curInfo.hate_list]},n.trySetParent=function(){var t=uiMgr.getOpenView("SlaveFindView");t&&t.nodeSubRoot&&this.node.setParent(t.nodeSubRoot)},n.onSlaveSearchInfoBack=function(t){0==t.type&&(this.curInfo=m.clone(t),this.onUpdateSpaceList())},n.onSlaveSearchInfoRefresh=function(t){this.curInfo&&(this.curInfo.null_list=t.null_list,this.curInfo.next_time=t.next_time,this.onUpdateSpaceList())},i}(R));var w=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).txtFilter=void 0,e.btnRefresh=void 0,e.btnRefreshMask=void 0,e.txtTime=void 0,e.itemList=void 0,e.utNode=void 0,e.utScroll=void 0,e.utMask=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.adaptiveSize=!0,this.txtFilter=f.findChildComponent(this.node,"title/txtFilter",s),this.btnRefresh=f.findChildComponent(this.node,"title/btnRefresh",a),this.btnRefreshMask=f.findChild(this.btnRefresh.node,"mask"),this.txtTime=f.findChildComponent(this.btnRefresh.node,"txtTime",s),this.view.addComponentCallbackListener(this.btnRefresh.node,a.EventType.CLICK,(function(){if(0==t.index){var e=t.view;null!=e.curInfo&&(v.serverTime<e.curInfo.next_time||IS(g).reqCaptureSlaveRefresh())}}));var e=f.findChildComponent(this.node,"ScrollView",o);this.itemList=this.view.addUIList(e,_,!1),this.utScroll=e.getComponent(h),this.utMask=f.findChildComponent(this.node,"ScrollView/view",h),this.utNode=this.node.getComponent(h)},n.updateTimeShow=function(){this.itemList.items.forEach((function(t,e,i){t.updateTimeShow()}));var t=this.view;if(null!=t.curInfo){var e=t.curInfo.next_time;if(e<=0)return this.btnRefreshMask.active=!1,void(this.txtTime.node.active=!1);var i=e-v.serverTime;if(i<=0)return this.btnRefreshMask.active=!1,void(this.txtTime.node.active=!1);this.btnRefreshMask.active=!0,this.txtTime.node.active=!0,this.txtTime.string=r.formatStr("%ss",i)}},n.onRender=function(t,e){this.txtFilter.string=[GetLanguage(201770),GetLanguage(201771)][e],this.btnRefresh.node.active=0==e,0==e&&(t.length=3),this.utNode.height=t.length<=3?436:436+118*(t.length-3),this.utScroll.height=t.length<=3?358:358+118*(t.length-3),this.utMask.height=t.length<=3?358:358+118*(t.length-3),this.itemList.datas=t},i}(c),_=t("SlaveItemMaker",function(t){function n(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).btnRoleInfo=void 0,e.imgIcon=void 0,e.imgHeadFrame=void 0,e.txtName=void 0,e.txtChapter=void 0,e.txtFightPower=void 0,e.nodeLine1=void 0,e.nodeLine2=void 0,e.btnCheck=void 0,e.nodeCD=void 0,e}e(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.btnRoleInfo=f.findChild(this.node,"imgFrame"),this.view.addComponentCallbackListener(this.btnRoleInfo,a.EventType.CLICK,(function(){t.data.role_id&&IS(S).reqOtherRoleNotice(t.data.role_id,1)})),this.imgIcon=f.findChildComponent(this.node,"imgFrame/imgIcon",d),this.imgHeadFrame=f.findChildComponent(this.node,"imgFrame/imgHeadFrame",d),this.txtName=f.findChildComponent(this.node,"nameInfo/txtName",s),this.btnCheck=f.findChild(this.node,"btnCheck"),this.view.addComponentCallbackListener(this.btnCheck,a.EventType.CLICK,(function(){uiMgr.openView("SlaveMasterView",t.data.role_id)})),this.txtChapter=f.findChildComponent(this.node,"txtChapter",s),this.txtFightPower=f.findChildComponent(this.node,"txtFightPower",s),this.nodeLine1=f.findChild(this.node,"imgLine1"),this.nodeLine2=f.findChild(this.node,"imgLine2"),this.nodeCD=f.findChild(this.node,"nameInfo/imgCD"),this.view.dealMirrorLayout(f.findChildComponent(this.node,"nameInfo",l))},o.onRender=function(t,e){this.nodeLine1.active=e>0,this.nodeLine2.active=e>0;for(var n,o=i(this.node.children);!(n=o()).done;){n.value.active=null!=t}if(null!=t){this.btnCheck.active=t.role_id!=IS(C).GetRoleId(),this.view.loadRemoteIcon(IS(L).getAttrStrById(t,p.ROLE_ATTR_HEAD_URL),this.imgIcon),this.txtName.string=IS(L).getRoleName(t);var s=IS(L).getAttrNumById(t,p.ROLE_ATTR_HEAD_FRAME_ID);if(s>0){this.imgHeadFrame.node.active=!0;var a=configAvatar_frame.getDataByKey(s);this.view.loadIcon(this.imgHeadFrame,"icon_frame",a.icon)}else this.imgHeadFrame.node.active=!1;this.txtFightPower.string=u.GetNumString(IS(L).getAttrNumById(t,p.ROLE_ATTR_POWER_SHOW)),this.txtChapter.string=IS(L).getExtValue(t,1),this.updateTimeShow()}},o.updateTimeShow=function(){var t=IS(L).getExtValue(this.data,4);this.nodeCD.active=null!=t&&0!=t&&v.serverTime<t},n}(c));n._RF.pop()}}}));

