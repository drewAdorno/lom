System.register("chunks:///_virtual/SeasonSceneRecordView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./RoleDataCache.ts","./SeasonDefine.ts","./SeasonSceneControl.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,h,a,d,f,r,l,g,c,u,m,v,p,C;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.ScrollView,s=t.Color,h=t.Sprite,a=t.Label,d=t.ProgressBar,f=t.Vec2},function(t){r=t.SelectedType,l=t.ListItem},function(t){g=t.default},function(t){c=t.default},function(t){u=t.default},null,function(t){m=t.RoleDataCache},function(t){v=t.SeasonEventDefine},function(t){p=t.default},function(t){C=t.BaseView}],execute:function(){e._RF.push({},"835ffwY6cJMY5e7mk84bzUS","SeasonSceneRecordView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).itemList=void 0,i.pos=new f,i.name="SeasonSceneRecordView",i.url="ui/module/season/scene-view/SeasonSceneRecordView",i}i(e,t);var s=e.prototype;return s.onInit=function(){var t=this,i=this.findChild("content/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("imgMask");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var s=this.findChildComponent("content/scroll",o);this.itemList=this.addUIList(s,w),this.itemList.selectedMode=r.SINGLE},s.registerUpdateHandler=function(){var t=this;this.addEvent(v.SEASON_SCENE_REPORTS,(function(i){t.itemList.datas=i}))},s.onAfterOpen=function(){IS(p).reqBattleReports()},s.onBeforeClose=function(){},s.onDestroy=function(){},e}(C));var b=["gvg_img_ping","gvg_img_shengli","gvg_img_shibai"],_=[new s("#3AFF1D"),new s("#FF8170")],w=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).imgBg=void 0,i.nodeBtnReview=void 0,i.txtTime=void 0,i.txtGrid=void 0,i.txtType=void 0,i.imgFightIconLeft=void 0,i.imgFightIconRight=void 0,i.imgFlag=void 0,i.txtNameLeft=void 0,i.txtNameRight=void 0,i.pbLeft=void 0,i.pbRight=void 0,i.leftBuff=void 0,i.rightBuff=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.adaptiveSize=!0,this.imgBg=g.findChildComponent(this.node,"imgBg",h),this.nodeBtnReview=g.findChild(this.node,"time/btnReview"),this.view.addComponentCallbackListener(this.nodeBtnReview,n.EventType.CLICK,(function(){t.onReviewClick()})),this.view.loadIcon(this.nodeBtnReview.getComponent(h),"gvg","gvg_btn_huifang"),this.txtType=g.findChildComponent(this.node,"txtType",a),this.txtGrid=g.findChildComponent(this.node,"txtGrid",a),this.txtTime=g.findChildComponent(this.node,"time/txtTime",a),this.imgFightIconLeft=g.findChildComponent(this.node,"fight/imgIcon1",h),this.imgFightIconRight=g.findChildComponent(this.node,"fight/imgIcon2",h),this.imgFlag=g.findChildComponent(this.node,"fight/imgFlag",h),this.txtNameLeft=g.findChildComponent(this.node,"fight/txtName1",a),this.txtNameRight=g.findChildComponent(this.node,"fight/txtName2",a),this.pbLeft=g.findChildComponent(this.node,"fight/pbLeft",d),this.pbRight=g.findChildComponent(this.node,"fight/pbRight",d);var i=g.findChild(this.node,"fight/btnBuffLeft");this.leftBuff=new R(i,this.view);var e=g.findChild(this.node,"fight/btnBuffRight");this.rightBuff=new R(e,this.view)},o.onRender=function(t,i){this.data=t;var e=configSeason_building_plot.getDataByKey(t.grid_id);this.txtType.string=t.atk_role.id==IS(m).GetRoleId()?GetLanguage(204623):GetLanguage(204624),this.txtGrid.string=c.formatStr("##1 (##2,##3)",e.name,t.grid_pos.x,t.grid_pos.y);var n=0;n=t.atk_role.id==IS(m).GetRoleId()?0==t.win_id?0:t.win_id==t.atk_role.id?1:2:0==t.win_id?0:t.win_id==t.def_role.id?1:2,this.txtTime.string=u.formatDate(new Date(1e3*t.time),"yyyy/MM/dd hh:mm:ss"),this.view.loadIcon(this.imgBg,"gvg",1==n?"gvg_img_zhanbao_shengli":"gvg_img_zhanbao_shibai"),this.view.loadIcon(this.imgFlag,"gvg",b[n]);var o=t.atk_role,s=t.def_role;this.view.loadRemoteIcon(o.head.url,this.imgFightIconLeft),this.view.loadRemoteIcon(s.head.url,this.imgFightIconRight),this.txtNameLeft.string=o.name,this.txtNameRight.string=s.name,o.id==IS(m).GetRoleId()?(this.txtNameLeft.color=_[0],this.txtNameRight.color=_[1],this.view.loadIcon(this.pbLeft.barSprite,"battle","zjm_ui_juesetiao02"),this.view.loadIcon(this.pbRight.barSprite,"battle","zjm_ui_guaiwutiao02")):(this.txtNameLeft.color=_[1],this.txtNameRight.color=_[0],this.view.loadIcon(this.pbLeft.barSprite,"battle","zjm_ui_guaiwutiao02"),this.view.loadIcon(this.pbRight.barSprite,"battle","zjm_ui_juesetiao02")),this.pbLeft.progress=Math.min(1,o.hp/o.hp_max),this.pbRight.progress=Math.min(1,s.hp/s.hp_max),this.leftBuff.updateBuff(o.debuff),this.rightBuff.updateBuff(s.debuff)},o.onReviewClick=function(){IS(p).reqVideo(this.data.vid,0),uiMgr.close("SeasonSceneRecordView")},e}(l),R=function(){function t(t,i){var e=this;this.buffs=[],this.debuff=void 0;for(var o=function(o){var s=g.findChild(t,"buff"+o);e.buffs.push(s),i.addComponentCallbackListener(s,n.EventType.CLICK,(function(){if(e.debuff&&e.debuff[o-1]){var t=configSkill_level.getDataByKeys("id",e.debuff[o-1],"level",1),i=c.formatStr(t.desc,t.desc_parm);uiMgr.openView("JobSkillTipsView",i,s)}}))},s=1;s<=3;s++)o(s)}return t.prototype.updateBuff=function(t){this.debuff=t;for(var i=0;i<3;i++)this.buffs[i].active=t&&null!=t[i]},t}();e._RF.pop()}}}));

