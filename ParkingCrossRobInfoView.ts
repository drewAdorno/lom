System.register("chunks:///_virtual/ParkingCrossRobInfoView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./MessageView.ts","./FriendControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./ParkingControl.ts","./ParkingDataCache.ts","./ParkingDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,a,r,d,l,h,f,c,u,v,g,_,C,p,m,R,I;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.ScrollView,a=t.Label,r=t.Sprite,d=t.ProgressBar},function(t){l=t.ListItem},function(t){h=t.default},function(t){f=t.default},function(t){c=t.default},null,function(t){u=t.default,v=t.TYPE_YES},function(t){g=t.default},function(t){_=t.RoleDataCache},function(t){C=t.PlayerAttr},function(t){p=t.default},function(t){m=t.ParkingDataCache},function(t){R=t.ParkingEventDefine},function(t){I=t.BaseView}],execute:function(){n._RF.push({},"d200fIxAnBKapnvdEgC3c2R","ParkingCrossRobInfoView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).playerList=void 0,i.btnTop=void 0,i.btnCancel=void 0,i.btnJoin=void 0,i.showList=void 0,i.name="ParkingCrossRobInfoView",i.url="ui/module/parking/ParkingCrossRobInfoView",i.poolTime=3e3,i}i(n,t);var a=n.prototype;return a.onInit=function(){var t=this,i=this.findChild("content/btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()}));var e=this.findChildComponent("content/ScrollView",s);this.playerList=this.addUIList(e,T,!0),this.btnTop=this.findChild("content/btnTop"),this.addComponentCallbackListener(this.btnTop,o.EventType.CLICK,(function(){IS(p).reqCrossParkBattleTop(IS(m).master_id)})),this.btnCancel=this.findChild("content/btnCancel"),this.addComponentCallbackListener(this.btnCancel,o.EventType.CLICK,(function(){1==t.checkSelfStatus()?u.showFlyTip(GetLanguage(201959)):u.showBoxTip({title:GetLanguage(201384),tip:GetLanguage(201958),func:function(t){t==v&&IS(p).reqCrossParkBattleJoin(0,IS(m).master_id,0)}})})),this.btnJoin=this.findChild("content/btnJoin"),this.addComponentCallbackListener(this.btnJoin,o.EventType.CLICK,(function(){IS(m).roleState[0].freeze_time>c.serverTime?u.showFlyTip(GetLanguage(201957)):u.showBoxTip({title:GetLanguage(201384),tip:GetLanguage(201956),func:function(t){t==v&&IS(p).reqCrossParkBattleJoin(0,IS(m).master_id,1)}})}))},a.registerUpdateHandler=function(){this.addEvent(R.PARKING_CROSS_FIGHTING_QUEUE_LIST,this.onListUpdate,this),this.addEvent(R.PARKING_CROSS_STATUS_INFO,this.checkBtnShow,this)},a.onAfterOpen=function(){var t=this;IS(p).reqCrossParkBattleQueue(0,IS(m).master_id),this.addTimer(1,-1,(function(){t.playerList.updateAll()}))},a.onListUpdate=function(t){this.playerList.datas=t.list,this.showList=t.list,IS(p).reqCrossParkRoleState(0)},a.checkBtnShow=function(){var t=IS(m);t.roleState[0].park_id==t.master_id?(this.btnJoin.active=!1,this.btnCancel.active=!0,this.btnTop.active=!0):(this.btnJoin.active=!0,this.btnTop.active=!1,this.btnCancel.active=!1),t.serv_id!=IS(_).GetServerId()&&(this.btnJoin.active=!1,this.btnTop.active=!1,this.btnCancel.active=!1)},a.checkSelfStatus=function(){for(var t,i,n,o=null,s=e(this.showList);!(n=s()).done;){for(var a,r=n.value,d=e(r.info_list.ks);!(a=d()).done;){if(a.value.k==C.ROLE_ATTR_ID){o=r;break}}if(o)break}return null!=(t=null==(i=o)?void 0:i.status)?t:0},a.onBeforeClose=function(){},a.onDestroy=function(){},n}(I));var T=function(t){function n(){for(var i,e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))||this).txtRank=void 0,e.txtName=void 0,e.txtLevel=void 0,e.txtPower=void 0,e.nodeBuff=void 0,e.imgHead=void 0,e.imgHeadFrame=void 0,e.pbHP=void 0,e.txtPb=void 0,e.imgBg=void 0,e.roleInfo=((i={})[C.ROLE_ATTR_LVL]=0,i[C.ROLE_ATTR_ID]=0,i[C.ROLE_ATTR_NAME]="",i[C.ROLE_ATTR_SERVER]=0,i[C.ROLE_ATTR_CUR_POWER]=0,i[C.ROLE_ATTR_POWER_SHOW]=0,i[C.ROLE_ATTR_HEAD_ID]=0,i[C.ROLE_ATTR_HEAD_FRAME_ID]=0,i[C.ROLE_ATTR_HEAD_URL]="",i),e}i(n,t);var s=n.prototype;return s.onInit=function(){var t=this;this.txtRank=h.findChildComponent(this.node,"txtIndex",a),this.txtName=h.findChildComponent(this.node,"txtName",a),this.txtLevel=h.findChildComponent(this.node,"txtLevel",a),this.txtPower=h.findChildComponent(this.node,"txtFightPower",a),this.imgHead=h.findChildComponent(this.node,"head",r),this.imgHeadFrame=h.findChildComponent(this.node,"imgHeadFrame",r),this.pbHP=h.findChildComponent(this.node,"ProgressBar",d),this.txtPb=h.findChildComponent(this.node,"ProgressBar/num",a),this.nodeBuff=h.findChild(this.node,"SpecialBuff"),this.imgBg=h.findChildComponent(this.node,"imgBg",r);var i=h.findChild(this.node,"clickNode");this.view.addComponentCallbackListener(i,o.EventType.CLICK,(function(){IS(g).reqOtherRoleNotice(t.roleInfo[C.ROLE_ATTR_ID])}))},s.onRender=function(t,i){var n=t.info_list.kv,o=t.info_list.ks;if(null!=n)for(var s,r=e(n);!(s=r()).done;){var d=s.value;this.roleInfo[d.k]=d.v}if(null!=o)for(var l,u=e(o);!(l=u()).done;){var v=l.value;this.roleInfo[v.k]=v.s}for(var g,p=0,R=0,I=0,T=e(t.ext);!(g=T()).done;){var L=g.value;1==L.k?p=L.v:2==L.k?R=L.v:3==L.k&&(I=L.v)}if(!configPark_pvp_debuff.getDataByKeys("num",R,"type",3)||0==R||I<=c.serverTime)this.nodeBuff.active=!1;else{this.nodeBuff.active=!0;var k=h.findChildComponent(this.nodeBuff,"num",a),E=h.findChildComponent(this.nodeBuff,"nodeTime/txtTime",a),S=c.getTimeLeft(I-c.serverTime);E.string=S,k.string=R>0?R+"":""}this.txtPb.string=(p/100).toFixed(2)+"%",this.pbHP.progress=p/1e4,this.txtRank.string=1==t.status?"":t.order,this.txtName.string="[s"+this.roleInfo[C.ROLE_ATTR_SERVER]+"]"+this.roleInfo[C.ROLE_ATTR_NAME],this.txtLevel.string="Lv."+this.roleInfo[C.ROLE_ATTR_LVL],this.txtPower.string=f.GetNumString(this.roleInfo[C.ROLE_ATTR_POWER_SHOW]);var b=this.roleInfo[C.ROLE_ATTR_HEAD_FRAME_ID];if(null!=b)if(this.view.loadRemoteIcon(this.roleInfo[C.ROLE_ATTR_HEAD_URL],this.imgHead),b>0){var A=configAvatar_frame.getDataByKey(b);this.view.loadIcon(this.imgHeadFrame,"icon_frame",A.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1;1==t.status?this.view.loadIcon(this.imgBg,"parking","gg_ui_red02"):IS(m).serv_id!=IS(_).GetServerId()?this.view.loadIcon(this.imgBg,"parking","gg_ui_red01"):this.roleInfo[C.ROLE_ATTR_ID]==IS(_).GetRoleId()?this.view.loadIcon(this.imgBg,"parking","gg_ui_green01"):this.view.loadIcon(this.imgBg,"parking","gg_ui_blue01"),h.findChild(this.node,"combat").active=1==t.status},s.onItemClick=function(){},n}(l);n._RF.pop()}}}));

