System.register("chunks:///_virtual/PlanStatueEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ConfigGlobal.ts","./MainViewModel.ts","./StatueControl.ts","./StatueDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,n,i,o,a,u,l,s,r,f,c,d,h,I,v,C,S,m;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t.Button,o=t.UITransform,a=t.Vec3,u=t.js,l=t.Label},function(t){s=t.default},function(t){r=t.default},null,function(t){f=t.ConfigGlobal},function(t){c=t.MainViewModel},function(t){d=t.default},function(t){h=t.StatueEventDefine},function(t){I=t.default},function(t){v=t.RoleDataCache},function(t){C=t.RoleEventDefine},function(t){S=t.PanelTabType},function(t){m=t.BaseView}],execute:function(){var g;n._RF.push({},"16889LerupP/aQWINGpc6+X","PlanStatueEditView",void 0),function(t){t[t.BuffUnlock=0]="BuffUnlock",t[t.BuffLock=1]="BuffLock",t[t.LevelUnlockable=2]="LevelUnlockable",t[t.LevelLock=3]="LevelLock"}(g||(g={}));var p=f.statue_tab_limit.length;t("default",function(t){function n(){var e;return(e=t.call(this)||this).infoItems=[],e.utContent=void 0,e.curStatueInfo=void 0,e.curPlanId=void 0,e.nodeItem=void 0,e.nodeContent=void 0,e.name="PlanStatueEditView",e.url="ui/module/role/PlanStatueEditView",e}e(n,t);var f=n.prototype;return f.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,i.EventType.CLICK,(function(){t.close()}));var n=this.findChild("content/btnGoTo");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){IS(c).TryJumpToMainViewPanel(S.Main_Mystery),uiMgr.openView("StatueView"),t.close(),uiMgr.close("RolePlanView"),uiMgr.close("DoubleChapterMainView")})),this.nodeContent=this.findChild("content/scroll/view/content"),this.utContent=this.nodeContent.getComponent(o),this.nodeItem=this.findChild("content/scroll/view/content/statueRoot"),this.nodeItem.active=!1;for(var a=function(e){var n=nodeInstantiate.instantiate(t.nodeItem);n.parent=t.nodeContent,n.active=!0;var a=s.findChild(n,"btnSwitch");t.addComponentCallbackListener(a,i.EventType.CLICK,(function(){IS(I).send_role_update_plan_c2s(t.curPlanId,[{k:4,v:e}])}));for(var r=[],f=1;f<=5;f++){var c=s.findChild(n,u.formatStr("effectParent/effectItem%s",f));r.push({node:c,txtAttrName:s.findChildComponent(c,"txtEffectName",l),txtAttr:s.findChildComponent(c,"txtEffectAttr",l)})}s.findChild(n,"imgSpace");t.infoItems.push({nodeStatueRoot:n,utStatueRoot:n.getComponent(o),txtName:s.findChildComponent(n,"name/txtName",l),nodeCur:s.findChild(n,"nodeCur"),btnSwitch:a,tabId:e,attrItems:r})},r=1;r<=p;r++)a(r)},f.registerUpdateHandler=function(){this.addEvent(C.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(C.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this),this.addEvent(h.HOME_FARM_STATUE_INFO_BACK,this.onHomeFarmStatueInfoBack,this)},f.onAfterOpen=function(){this.nodeContent.setPosition(new a(0,0,0)),this.curPlanId=this.openArgs[0],IS(d).reqStatueInfo()},f.updateContent=function(){for(var t=8,e=0,n=0;n<this.infoItems.length;n++){var i=this.updateSingleInfo(this.infoItems[n]);t+=i.height,i.isShow&&(e+=1),this.updateSelect(this.infoItems[n])}e>1&&(t+=20*(e-1)),this.utContent.height=t},f.getStatueTabInfo=function(t){if(null!=this.curStatueInfo){var e=this.curStatueInfo.tab_list;if(null!=e)for(var n=0;n<e.length;n++)if(e[n].tab==t)return e[n]}},f.getStatueTabName=function(t){var e=this.getStatueTabInfo(t),n=e&&e.name;return n&&""!=n||(n=r.formatStrWithMirrorDeal(GetLanguage(200488),GetLanguage(200662+t))),n},f.updateSingleInfo=function(t){t.txtName.string=this.getStatueTabName(t.tabId);var e=this.getStatueTabInfo(t.tabId);if(null==e)return t.nodeStatueRoot.active=!1,{isShow:!1,height:0};t.nodeStatueRoot.active=!0;for(var n=e.attr_list,i=0,o=0;o<t.attrItems.length;o++){var a,u=t.attrItems[o],l=n[o];if((null==l?g.LevelLock:l.is_lock)>g.BuffLock)u.node.active=!1;else{i+=1,u.node.active=!0;var s=(null==(a=configAttribute.getDataByKey(l.attr_id))?void 0:a.desc)||"";u.txtAttrName.string=""+s,u.txtAttr.string="+"+(.01*l.value).toFixed(2)+"%"}}var r=i+1;if(r<=0)return t.utStatueRoot.height=90,{isShow:!0,height:90};var f=41*r+14*(r-1);return t.utStatueRoot.height=90+f,{isShow:!0,height:90+f}},f.updateSelect=function(t){for(var e,n=IS(v).planIdToInfo[this.curPlanId].detail,i=0;i<n.length;i++)if(4==n[i].k){e=n[i].v;break}t.nodeCur.active=t.tabId==e,t.btnSwitch.active=t.tabId!=e},f.onHomeFarmStatueInfoBack=function(t){this.curStatueInfo=t,this.updateContent()},f.OnPlanInfoBack=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSelect(this.infoItems[t])},f.onPlanInfoUpdate=function(t){if(t==this.curPlanId)for(var e=0;e<this.infoItems.length;e++)this.updateSelect(this.infoItems[e])},f.onBeforeClose=function(){this.curStatueInfo=null},f.onDestroy=function(){},n}(m));n._RF.pop()}}}));

