System.register("chunks:///_virtual/MainView_EquipInfo.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./index57.ts","./BaseSubView.ts","./ItemIcon.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ArtifactDataCache.ts","./ArtifactDefine.ts","./EquipDataCache.ts","./EquipDefine.ts","./EquipModel.ts","./FateDataCache.ts","./FateDefine.ts","./FlyPetDataCache.ts","./FlyPetDefine.ts","./HorseDataChche.ts","./HorseDefine.ts","./MarryDefine.ts","./MarryDialogDataCache.ts","./RelicDataCache.ts","./RelicDefine.ts","./RoleDataCache.ts","./RoleDefine.ts","./SeasonDataCache.ts","./SeasonSceneControl.ts","./TaskDataCache.ts","./WingDataCache.ts","./WingDefine.ts","./UIDefine.ts"],(function(i){"use strict";var e,t,n,a,o,c,u,d,h,p,s,f,I,l,r,m,C,g,E,S,v,q,_,y,w,F,R,T,P,L,N,U,D,k,A,O,V,M,B,G,b,K;return{setters:[function(i){e=i.inheritsLoose},function(i){t=i.cclegacy,n=i.Button,a=i.Vec2,o=i.Sprite,c=i.Label,u=i.js},function(i){d=i.RedPointType},function(i){h=i.RedPointMgr},function(i){p=i.default},null,function(i){s=i.BaseSubView},function(i){f=i.IconAseetType},function(i){I=i.ConfigGlobal},function(i){l=i.default},function(i){r=i.default},function(i){m=i.ActivityEventDefine,C=i.ActivityType,g=i.ActivityState},function(i){E=i.ArtifactDataCache},function(i){S=i.ArtifactEvent},function(i){v=i.EquipDataCache},function(i){q=i.EquipEventDefine},function(i){_=i.EquipModel},function(i){y=i.default},function(i){w=i.FateEventDefine},function(i){F=i.default},function(i){R=i.FlyPetEventDefine,T=i.FlyPetQualityRes},function(i){P=i.HorseDataCache},function(i){L=i.HorseEvent},function(i){N=i.MarryEventDefine},function(i){U=i.default},function(i){D=i.RelicDataCache},function(i){k=i.RelicEventDefine},function(i){A=i.RoleDataCache},function(i){O=i.RoleEventDefine},function(i){V=i.SeasonDataCache},function(i){M=i.default},function(i){B=i.TaskDataCache},function(i){G=i.WingDataCache},function(i){b=i.WingEvent},function(i){K=i.OpenFunction}],execute:function(){t._RF.push({},"cae2c/NxC1CKq++STXol8rW","MainView_EquipInfo",void 0);var H=[{equipType:1,spriteName:"zjm_ui_wuqi"},{equipType:2,spriteName:"zjm_ui_goushi"},{equipType:3,spriteName:"zjm_ui_mianshi"},{equipType:4,spriteName:"zjm_ui_hujian"},{equipType:5,spriteName:"zjm_ui_kaijia"},{equipType:6,spriteName:"zjm_ui_bijia"},{equipType:7,spriteName:"zjm_ui_shoutao"},{equipType:8,spriteName:"zjm_ui_yaodai"},{equipType:9,spriteName:"zjm_ui_hutui"},{equipType:10,spriteName:"zjm_ui_xiezi"}];i("default",function(i){function t(){var e;return(e=i.call(this)||this).nodeEquipItem=void 0,e.nodeEquipParent=void 0,e.equipItems=void 0,e.wingItem=void 0,e.btnSuit=void 0,e.name="MainView_EquipInfo",e}e(t,i);var s=t.prototype;return s.onInit=function(){var i,e=this;this.nodeEquipParent=this.findChild("equipParent"),this.nodeEquipItem=this.findChild("equipParent/equipItem"),this.nodeEquipItem.active=!1,this.equipItems=[];for(var t=function(t){var a=H[t].equipType;i=H[t].spriteName;var u=nodeInstantiate.instantiate(e.nodeEquipItem);u.parent=e.nodeEquipParent,u.name=String(t+1);var d={node:u,imgType:p.findChildComponent(u,"imgEquipType",o),nodeEquip:p.findChild(u,"equipInfo"),imgFrame:p.findChildComponent(u,"equipInfo/imgFrame",o),imgIcon:p.findChildComponent(u,"equipInfo/imgIcon",o),imgFigure:p.findChildComponent(u,"equipInfo/imgFigure",o),txtLevel:p.findChildComponent(u,"equipInfo/txtLevel",c),equipType:a};e.addComponentCallbackListener(u,n.EventType.CLICK,(function(){e.onEquipClick(a,d.imgIcon.node)})),e.loadIcon(d.imgType,"equip",i),u.active=!0,e.equipItems.push(d)},u=0;u<H.length;u++)t(u);var d=this.findChild("mountEquipItem/imgLockBg");this.addComponentCallbackListener(d,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_MOUNT,!0)}));var s=this.findChild("artifactEquipItem/imgLockBg");this.addComponentCallbackListener(s,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_ARTIFACT,!0)}));var f=this.findChild("relicEquipItem/imgLockBg");this.addComponentCallbackListener(f,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_LEGACY,!0)}));var I=this.findChild("fateEquipItem");IS(h).addRedPoint("fate_main",I,new a(73,-13)),this.addComponentCallbackListener(I,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_FATE,!0)&&uiMgr.openView("FateTabView")})),this.btnSuit=this.findChild("btnSuit"),this.addComponentCallbackListener(this.btnSuit,n.EventType.CLICK,(function(){uiMgr.openView("RolePlanView")})),this.InitWingItem(),this.InitRingItem(),this.InitFlyPetItem()},s.InitWingItem=function(){var i=this.findChild("wingItem");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_BACK,!0)&&uiMgr.openView("WingView")})),this.addRedPoint("wing_red",i,new a(73,-13)),this.wingItem={equipNode:this.findChild("wingItem/equipInfo"),imgFrame:this.findChildComponent("wingItem/equipInfo/imgFrame",o),imgIcon:this.findChildComponent("wingItem/equipInfo/imgIcon",o)},IS(h).changeValue("wing_red",IS(G).GetWingRed())},s.InitRingItem=function(){var i=this.findChild("RingItem");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_RING,!0)&&uiMgr.openView("MarryRingUpgradeView")}))},s.InitFlyPetItem=function(){var i=this.findChild("BEquipItem");IS(h).addRedPoint("TaskFlyPetAllRed",i,new a(80,0)),this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){IS(A).CheckFuncOpen(K.FUNC_FLY_PET,!0)&&uiMgr.openView("FlyPetView")})),IS(B).updateFlyPetRed()},s.registerUpdateHandler=function(){this.addEvent(q.EQUIP_LIST_UPDATE,this.onEquipListUpdate,this),this.addEvent(O.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(q.EQUIP_FIGURE_UPDATE,this.onEquipFigureUpdate,this),this.addEvent(q.EQUIP_LIST_INIT,this.onEquipListInit,this),this.addEvent(q.EQUIP_TRY_PLAY_ROLE_EFFECT,this.onEquipTryPlayRoleEffect,this),this.addEvent(L.TYPE_HORSE_CHANGE,this.updateHorseShow,this),this.addEvent(S.TYPE_ARTIFACT_CHANGE,this.updateArtifactShow,this),this.addEvent(k.RELIC_LIST_UPDATE,this.updateRelicShow,this),this.addEvent(w.OnFateInfoUpdate,this.updateFateShow,this),this.addEvent(q.EQUIP_TAB_INFO_UPDATE,this.updateEquipSwitch,this),this.addEvent(O.ROLE_INFO_INIT,this.onRoleInfoInit,this),this.addEvent(b.TYPE_WING_CHANGE,this.UpdateWingShow,this),this.addEvent(N.MARRY_RING_INFO_UPDATE,this.updateRingShow,this),this.addEvent(O.ROLE_REGENDER,this.updateRingShow,this),this.addEvent(m.OnActivityListUpdate,this.UpdateSeasonShow,this),this.addEvent(m.OnActivityInfoUpdate,this.UpdateSeasonShow,this),this.addEvent(N.MARRY_RING_INFO_UPDATE,this.updateRingShow,this),this.addEvent(R.FlyPetUseChange,this.updateFlyPetShow,this),this.addEvent(O.ROLE_REGENDER,this.updateRingShow,this)},s.onAfterOpen=function(){this.updateEquipShow(),this.updateHorseShow(),this.updateArtifactShow(),this.updateRelicShow(),this.updateFateShow(),this.updateRingShow(),this.updateSuitShow(),this.UpdateWingShow(),this.updateFlyPetShow(),this.UpdateSeasonShow(),IS(h).changeValue("fate_main",IS(y).GetFateRed())},s.onRoleInfoInit=function(){this.updateHorseShow(),this.updateArtifactShow(),this.updateRelicShow(),this.updateFateShow(),this.updateFlyPetShow(),this.updateSuitShow(),this.updateRingShow()},s.updateEquipSwitch=function(){this.updateEquipShow()},s.updateEquipShow=function(){for(var i=0;i<this.equipItems.length;i++)this.updateSingleEquip(this.equipItems[i])},s.UpdateSeasonShow=function(){var i=this.findChild("SeasonItem"),e=this.findChild("SeasonItem/equipInfo");IS(h).addRedPoint("Season",i,new a(80,-10),d.Dot),IS(h).changeValue("Season",IS(V).checkRedPoint());var t=this.findChildComponent("SeasonItem/txtLevel",c);this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("SeasonPreviewPuzzleView")})),this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){var i=IS(r).GetActivityInfo(C.Season);i&&i.state!=g.Null?!i||i.state!=g.Open&&i.state!=g.EndShow?i&&i.state==g.Preview&&uiMgr.openView("SeasonRuleDetailView"):(IS(M).reqEnter(),uiMgr.getOpenView("SeasonMapSceneView")||(uiMgr.openView("SeasonMapLoadView"),uiMgr.openView("SeasonMapSceneView"))):uiMgr.openView("SeasonHallOfFameView")}));var o=IS(r).GetActivityInfo(C.SeasonPuzzle),u=IS(r).GetActivityInfo(C.Season);e.active=!0,i.active=!0,t.string=GetLanguage(204541),!o||o.state!=g.Open&&o.state!=g.EndShow?(!u||u.state==g.Null)&&IS(V).max_season_id<=0&&(e.active=!1,i.active=!1):(e.active=!1,t.string=GetLanguage(204542))},s.UpdateWingShow=function(){var i=IS(G).wing_id;if(i>0){this.wingItem.equipNode.active=!0;var e=configBack_decoration.getDataByKey(i);this.loadIcon(this.wingItem.imgFrame,"icon_equip",configColor.getDataByKey(e.quality).path),this.loadIcon(this.wingItem.imgIcon,"icon_item",e.icon_small)}else this.wingItem.equipNode.active=!1},s.updateHorseShow=function(){if(IS(A).CheckFuncOpen(K.FUNC_MOUNT)){var i=this.findChild("mountEquipItem/equipInfo"),e=this.findChild("mountEquipItem/equipInfo/imgFrame"),t=this.findChild("mountEquipItem/equipInfo/imgIcon");if(IS(h).addRedPoint("horse_skin_unlock_active",i,new a(30,30)),IS(h).addRedPoint("horse_upgrade_active",i,new a(30,30)),IS(h).addRedPoint("horse_enable_active",i,new a(30,30)),IS(P).checkSkinRP(),IS(P).checkEnableRP(),IS(P).checkUpgradeRP(),this.findChild("mountEquipItem/imgLockBg").active=!1,this.findChild("mountEquipItem/imgLock").active=!1,i.active=!0,this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("HorseView")})),IS(P).horse_id){e.active=!0,t.active=!0;var c=this.findChildComponent("mountEquipItem/equipInfo/imgIcon",o),u=this.findChildComponent("mountEquipItem/equipInfo/imgFrame",o),d=configMount.getDataByKey(IS(P).horse_id).icon_small,p=configMount.getDataByKey(IS(P).horse_id).quality;this.loadIcon(c,"icon_item",d),this.loadIcon(u,"icon_equip",configColor.getDataByKey(p).path)}else e.active=!1,t.active=!1}},s.updateArtifactShow=function(){if(IS(A).CheckFuncOpen(K.FUNC_ARTIFACT)){var i=this.findChild("artifactEquipItem/equipInfo"),e=this.findChild("artifactEquipItem/equipInfo/imgFrame"),t=this.findChild("artifactEquipItem/equipInfo/imgIcon");if(IS(h).addRedPoint("artifact_skin_unlock_active",i,new a(30,30)),IS(h).addRedPoint("artifact_upgrade_active",i,new a(30,30)),IS(E).checkSkinRP(),IS(E).checkUpgradeRP(),IS(A).CheckFuncOpen(K.FUNC_ARTIFACT_GEM)&&(IS(h).addRedPoint("artifact_refined_active",i,new a(30,30)),IS(E).checkGemRP()),this.findChild("artifactEquipItem/imgLockBg").active=!1,this.findChild("artifactEquipItem/imgLock").active=!1,i.active=!0,this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("ArtifactView")})),IS(E).artifact_id){e.active=!0,t.active=!0;var c=this.findChildComponent("artifactEquipItem/equipInfo/imgIcon",o),u=this.findChildComponent("artifactEquipItem/equipInfo/imgFrame",o),d=configArtifact.getDataByKey(IS(E).artifact_id).icon_small,p=configArtifact.getDataByKey(IS(E).artifact_id).quality;this.loadIcon(c,"icon_item",d),this.loadIcon(u,"icon_equip",configColor.getDataByKey(p).path)}else e.active=!1,t.active=!1}},s.updateRelicShow=function(){if(IS(A).CheckFuncOpen(K.FUNC_LEGACY)){var i=this.findChild("relicEquipItem/equipInfo"),e=this.findChild("relicEquipItem/equipInfo/imgFrame"),t=this.findChild("relicEquipItem/equipInfo/imgIcon"),c=this.findChild("relicEquipItem/imgEquipType");IS(h).addRedPoint("relic_main",i,new a(30,30));for(var u=0;u<8;u++)IS(h).addRedPoint("relicequip-"+(u+1),i,new a(30,30));if(IS(h).changeValue("relic_main",IS(D).getRelicRedCount()),this.findChild("relicEquipItem/imgLockBg").active=!1,this.findChild("relicEquipItem/imgLock").active=!1,i.active=!0,this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("RelicMainView")})),IS(D).findCount){e.active=!0,t.active=!0,c.active=!1;var d=0,p=0;for(var s in IS(D).relicIdToInfo)IS(D).relicIdToInfo[s].location>d&&(d=IS(D).relicIdToInfo[s].location,p=IS(D).relicIdToInfo[s].cfg_id);var I=this.findChildComponent("relicEquipItem/equipInfo/imgIcon",o),l=this.findChildComponent("relicEquipItem/equipInfo/imgFrame",o);p&&0!=p?(I.node.active=!0,l.node.active=!0,c.active=!1,this.loadIcon(l,"icon_equip",configColor.getDataByKey(d+1).path),this.loadIcon(I,"icon_relic",""+p,null,f.ICON_SPRITE)):(I.node.active=!1,l.node.active=!1,c.active=!0)}else e.active=!1,t.active=!1,c.active=!0}},s.updateFlyPetShow=function(){if(IS(A).CheckFuncOpen(K.FUNC_FLY_PET)){var i=IS(F).now_use_pet_info,e=this.findChild("BEquipItem/item"),t=this.findChildComponent("BEquipItem/item/icon",o),n=this.findChildComponent("BEquipItem/item/frame",o);if(null!=i){var a=configFly.getDataByKey(i.config_id);e.active=!0,this.loadIcon(n,"icon_equip",T[a.quality]),this.loadIcon(t,"icon_flypet",a.icon)}else e.active=!1}},s.updateFateShow=function(){if(IS(A).CheckFuncOpen(K.FUNC_FATE)){var i=this.findChild("fateEquipItem/equipInfo"),e=this.findChild("fateEquipItem/imgEquipType"),t=IS(y).GetShowFate();if(t){i.active=!0,e.active=!1;var n=this.findChildComponent("fateEquipItem/equipInfo/imgFrame",o),a=this.findChildComponent("fateEquipItem/equipInfo/imgIcon",o);this.findChildComponent("fateEquipItem/equipInfo/txtLevel",c).string="lv."+t.lv,this.loadIcon(n,"fate",I.fate_quality_pos[t.cfg.quality-1][1]),this.loadIcon(a,"icon_fate",t.cfg.icon,null,f.ICON_SPRITE)}else i.active=!1,e.active=!0}else{var u=this.findChild("fateEquipItem/equipInfo"),d=this.findChild("fateEquipItem/imgEquipType");u.active=!1,d.active=!0}},s.updateRingShow=function(){if(IS(A).CheckFuncOpen(K.FUNC_RING)){console.log("OpenFunction.FUNC_RING Yes!");var i=this.findChild("RingItem/equipInfo"),e=this.findChild("RingItem/equipInfo/imgFrame"),t=this.findChild("RingItem/equipInfo/imgIcon");if(IS(h).addRedPoint("marry_ring_upgrade_active",i,new a(90,40)),IS(U).checkUpgradeRP(),this.findChild("RingItem/imgLockBg").active=!1,this.findChild("RingItem/imgLock").active=!1,i.active=!0,this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("MarryRingUpgradeView")})),IS(U).GetRingInfo()&&IS(U).GetRingInfo().ring_id&&0!=IS(U).GetRingInfo().ring_id){e.active=!0,t.active=!0;var c,u=this.findChildComponent("RingItem/equipInfo/imgIcon",o),d=this.findChildComponent("RingItem/equipInfo/imgFrame",o);c=2==IS(A).GetGender()?configRing.getDataByKey(IS(U).GetRingInfo().ring_id).icon2:configRing.getDataByKey(IS(U).GetRingInfo().ring_id).icon1;var p=configRing.getDataByKey(IS(U).GetRingInfo().ring_id).quality;this.loadIcon(u,"icon_ring",c,null,f.ICON_SPRITE),this.loadIcon(d,"icon_equip",configColor.getDataByKey(p).path)}else e.active=!1,t.active=!1}else console.log("OpenFunction.FUNC_RING No!")},s.updateSuitShow=function(){this.btnSuit.active=IS(A).CheckFuncOpen(K.FUNC_SUIT)},s.updateSingleEquip=function(i){i.effect&&(this.removeUIEffect(i.effect),i.effect=null);var e=i.equipType,t=IS(_).getEquipByLocation(e,IS(v).tabInfo.tab);if(l.isEmpty(t))i.nodeEquip.active=!1;else{var n=configEquipment.getDataByKey(t.config_id);i.nodeEquip.active=!0,this.loadIcon(i.imgIcon,n.atlas,n.icon,null,f.ICON_SPRITE),this.loadIcon(i.imgFrame,"icon_equip",configColor.getDataByKey(n.quality).path);var o=configColor.getDataByKey(n.quality).effect_path;null!=o&&""!=o&&(i.effect=this.addUIEffect(u.formatStr("prefab/ui-effect/%s",o),i.imgIcon.node,-1,new a(0,0))),i.txtLevel.string=u.formatStr("Lv.%s",t.equip_lv),i.imgFigure.node.active=IS(_).checkFigureTipShow(e)||!1;var c=IS(_).getEquipFigureByLocation(e);i.imgFigure.grayscale=0==c||-1==c}},s.onBeforeClose=function(){},s.onDestroy=function(){},s.onEquipListInit=function(){this.updateEquipShow()},s.onEquipTryPlayRoleEffect=function(i){for(var e=0;e<this.equipItems.length;e++){var t=this.equipItems[e];if(t.equipType==i){this.addUIEffect("prefab/ui-effect/MX_ui_huanzhuang",t.node,2,new a(45,-45));break}}},s.onEquipListUpdate=function(){this.updateEquipShow()},s.onRoleOpenFunctionUpdate=function(i){i==K.FUNC_EQUIP_SKIN&&this.updateEquipShow(),i==K.FUNC_MOUNT&&this.updateHorseShow(),i==K.FUNC_ARTIFACT&&this.updateArtifactShow(),i==K.FUNC_LEGACY&&this.updateRelicShow(),i==K.FUNC_FATE&&(this.updateFateShow(),IS(h).changeValue("fate_main",IS(y).GetFateRed())),i==K.FUNC_SUIT&&this.updateSuitShow(),i==K.FUNC_RING&&this.updateRingShow(),i==K.FUNC_FLY_PET&&this.updateFlyPetShow()},s.onEquipFigureUpdate=function(){this.updateEquipShow()},s.onEquipClick=function(i,e){var t=IS(_).getEquipByLocation(i);l.isEmpty(t)||uiMgr.openView("EquipDetailView",null==t?void 0:t.equip_id)},t}(s));t._RF.pop()}}}));

