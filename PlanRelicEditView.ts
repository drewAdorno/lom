System.register("chunks:///_virtual/PlanRelicEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./RelicModel.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./BaseView.ts"],(function(t){"use strict";var n,e,i,o,a,l,c,d,s,u,r,f,h,I,C,g,v;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t.Button,o=t.UITransform,a=t.Vec3,l=t.js,c=t.Sprite,d=t.Label},function(t){s=t.default},null,function(t){u=t.IconAseetType},function(t){r=t.ConfigGlobal},function(t){f=t.default},function(t){h=t.RelicModel},function(t){I=t.default},function(t){C=t.RoleDataCache},function(t){g=t.RoleEventDefine},function(t){v=t.BaseView}],execute:function(){var m;e._RF.push({},"747ab1xgdJJ26ZDIdhfeftI","PlanRelicEditView",void 0);var p=((m={})[1]="yw_ui_yiwukuang01",m[2]="yw_ui_yiwukuang02",m[3]="yw_ui_yiwukuang03",m[4]="yw_ui_yiwukuang06",m[5]="yw_ui_yiwukuang07",m[6]="yw_ui_yiwukuang04",m[7]="yw_ui_yiwukuang05",m),_=r.relic_tab_num;t("default",function(t){function e(){var n;return(n=t.call(this)||this).infoItems=[],n.curPlanId=void 0,n.nodeItem=void 0,n.nodeContent=void 0,n.utContent=void 0,n.name="PlanRelicEditView",n.url="ui/module/role/PlanRelicEditView",n}n(e,t);var r=e.prototype;return r.onInit=function(){var t=this,n=this.findChild("imgMask");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){t.close()}));var e=this.findChild("content/btnGoTo");this.addComponentCallbackListener(e,i.EventType.CLICK,(function(){uiMgr.openView("RelicMainView"),t.close(),uiMgr.close("RolePlanView"),uiMgr.close("DoubleChapterMainView")})),this.nodeContent=this.findChild("content/scroll/view/content"),this.utContent=this.nodeContent.getComponent(o),this.nodeItem=this.findChild("content/scroll/view/content/relicRoot"),this.nodeItem.active=!1;for(var a=function(n){var e=nodeInstantiate.instantiate(t.nodeItem);e.parent=t.nodeContent,e.active=!0;var o=s.findChild(e,"btnSwitch");t.addComponentCallbackListener(o,i.EventType.CLICK,(function(){IS(I).send_role_update_plan_c2s(t.curPlanId,[{k:5,v:n}])}));for(var a=[],r=1;r<=7;r++){var f=s.findChild(e,l.formatStr("wearParent/relicItem%s",r)),h=s.findChildComponent(f,"imgType",c),C=configRelic_pos.getDataByKey(r);t.loadIcon(h,"icon_relic",C.icon,null,u.ICON_SPRITE),a.push({node:f,imgBg:s.findChildComponent(f,"imgBg",c),nodeLock:s.findChild(f,"imgLock"),nodeAdd:s.findChild(f,"imgAdd"),imgIcon:s.findChildComponent(f,"imgIcon",c),txtLevel:s.findChildComponent(f,"txtLevel",d),type:r})}t.infoItems.push({nodeRelicRoot:e,txtName:s.findChildComponent(e,"name/txtName",d),nodeCur:s.findChild(e,"nodeCur"),btnSwitch:o,tabId:n,relicItems:a})},r=1;r<=_;r++)a(r);this.utContent.height=8+261.26*_+17*(_-1)},r.registerUpdateHandler=function(){this.addEvent(g.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(g.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this)},r.onAfterOpen=function(){this.nodeContent.setPosition(new a(0,0,0)),this.curPlanId=this.openArgs[0],this.updateContent()},r.updateContent=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSingleInfo(this.infoItems[t]),this.updateSelect(this.infoItems[t])},r.updateSingleInfo=function(t){t.txtName.string=IS(h).getTabName(t.tabId);for(var n=IS(h).getTabInfo(t.tabId),e=n?n.pos_info:[],i={},o=0;o<e.length;o++)i[e[o].k]=e[o].v;for(var a=0;a<t.relicItems.length;a++){var c=t.relicItems[a],d=c.type,s=IS(h).checkRelicTypeUnlock(d),r=i[d],I=null!=r?IS(h).getRelicInfoByCfgId(r):null,C=!f.isEmpty(I);c.nodeLock.active=!s,c.nodeAdd.active=s&&!C,c.imgIcon.node.active=C,c.txtLevel.node.active=C;var g=s?p[d]:"yw_ui_yiwukuang08";if(this.loadIcon(c.imgBg,"relic",g),C){c.txtLevel.string=l.formatStr("Lv.%s",I.lv);var v=configRelic.getDataByKeys("id",I.cfg_id,"level",I.lv);this.loadIcon(c.imgIcon,"icon_relic",v.icon,null,u.ICON_SPRITE)}}},r.updateSelect=function(t){for(var n,e=IS(C).planIdToInfo[this.curPlanId].detail,i=0;i<e.length;i++)if(5==e[i].k){n=e[i].v;break}t.nodeCur.active=t.tabId==n,t.btnSwitch.active=t.tabId!=n},r.OnPlanInfoBack=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSelect(this.infoItems[t])},r.onPlanInfoUpdate=function(t){if(t==this.curPlanId)for(var n=0;n<this.infoItems.length;n++)this.updateSelect(this.infoItems[n])},r.onBeforeClose=function(){},r.onDestroy=function(){},e}(v));e._RF.pop()}}}));

