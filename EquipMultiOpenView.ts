System.register("chunks:///_virtual/EquipMultiOpenView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts","./BaseView.ts","./ConfigGlobal.ts","./BagModel.ts","./EquipDefine.ts","./EquipModel.ts","./RoleDataCache.ts"],(function(t){"use strict";var n,i,o,e,u,a,s,d,c,l,r,C,h,p,f,m;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t.math,e=t.Button,u=t.Sprite,a=t.LabelOutline,s=t.Label,d=t.EditBox,c=t.Color},function(t){l=t.default},function(t){r=t.BaseView},function(t){C=t.ConfigGlobal},function(t){h=t.BagModel},function(t){p=t.EquipEventDefine},function(t){f=t.EquipModel},function(t){m=t.RoleDataCache}],execute:function(){i._RF.push({},"200ddZZZD5JqLOUfVVFaGf5","EquipMultiOpenView",void 0);o.Vec3,o.Vec2;var v=C.box_goods_id;t("default",function(t){function i(){var n;return(n=t.call(this)||this).imgBtnStart=void 0,n.outLineBtnStart=void 0,n.maxOpenCount=void 0,n.curCount=void 0,n.selectQuality=void 0,n.nodeUp=void 0,n.nodeDown=void 0,n.txtQuality=void 0,n.nodeQuality=void 0,n.ebNum=void 0,n.name="EquipMultiOpenView",n.url="ui/module/equip/EquipMultiOpenView",n}n(i,t);var o=i.prototype;return o.onInit=function(){var t=this,n=this.findChild("imgMask");this.addComponentCallbackListener(n,e.EventType.CLICK,(function(){t.onMaskClick()}));var i=this.findChild("content/btnStart");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.onStartClick()})),this.imgBtnStart=i.getComponent(u),this.outLineBtnStart=this.findChildComponent("content/btnStart/Label",a);var o=this.findChild("content/conditions/btnReduce10");this.addComponentCallbackListener(o,e.EventType.CLICK,(function(){t.onNumClick(-10)}));var c=this.findChild("content/conditions/btnReduce1");this.addComponentCallbackListener(c,e.EventType.CLICK,(function(){t.onNumClick(-1)}));var l=this.findChild("content/conditions/btnAdd10");this.addComponentCallbackListener(l,e.EventType.CLICK,(function(){t.onNumClick(10)}));var r=this.findChild("content/conditions/btnAdd1");this.addComponentCallbackListener(r,e.EventType.CLICK,(function(){t.onNumClick(1)})),this.nodeQuality=this.findChild("content/conditions/btnQuality"),this.addComponentCallbackListener(this.nodeQuality,e.EventType.CLICK,(function(){t.onQualityClick()})),this.txtQuality=this.findChildComponent("content/conditions/btnQuality/txtSelect",s),this.nodeUp=this.findChild("content/conditions/btnQuality/imgUp"),this.nodeDown=this.findChild("content/conditions/btnQuality/imgDown"),this.ebNum=this.findChildComponent("content/conditions/ebNum",d),this.ebNum.placeholder=GetLanguage_UI(100377),this.addComponentCallbackListener(this.ebNum.node,d.EventType.EDITING_DID_ENDED,(function(){var n=Number(t.ebNum.string);if(null!=n){if(!isNaN(n))return n<=1?(t.curCount=1,void(t.ebNum.string="1")):n>t.maxOpenCount?(t.curCount=t.maxOpenCount,void(t.ebNum.string=String(t.maxOpenCount))):void(t.curCount=n);t.ebNum.string=String(t.curCount)}else t.ebNum.string=String(t.curCount)}))},o.registerUpdateHandler=function(){this.addEvent(p.AUTO_OPEN_CONDITION_CHANGE,this.onConditionChange,this),this.addEvent(p.CONDITION_LIST_VIEW_CLOSE,this.onConditionListViewClose,this)},o.onAfterOpen=function(){var t=IS(m).GetLevel(),n=configLevel.getDataByKey(t);this.maxOpenCount=Math.max(1,Math.min(n.num,IS(h).getGoodsCountByGoodsGtid(v))),this.curCount=this.maxOpenCount,this.updateQuality(),this.updateInput(),this.updateStartBtnStatus(),this.nodeDown.active=!0,this.nodeUp.active=!1},o.updateQuality=function(){this.selectQuality=1;var t=IS(f).getEquipQualityNameAndColor(1,!0);this.txtQuality.string=l.formatStrWithMirrorDeal(GetLanguage(200271),t.nameStr),this.txtQuality.color=t.nameColor},o.updateInput=function(){this.ebNum.string=String(this.curCount)},o.updateStartBtnStatus=function(){var t=IS(h).getGoodsCountByGoodsGtid(v)<=0;this.loadIcon(this.imgBtnStart,"common",t?"common_ICON_zhihuianniu":"common_ICON_luanniu"),this.outLineBtnStart.color=t?new c(76,76,76):new c(41,65,21)},o.onBeforeClose=function(){},o.onDestroy=function(){},o.onConditionChange=function(t){"quality"==t.typeStr&&this.updateQuality()},o.onConditionListViewClose=function(t){this.nodeUp.active=!1,this.nodeDown.active=!0},o.onMaskClick=function(){this.close()},o.onStartClick=function(){IS(h).getGoodsCountByGoodsGtid(v)<=0||(IS(f).tryMultiOpenBox(this.curCount,this.selectQuality),this.close())},o.onNumClick=function(t){var n=this.curCount+t;this.curCount+t>=this.maxOpenCount&&(n=this.maxOpenCount),this.curCount+t<=1&&(n=1),this.curCount=n,this.updateInput()},o.onQualityClick=function(){uiMgr.openView("EquipConditionListView",{typeStr:"quality",targetNode:this.nodeQuality,descStr:GetLanguage(200272),selectValue:1}),this.nodeUp.active=!0,this.nodeDown.active=!1},i}(r));i._RF.pop()}}}));

