System.register("chunks:///_virtual/GuildPinEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GuildPinItem.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./MulLanguageUtil.ts","./BagModel.ts","./MessageView.ts","./GuildControl.ts","./GuildDataCache.ts","./GuildDefine.ts","./BaseView.ts"],(function(i){"use strict";var t,e,a,s,n,o,l,h,d,c,u,r,g,v,f,p,C,m,_,I,w,D;return{setters:[function(i){t=i.inheritsLoose},function(i){e=i.cclegacy,a=i.Button,s=i.Label,n=i.ScrollView,o=i.UITransform,l=i.Sprite,h=i.Color},function(i){d=i.GuildPinItem},function(i){c=i.SelectedType,u=i.ListItem},function(i){r=i.default},function(i){g=i.default},null,function(i){v=i.IconAseetType},function(i){f=i.ConfigGlobal},function(i){p=i.default},function(i){C=i.BagModel},function(i){m=i.default},function(i){_=i.default},function(i){I=i.default},function(i){w=i.FlagColorDefine},function(i){D=i.BaseView}],execute:function(){e._RF.push({},"a2862WYpdRP2aMDKSSeoERE","GuildPinEditView",void 0);var G=f.change_guild_flag_cost,y=(i("default",function(i){function e(){var t;return(t=i.call(this)||this).scroll=void 0,t.curType=0,t.guildPinItem=void 0,t.saveGuidFlagData=void 0,t.tipsGo=void 0,t.tipsTxt=void 0,t.chooseFlagData={DesignId:1,ShapeId:1,DesignColor:1,ShapeColor:1},t.name="GuildPinEditView",t.url="ui/module/guild/GuildPinEditView",t}t(e,i);var o=e.prototype;return o.onInit=function(){var i=this;this.saveGuidFlagData=null,this.guildPinItem=new d(this,r.findChild(this.node,"view/GuildPinItem"),!0);var t=this.findChild("view/btnClose");this.addComponentCallbackListener(t,a.EventType.CLICK,(function(){i.onCloseClick()}));var e=this.findChild("imgMask");this.addComponentCallbackListener(e,a.EventType.CLICK,(function(){i.onCloseClick()})),this.tipsGo=this.findChild("view/tips"),this.tipsTxt=r.findChildComponent(this.node,"view/tips/txtDesc",s),this.tipsTxt.string=p.GetconfigLanguage_Text(103532).text;var o=this.findChild("view/btnTips");this.addComponentCallbackListener(o,a.EventType.CLICK,(function(){i.tipsGo.active=!0}));var l=this.findChild("view/tips");this.addComponentCallbackListener(l,a.EventType.CLICK,(function(){i.tipsGo.active=!1}));var h=this.findChild("view/btnSave");this.addComponentCallbackListener(h,a.EventType.CLICK,(function(){if(i.saveGuidFlagData&&i.saveGuidFlagData.length>=8){var t=configGoods.getDataByKey(G[0][0]),e=G[0][1],a=g.formatStrWithMirrorDeal(GetLanguage(200355),e,t.name);m.showBoxTip({tip:a,title:GetLanguage(200048),todayTog:"GuildFlagChange_"+t.id,func:function(t){if("type_yes"==t){if(e>IS(C).getGoodsCountByGoodsGtid(G[0][0]))return void m.showFlyTip(GetLanguage(200257));i.guildPinItem.SaveData(),IS(_).send_29_6(5,null,null,i.guildPinItem.saveData),i.onCloseClick()}}})}else{var s=p.GetconfigLanguage_Text(103531).text;m.showBoxTip({isSpecail:!1,tip:s,title:GetLanguage(200048),func:function(t){"type_yes"==t&&(i.guildPinItem.SaveData(),IS(_).send_29_6(5,null,null,i.guildPinItem.saveData),i.onCloseClick())}})}}));var c=this.findChild("view/btnRandom");this.addComponentCallbackListener(c,a.EventType.CLICK,(function(){i.randomGuildPin()}));var u=this.findChild("view/btnBack");this.addComponentCallbackListener(u,a.EventType.CLICK,(function(){i.guildPinItem.SetItem(i.saveGuidFlagData)}));var v=this.findChildComponent("view/scroll",n);this.scroll=this.addUIList(v,y,!0,0)},o.onCloseClick=function(){this.close()},o.registerUpdateHandler=function(){},o.onAfterOpen=function(){this.saveGuidFlagData=IS(I).GetGuildInfo().guild_flag,this.saveGuidFlagData&&this.saveGuidFlagData.length>=8?(this.chooseFlagData.ShapeId=this.saveGuidFlagData[0].v,this.chooseFlagData.ShapeColor=this.saveGuidFlagData[1].v,this.chooseFlagData.DesignId=this.saveGuidFlagData[2].v,this.chooseFlagData.DesignColor=this.saveGuidFlagData[3].v):(this.chooseFlagData.ShapeId=f.guild_flag_default[0],this.chooseFlagData.ShapeColor=f.guild_flag_default[1],this.chooseFlagData.DesignId=f.guild_flag_default[2],this.chooseFlagData.DesignColor=f.guild_flag_default[3]),this.guildPinItem.SetItem(this.saveGuidFlagData),this.UpdateOpen()},o.onBeforeClose=function(){},o.onDestroy=function(){},o.setType=function(i,t){void 0===t&&(t=!1),(this.curType!=i||t)&&(this.curType=i,this.scroll.updateAll())},o.SetIndex=function(i,t){switch(t){case 1:this.chooseFlagData.ShapeId=i,this.guildPinItem.ChangePicData(1,i);break;case 2:this.chooseFlagData.ShapeColor=i,this.guildPinItem.ChangePicData(2,i);break;case 3:this.chooseFlagData.DesignId=i,this.guildPinItem.ChangePicData(3,i);break;case 4:this.chooseFlagData.DesignColor=i,this.guildPinItem.ChangePicData(4,i)}this.scroll.updateAll()},o.UpdateOpen=function(){this.curType=1,this.hideList={};var i=f.guild_flag_scroll_view;this.scroll.datas=i},o.Refresh=function(){this.scroll.updateAll()},o.randomGuildPin=function(){var i=[];i.push({k:1,v:Number(((f.guild_flag_shape.length-1)*Math.random()+1).toFixed(0)),s:""}),i.push({k:2,v:Number(((f.guild_flag_color.length-1)*Math.random()+1).toFixed(0)),s:""}),i.push({k:3,v:Number(((f.guild_flag_design.length-1)*Math.random()+1).toFixed(0)),s:""}),i.push({k:4,v:Number(((f.guild_flag_design_color.length-1)*Math.random()+1).toFixed(0)),s:""}),i.push({k:5,v:Number((360*Math.random()).toFixed(0)),s:""}),i.push({k:6,v:f.guild_flag_moving_range[1]-Number((2*f.guild_flag_moving_range[1]*Math.random()).toFixed(0)),s:""}),i.push({k:7,v:f.guild_flag_moving_range[1]-Number((2*f.guild_flag_moving_range[1]*Math.random()).toFixed(0)),s:""}),i.push({k:8,v:10*Number((Math.random()+.5).toFixed(1)),s:""}),this.guildPinItem.SetItem(i)},e}(D)),function(i){function e(){for(var t,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return(t=i.call.apply(i,[this].concat(a))||this).txtTitle=void 0,t.arrUp=void 0,t.arrDown=void 0,t.imgBG1=void 0,t.imgBG2=void 0,t.scroll=void 0,t.scrollNode=void 0,t.scrollUT=void 0,t.scrollView=void 0,t}t(e,i);var l=e.prototype;return l.onInit=function(){var i=this;this.adaptiveSize=!0,this.txtTitle=r.findChildComponent(this.node,"title/Label",s),this.arrUp=r.findChild(this.node,"title/arrUp"),this.arrDown=r.findChild(this.node,"title/arrDown"),this.imgBG1=r.findChild(this.node,"title/imgBG1"),this.imgBG2=r.findChild(this.node,"title/imgBG2");var t=r.findChild(this.node,"title");this.view.addComponentCallbackListener(t,a.EventType.CLICK,(function(){i.arrUp.active?(i.view.hideList[i.data[0]]=!0,i.UpdateSelect()):(i.view.hideList[i.data[0]]=!1,i.view.setType(i.data[0],!0))})),this.scrollNode=r.findChild(this.node,"scroll"),this.scrollUT=r.findChildComponent(this.node,"scroll",o),this.scrollView=r.findChildComponent(this.node,"scroll",n),this.scroll=this.view.addUIList(this.scrollView,T,!1,0)},l.onRender=function(i,t){this.txtTitle.string=GetLanguage(i[1]);var e=i[0],a=this.view.curType==e&&!this.view.hideList[e];this.scrollNode.active=a,this.arrUp.active=a,this.arrDown.active=!a;var s=.01;if(0!=e){var n=null;switch(e){case 1:n=f.guild_flag_shape;break;case 2:n=f.guild_flag_color;break;case 3:n=f.guild_flag_design;break;case 4:n=f.guild_flag_design_color}if(this.scroll.selectedMode=c.SINGLE,this.scroll.touchEvent=!1,a){var l=Math.ceil(n.length/4);s=88*l+15*(l-1)+15+15,this.scrollUT.height=s,this.imgBG1.getComponent(o).height=s+52,this.imgBG1.active=!0,this.imgBG2.active=!1}else this.imgBG1.active=!1,this.imgBG2.active=!0;this.scroll.datas=n}this.ut.height=42+s},l.UpdateSelect=function(){var i=this.view.curType==this.data[0]&&!this.view.hideList[this.data[0]];this.scrollNode.active=i,this.arrUp.active=i,this.arrDown.active=!i;var t=.01;if(i){var e=this.scroll.datas,a=Math.ceil(e.length/4);t=88*a+15*(a-1)+15+15,this.scrollUT.height=t}this.ut.height=42+t},e}(u)),T=function(i){function e(){for(var t,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return(t=i.call.apply(i,[this].concat(a))||this).icon=void 0,t.used=void 0,t.select=void 0,t.text=void 0,t.type=void 0,t}t(e,i);var a=e.prototype;return a.onInit=function(){this.icon=r.findChildComponent(this.node,"icon",l),this.used=r.findChild(this.node,"used"),this.select=r.findChild(this.node,"select")},a.onRender=function(i,t){i[1]?1==i[1].split("_").length?this.type=1:this.type=3:2==this.view.curType?this.type=2:4==this.view.curType&&(this.type=4),i[1]?1==i[1].split("_").length?(this.icon.color=new h(255,255,255),this.select.active=1==this.view.curType&&this.view.chooseFlagData.ShapeId==this.data[0],this.view.loadIcon(this.icon,"icon_guildflag",i[1]+"_1",null,v.ICON_SPRITE)):(this.icon.color=new h(255,255,255),this.select.active=3==this.view.curType&&this.view.chooseFlagData.DesignId==this.data[0],this.view.loadIcon(this.icon,"icon_guildflag",i[1],null,v.ICON_SPRITE)):(2==this.view.curType?this.select.active=this.view.chooseFlagData.ShapeColor==this.data:4==this.view.curType&&(this.select.active=this.view.chooseFlagData.DesignColor==this.data),this.icon.color=new h(w[i]),this.view.loadIcon(this.icon,"icon_guildflag","jiazu_ui_yanse13",null,v.ICON_SPRITE))},a.onItemClick=function(){this.data[1]?this.view.SetIndex(this.data[0],this.type):this.view.SetIndex(this.data,this.type)},e}(u);e._RF.pop()}}}));

