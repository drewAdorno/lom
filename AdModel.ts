System.register("chunks:///_virtual/AdModel.ts",["cc","./TimeUtil.ts","./ConfigGlobal.ts","./MessageView.ts","./LoginDataCache.ts","./PrivilegeDataCache.ts","./PrivilegeDefine.ts","./RoleControl.ts","./NativeToJs.ts","./SdkControl.ts","./AdControl.ts","./AdDataCache.ts","./AdDefine.ts"],(function(t){"use strict";var e,n,i,a,o,d,s,r,c,u,f,g,l,h;return{setters:[function(t){e=t.cclegacy,n=t.sys},function(t){i=t.default},function(t){a=t.ConfigGlobal},function(t){o=t.default},function(t){d=t.LoginDataCache},function(t){s=t.PrivilegeDataCache},function(t){r=t.PrivilegeCardEffect,c=t.Privilege},function(t){u=t.default},function(t){f=t.NativeToJs},null,function(t){g=t.default},function(t){l=t.AdDataCache},function(t){h=t.AdEventDefine}],execute:function(){e._RF.push({},"5eb9cAvy2pB8advv6waWFtI","AdModel",void 0);t("AdModel",function(){var t=e.prototype;function e(){this.waitCbAdCfgId=void 0,this.ext=void 0,normalEvent.on(h.AD_WATCH_FINISH,this.onAdWatchFinish,this)}return t.clear=function(){normalEvent.off(h.AD_WATCH_FINISH,this.onAdWatchFinish,this)},t.getAdInfo=function(t){return IS(l).idToInfo[t]},t.getAdWatchCount=function(t){var e=this.getAdInfo(t);return null==e?0:e.count},t.getAdNextWatchTime=function(t){var e=this.getAdInfo(t);return null==e?0:e.next_time},t.getAdTotalWatchCount=function(t){var e=this.getAdInfo(t);return null==e?0:e.history_count},t.getAdRewardValue=function(t){var e=configAds.getDataByKey(t).reward[2],n=e[1],i=this.getAdTotalWatchCount(t);return i<=0?n:Math.min(e[2],Math.ceil(n+i*e[0]))},t.GetAPPaddId=function(t){var e,n=configAds.getDataByKey(t),i=configAppid.getDataByKey(IS(d).channelFN);if(!i)return n.app_ad_id;e=i.type+t;var a=configAppads.getDataByKey(e);return a?a.key:"0"},t.GetAndroidOrIosAddId=function(t){var e=configAds.getDataByKey(t);if(n.os==n.OS.ANDROID){if(2==f.GetBagTag())return e.hw_ad_id;if(4==f.GetBagTag())return e.sa_ad_id}else if(n.os==n.OS.IOS)return e.ios_ad_id;return e.ad_id},t.tryWatchAd=function(t,e){if(GlobalDefine.ADVERTISE_OPEN){var n=this.getAdWatchCount(t),d=configAds.getDataByKey(t).times;if(n>=(d+=IS(s).getPrivilegeCardValue(r.ADTIMES,t))){var u=1==a.ads_icon_is_show?GetLanguage(200115):GetLanguage(200116);o.showFlyTip(u)}else{var f=this.getAdNextWatchTime(t);if(i.serverTime<f){var l=1==a.ads_icon_is_show?GetLanguage(200117):GetLanguage(200118);o.showFlyTip(l)}else 1==a.ads_icon_is_show?IS(s).checkPrivilegeUnlock(c.NO_ADS)?IS(g).reqAdReward(t,e,1):o.showFlyTip(GetLanguage(300149)):IS(g).reqAdReward(t,e,0)}}else o.showFlyTip(GetLanguage(200114))},t.onAdWatchFinish=function(t){null!=this.waitCbAdCfgId&&(1==t?IS(g).reqAdReward(this.waitCbAdCfgId,this.ext,0):IS(u).send_3_30(1,2,[{k:1,v:this.waitCbAdCfgId,name:""}]),this.waitCbAdCfgId=null,this.ext=null)},e}());e._RF.pop()}}}));

