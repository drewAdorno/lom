System.register("chunks:///_virtual/ActivityHalloweenPvpView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./AdDefine.ts","./AdModel.ts","./CommonModel.ts","./ActivityControl.ts","./ActivityDefine.ts","./ActivityHalloweenDataCache.ts","./MessageView.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,a,d,h,l,c,v,r,f,u,p;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.Label,s=t.Sprite},null,function(t){a=t.ADS_TYPE,d=t.AdEventDefine},function(t){h=t.AdModel},function(t){l=t.CommonModel},function(t){c=t.default},function(t){v=t.ActivityEventDefine},function(t){r=t.default},function(t){f=t.default},function(t){u=t.ViewEvent,p=t.BaseView}],execute:function(){e._RF.push({},"50fd99eMz5GQJExF0nQmQ2g","ActivityHalloweenPvpView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).btnAd=void 0,i.btnBattle=void 0,i.btnGet=void 0,i.nodeTips=void 0,i.txtTips=void 0,i.nodeFinish=void 0,i.nodeRole=void 0,i.nodeInfo=void 0,i.imgIcon=void 0,i.imgHeadFrame=void 0,i.txtName=void 0,i.model=void 0,i.isFirstOpen=void 0,i.timer=void 0,i.name="ActivityHalloweenPvpView",i.url="ui/module/halloween/ActivityHalloweenPvpView",i}i(e,t);var p=e.prototype;return p.onInit=function(){var t=this,i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("view/btnAttr");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){uiMgr.openView("ActivityHalloweenPvpAttrView")})),this.btnAd=this.findChild("view/btnAd"),this.addComponentCallbackListener(this.btnAd,n.EventType.CLICK,(function(){f.showBoxTip({tip:GetLanguage(201237),func:function(t){"type_yes"==t&&IS(h).tryWatchAd(a.AD_TRICK_OR_TREAT)}})})),this.btnBattle=this.findChild("view/btnBattle"),this.addComponentCallbackListener(this.btnBattle,n.EventType.CLICK,(function(){IS(c).send_24_68(),battleMain.enterChapter(0),t.close(),uiMgr.close("ActivityHalloweenView")})),this.btnGet=this.findChild("view/btnGet"),this.addComponentCallbackListener(this.btnGet,n.EventType.CLICK,(function(){IS(c).send_24_70()})),this.nodeFinish=this.findChild("view/finish"),this.nodeRole=this.findChild("view/role"),this.nodeTips=this.findChild("view/tips"),this.txtTips=this.findChildComponent("view/tips/Label",o),this.nodeInfo=this.findChild("view/info"),this.imgIcon=this.findChildComponent("view/info/head/imgIcon",s),this.imgHeadFrame=this.findChildComponent("view/info/head/imgHeadFrame",s),this.txtName=this.findChildComponent("view/info/name",o)},p.registerUpdateHandler=function(){this.addEvent(v.OnHalloweenPvpInfo,this.updateInfo,this),this.addEvent(v.OnHalloweenPvpCandy,this.updateCandyCallBack,this),this.addEvent(u.ViewClose,this.onViewClose,this),this.addEvent(d.AD_INFO_UPDATE,this.updateAd,this)},p.onAfterOpen=function(){var t=IS(r).pvpResult;t?(1==t.result?uiMgr.openView("GoodsGetView",t.reward):0==t.result&&f.showFlyTip(GetLanguage(200500)),IS(r).pvpResult=null,this.updateInfo()):(this.isFirstOpen=!0,this.nodeTips.active=!1,IS(c).send_24_67()),this.updateAd()},p.onBeforeClose=function(){this.nodeTips.active=!1,this.removeUnitModel(this.model),this.removeTimer(this.timer)},p.onDestroy=function(){},p.updateInfo=function(){var t=IS(r).getPvpInfo();if(this.isFirstOpen&&t.choose_buff.length>0&&uiMgr.openView("ActivityHalloweenPvpTipsView"),this.isFirstOpen=!1,this.removeUnitModel(this.model),t.def_data){this.nodeFinish.active=!1,this.nodeRole.active=!0,this.nodeInfo.active=!0,this.btnBattle.active=0==t.can_candy,this.btnGet.active=1==t.can_candy,this.txtName.string=t.def_data.name,this.loadRemoteIcon(t.def_data.head.url,this.imgIcon);var i=t.def_data.head.frame_id;if(i>0){var e=configAvatar_frame.getDataByKey(i);this.loadIcon(this.imgHeadFrame,"icon_frame",e.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1;this.model=IS(l).AddRoleModel(this,t.def_data.figure,this.nodeRole,null,2)}else this.nodeFinish.active=!0,this.nodeRole.active=!1,this.nodeInfo.active=!1,this.btnBattle.active=!1,this.btnGet.active=!1},p.updateCandyCallBack=function(t){var i=this;this.nodeTips.active=!0,this.timer&&(this.removeTimer(this.timer),this.timer=null),0==t.can_candy?(this.btnBattle.active=!0,this.btnGet.active=!1,this.txtTips.string=GetLanguage(201235),this.timer=this.addTimer(2,0,(function(){i.nodeTips.active=!1}))):(this.btnBattle.active=!1,this.btnGet.active=!0,this.txtTips.string=GetLanguage(201236),uiMgr.openView("GoodsGetView",t.reward),this.timer=this.addTimer(2,0,(function(){i.nodeTips.active=!1})))},p.onViewClose=function(t){IS(r).getPvpInfo().choose_buff.length>0&&"GoodsGetView"==t&&uiMgr.openView("ActivityHalloweenPvpTipsView")},p.updateAd=function(){var t=configAds.getDataByKey(a.AD_TRICK_OR_TREAT),i=IS(h).getAdWatchCount(a.AD_TRICK_OR_TREAT);this.btnAd.active=i<t.times},e}(p));e._RF.pop()}}}));

