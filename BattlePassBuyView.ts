System.register("chunks:///_virtual/BattlePassBuyView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./BagModel.ts","./PayControl.ts","./BattlePassDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,a,o,r,s,d,l,u,h,c,f,v,g;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,a=t.Button,o=t.Label,r=t.UITransform,s=t.ScrollView},function(t){d=t.ItemGrid},function(t){l=t.ListItem},function(t){u=t.default},function(t){h=t.default},null,function(t){c=t.BagModel},function(t){f=t.default},function(t){v=t.BattlePassDataCache},function(t){g=t.BaseView}],execute:function(){n._RF.push({},"66e721XNyVBWLfpIy5wNScP","BattlePassBuyView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).utBg=void 0,i.nodeReward1=void 0,i.nodeReward2=void 0,i.scroll1=void 0,i.scroll2=void 0,i.rewardTitle=void 0,i.txtContent=void 0,i.txtDiamond=void 0,i.cfgId=0,i.name="BattlePassBuyView",i.url="ui/module/battlepass/BattlePassBuyView",i}i(n,t);var d=n.prototype;return d.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,a.EventType.CLICK,(function(){t.close()})),this.txtContent=this.findChildComponent("view/tips/btnDiamond/txtContent",o),this.txtDiamond=this.findChildComponent("view/tips/btnDiamond/txtDiamond",o),this.utBg=this.findChildComponent("view",r),this.nodeReward1=this.findChild("view/reward1"),this.nodeReward2=this.findChild("view/reward2"),this.rewardTitle=this.findChildComponent("view/reward2/title/Label",o);var e=this.findChildComponent("view/reward1/rewardScroll",s);this.scroll1=this.addUIList(e,y);var n=this.findChildComponent("view/reward2/rewardScroll",s);this.scroll2=this.addUIList(n,y);var d=this.findChild("view/tips/buttons/btnEnsure");this.addComponentCallbackListener(d,a.EventType.CLICK,(function(){IS(f).send_19_5(t.cfgId),t.close()}));var l=this.findChild("view/tips/buttons/btnCancel");this.addComponentCallbackListener(l,a.EventType.CLICK,(function(){t.close()}))},d.registerUpdateHandler=function(){},d.onAfterOpen=function(){var t;this.txtDiamond.string=h.GetNumString(IS(c).getGoodsCountByGoodsGtid(999));var i,n=this.openArgs[0],a=null!=(t=this.openArgs[1])?t:1,o=IS(v).getPassInfo(n);if(i=1==n?configBattlepass_reward.getDataByList("id",n):configWartoken_reward.getDataByList("id",n)){var r,s="";if(r=1==n?configBattlepass.getDataByKey(n):configWartoken.getDataByKey(n),a){s="middle_reward";var d=configPay_mall.getDataByKey(r.bundle_id2);this.txtContent.string=h.formatStrWithMirrorDeal(GetLanguage(200475),d.price),this.cfgId=r.bundle_id2}else{s="high_reward";var l=configPay_mall.getDataByKey(r.bundle_id);this.txtContent.string=h.formatStrWithMirrorDeal(GetLanguage(200475),l.price),this.cfgId=r.bundle_id}var u=0,f=[];f[1]=0;for(var g=0;g<i.length;g++){var y=i[g];u+=y.exp,f[y.level+1]=u}this.rewardTitle.string=h.formatStrWithMirrorDeal(GetLanguage(201890),o.max_lev);for(var m,p=[],w=e(i);!(m=w()).done;)for(var C,B=m.value,I=e(B[s]);!(C=I()).done;){var D=C.value;o.lev<B.level||(p[D[0]]||(p[D[0]]={id:D[0],num:0}),p[D[0]].num=p[D[0]].num+D[1])}var L=[];for(var G in p)p.hasOwnProperty(G)&&L.push(p[G]);if(L.sort((function(t,i){var e=configGoods.getDataByKey(t.id),n=configGoods.getDataByKey(i.id);return e.quality==n.quality?t.id-i.id:n.quality-e.quality})),this.scroll1.datas=L,o.lev<o.max_lev){this.utBg.height=661,this.nodeReward2.active=!0;for(var b,_=[],x=e(i);!(b=x()).done;)for(var P,S=b.value,K=e(S[s]);!(P=K()).done;){var R=P.value;_[R[0]]||(_[R[0]]={id:R[0],num:0}),_[R[0]].num=_[R[0]].num+R[1]}var q=[];for(var V in _)_.hasOwnProperty(V)&&q.push(_[V]);q.sort((function(t,i){var e=configGoods.getDataByKey(t.id),n=configGoods.getDataByKey(i.id);return e.quality==n.quality?t.id-i.id:n.quality-e.quality})),this.scroll2.datas=q}else this.utBg.height=487,this.nodeReward2.active=!1}},d.onBeforeClose=function(){this.cfgId=0},d.onDestroy=function(){},n}(g));var y=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.itemGridNode=u.findChild(this.node,"itemGrid"),this.itemGrid=new d(this.view,this.itemGridNode)},n.onRender=function(t,i){this.itemGrid.SetItemId(t.id,t.num)},e}(l);n._RF.pop()}}}));

