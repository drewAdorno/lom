System.register("chunks:///_virtual/SeasonSceneDetailAirdropView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./SLGMapData.ts","./SeasonSceneControl.ts","./SeasonSceneDataCache.ts","./BaseView.ts"],(function(e){"use strict";var t,n,i,o,s,r,a,d,c,h,f,l,m,u,p;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e.Button,o=e.RichText,s=e.Label,r=e.ProgressBar,a=e.sys,d=e.js},function(e){c=e.default},function(e){h=e.default},function(e){f=e.default},null,function(e){l=e.SLGMapData},function(e){m=e.default},function(e){u=e.SeasonSceneDataCache},function(e){p=e.BaseView}],execute:function(){n._RF.push({},"3f2eb3bz19HY4F7I4QT3i5p","SeasonSceneDetailAirdropView",void 0);e("default",function(e){function n(){var t;return(t=e.call(this)||this).txtReward1=void 0,t.txtReward2=void 0,t.btnLocate=void 0,t.nodePre=void 0,t.nodeOcc=void 0,t.nodeDone=void 0,t.txtPreDesc=void 0,t.txtBestLabel=void 0,t.pbOcc=void 0,t.pbTime=void 0,t.txtDoneInfo1=void 0,t.txtDoneInfo2=void 0,t.txtDoneInfo3=void 0,t.txtPreInfo=void 0,t.name="SeasonSceneDetailAirdropView",t.url="ui/module/season/scene-view/SeasonSceneDetailAirdropView",t}t(n,e);var p=n.prototype;return p.onInit=function(){var e=this,t=this.findChild("content/btnClose");this.addComponentCallbackListener(t,i.EventType.CLICK,(function(){e.close()}));var n=this.findChild("imgMask");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){e.close()})),this.btnLocate=this.findChild("content/btnLocate"),this.addComponentCallbackListener(this.btnLocate,i.EventType.CLICK,(function(){var t=IS(u).airDrops;if(t){var n=l.getCRToIndex(t.pos.x,t.pos.y);IS(m).reqLocate(n),e.close()}})),this.txtReward1=this.findChildComponent("content/node1/desc",o),this.txtReward2=this.findChildComponent("content/node2/desc",o),this.nodePre=this.findChild("content/nodePre"),this.nodeOcc=this.findChild("content/nodeOcc"),this.nodeDone=this.findChild("content/nodeDone"),this.txtPreDesc=this.findChildComponent("content/nodePre/desc",s),this.txtBestLabel=this.findChildComponent("content/nodeOcc/bestLabel",s),this.pbOcc=this.findChildComponent("content/nodeOcc/hp",r),this.pbTime=this.findChildComponent("content/nodeOcc/hp/txtNum",s),this.txtDoneInfo1=c.findChildComponent(this.nodeDone,"Node/img1/Label-001",s),this.txtDoneInfo2=c.findChildComponent(this.nodeDone,"Node/img2/Label-001",s),this.txtDoneInfo3=c.findChildComponent(this.nodeDone,"Node/img3/Label-001",s),this.txtPreInfo=c.findChildComponent(this.nodeDone,"desc-001",s)},p.registerUpdateHandler=function(){},p.onAfterOpen=function(){var e=this,t=configSeason_building_plot.getDataByKey(16),n=configSeason_mapevent_reward.getDataByKey(t.event_reward_id[1]);this.txtReward1.string=(a.uiMirror?h:d).formatStr(GetLanguage(204641),n.reward[0][1]);var i=configSeason_mapevent_reward.getDataByKey(t.event_reward_id[0]),o=configSkill_level.getDataByKeys("id",i.buff_reward[0][0],"level",i.buff_reward[0][1]);this.txtReward2.string=(a.uiMirror?h:d).formatStr(GetLanguage(204642),o.desc_parm[0]),this.updateTimeDesc(),this.addTimer(1,-1,(function(){e.updateTimeDesc()}))},p.updateTimeDesc=function(){var e=IS(u).airDrops;if(this.nodePre.active=!1,this.nodeOcc.active=!1,this.nodeDone.active=!1,this.btnLocate.active=!1,e)if(e.refresh_time&&0!=e.refresh_time){this.nodeDone.active=!0,this.txtDoneInfo1.string=e.role_name,this.txtDoneInfo2.string=f.getTimeLeft(e.occupy_time),this.txtDoneInfo3.string=h.formatStr("【s##1】",e.serv_id);var t=f.getTimeLeft(e.refresh_time-f.serverTime);this.txtPreInfo.string=h.formatStr(GetLanguage(205031),t)}else{this.btnLocate.active=!0;var n=e.start_time-f.serverTime;if(0==e.end_time&&n>=0){this.nodePre.active=!0;var i=f.getTimeLeft(n);this.txtPreDesc.string=(a.uiMirror?h:d).formatStr(GetLanguage(204648),i,e.pos.x,e.pos.y)}else{if(this.nodeOcc.active=!0,0==e.end_time)this.pbTime.string=f.getTimeLeft(0),this.pbOcc.progress=0;else{var o=e.end_time-f.serverTime;this.pbTime.string=f.getTimeLeft(900-o),this.pbOcc.progress=1-o/900}var r=c.findChildComponent(this.nodeOcc,"dhh_zhuangtai_di/txtNum",s);if(0!=e.serv_id)if(r.string="[s"+e.serv_id+"]",""!=e.role_name){var l=f.serverTime-e.occupy_start_time;this.txtBestLabel.string=h.formatStr("##1:【##2】",e.role_name,f.getTimeLeft(l))}else this.txtBestLabel.string=GetLanguage(205117);else r.string=GetLanguage(204649),this.txtBestLabel.string=""}}},p.onBeforeClose=function(){},p.onDestroy=function(){},n}(p));n._RF.pop()}}}));

