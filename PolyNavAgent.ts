System.register("chunks:///_virtual/PolyNavAgent.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var i,s,e;return{setters:[function(t){i=t.createClass},function(t){s=t.cclegacy,e=t.Vec2}],execute:function(){s._RF.push({},"c6d49B6fMpCNI3OvWxY6U74","PolyNavAgent",void 0);var o=new e;t("PolyNavAgent",function(){function t(t){this.maxSpeed=80,this.isMove=!1,this.activePath=[],this.pos=new e,this.dir=1,this.velocity=new e,this.polyNav=void 0,this.polyNav=t}var s=t.prototype;return s.updatePolyNav=function(t){this.polyNav=t},s.setDestination=function(t){return this.polyNav?e.distance(this.pos,t)<1?(this.stop(),!1):(this.polyNav.pointIsValid(t)||(t=this.polyNav.getCloserEdgePoint(t)),this.polyNav.findPath(this.pos,t,this.activePath)?(this.isMove=!0,!0):(this.stop(),!1)):(printLogErr("No PolyNav2D in scene!"),!1)},s.stop=function(){this.activePath.length=0,this.isMove=!1},s.onUpdate=function(t){if(!this.hasPath)return!1;var i=this.maxSpeed*t,s=this.seek(this.pos,this.nextPoint,i);return this.pos.set(s),!!this.hasPath||(this.stop(),!1)},s.seek=function(t,i,s){var h=this.activePath,n=e.distance(i,t);return n<s?(s-=n,h.length>1?(h.splice(0,1),this.seek(i,this.nextPoint,s)):(h.splice(0,1),e.subtract(this.velocity,i,t),i)):(e.subtract(this.velocity,i,t),this.velocity.x<0?this.dir=-1:this.velocity.x>0&&(this.dir=1),this.velocity.normalize().multiplyScalar(s),e.add(o,t,this.velocity),o)},s.setDirPos=function(t,i){if(t.x<0?this.dir=-1:t.x>0&&(this.dir=1),t.normalize().multiplyScalar(this.maxSpeed*i),e.add(o,this.pos,t),!this.polyNav||this.polyNav.pointIsValid(o))this.pos.set(o);else{var s=this.polyNav.getCloserEdgePoint(o);this.pos.set(s)}},i(t,[{key:"hasPath",get:function(){return this.activePath.length>0}},{key:"nextPoint",get:function(){return this.hasPath?this.activePath[0]:this.pos}}]),t}());s._RF.pop()}}}));

