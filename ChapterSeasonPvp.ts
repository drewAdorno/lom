System.register("chunks:///_virtual/ChapterSeasonPvp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FixMath.ts","./MetaAttrib.ts","./V2.ts","./ChapterArena.ts"],(function(t){"use strict";var a,n,e,r,i,o;return{setters:[function(t){a=t.inheritsLoose},function(t){n=t.cclegacy},function(t){e=t.FixMath},function(t){r=t.AttribDefine},function(t){i=t.V2},function(t){o=t.ChapterArena}],execute:function(){n._RF.push({},"192fbYSbYJNcbHY+okLW6Iw","ChapterSeasonPvp",void 0);var s=t("_IdleFormation",{2:115,1:-380}),d={1:[1,2,3,4],2:[3,4,1,2]},u=new i;t("ChapterSeasonPvp",function(t){function n(){return t.apply(this,arguments)||this}a(n,t);var i=n.prototype;return i.getConfig=function(t){return configSeason_pvp_chapter.getDataByKey(t)},i.start=function(){t.prototype.start.call(this);var a=this.battleMain;this.battleMain.seasonPveDamAdd=e.round(a.data.seasonPveDamAdd/1e4)},i.addGun=function(t,a,n,i,o){void 0===o&&(o=1);for(var l=this.battleMain,p=d[o],c=configSeason_ship_appearance.getDataByKey(a.gunId),f=null!=a.gun2?2:1,h=a.config.cannon_plot,g=e.roundInt(t.data.getAttribByInt(r.att)),y=e.roundInt(1e4*t.data.getAttrib(r.speed)),b=t.data.getAttrib(r.att_dam),_=t.data.getAttrib(r.att_resist),v=e.round(b*(1+_)),M=0;M<p.length;M++){var I=p[M],C=c.cannon_type,A=l.unitMgr.addUnit(C,n),P=h[I-1];if(2==o?(A.direction=-1,u.x=e.roundInt(720-i[0]-P[0]),u.y=e.roundInt(s[2]+i[1]+P[1])):(u.x=e.roundInt(i[0]+P[0]),u.y=e.roundInt(s[1]+i[1]+P[1])),M>=f)A.statectr.banAct++;else{var m=0==M?a.gun1:a.gun2;A.data.getAttribMeta(r.speed).baseValue=e.roundInt(y+m.speed),A.data.getAttribMeta(r.partner_dam).baseValue=e.roundInt(v*e.round(m.dam_add/1e4)*1e4),A.data.getAttribMeta(r.double_hit).baseValue=m.double_hit}A.position=u,A.data.getAttribMeta(r.att).baseValue=g,I<3&&(A.animatorctr.aniAddName="up")}},i.addQi=function(t,a,n,r){void 0===r&&(r=1);var i=this.battleMain,o=configSeason_ship_appearance.getDataByKey(t.flag);if(o){var d=t.config.sail_plot,l=o.cannon_type,p=i.unitMgr.addUnit(l,a);return 2==r?(p.direction=-1,u.x=e.roundInt(720-n[0]-d[0]),u.y=e.roundInt(s[2]+n[1]+d[1])):(u.x=e.roundInt(n[0]+d[0]),u.y=e.roundInt(s[1]+n[1]+d[1])),p.position=u,p.statectr.dizz++,p}},i.loadData=function(a){var n=this.battleMain;t.prototype.loadData.call(this,a);var r=n.showMainCtr.playerData.ship,i=r.config.ship_plot[0],o=r.config.player_plot[0],d=e.roundInt(i[0]+o[0]),u=e.roundInt(s[1]+i[1]+o[1]);n.showMainCtr.offsetY=u,n.showMainCtr.offsetX=d,n.showMainCtr.positionSelected(a,!0),this.addGun(n.showMainCtr.player,r,0,i,1),this.addQi(r,0,i,1),i=(r=this.arenaPlayerCtr.playerData.ship).config.ship_plot[1],o=r.config.player_plot[1],d=e.roundInt(i[0]+o[0]),u=e.roundInt(s[2]+i[1]+o[1]),this.arenaPlayerCtr.offsetX=d,this.arenaPlayerCtr.offsetY=u,this.arenaPlayerCtr.positionSelected(a+720,!0),this.addGun(this.arenaPlayerCtr.player,r,1,i,2),this.addQi(r,1,i,2),this.addBuff(this.battleMain.mainCtr.player),this.addBuff(this.arenaPlayerCtr.player)},i.addBuff=function(t){var a=t.data.buffs;null!=a&&0!=a.length&&a.forEach((function(a){t.skillctr.addChapterBuff(a)}))},n}(o));n._RF.pop()}}}));

