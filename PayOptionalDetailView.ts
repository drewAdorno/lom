System.register("chunks:///_virtual/PayOptionalDetailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./BagModel.ts","./PayControl.ts","./PayDefine.ts","./BaseView.ts"],(function(e){"use strict";var i,t,o,s,n,h,d,c,a,r,l,v;return{setters:[function(e){i=e.inheritsLoose},function(e){t=e.cclegacy,o=e.Button,s=e.ScrollView,n=e.Node},function(e){h=e.ItemGrid},function(e){d=e.ListItem},function(e){c=e.default},null,function(e){a=e.BagModel},function(e){r=e.default},function(e){l=e.PayEventDefine},function(e){v=e.BaseView}],execute:function(){t._RF.push({},"d129caMmYRKRLcA5HhmFx6a","PayOptionalDetailView",void 0);e("default",function(e){function t(){var i;return(i=e.call(this)||this).chooseList=void 0,i.hasChoose=void 0,i.gift_id=void 0,i.selectIndex=void 0,i.chooseIndex=void 0,i.saveChoose={},i.chooseScroll=void 0,i.chooseNodeList={},i.chooseItemGridList={},i.time=0,i.isTouch=void 0,i.itemId=0,i.showNode=null,i.name="PayOptionalDetailView",i.url="ui/module/shop/PayOptionalDetailView",i}i(t,e);var n=t.prototype;return n.onInit=function(){var e=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){e.close()}));var t=this.findChild("view/btnCancel");this.addComponentCallbackListener(t,o.EventType.CLICK,(function(){e.close()}));var n=this.findChild("view/btnSave");this.addComponentCallbackListener(n,o.EventType.CLICK,(function(){var i=[];for(var t in e.saveChoose)if(e.saveChoose.hasOwnProperty(t)){var o=e.saveChoose[t];i.push(o)}IS(r).send_19_9({id:e.gift_id,list:i})}));var d=this.findChildComponent("view/chooseScroll",s);this.chooseScroll=this.addUIList(d,f,!1),this.chooseScroll.touchEvent=!1;for(var c=function(i){e.chooseNodeList[i]=e.findChild("view/choose/"+i),e.addComponentCallbackListener(e.chooseNodeList[i],o.EventType.CLICK,(function(){e.changeChoose(i)}))},a=1;a<3;a++)c(a);for(var l=1;l<3;l++)this.chooseItemGridList[l]={go:this.findChild("view/choose/"+l+"/itemGrid"),itemGrid:new h(this,this.findChild("view/choose/"+l+"/itemGrid")),select:this.findChild("view/choose/"+l+"/select")}},n.onUpdate=function(e){this.isTouch&&(this.time=this.time+e,0!=this.itemId&&this.time>=.5&&IS(a).OpenItemTips(this.itemId,this.showNode))},n.registerUpdateHandler=function(){this.addEvent(l.PAY_CUSTOM_INFO_SET,this.close,this)},n.onAfterOpen=function(){this.chooseList=this.openArgs[0],this.gift_id=this.openArgs[1],this.hasChoose=this.openArgs[2],this.selectIndex=0,this.chooseIndex=1,this.saveChoose={},null==this.chooseList&&this.close();for(var e=1;e<3;e++)this.chooseNodeList[e].active=!1;for(var i=1;i<=this.chooseList.length;i++)this.chooseNodeList[i].active=!0;for(var t=1;t<3;t++)this.chooseItemGridList[t].go.active=!1;if(null!=this.hasChoose)for(var o in this.hasChoose)if(this.hasChoose.hasOwnProperty(o)){var s=this.hasChoose[o];this.chooseItemGridList[s.k].go.active=!0,this.saveChoose[s.k]={k:s.k,v:s.v};var n=0,h=this.chooseList[s.k-1][1];for(var d in h)if(h.hasOwnProperty(d)){var c=h[d];c[0]==s.v&&(n=c[1])}this.chooseItemGridList[s.k].itemGrid.SetItemId(s.v,n)}this.changeChoose(this.openArgs[3])},n.onBeforeClose=function(){},n.onDestroy=function(){},n.changeChoose=function(e){this.chooseIndex=e,this.selectIndex=-1;for(var i=1;i<3;i++)this.chooseItemGridList[i].select.active=i==e;this.chooseScroll.datas=this.chooseList[e-1][1],this.chooseScroll.updateAll()},t}(v));var f=function(e){function t(){for(var i,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return(i=e.call.apply(e,[this].concat(o))||this).itemGridNode=void 0,i.itemGrid=void 0,i.select=void 0,i}i(t,e);var o=t.prototype;return o.onInit=function(){var e=this;this.itemGridNode=c.findChild(this.node,"itemGrid"),this.itemGrid=new h(this.view,this.itemGridNode),this.select=c.findChild(this.node,"select"),this.view.addComponentCallbackListener(this.node,n.EventType.TOUCH_START,(function(){e.view.itemId=e.data[0],e.view.showNode=e.node,e.view.time=0,e.view.isTouch=!0})),this.view.addComponentCallbackListener(this.node,n.EventType.TOUCH_CANCEL,(function(){e.view.time=0,e.view.isTouch=!1})),this.view.addComponentCallbackListener(this.node,n.EventType.TOUCH_END,(function(){e.view.time<.5&&(e.view.selectIndex=e.index,e.view.chooseScroll.updateAll(),e.view.chooseItemGridList[e.view.chooseIndex].go.active=!0,e.view.chooseItemGridList[e.view.chooseIndex].itemGrid.SetItemId(e.data[0],e.data[1]),e.view.saveChoose[e.view.chooseIndex]={k:e.view.chooseIndex,v:e.data[0]}),e.view.time=0,e.view.isTouch=!1}))},o.onRender=function(e,i){this.itemGrid.SetItemId(e[0],e[1]),this.SetSelect()},o.SetSelect=function(){this.select.active=this.index==this.view.selectIndex},t}(d);t._RF.pop()}}}));

