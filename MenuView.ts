System.register("chunks:///_virtual/MenuView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./RedPoint.ts","./RedPointMgr.ts","./index57.ts","./BaseView.ts","./ReturnDataCache.ts","./RouletteControl.ts","./CodeInviteDataCache.ts","./CodeInviteDefine.ts","./FriendModel.ts","./MailModel.ts","./CustomeHeadDefine.ts","./FrameDataCache.ts","./TitleDefine.ts","./RoleDataCache.ts","./RoleDefine.ts","./NativeToJs.ts","./SevenLoginDataCache.ts","./SevenLoginDefine.ts","./SurveyDataCache.ts","./SurveyDefine.ts","./WelfareControl.ts","./WelfareDataCache.ts","./UIDefine.ts"],(function(e){"use strict";var n,t,i,o,a,s,h,d,c,l,C,u,r,m,g,f,v,S,I,p,w,b,k,F,_,y,M,R,L,V,E,B,N,U;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,i=e.Button,o=e.Sprite,a=e.Label,s=e.Vec2,h=e.UITransform,d=e.sys,c=e.js,l=e.Vec3},function(e){C=e.BYTEDANCE},function(e){u=e.RedPointType},function(e){r=e.RedPointMgr},null,function(e){m=e.BaseView},function(e){g=e.ReturnDataCache},function(e){f=e.default},function(e){v=e.CodeInviteDataCache},function(e){S=e.CodeInviteDefine},function(e){I=e.FriendModel},function(e){p=e.MailModel},function(e){w=e.CustomeHeadDefine},function(e){b=e.FrameDataCache},function(e){k=e.TitleEventDefine},function(e){F=e.RoleDataCache},function(e){_=e.PlayerAttr,y=e.RoleEventDefine},function(e){M=e.NativeToJs},function(e){R=e.SevenLoginDataCache},function(e){L=e.SevenLoginDefine},function(e){V=e.SurveyDataCache},function(e){E=e.SurveyDefine},function(e){B=e.default},function(e){N=e.WelfareDataCache},function(e){U=e.OpenFunction}],execute:function(){t._RF.push({},"4db82eYEIFGJKxpZ1NQCsED","MenuView",void 0);e("default",function(e){function t(){var n;return(n=e.call(this)||this).imgHead=void 0,n.imgFrame=void 0,n.txtName=void 0,n.txtID=void 0,n.avatarUrl=void 0,n.btnMail=void 0,n.btnFriend=void 0,n.btnCircleFriends=void 0,n.btnRank=void 0,n.btnGameClub=void 0,n.btnHead=void 0,n.btnCallFriend=void 0,n.btnActivity=void 0,n.utSystem=void 0,n.nodeSystem=void 0,n.needUpdate=!1,n.utBg=void 0,n.nodeContent=void 0,n.name="MenuView",n.avatarUrl="",n.url="ui/module/main/MenuView",n}n(t,e);var m=t.prototype;return m.onInit=function(){var e=this,n=this.findChild("MenuView/imgMask");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){e.onMaskClick()}));var t=this.findChild("MenuView/content/btnExit");this.addComponentCallbackListener(t,i.EventType.CLICK,(function(){e.onExitClick()})),this.btnHead=this.findChild("MenuView/content/imgBg/info/btnHead"),this.addComponentCallbackListener(this.btnHead,i.EventType.CLICK,(function(){e.onHeadClick()})),this.btnMail=this.findChild("MenuView/content/imgBg/system/btnMail"),this.addComponentCallbackListener(this.btnMail,i.EventType.CLICK,(function(){e.onMailClick()})),this.loadIcon(this.btnMail.getComponent(o),"main","gongneng_ICON_youxiang"),this.btnCircleFriends=this.findChild("MenuView/content/imgBg/system/btnCircleFriends"),this.loadIcon(this.btnCircleFriends.getComponent(o),"main","gongneng_ICON_pengyouquan"),this.addComponentCallbackListener(this.btnCircleFriends,i.EventType.CLICK,(function(){uiMgr.openView("CircleOfFriendsView")})),this.btnFriend=this.findChild("MenuView/content/imgBg/system/btnFriend"),this.loadIcon(this.btnFriend.getComponent(o),"main","gongneng_ICON_haoyou"),this.addComponentCallbackListener(this.btnFriend,i.EventType.CLICK,(function(){e.onFriendClick()})),this.btnRank=this.findChild("MenuView/content/imgBg/system/btnRank"),this.loadIcon(this.btnRank.getComponent(o),"main","gongneng_ICON_paihang"),this.addComponentCallbackListener(this.btnRank,i.EventType.CLICK,(function(){e.onRankClick()})),this.imgHead=this.findChildComponent("MenuView/content/imgBg/info/btnHead/imgIcon",o),this.imgFrame=this.findChildComponent("MenuView/content/imgBg/info/btnHead/imgFrame",o),this.txtName=this.findChildComponent("MenuView/content/imgBg/info/txtName",a),this.txtID=this.findChildComponent("MenuView/content/imgBg/info/txtID",a);var c=this.findChild("MenuView/content/imgBg/system/btnSurvey");this.loadIcon(c.getComponent(o),"main","zjm_icon_wenjuandiaocha"),this.addComponentCallbackListener(c,i.EventType.CLICK,(function(){uiMgr.openView("SurveyView")}));var l=this.findChild("MenuView/content/imgBg/system/btnShare");this.loadIcon(l.getComponent(o),"main","zjm_ICON_yaoqinganniu"),GlobalDefine.IS_APP&&!C?l.active=!1:(this.addRedPoint("Share_Redpoint",l,new s(22,22)),this.addComponentCallbackListener(l,i.EventType.CLICK,(function(){uiMgr.openView("ShareView")})));var u=this.findChild("MenuView/content/imgBg/system/btnNotice");this.loadIcon(u.getComponent(o),"main","zjm_ICON_gg"),u.active=!1,this.addComponentCallbackListener(u,i.EventType.CLICK,(function(){uiMgr.openView("NoticeView")}));var r=this.findChild("MenuView/content/imgBg/system/btnRoll");this.loadIcon(r.getComponent(o),"main","zjm_ICON_xyzp"),this.addRedPoint("Roulette_Redpoint",r,new s(22,22)),this.addComponentCallbackListener(r,i.EventType.CLICK,(function(){uiMgr.openView("RouletteView")})),this.btnGameClub=this.findChild("MenuView/content/imgBg/system/btnGameClub"),this.loadIcon(this.btnGameClub.getComponent(o),"main","zjm_ICON_youxiquan1"),this.btnGameClub.active=!1;var m=this.findChild("MenuView/content/imgBg/system/btnGameCenter");this.loadIcon(m.getComponent(o),"main","gongneng_ICON_youxizhongxin"),this.addComponentCallbackListener(m,i.EventType.CLICK,(function(){uiMgr.openView("GameCenterView")})),this.checkWelfareBtn();var g=this.findChild("MenuView/content/imgBg/system/btnWelfareCenter");this.loadIcon(g.getComponent(o),"main","gongneng_ICON_fuli"),g.active=!M.IsPreviewServer(),this.addRedPoint("Welfare_Redpoint",g,new s(22,22)),this.addComponentCallbackListener(g,i.EventType.CLICK,(function(){uiMgr.openView("WelfareCenterView")})),m.active=!1,this.btnActivity=this.findChild("MenuView/content/imgBg/system/btnActivity"),this.loadIcon(this.findChildComponent("MenuView/content/imgBg/system/btnActivity/bg",o),"main","zjm_ICON_richeng"),this.addComponentCallbackListener(this.btnActivity,i.EventType.CLICK,(function(){uiMgr.openView("GuildSchduleView")}));var f=this.findChild("MenuView/content/imgBg/system/btnSevenLogin");this.loadIcon(this.findChildComponent("MenuView/content/imgBg/system/btnSevenLogin/bg",o),"main","zjm_ICON_qiandaorukou"),this.addComponentCallbackListener(f,i.EventType.CLICK,(function(){uiMgr.openView("SevenLoginView")}));var v=this.findChild("MenuView/content/imgBg/system/btnCodeInvite");this.loadIcon(v.getComponent(o),"main","zjm_ICON_fenxiang01"),this.addRedPoint("btnCodeInvite",v,new s(22,22)),this.addComponentCallbackListener(v,i.EventType.CLICK,(function(){uiMgr.openView("CodeInviteView")})),this.utSystem=this.findChildComponent("MenuView/content/imgBg/system",h),this.nodeSystem=this.utSystem.node,this.utBg=this.findChildComponent("MenuView/content/imgBg",h),this.nodeContent=this.findChild("MenuView/content"),d.uiMirror&&(this.findChild("MenuView/content/imgBg/system/btnMail/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnRoll/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnFriend/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnRank/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnWelfareCenter/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnSurvey/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnNotice/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnCircleFriends/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnGameClub/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnShare/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnGameCenter/Label").setScale(1,1,1),this.findChild("MenuView/content/imgBg/system/btnCodeInvite/Label").setScale(1,1,1)),this.btnCallFriend=this.findChild("MenuView/content/imgBg/system/btnCallFriend"),this.addRedPoint("return_callFriend",this.btnCallFriend,new s(22,22)),this.addComponentCallbackListener(this.btnCallFriend,i.EventType.CLICK,(function(){uiMgr.openView("ReturnCallFriendView")}))},m.updateroleHead=function(){var e=IS(F);this.avatarUrl=e.GetRoleAttr(_.ROLE_ATTR_HEAD_URL),this.loadRemoteIcon(this.avatarUrl,this.imgHead)},m.UpdateSkinRed=function(){this.addRedPoint("skinTitle_red",this.btnHead,new s(40,40),u.Dot),IS(F).CheckSkinTitleRed()},m.updateInfo=function(e){e[_.ROLE_ATTR_NAME]&&(this.txtName.string=IS(F).GetRoleAttr(_.ROLE_ATTR_NAME))},m.registerUpdateHandler=function(){this.addEvent(y.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(y.ROLE_INFO_UPDATE_HEADURL,this.updateroleHead,this),this.addEvent(y.ROLE_INFO_UPDATE,this.updateInfo,this),this.addEvent(E.SURVEY_INFO_UPDATE,this.checkShowSurveyBtn,this),this.addEvent(y.ROLE_SKIN_LIST,this.UpdateSkinRed,this),this.addEvent(y.ROLE_SKIN_CHANGE,this.UpdateSkinRed,this),this.addEvent(k.Title_INFO_UPDATE,this.UpdateSkinRed,this),this.addEvent(k.Frame_INFO_UPDATE,this.UpdateSkinRed,this),this.addEvent(k.Bubble_INFO_UPDATE,this.UpdateSkinRed,this),this.addEvent(w.UpdateHeadRed,this.UpdateSkinRed,this),this.addEvent(y.HIDE_LIST_UPDATE,this.checkShowShareBtn,this),this.addEvent(k.Frame_INFO_UPDATE,this.updateHeadFrame,this),this.addEvent(L.SEVEN_LOGIN_INFO_UPDATE,this.checkShowSevenLogin,this),this.addEvent(L.SEVEN_LOGIN_REWARDLIST_UPDATE,this.checkShowSevenLogin,this),this.addEvent(S.OnInviteInfoUpdate,this.checkShowCodeInvite,this)},m.checkShowRank=function(){var e=IS(F).CheckFuncOpen(U.FUNC_RANK);this.btnRank.active=e},m.onAfterOpen=function(){var e=IS(F);this.txtName.string=e.GetRoleAttr(_.ROLE_ATTR_NAME),this.txtID.string=c.formatStr("UID:%s",e.GetShowId()),this.addRedPoint("mail_red",this.btnMail,new s(30,30),u.Dot),IS(p).GetMailRed(),this.addRedPoint("friend_red",this.btnFriend,new s(30,30),u.Dot),IS(I).GetFriendRed(),this.checkBtnShow(),this.updateroleHead(),this.UpdateSkinRed(),this.updateHeadFrame(),this.needUpdate=!0},m.checkBtnShow=function(){this.checkShowRollBtn(),this.checkShowFriendBtn(),this.checkShowMailBtn(),this.checkShowRank(),this.checkShowSurveyBtn(),this.checkShowShareBtn(),this.checkWelfareBtn(),this.checkFriendShow(),this.checkSchdulePvpBtn(),this.checkShowSevenLogin(),this.checkShowCodeInvite(),this.checkCallFriendBtn()},m.onUpdate=function(e){this.needUpdate&&(this.setSystemHeight(),this.needUpdate=!1)},m.setSystemHeight=function(){for(var e=this.nodeSystem.children,n=0,t=0;t<e.length;t++)e[t].active&&(n+=1);n>=9?(this.utSystem.height=888.291,this.utBg.width=257.402,this.nodeContent.position=new l(-279.032,640,0)):(this.utSystem.height=n<=0?20:20+100*n+9*(n-1),this.utBg.width=158,this.nodeContent.position=new l(-329.243,640,0))},m.checkSchdulePvpBtn=function(){this.btnActivity.active=IS(F).CheckFuncOpen(U.FUNC_ACTIVITY_SCHEDULE)},m.checkShowSevenLogin=function(){var e=this.findChild("MenuView/content/imgBg/system/btnSevenLogin"),n=IS(R);e.active=n.getIsShowBtn(),this.addRedPoint("btnSevenLogin",e,new s(22,22),u.Dot),n.getDayMax.includes(n.day)&&n.getDayMax.length==n.day?IS(r).changeValue("btnSevenLogin",0):IS(r).changeValue("btnSevenLogin",1)},m.checkShowCodeInvite=function(){this.findChild("MenuView/content/imgBg/system/btnCodeInvite").active=!M.IsPreviewServer()&&IS(F).CheckFuncOpen(U.FUNC_INVITE),IS(r).changeValue("btnCodeInvite",IS(v).getRed())},m.updateHeadFrame=function(){var e=IS(b).curFrameId;if(e>0){var n=configAvatar_frame.getDataByKey(e);this.loadIcon(this.imgFrame,"icon_frame",n.icon),this.imgFrame.node.active=!0}else this.imgFrame.node.active=!1},m.checkShowSurveyBtn=function(){var e=this.findChild("MenuView/content/imgBg/system/btnSurvey"),n=IS(V);e.active=Boolean(n.surveyList.length>0)},m.checkShowShareBtn=function(){var e=this.findChild("MenuView/content/imgBg/system/btnShare");!GlobalDefine.IS_APP||C?(IS(F).isHaveHideByType(6),e.active=!1):e.active=!1},m.checkShowGameClub=function(){var e=this.findChild("MenuView/content/imgBg/system/btnGameClub");GlobalDefine.IS_APP?e.active=!1:e.active=IS(F).CheckFuncOpen(U.FUNC_FORUM)},m.checkShowRollBtn=function(){var e=this.findChild("MenuView/content/imgBg/system/btnRoll");f.checkRedPoint(),e.active=IS(F).CheckFuncOpen(U.FUNC_ROLL)},m.checkShowFriendBtn=function(){this.btnFriend.active=IS(F).CheckFuncOpen(U.FUNC_FRIEND)},m.checkShowMailBtn=function(){this.btnMail.active=IS(F).CheckFuncOpen(U.FUNC_MAIL)},m.checkWelfareBtn=function(){IS(B).reqFbRewardInfo(),IS(B).reqBindInfo(),IS(N).updateRedPoint()},m.checkFriendShow=function(){this.btnCircleFriends.active=IS(F).CheckFuncOpen(U.FUNC_CIRCLE)&&!M.IsPreviewServer()},m.onBeforeClose=function(){this.needUpdate=!0},m.onDestroy=function(){},m.onRoleOpenFunctionUpdate=function(e){e==U.FUNC_ROLL?this.checkShowRollBtn():e==U.FUNC_FRIEND?this.checkShowFriendBtn():e==U.FUNC_MAIL?this.checkShowMailBtn():e==U.FUNC_RANK?this.checkShowRank():e==U.FUNC_FORUM||(e==U.FUNC_ACTIVITY_SCHEDULE?this.checkSchdulePvpBtn():e==U.FUNC_SEVEN_LOGIN?this.checkShowSevenLogin():e==U.FUNC_INVITE&&this.checkShowCodeInvite()),this.setSystemHeight()},m.getShwoBtnCount=function(){var e=3;return e+=IS(F).CheckFuncOpen(U.FUNC_FRIEND)?1:0,e+=IS(F).CheckFuncOpen(U.FUNC_MAIL)?1:0,e+=IS(F).CheckFuncOpen(U.FUNC_RANK)?1:0},m.checkCallFriendBtn=function(){IS(F).CheckFuncOpen(U.FUNC_RECALL_TURNTABLE)?(this.btnCallFriend.active=!0,IS(r).changeValue("return_callFriend",IS(g).GetCallFriendRed())):(this.btnCallFriend.active=!1,IS(r).changeValue("return_callFriend",IS(g).GetCallFriendRed()))},m.onMaskClick=function(){this.close()},m.onExitClick=function(){this.close()},m.onHeadClick=function(){uiMgr.openView("PlayerInfoView")},m.onMailClick=function(){uiMgr.openView("MailView")},m.onFriendClick=function(){uiMgr.openView("FriendView")},m.onRankClick=function(){uiMgr.openView("RankView")},t}(m));t._RF.pop()}}}));

