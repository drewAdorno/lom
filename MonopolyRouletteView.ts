System.register("chunks:///_virtual/MonopolyRouletteView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./index3.ts","./ItemGrid.ts","./NodeUtil.ts","./index57.ts","./MonopolyDataCache.ts","./EaseMethod.ts","./BaseView.ts"],(function(e){"use strict";var t,i,o,n,l,s,r,a,d,h;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,o=e.Button,n=e.randomRangeInt},function(e){l=e.audioMgr},null,function(e){s=e.ItemGrid},function(e){r=e.default},null,function(e){a=e.MonopolyDataCache},function(e){d=e.EasingMethod},function(e){h=e.BaseView}],execute:function(){i._RF.push({},"204b1OoljRNWZnIqaVNV+TA","MonopolyRouletteView",void 0);e("default",function(e){function i(){var t;return(t=e.call(this)||this).nodeTable=void 0,t.moveTween=void 0,t.actionTime=5,t.rollItemList=[],t.imgMask=void 0,t.isRolling=!1,t.rewardList=void 0,t.rewardIndex=void 0,t.name="MonopolyRouletteView",t.url="ui/module/activity/MonopolyRouletteView",t.poolTime=3e3,t}t(i,e);var h=i.prototype;return h.onInit=function(){var e=this;this.nodeTable=this.findChild("root/turntable"),this.imgMask=this.findChild("imgMask"),this.addComponentCallbackListener(this.imgMask,o.EventType.CLICK,(function(){e.isRolling||e.close()})),this.nodeTable.removeAllChildren();for(var t=0;t<12;t++){var i=this.findChild("root/item"),n=nodeInstantiate.instantiate(i);n.active=!0,n.setParent(this.nodeTable),n.angle=-30*t,this.rollItemList.push({node:n,itemGrid:new s(this,r.findChild(n,"itemnode"))})}},h.onAfterOpen=function(){var e=this.openArgs[0];this.rewardIndex=this.openArgs[1];var t=configMonopoly_random.getDataByKey(e.id);this.rewardList=t.type[1];for(var i=0;i<this.rewardList.length;i++)this.rollItemList[i].itemGrid.SetItemId(this.rewardList[i][0][0],1!=IS(a).monopolyInfo.double_card_open?this.rewardList[i][0][1]:2*this.rewardList[i][0][1]);this.startRoll(),this.nodeTable.angle=0;for(var o=0;o<this.rollItemList.length;o++)r.findChild(this.rollItemList[o].node,"select").active=!1},h.registerUpdateHandler=function(){},h.startRoll=function(){var e=this;l.playSound("common_zhuanpan"),this.isRolling=!0;var t=this.rewardIndex-1,i=360/this.rollItemList.length;null!=this.moveTween&&this.moveTween.stop();for(var o=720+i*t+n(-i/2+1,i/2),s=0;s<this.rollItemList.length;s++)r.findChild(this.rollItemList[s].node,"select").active=!1;this.moveTween=this.addTween(0,1,this.actionTime,(function(t,i){e.nodeTable.angle=o*i})).easing(d.CUBIC_OUT).call((function(){for(var o=0;o<e.rollItemList.length;o++){var n=360-(e.nodeTable.angle+e.rollItemList[o].angle)%360;r.findChild(e.rollItemList[o].node,"select").active=!1,(n<=i/2||n>=360-i/2)&&(r.findChild(e.rollItemList[o].node,"select").active=!0)}r.findChild(e.rollItemList[t].node,"select").active=!0;var l=e.rewardList[t];uiMgr.openView("GoodsGetView",[{gtid:l[0][0],num:1!=IS(a).monopolyInfo.double_card_open?l[0][1]:2*l[0][1]}]),e.isRolling=!1})).start()},h.onBeforeClose=function(){if(null!=this.moveTween&&this.moveTween.stop(),this.isRolling){var e=this.rewardList[this.rewardIndex-1];uiMgr.openView("GoodsGetView",[{gtid:e[0][0],num:1!=IS(a).monopolyInfo.double_card_open?e[0][1]:2*e[0][1]}])}},h.onDestroy=function(){},i}(h));i._RF.pop()}}}));

