System.register("chunks:///_virtual/SlaveLogView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./ChatDataCache.ts","./ChatDefine.ts","./MessageView.ts","./RoleDataCache.ts","./RoleDefine.ts","./SlaveControl.ts","./SlaveDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,a,s,r,d,f,h,l,v,c,m,_,g,L,u,R,I,C,T,p;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,a=t.ScrollView,s=t.Sprite,r=t.Label,d=t.Layout},function(t){f=t.RecordSource},function(t){h=t.ListItem},function(t){l=t.default},function(t){v=t.default},function(t){c=t.default},null,function(t){m=t.ConfigGlobal},function(t){_=t.ChatDataCache,g=t.EPvpShareType},function(t){L=t.ChatDefine},function(t){u=t.default},function(t){R=t.RoleDataCache},function(t){I=t.PlayerAttr},function(t){C=t.default},function(t){T=t.SlaveEventDefine},function(t){p=t.BaseView}],execute:function(){n._RF.push({},"4f048W3dI1HZb7UCXI22Y2/","SlaveLogView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).scrollList=void 0,i.name="SlaveLogView",i.url="ui/module/slave/SlaveLogView",i}i(n,t);var s=n.prototype;return s.onInit=function(){var t=this,i=this.findChild("bottom/btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()}));var e=this.findChildComponent("container/content/scroll",a);this.scrollList=this.addUIList(e,E)},s.registerUpdateHandler=function(){this.addEvent(T.SLAVE_VIDEO_BACK,this.onSlaveVideoBack,this)},s.onAfterOpen=function(){IS(C).reqCaptureSlaveVideo()},s.onBeforeClose=function(){},s.onDestroy=function(){},s.onSlaveVideoBack=function(t){this.scrollList.datas=t.video_list.sort((function(t,i){return i.time-t.time}));var i=new Array;if(null!=t.video_list)for(var n=0;n<t.video_list.length;n++)for(var o,a=t.video_list[n],s=e(a.ext);!(o=s()).done;){var r=o.value;1==r.k&&1==r.v&&i.push(a.vid)}i.length>0&&IS(C).reqCaptureSalveLook(i)},n}(p));var E=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).left={},i.right={},i.txtTime=void 0,i.imgLeftWin=void 0,i.imgRightWin=void 0,i.nodeNew=void 0,i.atkInfoList={},i.defInfoList={},i}i(n,t);var a=n.prototype;return a.onInit=function(){var t=this;this.imgLeftWin=l.findChild(this.node,"imgLeftWin"),this.imgRightWin=l.findChild(this.node,"imgRightWin"),this.left.imgLose=l.findChild(this.node,"left/imgLose"),this.left.imgIcon=l.findChildComponent(this.node,"left/imgIcon",s),this.left.imgHeadFrame=l.findChildComponent(this.node,"left/imgHeadFrame",s),this.left.txtName=l.findChildComponent(this.node,"left/txtName",r),this.left.txtPower=l.findChildComponent(this.node,"left/txtPower",r),this.right.imgLose=l.findChild(this.node,"right/imgLose"),this.right.imgIcon=l.findChildComponent(this.node,"right/imgIcon",s),this.right.imgHeadFrame=l.findChildComponent(this.node,"right/imgHeadFrame",s),this.right.txtName=l.findChildComponent(this.node,"right/txtName",r),this.right.txtPower=l.findChildComponent(this.node,"right/power/txtPower",r),this.txtTime=l.findChildComponent(this.node,"txtTime",r),this.nodeNew=l.findChild(this.node,"imgNew"),this.nodeNew.active=!1;var i=l.findChild(this.node,"btnShare");this.view.addComponentCallbackListener(i,o.EventType.CLICK,(function(){if(IS(_).IsOpenInput()){if(t.data.atk_info_list&&t.data.def_info_list){var i={win_id:t.data.win_id,vid:t.data.vid,atk_role:{id:t.atkInfoList[I.ROLE_ATTR_ID],name:t.atkInfoList[I.ROLE_ATTR_NAME],lev:t.atkInfoList[I.ROLE_ATTR_LVL],power:t.atkInfoList[I.ROLE_ATTR_POWER_SHOW],job:t.atkInfoList[I.ROLE_ATTR_CUR_JOB],sex:t.atkInfoList[I.ROLE_ATTR_GENDER]},def_role:{id:t.defInfoList[I.ROLE_ATTR_ID],name:t.defInfoList[I.ROLE_ATTR_NAME],lev:t.defInfoList[I.ROLE_ATTR_LVL],power:t.defInfoList[I.ROLE_ATTR_POWER_SHOW],job:t.defInfoList[I.ROLE_ATTR_CUR_JOB],sex:t.defInfoList[I.ROLE_ATTR_GENDER]}};IS(_).SendShareData(L.ChatLinkType.PvpShare,i,void 0,void 0,g.slaveBattle)}}else u.showFlyTip(v.formatStrWithMirrorDeal(GetLanguage(200490),m.chat_level))}));var e=l.findChild(this.node,"btnPlayRecord");this.view.addComponentCallbackListener(e,o.EventType.CLICK,(function(){IS(C).reqCaptureSlaveVideoPlay(t.data.vid,f.default),battleMain.enterChapter(0),uiMgr.closeAllView(["MainView","MessageView","GuideView","BattleHubView"]),uiMgr.getOpenView("MainView").setIndex(0)})),this.view.loadIcon(l.findChildComponent(this.node,"imgVs",s),"jjc","jjc_ui_vs"),this.view.loadIcon(this.nodeNew.getComponent(s),"farm","zy_ui_new"),this.view.loadIcon(this.imgLeftWin.getComponent(s),"common","gvg_img_shengli"),this.view.loadIcon(this.imgRightWin.getComponent(s),"common","gvg_img_shengli"),this.view.dealMirrorLayout(l.findChildComponent(this.node,"right/power",d))},a.onRender=function(t,i){for(var n,o=e(t.atk_info_list.ks);!(n=o()).done;){var a=n.value;this.atkInfoList[a.k]=a.s}for(var s,r=e(t.atk_info_list.kv);!(s=r()).done;){var d=s.value;this.atkInfoList[d.k]=d.v}for(var f,h=e(t.def_info_list.ks);!(f=h()).done;){var l=f.value;this.defInfoList[l.k]=l.s}for(var v,m=e(t.def_info_list.kv);!(v=m()).done;){var _=v.value;this.defInfoList[_.k]=_.v}var g=IS(R).GetRoleId();this.atkInfoList[I.ROLE_ATTR_ID];g!=this.atkInfoList[I.ROLE_ATTR_ID]&&g!=this.defInfoList[I.ROLE_ATTR_ID]&&(g=this.atkInfoList[I.ROLE_ATTR_ID]);var L=g==t.win_id;this.imgLeftWin.active=L,this.imgRightWin.active=!L,this.left.imgLose.active=!L,this.right.imgLose.active=L;var u=this.atkInfoList[I.ROLE_ATTR_ID]==g?[this.atkInfoList,this.defInfoList]:[this.defInfoList,this.atkInfoList],C=u[0],T=u[1];this.left.txtName.string=C[I.ROLE_ATTR_NAME],this.left.txtPower.string=C[I.ROLE_ATTR_POWER_SHOW];var p=C[I.ROLE_ATTR_HEAD_FRAME_ID];if(null!=p)if(this.view.loadRemoteIcon(C[I.ROLE_ATTR_HEAD_URL],this.left.imgIcon),p>0){var E=configAvatar_frame.getDataByKey(p);this.view.loadIcon(this.left.imgHeadFrame,"icon_frame",E.icon),this.left.imgHeadFrame.node.active=!0}else this.left.imgHeadFrame.node.active=!1;if(this.right.txtName.string=T[I.ROLE_ATTR_NAME],this.right.txtPower.string=T[I.ROLE_ATTR_POWER_SHOW],null!=(p=T[I.ROLE_ATTR_HEAD_FRAME_ID]))if(this.view.loadRemoteIcon(T[I.ROLE_ATTR_HEAD_URL],this.right.imgIcon),p>0){var w=configAvatar_frame.getDataByKey(p);this.view.loadIcon(this.right.imgHeadFrame,"icon_frame",w.icon),this.right.imgHeadFrame.node.active=!0}else this.right.imgHeadFrame.node.active=!1;for(var A,O=e(t.ext);!(A=O()).done;){var k=A.value;1==k.k&&(this.nodeNew.active=1==k.v)}this.txtTime.string=c.formatDate(new Date(1e3*t.time),"yyyy/MM/dd hh:mm:ss")+c.GetServerTimeZoneStr()},n}(h);n._RF.pop()}}}));

