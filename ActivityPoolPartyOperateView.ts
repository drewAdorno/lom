System.register("chunks:///_virtual/ActivityPoolPartyOperateView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts","./index57.ts","./BagModel.ts","./MessageView.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ActivityPoolPartyDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,s,r,d,l,u,c,h,f,g,m,v;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.Sprite,a=t.Label,s=t.RichText},function(t){r=t.default},null,function(t){d=t.BagModel},function(t){l=t.default},function(t){u=t.default},function(t){c=t.default},function(t){h=t.ActivityType,f=t.ActivityState,g=t.ActivityEventDefine},function(t){m=t.CardPoolPartyItemIcon},function(t){v=t.BaseView}],execute:function(){i._RF.push({},"d3d2eqexDZFjoXvRCG822eX","ActivityPoolPartyOperateView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).tabList=void 0,e.curIndex=void 0,e.itemId=void 0,e.sendPrivateTxt=void 0,e.sendChannelTxt=void 0,e.item=void 0,e.cardName=void 0,e.haveNum=void 0,e.times=void 0,e.isTimesEnough=void 0,e.isRecTimeEnough=void 0,e.name="ActivityPoolPartyOperateView",e.url="ui/module/activityPoolParty/ActivityPoolPartyOperateView",e}e(i,t);var v=i.prototype;return v.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var i=this.findChild("btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()})),this.tabList=[];for(var g=function(e){var i={itemGo:t.findChild("select/item"+(e+1)),select:t.findChild("select/item"+(e+1)+"/select")};t.addComponentCallbackListener(i.itemGo,n.EventType.CLICK,(function(){t.RefreshSelectItem(e)})),t.tabList[e]=i},m=0;m<2;m++)g(m);this.item=this.findChildComponent("itemNode/itemIcon",o),this.times=this.findChildComponent("times",a),this.haveNum=this.findChildComponent("haveNum",s),this.cardName=this.findChildComponent("itemNode/name/Label",a);var v=this.findChild("sendPrivateBtn");this.addComponentCallbackListener(v,n.EventType.CLICK,(function(){var e=IS(c).GetActivityInfo(h.PoolPartyPuzzle);if(e&&e.state!=f.EndShow)if(0==t.curIndex){if(IS(d).getGoodsCountByGoodsGtid(t.itemId)<=1)return void l.showFlyTip(GetLanguage(201740));uiMgr.openView("ActivityPoolPartyCardSendView",t.itemId,1)}else{if(!t.isRecTimeEnough)return void l.showFlyTip(GetLanguage(201781));uiMgr.openView("ActivityPoolPartyCardSendView",t.itemId,2)}else l.showFlyTip(GetLanguage(200026))}));var y=this.findChild("sendChannelBtn");this.addComponentCallbackListener(y,n.EventType.CLICK,(function(){var e=IS(c).GetActivityInfo(h.PoolPartyPuzzle);if(e&&e.state!=f.EndShow)if(0==t.curIndex){if(IS(d).getGoodsCountByGoodsGtid(t.itemId)<=1)return void l.showFlyTip(GetLanguage(201740));var i=configGoods.getDataByKey(t.itemId),n=r.formatStrWithMirrorDeal(GetLanguage(200751),i.name);l.showBoxTip({tip:n,title:GetLanguage(200048),func:function(e){"type_yes"==e&&IS(u).send_collect_send(h.PoolPartyPuzzle,t.itemId,2,0,0)}})}else{if(!t.isRecTimeEnough)return void l.showFlyTip(GetLanguage(201781));var o=configGoods.getDataByKey(t.itemId),a=r.formatStrWithMirrorDeal(GetLanguage(200771),o.name);l.showBoxTip({tip:a,title:GetLanguage(200048),func:function(e){"type_yes"==e&&IS(u).send_collect_ask(h.PoolPartyPuzzle,t.itemId,0,0)}})}else l.showFlyTip(GetLanguage(200026))})),this.sendPrivateTxt=this.findChildComponent("sendPrivateBtn/Label",a),this.sendChannelTxt=this.findChildComponent("sendChannelBtn/Label",a)},v.RefreshSelectItem=function(t){if(this.curIndex!=t){for(var e=0;e<this.tabList.length;e++)this.tabList[e].select.active=t==e;this.curIndex=t,this.sendPrivateTxt.string=0==this.curIndex?GetLanguage(200787):GetLanguage(200789),this.sendChannelTxt.string=0==this.curIndex?GetLanguage(200788):GetLanguage(200790),this.updateInfo()}},v.registerUpdateHandler=function(){this.addEvent(g.OnActivityCollectInfo,this.updateInfo,this)},v.onAfterOpen=function(){this.itemId=this.openArgs[0];var t=configGoods.getDataByKey(this.itemId);this.loadIcon(this.item,"act_poolparty_puzzle",m[this.itemId]),this.cardName.string=t.name,this.RefreshSelectItem(0),this.updateInfo()},v.onBeforeClose=function(){},v.onDestroy=function(){},v.updateInfo=function(){var t,e=IS(c).getCollectInfo(h.PoolPartyPuzzle),i=IS(d).getGoodsCountByGoodsGtid(this.itemId),n="";n=i>1?r.formatStrWithMirrorDeal(GetLanguage(700030187),i,r.formatStrWithMirrorDeal(GetLanguage(200791),i-1)):i>0?r.formatStrWithMirrorDeal(GetLanguage(700030188),i):r.formatStrWithMirrorDeal(GetLanguage(700030189),i),this.haveNum.string=r.formatStrWithMirrorDeal(GetLanguage(700030190),r.formatStrWithMirrorDeal(GetLanguage(200792),n));var o,a=IS(c).GetActivityInfo(h.PoolPartyPuzzle);a&&a.state!=f.EndShow?this.times.string=r.formatStrWithMirrorDeal(GetLanguage(204404),Math.max(0,null!=(o=e.recv_times)?o:0)):this.times.string="";this.isRecTimeEnough=(null!=(t=e.recv_times)?t:0)>0},v.updateTask=function(){},i}(v));i._RF.pop()}}}));

