System.register("chunks:///_virtual/GuildControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigGlobal.ts","./MessageView.ts","./ControlMgr.ts","./RoleDataCache.ts","./GuildDataCache.ts","./GuildDefine.ts"],(function(e){"use strict";var n,t,i,d,_,a,u,l,s;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy},function(e){i=e.ConfigGlobal},function(e){d=e.default},function(e){_=e.controlMgr},function(e){a=e.RoleDataCache},function(e){u=e.default},function(e){l=e.GuildEventDefine,s=e.RoleUpdateFlag}],execute:function(){t._RF.push({},"38b83xrhmVENoY+bvJsDgcI","GuildControl",void 0);e("default",function(){var e=t.prototype;function t(){netManager.addEventListener("guild.guild_info_s2c",this.update_29_1,this),netManager.addEventListener("guild.guild_create_s2c",this.update_29_2,this),netManager.addEventListener("guild.guild_search_s2c",this.update_29_3,this),netManager.addEventListener("guild.guild_join_s2c",this.update_29_4,this),netManager.addEventListener("guild.guild_setting_s2c",this.update_29_6,this),netManager.addEventListener("guild.guild_apply_s2c",this.update_29_7,this),netManager.addEventListener("guild.guild_approve_s2c",this.update_29_8,this),netManager.addEventListener("guild.guild_kick_out_s2c",this.update_29_9,this),netManager.addEventListener("guild.guild_quit_s2c",this.update_29_11,this),netManager.addEventListener("guild.guild_dissolve_s2c",this.update_29_12,this),netManager.addEventListener("guild.guild_change_career_s2c",this.update_29_13,this),netManager.addEventListener("guild.guild_info_update_s2c",this.update_29_14,this),netManager.addEventListener("guild.guild_members_change_s2c",this.update_29_15,this),netManager.addEventListener("guild.guild_members_info_s2c",this.update_29_16,this),netManager.addEventListener("guild.guild_donate_s2c",this.update_29_17,this),netManager.addEventListener("guild.guild_apply_list_s2c",this.update_29_18,this),netManager.addEventListener("guild.guild_resource_change_s2c",this.update_29_19,this),netManager.addEventListener("guild.guild_rank_info_s2c",this.update_29_20,this),netManager.addEventListener("guild.guild_rank_my_info_s2c",this.update_29_21,this),netManager.addEventListener("guild.guild_question_s2c",this.update_29_22,this),netManager.addEventListener("guild.guild_question_rank_s2c",this.update_29_23,this),netManager.addEventListener("guild.guild_area_enter_s2c",this.update_29_24,this),netManager.addEventListener("guild.guild_area_exit_s2c",this.update_29_25,this),netManager.addEventListener("guild.guild_area_move_s2c",this.update_29_26,this),netManager.addEventListener("guild.guild_area_broadcast_s2c",this.update_29_27,this),netManager.addEventListener("guild.guild_help_info_s2c",this.update_29_28,this),netManager.addEventListener("guild.guild_help_ask_s2c",this.update_29_29,this),netManager.addEventListener("guild.guild_help_s2c",this.update_29_30,this),netManager.addEventListener("guild.guild_help_change_s2c",this.update_29_31,this),netManager.addEventListener("guild.guild_help_status_s2c",this.update_29_32,this),netManager.addEventListener("guild.guild_treasure_info_s2c",this.update_29_35,this),netManager.addEventListener("guild.guild_treasure_open_s2c",this.update_29_36,this),netManager.addEventListener("guild.guild_dice_start_s2c",this.update_29_33,this),netManager.addEventListener("guild.guild_dice_point_s2c",this.update_29_34,this),netManager.addEventListener("guild.guild_schedule_s2c",this.update_29_37,this),netManager.addEventListener("guild.guild_log_s2c",this.update_29_38,this),_.addControl(this)}return e.clear=function(){},e.onLogin=function(){this.send_29_24(IS(u).enterPos,1)},e.onReconnect=function(){IS(a).HasGuild()&&this.send_29_24(IS(u).enterPos,1)},e.send_29_1=function(e){netManager.send("guild.guild_info_c2s",{guild_id:e})},e.update_29_1=function(e){var n=IS(a).GetGuildId();e.guild_info.guild_id==n?IS(u).UpdateGuildInfo(e.guild_info):uiMgr.openView("GuildInfoView",e.guild_info)},e.send_29_2=function(e){netManager.send("guild.guild_create_c2s",{name:e})},e.update_29_2=function(e){0==e.code&&(d.showFlyTip(GetLanguage(200322)),uiMgr.close("GuildCreateView")),IS(u).UpdateGuildInfo(e.guild_info)},e.send_29_3=function(e,n,t){netManager.send("guild.guild_search_c2s",{type:e,search_key:n,page:t})},e.update_29_3=function(e){IS(u).SetGuildList(e)},e.send_29_4=function(e){netManager.send("guild.guild_join_c2s",{guild_id:e})},e.update_29_4=function(e){IS(u).UpdateJoin(e)},e.send_29_5=function(){netManager.send("guild.guild_quick_join_c2s",{})},e.send_29_6=function(e,n,t,i){n||(n=0),t||(t=""),netManager.send("guild.guild_setting_c2s",{k:e,v:n,s:t,l:i})},e.update_29_6=function(e){},e.send_29_7=function(e){netManager.send("guild.guild_apply_c2s",{guild_id:e})},e.update_29_7=function(e){IS(u).SetGuildApplyList(e)},e.send_29_8=function(e,n){netManager.send("guild.guild_approve_c2s",{apply_uid:e,type:n})},e.update_29_8=function(e){IS(u).UpdateApprove(e)},e.send_29_9=function(e){netManager.send("guild.guild_kick_out_c2s",{role_id:e})},e.update_29_9=function(e){IS(u).RemoveGuildMember(e),uiMgr.close("GuildMemberView")},e.send_29_11=function(){netManager.send("guild.guild_quit_c2s",{})},e.update_29_11=function(e){IS(u).QuitGuild(),uiMgr.close("GuildView")},e.send_29_12=function(){netManager.send("guild.guild_dissolve_c2s",{})},e.update_29_12=function(e){},e.send_29_13=function(e,n){netManager.send("guild.guild_change_career_c2s",{role_id:e,career:n})},e.update_29_13=function(e){uiMgr.close("GuildMemberView")},e.update_29_14=function(e){IS(u).UpdateGuildInfoAdd(e)},e.update_29_15=function(e){IS(u).UpdateMemberInfo(e)},e.send_29_16=function(e){netManager.send("guild.guild_members_info_c2s",{guild_id:e})},e.update_29_16=function(e){normalEvent.emit(l.GUILD_MEMBER_INFO,e)},e.send_29_17=function(){netManager.send("guild.guild_donate_c2s",{})},e.update_29_17=function(e){d.showFlyTip(GetLanguage(200323)),IS(u).UpdateDonate(e),IS(u).GetDonateNum()>=i.guild_donate_cost.length?uiMgr.close("GuildDonateView"):normalEvent.emit(l.GUIDE_UPATE_DONATEBTN)},e.send_29_18=function(){netManager.send("guild.guild_apply_list_c2s",{})},e.update_29_18=function(e){IS(u).UpdateSelfApplyList(e)},e.update_29_19=function(e){IS(u).UpdateGuildRes(e)},e.send_29_20=function(e,n,t){void 0===t&&(t=0),netManager.send("guild.guild_rank_info_c2s",{rank_type:e,page:n,guild_id:t})},e.update_29_20=function(e){var n=IS(a).GetGuildId();0!=e.guild_id&&e.guild_id==n&&(IS(u).SetGuildRankList(e),1==e.rank_type?uiMgr.openView("SingleRankView",e):2==e.rank_type&&uiMgr.openView("MultiRankView",e))},e.send_29_21=function(e){netManager.send("guild.guild_rank_my_info_c2s",{rank_type:e})},e.update_29_21=function(e){uiMgr.openView("SingleEnterView",e)},e.send_29_22=function(){netManager.send("guild.guild_question_c2s",{})},e.update_29_22=function(e){IS(u).SetGuildQuestion(e)},e.update_29_23=function(e){IS(u).SetGuildQuestionRank(e)},e.send_29_24=function(e,n){e.x=Math.floor(e.x),e.y=Math.floor(e.y),netManager.send("guild.guild_area_enter_c2s",{pos:e,break:n})},e.update_29_24=function(e){var t=e.member_list,i=IS(u);i.roleMap={};for(var d,_=n(t);!(d=_()).done;){var a=d.value;i.roleMap[a.role_id]=a}i.clearRoleActions(),i.roleUpdateFlag=s.All},e.send_29_25=function(){netManager.send("guild.guild_area_exit_c2s",{})},e.update_29_25=function(e){},e.send_29_26=function(e){e.forEach((function(e){e.x=Math.floor(e.x),e.y=Math.floor(e.y)})),netManager.send("guild.guild_area_move_c2s",{pos_list:e})},e.update_29_26=function(e){},e.update_29_27=function(e){var n=IS(u);if(1==e.type)n.roleUpdateFlag=s.Add,n.roleActions[s.Add].add(e.action_member.role_id),n.roleActions[s.Move].delete(e.action_member.role_id),n.roleActions[s.Del].delete(e.action_member.role_id),n.roleActions[s.Break].delete(e.action_member.role_id),n.roleMap[e.action_member.role_id]=e.action_member;else if(2==e.type){if(!n.roleMap[e.action_member.role_id])return;n.roleUpdateFlag|=s.Break,n.roleMap[e.action_member.role_id].break=e.action_member.break,n.roleActions[s.Break].add(e.action_member.role_id)}else if(3==e.type){if(!n.roleMap[e.action_member.role_id])return;if(e.action_member.role_id==IS(a).GetRoleId())return;n.roleUpdateFlag|=s.Move,n.roleActions[s.Move].add(e.action_member.role_id),n.roleMap[e.action_member.role_id].pos_list=e.pos_list}else if(4==e.type){if(!n.roleMap[e.action_member.role_id])return;n.roleUpdateFlag|=s.Del,delete n.roleMap[e.action_member.role_id],n.roleActions[s.Del].add(e.action_member.role_id),n.roleActions[s.Move].delete(e.action_member.role_id),n.roleActions[s.Add].delete(e.action_member.role_id),n.roleActions[s.Break].delete(e.action_member.role_id)}},e.send_29_28=function(e){netManager.send("guild.guild_help_info_c2s",{type:e})},e.update_29_28=function(e){IS(u).UpdateGuildHelpList(e)},e.send_29_29=function(e,n){netManager.send("guild.guild_help_ask_c2s",{type:e,sub_type:n})},e.update_29_29=function(e){d.showFlyTip(GetLanguage(200324))},e.send_29_30=function(e){netManager.send("guild.guild_help_c2s",{help_id:e})},e.update_29_30=function(e){IS(u).UpdateDailyHelp(e)},e.update_29_31=function(e){IS(u).UpdateGuildHelp(e)},e.send_29_32=function(){netManager.send("guild.guild_help_status_c2s",{})},e.update_29_32=function(e){IS(u).UpdateGuildHelpState(e)},e.update_29_35=function(e){for(var t,i=IS(u).boxMap,d=n(e.box_list);!(t=d()).done;){var _=t.value;i[_.n]=_,i[_.n].round=e.round}var a=[];for(var s in i){for(var r,o=!1,g=n(e.box_list);!(r=g()).done;){var c=r.value;c.n==Number(s)&&(o=!0,i[c.n]=c,i[c.n].round=e.round)}o||a.push(s)}for(var p=0,f=a;p<f.length;p++){delete i[f[p]]}IS(u).boxInfo=e,normalEvent.emit(l.GUILD_BOX_SHOW)},e.send_29_36=function(e){null!=e&&netManager.send("guild.guild_treasure_open_c2s",{n:e.n,round:e.round})},e.update_29_36=function(e){var n=IS(u).boxMap;n[e.n]&&(delete n[e.n],normalEvent.emit(l.GUILD_BOX_SHOW))},e.send_29_33=function(){netManager.send("guild.guild_dice_start_c2s",{})},e.update_29_33=function(e){IS(u).UpdateGuildDiceTime(e)},e.send_29_34=function(){netManager.send("guild.guild_dice_point_c2s",{})},e.update_29_34=function(e){IS(u).UpdateGuildDiceResult(e)},e.update_29_37=function(e){IS(u).act_list={};for(var t,i=n(e.schedules);!(t=i()).done;){var d=t.value;IS(u).act_list[d.k]=d.v}normalEvent.emit(l.GUILD_ACT_INFO_UPDATE)},e.send_29_38=function(e){netManager.send("guild.guild_log_c2s",{guild_log_id:e})},e.update_29_38=function(e){IS(u).UpdateGuildLog(e)},t}());t._RF.pop()}}}));

