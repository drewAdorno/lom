System.register("chunks:///_virtual/CircleOfFriendsDynamicMainMessageItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./TranslateTips.ts","./UIList.ts","./LabelUtil.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./ConfigGlobal.ts","./RoleDataCache.ts","./CircleOfFriendsControl.ts","./CircleOfFriendsDefine.ts"],(function(e){"use strict";var t,i,n,o,a,m,s,d,h,c,r,l,f,p,v,C,I,g,u,L,T;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.UITransform,o=e.Button,a=e.Label,m=e.sys,s=e.Widget,d=e.Sprite,h=e.RichText,c=e.js},function(e){r=e.TranslateTips},function(e){l=e.ListItem},function(e){f=e.LabelUtil},function(e){p=e.default},function(e){v=e.default},function(e){C=e.default},function(e){I=e.ConfigGlobal},function(e){g=e.RoleDataCache},function(e){u=e.default},function(e){L=e.CircleOfFriendsEvent,T=e.CircleOfFriendsDefine}],execute:function(){i._RF.push({},"de30erVZWhOia+HFPhjTi7+","CircleOfFriendsDynamicMainMessageItem",void 0);e("CircleOfFriendsDynamicMainMessageItem",function(e){function i(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).mainInfo=void 0,t.commentInfo=void 0,t.name=void 0,t.time=void 0,t.posNode=void 0,t.posName=void 0,t.official=void 0,t.gmIcon=void 0,t.headImg=void 0,t.imgHeadFrame=void 0,t.attentionBtn=void 0,t.operateBtn=void 0,t.attentionNormal=void 0,t.attentionActive=void 0,t.attentionTxt=void 0,t.isTempItem=void 0,t.content=void 0,t.contenTrans=void 0,t.picWidge=void 0,t.picIcon=void 0,t.isLike=void 0,t.emptyLike=void 0,t.likeNum=void 0,t.commentNum=void 0,t.operateListWidge=void 0,t.translateTips=void 0,t.commentName=void 0,t.commentOfficial=void 0,t.commentGmIcon=void 0,t.commentHeadImg=void 0,t.commentImgHeadFrame=void 0,t.commentLikeBtn=void 0,t.commentIsLike=void 0,t.commentEmptyLike=void 0,t.commentLikeNum=void 0,t.commentTime=void 0,t.commentContent=void 0,t.commentline=void 0,t.commentOperateBtn=void 0,t.commentTranslateTips=void 0,t}t(i,e);var l=i.prototype;return l.onInit=function(){var e=this;if(this.mainInfo=p.findChild(this.node,"mainInfo"),this.commentInfo=p.findChildComponent(this.node,"comment",n),this.view.addComponentCallbackListener(p.findChild(this.node,"mainInfo/playerInfo/head"),o.EventType.CLICK,(function(){0!=e.data.role_id&&normalEvent.emit(L.OpenChildView,T.ViewType.OtherPanel,[e.data.role_id])})),this.name=p.findChildComponent(this.node,"mainInfo/playerInfo/name",a),this.time=p.findChildComponent(this.node,"mainInfo/playerInfo/time",a),this.posNode=p.findChild(this.node,"mainInfo/playerInfo/time/pos"),m.uiMirror){var t=p.findChildComponent(this.node,"mainInfo/playerInfo/time/pos",s),i=t.right;t.isAlignRight=!1,t.isAlignLeft=!0,t.left=i,t.node.setScale(-1,1,1)}this.posName=p.findChildComponent(this.node,"mainInfo/playerInfo/time/pos/name",a),this.attentionBtn=p.findChild(this.node,"mainInfo/playerInfo/attentionBtn"),this.attentionNormal=p.findChild(this.node,"mainInfo/playerInfo/attentionBtn/normal"),this.attentionActive=p.findChild(this.node,"mainInfo/playerInfo/attentionBtn/active"),this.attentionTxt=p.findChildComponent(this.node,"mainInfo/playerInfo/attentionBtn/Label",a),this.view.addComponentCallbackListener(this.attentionBtn,o.EventType.CLICK,(function(){1==e.data.state||3==e.data.state||IS(u).sendToSubscrib(e.data.role_id,1)})),this.operateBtn=p.findChild(this.node,"mainInfo/playerInfo/operateBtn"),this.view.addComponentCallbackListener(this.operateBtn,o.EventType.CLICK,(function(){uiMgr.openView("CircleOfFriendsOperateView",e.operateBtn,e.data.id)})),this.official=p.findChild(this.node,"mainInfo/playerInfo/name/official"),this.gmIcon=p.findChild(this.node,"mainInfo/playerInfo/head/gmIcon"),this.headImg=p.findChildComponent(this.node,"mainInfo/playerInfo/head/image",d),this.imgHeadFrame=p.findChildComponent(this.node,"mainInfo/playerInfo/head/imgHeadFrame",d),this.content=p.findChildComponent(this.node,"mainInfo/content",h),this.contenTrans=p.findChildComponent(this.node,"mainInfo/content",n),this.picWidge=p.findChildComponent(this.node,"mainInfo/pic",s),this.view.addComponentCallbackListener(this.picWidge.node,o.EventType.CLICK,(function(){uiMgr.openView("CircleOfFriendsPicCheckView",e.picIcon.spriteFrame)})),this.picIcon=p.findChildComponent(this.node,"mainInfo/pic/mask/default",d),this.isLike=p.findChild(this.node,"mainInfo/operateList/likeBtn/isLike"),this.emptyLike=p.findChild(this.node,"mainInfo/operateList/likeBtn/empty"),this.likeNum=p.findChildComponent(this.node,"mainInfo/operateList/likeBtn/num",a),this.view.addComponentCallbackListener(p.findChild(this.node,"mainInfo/operateList/likeBtn"),o.EventType.CLICK,(function(){IS(u).sendToPostMomentLike(e.data.id,1==e.data.is_like?2:1)})),this.commentNum=p.findChildComponent(this.node,"mainInfo/operateList/commentBtn/num",a),this.operateListWidge=p.findChildComponent(this.node,"mainInfo/operateList",s),this.view.addComponentCallbackListener(p.findChild(this.node,"mainInfo/operateList/commentBtn"),o.EventType.CLICK,(function(){e.view.ClickInput()})),this.translateTips=new r(this.view,p.findChild(this.node,"mainInfo/operateList/translateBtn")),this.commentName=p.findChildComponent(this.node,"comment/playerInfo/name",a),this.commentOfficial=p.findChild(this.node,"comment/playerInfo/name/official"),this.commentGmIcon=p.findChild(this.node,"comment/playerInfo/head/gmIcon"),this.commentHeadImg=p.findChildComponent(this.node,"comment/playerInfo/head/image",d),this.commentImgHeadFrame=p.findChildComponent(this.node,"comment/playerInfo/head/imgHeadFrame",d),this.commentLikeBtn=p.findChild(this.node,"comment/likeBtn"),this.view.addComponentCallbackListener(this.commentLikeBtn,o.EventType.CLICK,(function(){var t=1==e.data.is_like?2:1;IS(u).sendToPostDiscussLike(e.view.dynamicData.id,e.data.id,t)})),this.view.addComponentCallbackListener(p.findChild(this.node,"comment/playerInfo/head"),o.EventType.CLICK,(function(){0!=e.data.role_id&&e.data.role_id!=IS(g).GetRoleId()&&normalEvent.emit(L.OpenChildView,T.ViewType.OtherPanel,[e.data.role_id])})),this.commentIsLike=p.findChild(this.node,"comment/likeBtn/isLike"),this.commentEmptyLike=p.findChild(this.node,"comment/likeBtn/empty"),this.commentLikeNum=p.findChildComponent(this.node,"comment/likeBtn/num",a),this.commentTime=p.findChildComponent(this.node,"comment/playerInfo/time",a),this.commentContent=p.findChildComponent(this.node,"comment/content",a),this.commentline=p.findChild(this.node,"comment/line"),this.commentOperateBtn=p.findChild(this.node,"comment/playerInfo/operateBtn"),this.view.addComponentCallbackListener(this.commentOperateBtn,o.EventType.CLICK,(function(){uiMgr.openView("CircleOfFriendsOperateView",e.commentOperateBtn,e.view.dynamicData.id,e.data.id)})),this.commentTranslateTips=new r(this.view,p.findChild(this.node,"comment/translateBtn"))},l.onRender=function(e,t){var i=e;if(i.moment){if(this.mainInfo.active=!0,this.commentInfo.node.active=!1,0==i.role_id?(this.name.string=GetLanguage(I.circle_official_name_id),this.official.active=!0,this.gmIcon.active=!0,this.headImg.node.active=!1):(this.headImg.node.active=!0,this.name.string=v.GetServNameById(i.server_id)+i.name,this.official.active=!1,this.gmIcon.active=!1,this.view.loadRemoteIcon(i.head_url,this.headImg)),i.area1&&i.area1>0){this.posNode.active=!0;var n=configCircle_location.getDataByKey(i.area1);this.posName.string=n.name}else this.posNode.active=!1;if(this.time.string=C.getDateDiff(i.time),i.role_id==IS(g).GetRoleId()||0==e.role_id)this.attentionBtn.active=!1,this.operateBtn.active=i.role_id==IS(g).GetRoleId();else{this.attentionBtn.active=!0,this.operateBtn.active=!1;var o=1==i.state||3==i.state;this.attentionNormal.active=!o,this.attentionActive.active=o,this.attentionTxt.string=o?GetLanguage(300127):GetLanguage(300128)}var a=i.head_frame;if(a>0){this.imgHeadFrame.node.active=!0;var m=configAvatar_frame.getDataByKey(a);this.view.loadIcon(this.imgHeadFrame,"icon_frame",m.icon)}else this.imgHeadFrame.node.active=!1;this.translateTips.SetTranslateInfo("CircleOfFriend",i.id,i.moment);var s=this.translateTips.GetShowContent();this.content.string=c.formatStr("<color=#544231>%s</color>",s);var d=99+this.contenTrans.height;e.photo&&""!=e.photo?(this.picWidge.top=d,d+=266,this.picWidge.node.active=!0,this.view.loadRemoteIcon(e.photo,this.picIcon)):(this.picWidge.node.active=!1,d+=5),this.operateListWidge.top=d,this.isLike.active=1==i.is_like,this.emptyLike.active=0==i.is_like,this.likeNum.string=i.like_num,this.commentNum.string=i.discuss_num}else{this.mainInfo.active=!1,this.commentInfo.node.active=!0,this.commentName.string=i.name;var h=i.head_frame,r=IS(g).GetRoleId();if(this.commentOperateBtn.active=this.view.dynamicData.role_id==r||this.data.role_id==r,h>0){this.commentImgHeadFrame.node.active=!0;var l=configAvatar_frame.getDataByKey(h);this.view.loadIcon(this.commentImgHeadFrame,"icon_frame",l.icon)}else this.commentImgHeadFrame.node.active=!1;0==i.role_id?(this.commentName.string=i.name,this.commentOfficial.active=!0,this.commentGmIcon.active=!0,this.commentHeadImg.node.active=!1):(this.commentName.string=v.GetServNameById(i.server_id)+i.name,this.commentOfficial.active=!1,this.commentGmIcon.active=!1,this.view.loadRemoteIcon(i.head_url,this.commentHeadImg)),this.commentTranslateTips.SetTranslateInfo("CircleOfFriend",i.id,i.discuss);var p=this.commentTranslateTips.GetShowContent();this.commentContent.string=p;var u=f.measureSize(this.commentContent),L=94;u.width>=380&&u.height<=40.32?L+=80.32:u.height>40.32?L+=u.height+40:L+=u.height,this.commentInfo.height=L,this.commentIsLike.active=1==i.is_like,this.commentEmptyLike.active=0==i.is_like,this.commentLikeNum.string=i.like_num,this.commentTime.string=C.getDateDiff(i.time),this.commentline.active=t!=this.view.list.length-1}},l.CalcHeight=function(e){var t=e,i=0;if(t.moment){this.translateTips.SetTranslateInfo("CircleOfFriend",t.id,t.moment);var n=this.translateTips.GetShowContent();i=99,this.content.string=c.formatStr("<color=#544231>%s</color>",n),i+=this.contenTrans.height,e.photo&&""!=e.photo?i+=266:i+=5,i+=36,i+=10}else{this.commentTranslateTips.SetTranslateInfo("CircleOfFriend",t.id,t.discuss);var o=this.commentTranslateTips.GetShowContent();this.commentContent.string=o;var a=f.measureSize(this.commentContent);i=94,a.width>=380&&a.height<=40.32?i+=80.32:a.height>40.32?i+=a.height+40:i+=a.height}return i},l.GetShowContent=function(e){var t=e;return t.moment?(this.translateTips.SetTranslateInfo("CircleOfFriend",t.id,t.moment),this.translateTips.GetShowContent()):(this.commentTranslateTips.SetTranslateInfo("CircleOfFriend",t.id,t.discuss),this.commentTranslateTips.GetShowContent())},i}(l));i._RF.pop()}}}));

