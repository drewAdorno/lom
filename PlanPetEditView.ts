System.register("chunks:///_virtual/PlanPetEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./index57.ts","./ConfigGlobal.ts","./MainViewModel.ts","./PetModel.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,n,i,o,a,s,d,l,c,r,f,u,h,m,I,p,v;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,i=t.Button,o=t.UITransform,a=t.Vec3,s=t.js,d=t.Sprite,l=t.Label},function(t){c=t.default},null,function(t){r=t.ConfigGlobal},function(t){f=t.MainViewModel},function(t){u=t.PetModel},function(t){h=t.default},function(t){m=t.RoleDataCache},function(t){I=t.RoleEventDefine},function(t){p=t.PanelTabType},function(t){v=t.BaseView}],execute:function(){n._RF.push({},"83b82UEk4JFNqUMD40ERiBM","PlanPetEditView",void 0);var C=r.pet_tab_num;t("default",function(t){function n(){var e;return(e=t.call(this)||this).infoItems=[],e.curPlanId=void 0,e.nodeItem=void 0,e.nodeContent=void 0,e.utContent=void 0,e.name="PlanPetEditView",e.url="ui/module/role/PlanPetEditView",e}e(n,t);var r=n.prototype;return r.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,i.EventType.CLICK,(function(){t.close()}));var n=this.findChild("content/btnGoTo");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){IS(f).TryJumpToMainViewPanel(p.Main_Partner),t.close(),uiMgr.close("RolePlanView"),uiMgr.close("DoubleChapterMainView")})),this.nodeContent=this.findChild("content/scroll/view/content"),this.utContent=this.nodeContent.getComponent(o),this.nodeItem=this.findChild("content/scroll/view/content/petRoot"),this.nodeItem.active=!1;for(var a=function(e){var n=nodeInstantiate.instantiate(t.nodeItem);n.parent=t.nodeContent,n.active=!0;var o=c.findChild(n,"btnSwitch");t.addComponentCallbackListener(o,i.EventType.CLICK,(function(){IS(h).send_role_update_plan_c2s(t.curPlanId,[{k:3,v:e}])}));for(var a=[],r=1;r<=5;r++){var f=c.findChild(n,s.formatStr("wearParent/item%s",r));a.push({node:f,pos:r,nodeLock:c.findChild(f,"imgLock"),nodeEmpty:c.findChild(f,"btnWear"),nodeWear:c.findChild(f,"nodeWear"),imgFrame:f.getComponent(d),imgIcon:c.findChildComponent(f,"nodeWear/imgIcon",d),txtLevel:c.findChildComponent(f,"nodeWear/txtLevel",l)})}t.infoItems.push({nodePetRoot:n,txtName:c.findChildComponent(n,"name/txtName",l),nodeCur:c.findChild(n,"nodeCur"),btnSwitch:o,tabId:e,petItems:a})},r=1;r<=C;r++)a(r);this.utContent.height=8+160.96*C+20*(C-1)},r.registerUpdateHandler=function(){this.addEvent(I.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(I.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this)},r.onAfterOpen=function(){this.nodeContent.setPosition(new a(0,0,0)),this.curPlanId=this.openArgs[0],this.updateContent()},r.updateContent=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSingleInfo(this.infoItems[t]),this.updateSelect(this.infoItems[t])},r.updateSingleInfo=function(t){t.txtName.string=IS(u).getTabName(t.tabId);for(var e=IS(u).getTabInfo(t.tabId),n=e?e.pos_info:[],i={},o=0;o<n.length;o++)i[n[o].k]=n[o].v;for(var a=0;a<t.petItems.length;a++){var d=t.petItems[a],l=d.pos;if(d.nodeLock.active=!1,d.nodeEmpty.active=!1,d.nodeWear.active=!1,1==IS(u).checkPosUnlock(l)){d.imgFrame.grayscale=!1;var c=i[l];if(c&&0!=c){var r=IS(u).getPetInfoByPetId(c),f=configPet.getDataByKey(c);this.loadIcon(d.imgFrame,"icon_pet",configColor.getDataByKey(f.quality).path),this.loadIcon(d.imgIcon,"icon_pet",f.icon),d.nodeWear.active=!0;var h=r.level;d.txtLevel.string=s.formatStr("Lv.%s",h)}else this.loadIcon(d.imgFrame,"icon_pet","zjm_ui_pinzhikuangbai"),d.nodeEmpty.active=!0}else d.nodeLock.active=!0,this.loadIcon(d.imgFrame,"icon_pet","zjm_ui_pinzhikuangbai"),d.imgFrame.grayscale=!0}},r.updateSelect=function(t){for(var e,n=IS(m).planIdToInfo[this.curPlanId].detail,i=0;i<n.length;i++)if(3==n[i].k){e=n[i].v;break}t.nodeCur.active=t.tabId==e,t.btnSwitch.active=t.tabId!=e},r.OnPlanInfoBack=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSelect(this.infoItems[t])},r.onPlanInfoUpdate=function(t){if(t==this.curPlanId)for(var e=0;e<this.infoItems.length;e++)this.updateSelect(this.infoItems[e])},r.onBeforeClose=function(){},r.onDestroy=function(){},n}(v));n._RF.pop()}}}));

