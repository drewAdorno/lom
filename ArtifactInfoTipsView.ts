System.register("chunks:///_virtual/ArtifactInfoTipsView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./ChatDefine.ts","./ArtifactControl.ts","./ArtifactDataCache.ts","./ArtifactDefine.ts","./ArtifactRefinedView.ts","./BasePopupView.ts"],(function(t){"use strict";var e,i,n,o,s,a,h,r,d,c,g,l,f,v,m,u,p,C,I,w;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.UITransform,s=t.ScrollView,a=t.Node,h=t.math,r=t.Label,d=t.Sprite,c=t.Button,g=t.Vec3,l=t.Color},null,function(t){f=t.ChatDefine},function(t){v=t.default},function(t){m=t.ArtifactDataCache},function(t){u=t.ArtifactEvent,p=t.posToRotation,C=t.numToRoman},function(t){I=t.ArtifactGemAttrItem},function(t){w=t.BasePopupView}],execute:function(){n._RF.push({},"f70f9R7og5PRrB2CF8VuyNf","ArtifactInfoTipsView",void 0);t("default",function(t){function n(){var e;return(e=t.call(this)||this).txtName=void 0,e.bgNode=void 0,e.bgUT=void 0,e.viewContainerNode=void 0,e.arrNode=void 0,e.targetNode=void 0,e.showID=void 0,e.pos=void 0,e.txtSuit1=void 0,e.txtSuit2=void 0,e.attrScroll=void 0,e.txtLevel=void 0,e.imgFrame=void 0,e.imgIcon=void 0,e.imgLock=void 0,e.imgUnlock=void 0,e.btnShare=void 0,e.btnWear=void 0,e.btnReplace=void 0,e.btnTake=void 0,e.btnGen=void 0,e.btnLock=void 0,e.using=void 0,e.showBtnNode=void 0,e.name="ArtifactInfoTipsView",e.url="ui/module/artifact/ArtifactInfoTipsView",e}e(n,t);var w=n.prototype;return w.onInit=function(){var t=this;this.viewContainerNode=this.findChild("view"),this.bgNode=this.findChild("view/imgBg"),this.bgUT=this.bgNode.getComponent(o),this.arrNode=this.findChild("view/imgBg/imgArr");var e=this.findChildComponent("view/imgBg/nodeInfo/ScrollView",s);this.attrScroll=this.addUIList(e,I);var i=this.findChild("view/imgBg/nodeInfo");i.on(a.EventType.SIZE_CHANGED,(function(){var e=i.getComponent(o).contentSize;t.bgUT.contentSize=new h.Size(e.x,e.y+20),t.arrNode.getComponent(o).contentSize=new h.Size(e.x,e.y+20),t.UpdateAlign()})),this.txtName=this.findChildComponent("view/imgBg/nodeInfo/nodeName/name",r),this.txtLevel=this.findChildComponent("view/imgBg/nodeInfo/nodeName/level",r),this.txtSuit1=this.findChildComponent("view/imgBg/nodeInfo/nodeSuit/suit1",r),this.txtSuit2=this.findChildComponent("view/imgBg/nodeInfo/nodeSuit/suit2",r),this.imgFrame=this.findChildComponent("view/imgBg/nodeInfo/nodeName/imgFrame",d),this.imgIcon=this.findChildComponent("view/imgBg/nodeInfo/nodeName/imgFrame/imgIcon",d),this.btnWear=this.findChild("view/imgBg/nodeInfo/nodeBtn/btnWear"),this.addComponentCallbackListener(this.btnWear,c.EventType.CLICK,(function(){IS(v).reqGemWearInfo(t.pos,t.showID),t.close()})),this.btnShare=this.findChild("view/imgBg/nodeInfo/nodeBtn/btnShare"),this.addComponentCallbackListener(this.btnShare,c.EventType.CLICK,(function(){uiMgr.openView("ChatView",null,null,{contentType:f.ChatContentType.Share,linkType:f.ChatLinkType.ArtifactGemInfo,cacheData:{gemInfoStr:JSON.stringify(IS(m).getStoneInfoByID(t.showID).toObject())},showString:GetLanguage(201673)}),t.close()})),this.btnReplace=this.findChild("view/imgBg/nodeInfo/nodeBtn/btnReplace"),this.addComponentCallbackListener(this.btnReplace,c.EventType.CLICK,(function(){IS(v).reqGemWearInfo(t.pos,t.showID),t.close()})),this.btnTake=this.findChild("view/imgBg/nodeInfo/nodeBtn/btnTake"),this.addComponentCallbackListener(this.btnTake,c.EventType.CLICK,(function(){IS(v).reqGemWearInfo(t.pos,0),t.close()})),this.btnGen=this.findChild("view/imgBg/nodeInfo/nodeBtn/btnGen"),this.addComponentCallbackListener(this.btnGen,c.EventType.CLICK,(function(){uiMgr.openView("ArtifactGemUpgradeView",t.showID),t.close()})),this.btnLock=this.findChild("view/imgBg/nodeInfo/nodeName/lock"),this.imgLock=this.findChild("view/imgBg/nodeInfo/nodeName/lock/lock"),this.imgUnlock=this.findChild("view/imgBg/nodeInfo/nodeName/lock/unlock"),this.addComponentCallbackListener(this.btnLock,c.EventType.CLICK,(function(){IS(v).reqGemLock(t.showID)})),this.using=this.findChild("view/imgBg/nodeInfo/nodeBtn")},w.registerUpdateHandler=function(){this.addEvent(u.TYPE_ARTIFACT_GEM_INFO_UPDATE,this.refreshLockStatus)},w.onAfterOpen=function(){var e;t.prototype.onAfterOpen.call(this),this.showID=this.openArgs[0],this.targetNode=this.openArgs[1],this.showBtnNode=null!=(e=this.openArgs[2])?e:0,this.refreshStoneInfo(),this.UpdateAlign()},w.refreshStoneInfo=function(){var t=this.showID,e=IS(m).getStoneInfoByID(t);if(e){this.pos=e.pos;var n=configArtifact_gemquality.getDataByKey(e.quality).frame;this.loadIcon(this.imgFrame,"icon_gem",n);var s=configArtifact_gemsets.getDataByKey(e.suit);this.loadIcon(this.imgIcon,"icon_gem",s.icon),this.imgFrame.node.eulerAngles=new g(0,0,p[e.pos]);var a=configArtifact_gemsets.getDataByKey(e.suit);this.txtName.string=a.name+"Â·"+C[e.pos],this.txtLevel.string="Lv."+e.lv;var h=[];h.push({info:e.base_attr[0],type:1});for(var r,d=i(e.rand_attr);!(r=d()).done;){var c=r.value;h.push({info:c,type:2})}this.attrScroll.datas=h,this.attrScroll.node.getComponent(o).height=50*h.length,this.txtSuit1.string=GetLanguage(201495)+a.bonus2_desc,this.txtSuit2.string=GetLanguage(201496)+a.bonus4_desc;var f=IS(m).getStoneSuitInfo();this.txtSuit1.color=new l(134,123,114),this.txtSuit2.color=new l(134,123,114),f[e.suit]&&f[e.suit]>=2&&(this.txtSuit1.color=new l(49,95,20)),f[e.suit]&&f[e.suit]>=4&&(this.txtSuit2.color=new l(49,95,20)),this.btnShare.active=!1,this.btnWear.active=!1,this.btnReplace.active=!1,this.btnTake.active=!1,this.btnGen.active=!1;var v=configArtifact_gemquality.getDataByKey(e.quality).max_level;e.lv<v?this.btnGen.active=!0:this.btnShare.active=!0;var u=IS(m).pos_list[e.pos];u&&0!=u?this.btnReplace.active=!0:this.btnWear.active=!0,u==this.showID&&(this.btnWear.active=!1,this.btnReplace.active=!1,this.btnTake.active=!0),this.refreshLockStatus(),this.using.active=0!=this.showBtnNode}},w.refreshLockStatus=function(){var t=IS(m).getStoneInfoByID(this.showID);this.imgLock.active=1==t.is_lock,this.imgUnlock.active=1!=t.is_lock},w.onDestroy=function(){},w.UpdateAlign=function(){var t=this.GetAlignCenter(),e=t.posX,i=t.posY,n=t.angleX,o=t.angleY;this.viewContainerNode.setPosition(e,i),this.arrNode.setRotationFromEuler(n,o,0)},w.GetAlignCenter=function(){var t=this.targetNode.worldPosition,e=this.targetNode.getComponent(o),i=this.node.getComponent(o).convertToNodeSpaceAR(t),n=(i.x,this.bgUT.width,i.x,this.bgUT.width,0),s=0,a=0,h=0,r=0;return(n=i.x)>=0?(h=0,r=100):(h=180,r=-100),n-=r,i.y<0?(s=i.y+e.height/2+this.bgUT.height/2-12,a=0):(s=i.y-e.height/2-this.bgUT.height/2-24,a=180),{posX:n,posY:s,angleX:a,angleY:h}},n}(w));n._RF.pop()}}}));

