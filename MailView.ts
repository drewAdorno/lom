System.register("chunks:///_virtual/MailView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./BaseView.ts","./MailControl.ts","./MailDefine.ts","./MailModel.ts","./TimeUtil.ts","./FixMath.ts","./BagDefine.ts","./BagModel.ts","./GuildControl.ts"],(function(t){"use strict";var i,e,n,o,a,s,d,l,h,r,c,u,g,m,f,C,v,p,_,I;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.ScrollView,a=t.Sprite,s=t.Label,d=t.sys,l=t.js},function(t){h=t.SelectedType,r=t.ListItem},function(t){c=t.default},function(t){u=t.BaseView},function(t){g=t.default},function(t){m=t.MailDefine},function(t){f=t.MailModel},function(t){C=t.default},function(t){v=t.FixMath},function(t){p=t.ItemIdDefine},function(t){_=t.BagModel},function(t){I=t.default}],execute:function(){e._RF.push({},"f14a47+91JFVI02bb9SzOO6","MailView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).mailList=void 0,i.mailred=void 0,i.emptyNode=void 0,i.name="MailView",i.url="ui/module/mail/MailView",i}i(e,t);var a=e.prototype;return a.onInit=function(){var t=this,i=this.findChild("root/imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.onMaskClick()}));var e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.onMaskClick()}));var a=this.findChild("root/content/btnGetAll");this.addComponentCallbackListener(a,n.EventType.CLICK,(function(){IS(g).reqGetMailGood(0,0)}));var s=this.findChild("root/content/btnDelAll");this.addComponentCallbackListener(s,n.EventType.CLICK,(function(){IS(g).reqDelMail(0,0)}));this.findChild("root/content/mailList");var d=this.findChildComponent("root/content/mailList",o);this.mailList=this.addUIList(d,M),this.mailList.selectedMode=h.SINGLE,this.mailred=this.findChild("root/content/btnGetAll/red"),this.emptyNode=this.findChild("root/content/empty")},a.registerUpdateHandler=function(){this.addEvent(m.MailInfoBack,this.updateData,this)},a.onMaskClick=function(){this.close()},a.onAfterOpen=function(){IS(g).req_mail_expired_reward_c2s(),this.updateData()},a.onBeforeClose=function(){},a.updateData=function(){var t=IS(f).GetMailList(1);this.mailList.datas=t,this.emptyNode.active=t.length<=0,this.mailred.active=IS(f).isHaveAttach()},a.onDestroy=function(){},e}(u));var M=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).imgFrame=void 0,i.imgIcon=void 0,i.read_bg=void 0,i.mailTitle=void 0,i.mailTime=void 0,i.goodsNnum=void 0,i.get_status=void 0,i.get_status2=void 0,i.itemGo=void 0,i.btnClick=void 0,i.new_icon=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.imgFrame=c.findChildComponent(this.node,"head/imgFrame",a),this.imgIcon=c.findChildComponent(this.node,"head/imgIcon",a),this.goodsNnum=c.findChildComponent(this.node,"head/num",s),this.get_status=c.findChild(this.node,"head/get_status"),this.get_status2=c.findChild(this.node,"head/get_status2");var i=this.get_status2.getComponent(a);this.view.loadIcon(i,"player","grxx_ui_gouxuan"),this.itemGo=c.findChild(this.node,"head"),this.new_icon=c.findChild(this.node,"new");var e=this.new_icon.getComponent(a);this.view.loadIcon(e,"mail","yx_ui_tishi"),this.read_bg=c.findChild(this.node,"bg2"),this.mailTitle=c.findChildComponent(this.node,"name",s),this.mailTime=c.findChildComponent(this.node,"time",s),this.btnClick=c.findChild(this.node,""),this.view.addComponentCallbackListener(this.imgIcon.node,n.EventType.CLICK,(function(){IS(_).OpenItemTips(t.data.goods_list[0].gtid,t.imgIcon.node)})),this.view.addComponentCallbackListener(this.btnClick,n.EventType.CLICK,(function(){t.onBtnClick()}))},o.onRender=function(t,i){this.data=t;var e=1e3*t.send_time,n=C.ServerDate(e),o=n.getFullYear(),a=n.getMonth()+1,s=n.getDate(),h=n.getHours(),r=n.getMinutes(),c=h+"";h<10&&(c="0"+h);var u=r+"";r<10&&(u="0"+r),this.mailTime.string=o+"/"+a+"/"+s+"  "+c+":"+u+C.GetServerTimeZoneStr(),this.read_bg.active=1==t.is_read,this.get_status.active=0==t.is_attach,this.get_status2.active=0==t.is_attach,this.new_icon.active=IS(f).IsNewMail(t.id);var g=configMail.getDataByKey(this.data.cfg_id),m="";(m=null!=this.data.title.arg_list&&this.data.title.arg_list.length>0&&3==this.data.title.arg_list[0].k&&0==this.data.title.arg_list[0].v?this.data.title.arg_list[0].name:g.title).length>=24&&(m=m.substring(0,24)+(d.uiMirror?"":"...")),this.mailTitle.string=m;var _=!1;if(null!=t.goods_list&&t.goods_list.length>0){_=!0;var I=configGoods.getDataByKey(t.goods_list[0].gtid),M=configColor.getDataByKey(I.quality);this.view.loadIcon(this.imgFrame,"icon_equip",M.path),this.view.loadIcon(this.imgIcon,I.icon_group,I.icon),t.goods_list[0].gtid==p.FakeRechare?this.goodsNnum.string=l.formatStr("%s ",v.round(t.goods_list[0].num/100)):this.goodsNnum.string=t.goods_list[0].num+""}this.itemGo.active=_},o.onBtnClick=function(){IS(g).reqReadMail(this.data.id),10115!=this.data.cfg_id?uiMgr.openView("MailDetailView",this.data):IS(I).send_29_20(2,1)},o.onItemClick=function(){},e}(r);e._RF.pop()}}}));

