System.register("chunks:///_virtual/ItemBuyView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./ItemGrid.ts","./BagModel.ts","./MessageView.ts","./BagControl.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,d,u,a,h,c,r,l,m;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.Label,s=t.RichText,d=t.Sprite,u=t.EditBox,a=t.js},null,function(t){h=t.ItemGrid},function(t){c=t.BagModel},function(t){r=t.default},function(t){l=t.default},function(t){m=t.BaseView}],execute:function(){e._RF.push({},"f4d4aaZH/RG3Y8J8rFspVBH","ItemBuyView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).txtPrice=void 0,i.editBox=void 0,i.itemGrid=void 0,i.priceIcon=void 0,i.txtName=void 0,i.goodsGtid=0,i.buyNum=1,i.limitNum=0,i.txtAddTen=void 0,i.txtMinusTen=void 0,i.name="ItemBuyView",i.url="ui/module/common/ItemBuyView",i}i(e,t);var m=e.prototype;return m.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.onCloseClick()})),this.itemGrid=new h(this,this.findChild("view/item/itemGrid")),this.txtName=this.findChildComponent("view/item/txtName",o),this.txtPrice=this.findChildComponent("view/price",s),this.priceIcon=this.findChildComponent("view/price/imgIcon",d),this.editBox=this.findChildComponent("view/EditBox",u),this.addComponentCallbackListener(this.editBox.node,u.EventType.EDITING_DID_ENDED,(function(){var i=Number(t.editBox.string);(isNaN(i)||i<=1)&&(i=1),t.buyNum=Math.floor(i),t.changeNum()}));var e=this.findChild("view/btnBuy");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.BuyClick()}));var a=this.findChild("view/btnAdd");this.addComponentCallbackListener(a,n.EventType.CLICK,(function(){t.changeNum(1)}));var c=this.findChild("view/btnMinus");this.addComponentCallbackListener(c,n.EventType.CLICK,(function(){t.changeNum(-1)}));var r=this.findChild("view/btnAddTen");this.addComponentCallbackListener(r,n.EventType.CLICK,(function(){t.changeNum(10)})),this.txtAddTen=this.findChildComponent("view/btnAddTen/Label",o);var l=this.findChild("view/btnMinusTen");this.addComponentCallbackListener(l,n.EventType.CLICK,(function(){t.changeNum(-10)})),this.txtMinusTen=this.findChildComponent("view/btnMinusTen/Label",o)},m.onCloseClick=function(){this.close()},m.registerUpdateHandler=function(){},m.onAfterOpen=function(){var t;this.goodsGtid=this.openArgs[0],this.limitNum=null!=(t=this.openArgs[1])?t:0,this.buyNum=1;var i=this.goodsGtid,e=configGoods.getDataByKey(i);if(0!=e.price.length){var n=e.quality;configColor.getDataByKey(n);this.txtName.string=e.name,this.itemGrid.SetItemId(this.goodsGtid);var o=configGoods.getDataByKey(e.price[0]);this.loadIcon(this.priceIcon,o.icon_group,o.icon),this.changeNum()}else this.close()},m.onBeforeClose=function(){},m.onDestroy=function(){},m.BuyClick=function(){var t=configGoods.getDataByKey(this.goodsGtid),i=IS(c).getGoodsCountByGoodsGtid(t.price[0]);0==i||i<t.price[1]*this.buyNum?r.showFlyTip(GetLanguage(200069)):(IS(l).reqItemBuy(this.goodsGtid,this.buyNum),this.close())},m.changeNum=function(t){null!=t&&(this.buyNum=this.buyNum+t);var i=0!=this.limitNum?this.limitNum:999999;this.buyNum=Math.min(i,Math.max(this.buyNum,1)),this.editBox.string=String(this.buyNum);var e=configGoods.getDataByKey(this.goodsGtid),n=IS(c).getGoodsCountByGoodsGtid(e.price[0]),o=e.price[1]*this.buyNum,s="#2dc05a";n<o&&(s="#DB0C0C"),this.txtPrice.string=a.formatStr("<b><color=%s>%s</color></b>",s,o)},e}(m));e._RF.pop()}}}));

