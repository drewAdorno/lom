System.register("chunks:///_virtual/BattlePassControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ConfigGlobal.ts","./ControlMgr.ts","./PayDefine.ts","./BattlePassDataCache.ts","./BattlePassDefine.ts"],(function(e){"use strict";var t,a,n,r,_,s,o;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy},function(e){n=e.ConfigGlobal},function(e){r=e.controlMgr},function(e){_=e.PayEventDefine},function(e){s=e.BattlePassDataCache},function(e){o=e.BattlePassDefine}],execute:function(){a._RF.push({},"e3f09ujNjNJp7haOu1atwHC","BattlePassControl",void 0);e("default",function(){var e=a.prototype;function a(){netManager.addEventListener("act.act_war_token_info_s2c",this.on_war_token_info_s2c,this),netManager.addEventListener("act.act_war_token_update_task_s2c",this.on_war_token_update_task_s2c,this),netManager.addEventListener("act.act_war_token_task_reward_s2c",this.on_war_token_task_reward_s2c,this),netManager.addEventListener("act.act_war_token_lev_reward_s2c",this.on_war_token_lev_reward_s2c,this),netManager.addEventListener("act.act_war_token_add_reward_s2c",this.on_war_token_add_reward_s2c,this),netManager.addEventListener("war_token.war_token_info_s2c",this.update_40_1,this),netManager.addEventListener("war_token.war_token_close_s2c",this.update_40_2,this),netManager.addEventListener("war_token.war_token_update_task_s2c",this.update_40_3,this),netManager.addEventListener("war_token.war_token_task_reward_s2c",this.update_40_4,this),netManager.addEventListener("war_token.war_token_lev_reward_s2c",this.update_40_5,this),netManager.addEventListener("war_token.war_token_add_reward_s2c",this.update_40_6,this),netManager.addEventListener("war_token.war_token_update_exp_s2c",this.update_40_7,this),netManager.addEventListener("war_token.war_token_claim_special_reward_s2c",this.update_40_8,this),normalEvent.on(_.PAY_RECHARGE_SUCCESS,this.on_charge_success),r.addControl(this)}return e.clear=function(){printLog("BattlePassControl")},e.onLogin=function(){},e.onReconnect=function(){},e.reqBattlePassInfo=function(){netManager.send("act.act_war_token_info_c2s",{})},e.reqBattlePassTaskReward=function(e){netManager.send("act.act_war_token_task_reward_c2s",{task_id:e})},e.reqBattlePassLevelReward=function(e,t){netManager.send("act.act_war_token_lev_reward_c2s",{take_lev:e,type:t})},e.reqBattlePassExtReward=function(){netManager.send("act.act_war_token_add_reward_c2s",{})},e.on_war_token_info_s2c=function(e){IS(s).updateInfo(e),normalEvent.emit(o.BATTLE_PASS_INFO_UPDATE)},e.on_war_token_close=function(e){IS(s).updateClose(e)},e.on_war_token_update_task_s2c=function(e){IS(s).updateTask(e)},e.on_war_token_task_reward_s2c=function(e){IS(s).updateTaskReward(e)},e.on_war_token_lev_reward_s2c=function(e){IS(s).updateLevReward(e)},e.on_war_token_add_reward_s2c=function(e){IS(s).updateAddReward(e)},e.on_charge_success=function(){uiMgr.close("BuyBPView"),normalEvent.emit(o.BATTLE_PASS_TASK_INFO_UPDATE)},e.send_40_1=function(e){netManager.send("war_token.war_token_info_c2s",{id:e})},e.update_40_1=function(e){IS(s).updateInfo(e)},e.update_40_2=function(e){IS(s).updateClose(e)},e.update_40_3=function(e){IS(s).updateTask(e)},e.send_40_4=function(e,t){netManager.send("war_token.war_token_task_reward_c2s",{id:e,task_id:t})},e.update_40_4=function(e){IS(s).updateTaskReward(e)},e.send_40_5=function(e,t,a){netManager.send("war_token.war_token_lev_reward_c2s",{id:e,take_lev:t,type:a})},e.update_40_5=function(e){IS(s).updateLevReward(e)},e.send_40_6=function(e){netManager.send("war_token.war_token_add_reward_c2s",{id:e})},e.update_40_6=function(e){IS(s).updateAddReward(e)},e.update_40_7=function(e){IS(s).updateExp(e)},e.send_40_8=function(e,t){netManager.send("war_token.war_token_claim_special_reward_c2s",{id:e,cfg_id:t})},e.update_40_8=function(e){IS(s).updateSpecialReward(e)},a.checkMainRewardRP=function(){var e=IS(s).getPassInfoList();for(var t in e)if(e.hasOwnProperty(t)){var n,r,_=e[t],o=null!=(n=null==(r=configWartoken.getDataByKey(_.id))?void 0:r.view)?n:0;if(1!=_.id&&0==o)continue;if(a.checkRewardRP(_.id)>=0)return 1}return 0},a.checkRewardRP=function(e){var t=IS(s).getPassInfo(e),a=-1;if(!t)return a;for(var n=0;n<t.lev&&((1==t.free_reward[n].status||1==t.high_reward[n].status&&t.if_buy||t.high_reward_2.length>0&&1==t.high_reward_2[n].status&&t.if_buy_2)&&(a=n),!(a>0))&&!(a>=0);n++);return a},a.checkMainAddRewardRP=function(){var e=IS(s).getPassInfoList();for(var t in e)if(e.hasOwnProperty(t)){var n,r,_=e[t],o=null!=(n=null==(r=configWartoken.getDataByKey(_.id))?void 0:r.view)?n:0;if(1!=_.id&&0==o)continue;if(a.checkAddRewardRP(_.id)>0)return 1}return 0},a.checkAddRewardRP=function(e){var t=IS(s).getPassInfo(e);return t&&t.lev>=t.max_lev&&t.exp>=t.extra_need_exp&&t.if_buy&&t.extra_times<t.extra_max_times?1:0},a.checkMainTaskRP=function(){var e=IS(s).getPassInfoList();for(var t in e)if(e.hasOwnProperty(t)){var n,r,_=e[t],o=null!=(n=null==(r=configWartoken.getDataByKey(_.id))?void 0:r.view)?n:0;if(1!=_.id&&0==o)continue;if(a.checkTaskRP(_.id)>=0)return 1}return 0},a.checkTaskRP=function(e){var t=IS(s).getPassInfo(e),a=-1;if(!t)return a;for(var n=0;n<t.task_list.length;n++){var r=t.task_list[n];if((1==r.type&&1==r.state||2==r.type&&t.if_buy&&1==r.state)&&(a=n),a>=0)break}return a},a.checkSpecialRewardRP=function(e){var a,r=IS(s).getPassInfo(e);if(!r)return 0;for(var _,o,i=n.autumn_panghong_gift,d=t(i);!(o=d()).done;){var c=o.value;if(c[0]==e){_=c[1];break}}if(!_)return 0;for(var u,f=null!=(a=r.total_exp)?a:0,w=t(_);!(u=w()).done;){var k=u.value;if(f>=k[1]&&!r.specialReward[k[0]])return 1}return 0},a.checkRewardRoll=function(e){for(var t=IS(s).getPassInfo(e),a=-1,n=0;n<t.lev;n++)(2==t.free_reward[n].status||2==t.high_reward[n].status&&t.if_buy||2==t.high_reward_2[n].status&&t.if_buy_2)&&(a=n);return a},a}());a._RF.pop()}}}));

