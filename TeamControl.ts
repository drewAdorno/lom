System.register("chunks:///_virtual/TeamControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BattleData.ts","./RedPointMgr.ts","./BagModel.ts","./ChapterControl.ts","./ChapterDataCache.ts","./ChapterDefine.ts","./ChatDefine.ts","./ControlMgr.ts","./PvpControl.ts","./TeamDataCache.ts","./TeamDefine.ts"],(function(e){"use strict";var t,a,n,i,o,s,r,_,m,c,d,u,f,l,h;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy},function(e){n=e.ChapterType,i=e.PlayerData,o=e.BattleData},function(e){s=e.RedPointMgr},function(e){r=e.BagModel},function(e){_=e.default},function(e){m=e.ChapterDataCache},function(e){c=e.ChapterEventDefine},function(e){d=e.ChatEventDefine},function(e){u=e.controlMgr},function(e){f=e.default},function(e){l=e.TeamDataCache},function(e){h=e.TeamEvent}],execute:function(){a._RF.push({},"21213nV8IRBUIEKMc5Vggku","TeamControl",void 0);e("default",function(){var e=a.prototype;function a(){netManager.addEventListener("team.team_info_s2c",this.on_team_info_s2c,this),netManager.addEventListener("team.team_create_s2c",this.on_team_create_s2c,this),netManager.addEventListener("team.team_match_s2c",this.on_team_match_s2c,this),netManager.addEventListener("team.team_join_s2c",this.on_team_join_s2c,this),netManager.addEventListener("team.team_exit_s2c",this.on_team_exit_s2c,this),netManager.addEventListener("team.team_ready_s2c",this.on_team_ready_s2c,this),netManager.addEventListener("team.team_choose_pet_s2c",this.on_team_choose_pet_s2c,this),netManager.addEventListener("team.team_combat_s2c",this.on_team_combat_s2c,this),netManager.addEventListener("team.team_result_s2c",this.on_team_result_s2c,this),netManager.addEventListener("team.team_apply_s2c",this.on_team_apply_s2c,this),netManager.addEventListener("team.team_choose_diff_s2c",this.on_team_choose_diff_s2c,this),normalEvent.on(d.InsertNewMsg,this.updateMessage),u.addControl(this)}return e.clear=function(){printLog("TeamControl")},e.onLogin=function(){this.reqTeamInfo()},e.onReconnect=function(){},e.reqTeamInfo=function(){netManager.send("team.team_info_c2s",{})},e.reqTeamCreate=function(e){netManager.send("team.team_create_c2s",{type:e,args:[]})},e.reqTeamMatch=function(e){netManager.send("team.team_match_c2s",{diff:e})},e.reqTeamJoin=function(e){netManager.send("team.team_join_c2s",{team_id:e})},e.reqTeamExit=function(){netManager.send("team.team_exit_c2s",{}),IS(_).reqEnterChapter(0)},e.reqTeamReady=function(e){netManager.send("team.team_ready_c2s",{is_ready:e})},e.reqTeamChoosePet=function(e){netManager.send("team.team_choose_pet_c2s",{pet_list:e})},e.reqTeamResult=function(e,t){void 0===t&&(t=0),netManager.send("team.team_result_c2s",{result:e,manual_operators:0,ext:[{k:1,v:t}]}),IS(_).reqEnterChapter(0)},e.reqTeamCombat=function(){var e=IS(m);e.currentLoadType>0||(e.chapterType=n.Team3,e.currentLoadType=n.Team3,e.battleData=null,netManager.send("team.team_combat_c2s",{}))},e.reqTeamApply=function(){netManager.send("team.team_apply_c2s",{})},e.reqChooseDiff=function(e){netManager.send("team.team_choose_diff_c2s",{diff:e})},e.on_team_info_s2c=function(e){IS(l).team_id=e.team_id,IS(l).team_type=e.team_type,IS(l).leader_id=e.leader_id,IS(l).state=e.state,IS(l).member_list=e.member_list,IS(l).teamDiff=e.team_diff,IS(l).max_diff=e.max_diff,normalEvent.emit(h.TEAM_INFO_CHANGE)},e.on_team_create_s2c=function(e){normalEvent.emit(h.TEAM_CREATE_CALLBACK,e.code)},e.on_team_match_s2c=function(){normalEvent.emit(h.TEAM_MATCH_CALLBACK)},e.on_team_join_s2c=function(){uiMgr.openView("MakeTeamView"),normalEvent.emit(h.TEAM_JOIN_CALLBACK)},e.on_team_exit_s2c=function(){uiMgr.close("MakeTeamView"),normalEvent.emit(h.TEAM_EXIT_CALLBACK)},e.on_team_ready_s2c=function(){normalEvent.emit(h.TEAM_READY_CALLBACK)},e.on_team_choose_pet_s2c=function(){normalEvent.emit(h.TEAM_READY_CALLBACK)},e.on_team_combat_s2c=function(e){var a=IS(m);a.currentLoadType=0,a.chapterType=n.Team3,a.curDungeonId=e.dun_id;var s=new o;s.chapterId=e.dun_id,s.chapterMode=0,s.seed=e.random_seed,s.passTime=e.pass_ms,IS(l).cacheMember_list=IS(l).member_list;for(var r,_=t(e.roles);!(r=_()).done;){var d=r.value,u=new i(d.id);s.playerList[d.id]=u,IS(f).setPlayerList(d,u)}s.chapterType=n.Team3,a.battleData=s,normalEvent.emit(c.BATTLE_STATE,n.Team3,!0),battleMain.enterChapter(0,!0),normalEvent.emit(h.TEAM_CLOSE)},e.on_team_result_s2c=function(e){IS(r).getGoodsCountByGoodsGtid(1009)>0&&uiMgr.openView("MakeTeamView"),normalTimer.start(.1,1,(function(){0==e.result?uiMgr.openView("RewardGetView",e.reward_type,e.reward_list,IS(l).cacheMember_list,e.defence):uiMgr.openView("DungeonDefeatView")}))},e.on_team_apply_s2c=function(e){IS(l).apply_list=e.apply_list,null==uiMgr.getOpenView("FriendInviteView")?uiMgr.openView("FriendInviteView"):normalEvent.emit(h.TEAM_APPLY_INFO)},e.updateMessage=function(e){if(e.links&&!(e.links.length<=0)&&e.links[0].args_list){var t=e.links[0].args_list[1];t!=IS(l).team_id&&IS(s).changeValue("team_"+t,1)}},e.on_team_choose_diff_s2c=function(e){},a}());a._RF.pop()}}}));

