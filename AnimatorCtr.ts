System.register("chunks:///_virtual/AnimatorCtr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventInvoker.ts","./FixMath.ts"],(function(t){"use strict";var e,i,n,s;return{setters:[function(t){e=t.createClass},function(t){i=t.cclegacy},function(t){n=t.EventInvoker},function(t){s=t.FixMath}],execute:function(){i._RF.push({},"36eceHLROtBZohfpgkg7aI2","AnimatorCtr",void 0);t("AnimatorCtr",function(){function t(){this.invoker=new n("AnimatorCtr"),this._aniName="run",this._reset=!1,this._currenModeState=void 0,this._curFrame=void 0,this._speed=1,this._static=1,this._indexList=[],this._stateSpeed=1,this._changeData=!1,this._owner=void 0,this.config=void 0,this.aniAddName=void 0}var i=t.prototype;return i.init=function(t){this._owner=t,this.config=configUnitModel.getDataByKey(t.data.config.model)},i.reset=function(){this.invoker.clear(),this._currenModeState=null,this._indexList.length=0,this._curFrame=0,this._static=this._stateSpeed=1,this.speed=1},i.addEvent=function(t,e,i){this.invoker.on(t,e,i)},i.removeEvent=function(t,e,i){this.invoker.off(t,e,i)},i.hasState=function(t){return this._aniName==t},i.changeState=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.refreshModeState(t),this._stateSpeed=i,this._aniName=t,this._reset=e,this._changeData=!0},i.refreshModeState=function(t){var e=this.config[t];this._currenModeState=e,this._stateSpeed=1,this._indexList.length=0,this._curFrame=0},i.onUpdate=function(t){if(0!=this.timeScale)if(null!=this._currenModeState){var e=this._currenModeState,i=e[0];if(this._indexList.length<i.length-1)for(var n=1;n<i.length;n++)if(-1==this._indexList.indexOf(n)){var r=i[n];if(this._curFrame>=r){this._indexList.push(n),this.invoker.emit("OnAction",e[1]);break}}if(this._curFrame>=i[0])return this._curFrame=0,this._currenModeState=null,void this.invoker.emit("OnEnd");this._curFrame=Math.min(s.round(this._curFrame+this.timeScale),i[0])}else this._curFrame=s.round(this._curFrame+this.timeScale)},e(t,[{key:"speed",get:function(){return this._speed},set:function(t){this._speed=t}},{key:"aniName",get:function(){return this._aniName}},{key:"aniReset",get:function(){return this._reset}},{key:"changeData",get:function(){return this._changeData},set:function(t){this._changeData=t}},{key:"timeScale",get:function(){return s.round(this._speed*s.round(this._static*this._stateSpeed))}},{key:"curFrame",get:function(){return this._curFrame}}]),t}());i._RF.pop()}}}));

