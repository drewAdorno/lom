System.register("chunks:///_virtual/ActivityChildhoodView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RedPoint.ts","./RedPointMgr.ts","./TimeUtil.ts","./index57.ts","./BattlePassDefine.ts","./MessageView.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ActivityChildhoodDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,a,s,o,d,h,l,r,c,u,f,v,p,T,C;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,a=t.Vec2,s=t.Label,o=t.js},function(t){d=t.RedPointType},function(t){h=t.RedPointMgr},function(t){l=t.default},null,function(t){r=t.BattlePassDefine},function(t){c=t.default},function(t){u=t.default},function(t){f=t.ActivityType,v=t.ActivityState,p=t.ActivityEventDefine},function(t){T=t.default},function(t){C=t.BaseView}],execute:function(){i._RF.push({},"794ed1OcvNKS6OQkHvs+si7","ActivityChildhoodView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).txtTimeDesc=void 0,e.txtLeftTime=void 0,e.leftTime=0,e.deltaTime=0,e.canUpdate=!1,e.name="ActivityChildhoodView",e.url="ui/module/childhood/ActivityChildhoodView",e.fullScreen=!0,e}e(i,t);var C=i.prototype;return C.onInit=function(){var t=this,e=this.findChild("view/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var i=this.findChild("view/btnTurn");this.addRedPoint("childhood_turn",i,new a(65,65),d.Dot),this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){var t=IS(u).GetActivityInfo(f.ChildhoodTurn);t&&t.state==v.Open?uiMgr.openView("ActivityChildhoodTurnView"):t&&t.state==v.Preview?c.showFlyTip(GetLanguage(200086)):c.showFlyTip(GetLanguage(200026))}));var o=this.findChild("view/btnPass");this.addRedPoint("childhood_pass",o,new a(60,60),d.Dot),this.addComponentCallbackListener(o,n.EventType.CLICK,(function(){var t=IS(u).GetActivityInfo(f.ChildhoodPass);t&&t.state==v.Open?uiMgr.openView("ActivityChildhoodPassView"):t&&t.state==v.Preview?c.showFlyTip(GetLanguage(200086)):c.showFlyTip(GetLanguage(200026))}));var h=this.findChild("view/btnRank");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){uiMgr.openView("ActivityAutumnRankView",f.Childhood)}));var l=this.findChild("view/btnTask");this.addRedPoint("childhood_task",l,new a(60,60),d.Dot),this.addComponentCallbackListener(l,n.EventType.CLICK,(function(){var t=IS(u).GetActivityInfo(f.ChildhoodTask);t&&t.state==v.Open?uiMgr.openView("ActivityChildhoodTaskView",f.ChildhoodTask):t&&t.state==v.Preview?c.showFlyTip(GetLanguage(200086)):c.showFlyTip(GetLanguage(200026))}));var r=this.findChild("view/btnStore");this.addRedPoint("childhood_store",r,new a(50,50),d.Dot),this.addComponentCallbackListener(r,n.EventType.CLICK,(function(){uiMgr.openView("ActivityChildhoodStoreView",f.Childhood)}));var p=this.findChild("view/btnGift");this.addComponentCallbackListener(p,n.EventType.CLICK,(function(){var t=IS(u).GetActivityInfo(f.ChildhoodTurn);t&&t.state==v.Open?uiMgr.openView("HorseCarnivalGiftView",f.ChildhoodTurn):t&&t.state==v.Preview?c.showFlyTip(GetLanguage(200086)):c.showFlyTip(GetLanguage(200026))})),this.txtTimeDesc=this.findChildComponent("view/nodeTime/txtDesc",s),this.txtLeftTime=this.findChildComponent("view/nodeTime/txtTime",s)},C.registerUpdateHandler=function(){this.addEvent(p.OnActivityInfoUpdate,this.updateInfo,this),this.addEvent(p.OnActivityInfoTaskUpdate,this.updateRed,this),this.addEvent(p.OnActivityInfoUpdate,this.updateRed,this),this.addEvent(r.BATTLE_PASS_INFO_UPDATE,this.updateRed,this),this.addEvent(p.OnHorseCarnivalUpdate,this.updateRed,this),this.addEvent(p.OnHorseCarnivalReward,this.updateRed,this)},C.onAfterOpen=function(){this.updateRed();var t=IS(u).GetActivityInfo(f.Childhood);if(t){var e,i=null!=(e=t.state_time[t.state])?e:t.state_time[v.Open];if(this.leftTime=i.end_time-l.serverTime,this.leftTime>0){var n="";t.state==v.Preview?n=GetLanguage(200763):t.state==v.Open?n=GetLanguage(200764):t.state==v.EndShow&&(n=GetLanguage(200765)),this.txtTimeDesc.string=n,this.canUpdate=!0,this.txtLeftTime.string=o.formatStr("%s",l.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}},C.onBeforeClose=function(){this.canUpdate=!1},C.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=o.formatStr("%s",l.formatTimeStringForSecond(this.leftTime)):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},C.onDestroy=function(){},C.updateRed=function(){IS(h).changeValue("childhood_task",IS(u).GetTaskRedNum(f.ChildhoodTask)),IS(h).changeValue("childhood_pass",IS(T).getPassRedNum()),IS(h).changeValue("childhood_store",IS(T).GetStoreRed()),IS(h).changeValue("childhood_turn",IS(T).GetTurnRed())},C.updateInfo=function(t){if(t.type==f.Childhood&&t.state!=v.Null){var e,i=null!=(e=t.state_time[t.state])?e:t.state_time[v.Open];if(this.leftTime=i.end_time-l.serverTime,this.leftTime>0){var n="";t.state==v.Preview?n=GetLanguage(200763):t.state==v.Open?n=GetLanguage(200764):t.state==v.EndShow&&(n=GetLanguage(200765)),this.txtTimeDesc.string=n,this.canUpdate=!0,this.txtLeftTime.string=o.formatStr("%s",l.formatTimeStringForSecond(this.leftTime))}else this.txtLeftTime.string=GetLanguage(200026)}},i}(C));i._RF.pop()}}}));

