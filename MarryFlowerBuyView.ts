System.register("chunks:///_virtual/MarryFlowerBuyView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./index57.ts","./BagModel.ts","./MessageView.ts","./MarryControl.ts","./BaseView.ts"],(function(i){"use strict";var t,e,n,o,s,d,u,a,r,c,h,l,m;return{setters:[function(i){t=i.inheritsLoose},function(i){e=i.cclegacy,n=i.Button,o=i.Label,s=i.RichText,d=i.Sprite,u=i.EditBox,a=i.js},function(i){r=i.ItemGrid},null,function(i){c=i.BagModel},function(i){h=i.default},function(i){l=i.default},function(i){m=i.BaseView}],execute:function(){e._RF.push({},"c9794AmcehCPaqzz+dXEncH","MarryFlowerBuyView",void 0);i("default",function(i){function e(){var t;return(t=i.call(this)||this).txtPrice=void 0,t.editBox=void 0,t.itemGrid=void 0,t.priceIcon=void 0,t.txtName=void 0,t.goodsGtid=0,t.buyNum=1,t.limitNum=0,t.txtAddTen=void 0,t.txtMinusTen=void 0,t.name="MarryFlowerBuyView",t.url="ui/module/common/ItemBuyView",t}t(e,i);var m=e.prototype;return m.onInit=function(){var i=this,t=this.findChild("imgMask");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){i.onCloseClick()})),this.itemGrid=new r(this,this.findChild("view/item/itemGrid")),this.txtName=this.findChildComponent("view/item/txtName",o),this.txtPrice=this.findChildComponent("view/price",s),this.priceIcon=this.findChildComponent("view/price/imgIcon",d),this.editBox=this.findChildComponent("view/EditBox",u),this.addComponentCallbackListener(this.editBox.node,u.EventType.EDITING_DID_ENDED,(function(){var t=Number(i.editBox.string);(isNaN(t)||t<=1)&&(t=1),i.buyNum=Math.floor(t),i.changeNum()}));var e=this.findChild("view/btnBuy");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){i.BuyClick()}));var a=this.findChild("view/btnAdd");this.addComponentCallbackListener(a,n.EventType.CLICK,(function(){i.changeNum(1)}));var c=this.findChild("view/btnMinus");this.addComponentCallbackListener(c,n.EventType.CLICK,(function(){i.changeNum(-1)}));var h=this.findChild("view/btnAddTen");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){i.changeNum(10)})),this.txtAddTen=this.findChildComponent("view/btnAddTen/Label",o);var l=this.findChild("view/btnMinusTen");this.addComponentCallbackListener(l,n.EventType.CLICK,(function(){i.changeNum(-10)})),this.txtMinusTen=this.findChildComponent("view/btnMinusTen/Label",o)},m.onCloseClick=function(){this.close()},m.registerUpdateHandler=function(){},m.onAfterOpen=function(){var i;this.goodsGtid=this.openArgs[0],this.limitNum=null!=(i=this.openArgs[1])?i:0,this.buyNum=1;var t=this.goodsGtid,e=configGoods.getDataByKey(t);if(0!=e.price.length){var n=e.quality;configColor.getDataByKey(n);this.txtName.string=e.name,this.itemGrid.SetItemId(this.goodsGtid);var o=configGoods.getDataByKey(e.price[0]);this.loadIcon(this.priceIcon,o.icon_group,o.icon),this.changeNum()}else this.close()},m.onBeforeClose=function(){},m.onDestroy=function(){},m.BuyClick=function(){var i=configGoods.getDataByKey(this.goodsGtid),t=IS(c).getGoodsCountByGoodsGtid(i.price[0]);0==t||t<i.price[1]*this.buyNum?h.showFlyTip(GetLanguage(200069)):(IS(l).send_favor_buy_flower_c2s(this.buyNum),this.close())},m.changeNum=function(i){null!=i&&(this.buyNum=this.buyNum+i);var t=0!=this.limitNum?this.limitNum:999999;this.buyNum=Math.min(t,Math.max(this.buyNum,1)),this.editBox.string=String(this.buyNum);var e=configGoods.getDataByKey(this.goodsGtid),n=IS(c).getGoodsCountByGoodsGtid(e.price[0]),o=e.price[1]*this.buyNum,s="#2dc05a";n<o&&(s="#DB0C0C"),this.txtPrice.string=a.formatStr("<b><color=%s>%s</color></b>",s,o)},e}(m));e._RF.pop()}}}));

