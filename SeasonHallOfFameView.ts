System.register("chunks:///_virtual/SeasonHallOfFameView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GuildPinItem.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./CommonModel.ts","./RoleDataCache.ts","./SeasonControl.ts","./SeasonDataCache.ts","./SeasonDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,o,n,r,s,a,l,d,h,u,f,c,S,p,m;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,n=t.Button,r=t.Label,s=t.sys,a=t.Color},function(t){l=t.GuildPinItem},function(t){d=t.default},function(t){h=t.default},null,function(t){u=t.CommonModel},function(t){f=t.RoleDataCache},function(t){c=t.default},function(t){S=t.SeasonDataCache},function(t){p=t.SeasonEventDefine},function(t){m=t.BaseView}],execute:function(){o._RF.push({},"756f1FOmVRNvI8HSGxC+02K","SeasonHallOfFameView",void 0);t("default",function(t){function o(){var e;return(e=t.call(this)||this).txtServerName=void 0,e.txtServerScore=void 0,e.txtPlayerName=void 0,e.txtPlayerServ=void 0,e.txtPlayerScore=void 0,e.txtGroupBtn=void 0,e.tabelParent=void 0,e.tabelNode=void 0,e.tableList=[],e.curSel=void 0,e.model=void 0,e.topFlag=void 0,e.topPlayer=void 0,e.name="SeasonHallOfFameView",e.url="ui/module/season/SeasonHallOfFameView",e}e(o,t);var m=o.prototype;return m.onInit=function(){var t=this,e=this.findChild("root/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var i=this.findChild("root/btnShop");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("SeasonShopView")}));var o=this.findChild("root/btnShip");this.addComponentCallbackListener(o,n.EventType.CLICK,(function(){uiMgr.openView("SeasonShipBodyView")}));var s=this.findChild("root/btnGroup");this.addComponentCallbackListener(s,n.EventType.CLICK,(function(){var e=IS(S).hallInfo;e[t.curSel]&&uiMgr.openView("SeasonPreviewGroupView",e[t.curSel].serv_list)})),this.txtServerName=this.findChildComponent("root/nodeTop/server/bg/num",r),this.txtServerScore=this.findChildComponent("root/nodeTop/server/num/num",r),this.txtPlayerName=this.findChildComponent("root/nodeTop/player/Name",r),this.txtPlayerServ=this.findChildComponent("root/nodeTop/player/bg/num",r),this.txtPlayerScore=this.findChildComponent("root/nodeTop/player/num/num",r),this.tabelParent=this.findChild("root/bg"),this.tabelNode=this.findChild("root/bg/node"),this.txtGroupBtn=this.findChildComponent("root/btnGroup/num",r);var a=this.findChild("root/nodeTop/server/GuildPinItem");this.topFlag=new l(this,a),this.topPlayer=this.findChild("root/nodeTop/player/player")},m.registerUpdateHandler=function(){this.addEvent(p.SEASON_HALL_INFO_UPDATE,this.refreshCurShow,this),this.addEvent(p.SEASON_ACT_INFO_UPDATE,this.updateTabel,this)},m.onAfterOpen=function(){IS(c).reqSeasonActInfo(),this.updateTabel(),this.switchTable(1),this.tabelNode.active=!1},m.updateTabel=function(){for(var t=this,e=function(e){var i=nodeInstantiate.instantiate(t.tabelNode);i.parent=t.tabelParent;var o={node:i,nodeSel:d.findChild(i,"sel"),txtNormal:d.findChildComponent(i,"normal/Label",r),txtSel:d.findChildComponent(i,"sel/Label",r),index:e};t.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.switchTable(e)})),t.tableList.push(o)},i=1;i<=IS(S).max_season_id;i++)e(i)},m.refreshCurShow=function(){var t=IS(S).hallInfo;if(t[this.curSel]){var e=t[this.curSel].role,i=t[this.curSel].server;e&&i&&(this.txtGroupBtn.string="s"+this.curSel,this.topFlag.SetItem(i.guild_flag),this.model&&this.removeUnitModel(this.model),this.model=IS(u).AddRoleModel(this,e.figure,this.topPlayer),s.uiMirror&&(this.getUnitModel(this.model).dir=-1),this.txtServerName.string=h.formatStr("【s##1】",i.serv_id),this.txtServerScore.string=h.GetNumString(i.score),this.txtPlayerServ.string=h.formatStr("【s##1】",e.serv_id),this.txtPlayerName.string=e.name,this.txtPlayerScore.string=h.GetNumString(e.score),e.belong_id==IS(f).GetRoleId()?this.txtPlayerName.color=new a("#77f79b"):this.txtPlayerName.color=new a("#ffe586"))}else IS(c).reqHallInfo(this.curSel)},m.switchTable=function(t){if(this.curSel!=t){this.curSel=t;for(var e,o=i(this.tableList);!(e=o()).done;){var n=e.value;n.nodeSel.active=this.curSel==n.index,n.txtNormal.string="s"+n.index,n.txtSel.string="s"+n.index}this.refreshCurShow()}},m.onBeforeClose=function(){this.curSel=0},m.onDestroy=function(){},o}(m));o._RF.pop()}}}));

