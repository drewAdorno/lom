System.register("chunks:///_virtual/DPVPPlayerAI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListPool.ts","./FixMath.ts","./IAIHandle.ts","./EnumDefine.ts","./V2.ts"],(function(t){"use strict";var e,i,n,r,a,u,l,o;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy},function(t){r=t.ListPool},function(t){a=t.FixMath},function(t){u=t.IAIHandle},function(t){l=t.TargetFilter},function(t){o=t.V2}],execute:function(){n._RF.push({},"979b8Sh5RVH8bWWR1zjN/5j","DPVPPlayerAI",void 0);new o;var s=new r;t("DPVPPlayerAI",function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.handleAction=function(){var t=this.getTarget();if(null==t)return this.cast.wantTarget=null,this.cast.curTarget=null,void this.startSkill();this.startSkill(),this.selectTarget(t)},r.getTarget=function(){for(var t,e=this.cast,n=e.hatredCtr.getHatredList(),r=s.alloc(),a=i(n);!(t=a()).done;){var u=t.value;if(!u.unit.isDead){if(u.unit.isCallType)return u.unit;u.unit.position.y==e.position.y&&r.push(u)}}var l=e.curTarget&&e.curTarget.unit&&!e.curTarget.unit.isDead;if(0==r.length&&l)return s.free(r),e.curTarget.unit;if(r.length>0&&l){for(var o,f=!1,c=i(r);!(o=c()).done;){var h=o.value;if(!h.unit.isDead&&h.unit==e.curTarget.unit){f=!0;break}}if(f)return s.free(r),e.curTarget.unit}0==r.length&&n.forEach((function(t){r.push(t)}));for(var g=null,d=0;r.length>0&&d<20;){var v=e.battleMain.random.randomInt(0,r.length),p=r[v].unit;if(d++,!p.isDead){g=p;break}}return s.free(r),g},r.startSkill=function(){var t=this.cast;if(GlobalDefine.CLIENT_TYPE&&!t.battleMain.playerAuto){if(t.battleMain.showMainCtr.player==t)return}else if(!t.battleMain.playerAuto)return;var e=t.data.skillList;if(null==e||0==e.length)return!1;for(var n,r=i(e);!(n=r()).done;){var u=n.value;if(t.aiTime>=u.useDelay&&0==u.state){var o=a.roundInt(u.config.autoDis+t.skillAutoDis);if(0==t.battleMain.unitMgr.findTarget(t,l.Enemy,o,t.position).length)continue;t.addUnlimitSkill(u)}}},n}(u));n._RF.pop()}}}));

