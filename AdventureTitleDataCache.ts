System.register("chunks:///_virtual/AdventureTitleDataCache.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RedPointMgr.ts","./ConfigGlobal.ts","./RoleDataCache.ts","./RoleDefine.ts","./TaskDataCache.ts","./TaskDefine.ts","./AdventureTitleDefine.ts"],(function(e){"use strict";var t,n,a,i,o,r,l,s,v,u,c,f;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,n=e.createClass},function(e){a=e.cclegacy},function(e){i=e.RedPointMgr},function(e){o=e.ConfigGlobal},function(e){r=e.RoleDataCache},function(e){l=e.RoleEventDefine},function(e){s=e.TaskDataCache},function(e){v=e.TaskType,u=e.TaskState,c=e.TaskEventDefine},function(e){f=e.AdventureTitleEventDefine}],execute:function(){a._RF.push({},"fff4dyjandAf42fsr9jK9T5","AdventureTitleDataCache",void 0);e("AdventureTitleDataCache",function(){var e=a.prototype;function a(){this._level=1,this._evolveRed=!0,this._lastJobLevel=-1,this._targetLevel=0,normalEvent.on(c.TASK_INFO_UPDATE,this.updateRed,this),normalEvent.on(l.ROLE_INFO_UPDATE,this.updateRed,this);var e=IS(r).GetJob();if(null!=configJobs.getDataByKey(e)){var t=configJobs.getDataByKey(e).change_times;this._lastJobLevel<0&&(this._lastJobLevel=t),0==this._targetLevel&&(this._targetLevel=o.transfer_job_level[t])}}return e.clear=function(){},e.canLevUp=function(){var e=IS(a).level,n=configAdventure_level.getDataByKey(e);if(0==n.next_id)return!1;for(var i,o=t(n.task_group);!(i=o()).done;){var r=i.value,l=IS(s).GetTaskItem(v.AdventureTitle,r);if(!l||l.state==u.Normal)return!1}return!0},e.canGetTask=function(){var e=IS(a).level,n=configAdventure_level.getDataByKey(e);if(0==n.next_id)return!1;for(var i,o=t(n.task_group);!(i=o()).done;){var r=i.value,l=IS(s).GetTaskItem(v.AdventureTitle,r);if(l&&l.state==u.Complete)return!0}return!1},e.canEvolve=function(){if(!this._evolveRed)return!1;var e=IS(r).GetJob();return!(configJobs.getDataByKey(e).change_times>=5)&&IS(r).GetLevel()>=this._targetLevel},e.updateRed=function(){var e=IS(r).GetJob();if(e&&0!=e&&configJobs.getDataByKey(e)){var t=configJobs.getDataByKey(e).change_times;this._lastJobLevel!=t&&(this._evolveRed=!0,this._targetLevel=o.transfer_job_level[t]),t>=5&&(this._evolveRed=!1);var n=0;this.canLevUp()&&n++,this.canGetTask()&&n++,this.canEvolve()&&n++,IS(i).changeValue("AdventureTitle",n)}},n(a,[{key:"level",get:function(){return this._level},set:function(e){this._level=e,this.updateRed(),normalEvent.emit(f.OnAdventureTitleUpdate)}},{key:"evolveRed",get:function(){return this._evolveRed},set:function(e){this._evolveRed=e}},{key:"lastJobLevel",get:function(){return this._lastJobLevel},set:function(e){this._lastJobLevel=e}},{key:"targetLevel",get:function(){return this._targetLevel},set:function(e){this._targetLevel=e}}]),a}());a._RF.pop()}}}));

