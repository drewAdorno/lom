System.register("chunks:///_virtual/FatePreView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./RoleDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,a,l,r,h,c,d,f,v,u,p,C;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.ScrollView,a=t.Label,l=t.UITransform,r=t.Sprite},function(t){h=t.SelectedType,c=t.ListItem},function(t){d=t.default},function(t){f=t.default},null,function(t){v=t.IconAseetType},function(t){u=t.ConfigGlobal},function(t){p=t.RoleDataCache},function(t){C=t.BaseView}],execute:function(){n._RF.push({},"aca80HVw+tO6qQa5b4x27mD","FatePreView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).scroll=void 0,i.curType=0,i.name="FatePreView",i.url="ui/module/fate/FatePreView",i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this,i=this.findChild("btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.onCloseClick()}));var e=this.findChild("imgMask");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.onCloseClick()}));var n=this.findChildComponent("scroll",s);this.scroll=this.addUIList(n,g,!0,0)},n.onCloseClick=function(){this.close()},n.registerUpdateHandler=function(){},n.onAfterOpen=function(){this.UpdateOpen()},n.onBeforeClose=function(){},n.onDestroy=function(){},n.setType=function(t,i){void 0===i&&(i=!1),(this.curType!=t||i)&&(this.curType=t,this.scroll.updateAll())},n.SetIndex=function(){this.scroll.updateAll()},n.UpdateOpen=function(){this.curType=1,this.hideList={};var t=u.fate_quality;this.scroll.datas=t},n.Refresh=function(){this.scroll.updateAll()},e}(C));var g=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtTitle=void 0,i.arrUp=void 0,i.arrDown=void 0,i.imgBG1=void 0,i.imgBG2=void 0,i.scroll=void 0,i.scrollNode=void 0,i.scrollUT=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.adaptiveSize=!0,this.txtTitle=d.findChildComponent(this.node,"title/Label",a),this.arrUp=d.findChild(this.node,"title/arrUp"),this.arrDown=d.findChild(this.node,"title/arrDown"),this.imgBG1=d.findChild(this.node,"title/imgBG1"),this.imgBG2=d.findChild(this.node,"title/imgBG2");var i=d.findChild(this.node,"title");this.view.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.arrUp.active?(t.view.hideList[t.data[0]]=!0,t.UpdateSelect()):(t.view.hideList[t.data[0]]=!1,t.view.setType(t.data[0],!0))}));var e=d.findChildComponent(this.node,"scroll",s);this.scroll=this.view.addUIList(e,y,!1,0),this.scroll.selectedMode=h.SINGLE,this.scroll.touchEvent=!1,this.scrollNode=d.findChild(this.node,"scroll"),this.scrollUT=d.findChildComponent(this.node,"scroll",l)},n.onRender=function(t,i){this.txtTitle.string=GetLanguage(t[1]);var e=t[0],n=this.view.curType==e&&!this.view.hideList[e];this.scrollNode.active=n,this.arrUp.active=n,this.arrDown.active=!n;var o=.01;if(0!=e){var s=configFate.getDataByList("quality",e);if(n){var a=Math.ceil(s.length);o=140*a+15*(a-1)+15+15,this.scrollUT.height=o,this.imgBG1.getComponent(l).height=o+52,this.imgBG1.active=!0,this.imgBG2.active=!1}else this.imgBG1.active=!1,this.imgBG2.active=!0;this.scroll.datas=s}this.ut.height=42+o},n.UpdateSelect=function(){var t=this.view.curType==this.data[0]&&!this.view.hideList[this.data[0]];this.scrollNode.active=t,this.arrUp.active=t,this.arrDown.active=!t;var i=.01;if(t){var e=this.scroll.datas,n=Math.ceil(e.length);i=88*n+15*(n-1)+15+15,this.scrollUT.height=i}this.ut.height=42+i},e}(c),y=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).icon=void 0,i.name=void 0,i.attrscroll=void 0,i.scrollUT=void 0,i.fate_id=void 0,i.btn=void 0,i}i(n,t);var c=n.prototype;return c.onInit=function(){var t=this;this.icon=d.findChildComponent(this.node,"icon",r),this.name=d.findChildComponent(this.node,"name",a);var i=d.findChildComponent(this.node,"scroll",s);this.attrscroll=this.view.addUIList(i,m),this.attrscroll.selectedMode=h.SINGLE,this.scrollUT=d.findChildComponent(this.node,"scroll",l),this.btn=d.findChild(this.node,"btn"),this.view.addComponentCallbackListener(this.btn,o.EventType.CLICK,(function(){uiMgr.openView("FateExtAttrView",t.data.fate_id)}))},c.onRender=function(t,i){this.fate_id=t.fate_id,this.name.string=t.name+" LV.1";for(var n,o=configFate_level.getDataByKeys("fate_id",this.fate_id,"level",1),s=[],a=e(o.attr);!(n=a()).done;){var l=n.value;s.push({type:1,info:l})}for(var r,h=e(o.skill);!(r=h()).done;){var c=r.value;s.push({type:2,info:c})}this.attrscroll.datas=s;var d=configFate.getDataByKey(this.fate_id);this.view.loadIcon(this.icon,"icon_fate",d.icon,null,v.ICON_SPRITE),this.btn.active=t.preview.length>0},n}(c),m=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).attr=void 0,i.val=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.attr=d.findChildComponent(this.node,"attr",a),this.val=d.findChildComponent(this.node,"val",a)},n.onRender=function(t,i){if(1==t.type){var e=configAttribute.getDataByKey(t.info[0]);this.attr.string=e.desc,this.val.string=IS(p).getAttrValueShow(t.info[0],t.info[1])}else{var n=configSkill.getDataByKey(t.info[0]),o=configSkill_level.getDataByKeys("id",n.id,"level",t.info[1]);this.attr.string=n.name,this.val.string=f.formatStr.apply(f,[o.desc].concat(o.desc_parm))}},e}(c);n._RF.pop()}}}));

