System.register("chunks:///_virtual/Record.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EnumDefine.ts"],(function(t){"use strict";var a,e,i;return{setters:[function(t){a=t.createForOfIteratorHelperLoose},function(t){e=t.cclegacy},function(t){i=t.UnityType}],execute:function(){e._RF.push({},"95952dJ77lKmKV0Oc8tipEy","Record",void 0);var n=1,d=2,r=3;t("Record",function(){function t(t){this.collects=[],this.damage_collects={},this.attack_collects=[],this.hp_state_collects={},this.hp_index=void 0,this.total_damage=void 0,this.commands={},this.battleMain=void 0,this.manual=!0,this.buff_collects=[],this.battleMain=t,this.hp_index=0,this.total_damage=0}var e=t.prototype;return e.addCommandSKill=function(t,a,e){var i;e=null!=(i=e)?i:this.battleMain.frameCount,this.collects.push({type:n,frame:e,id:t,skill_id:a})},e.addCommandHp=function(t,a,e,i,n){var r;n=null!=(r=n)?r:this.battleMain.frameCount,this.collects.push({type:d,frame:n,id:t,cur_hp:a,health:e,health_type:i})},e.addCommandCallUnit=function(t,a){var e;a=null!=(e=a)?e:this.battleMain.frameCount,this.collects.push({type:r,frame:a,id:t})},e.addDamage=function(a,e,i,n,d){this.battleMain.printLogFlag&&this.battleMain.printLogDebug("Record.addDamage, attackerId "+a+", defenceId "+e+", type "+i+", damage "+n+", dead "+d);var r,l=this.battleMain.unitMgr.getUnit(a),o=this.battleMain.unitMgr.getUnit(e);null!=l&&null!=o?(this.damage_collects[a]=null!=(r=this.damage_collects[a])?r:{},null==this.damage_collects[a][e]?this.damage_collects[a][e]={attacker_id:a,attacker_type:l.data.config.type,attacker_role_id:l.data.roleId,defence_id:e,defence_type:o.data.config.type,defence_role_id:o.data.roleId,type:i,damage:n,dead:d}:t.addDamage(this.damage_collects[a][e],n,d)):this.battleMain.printLogWarn("Record.addDamage error, attackerId "+a+", defenceId "+e+", type "+i+", damage "+n+", dead "+d+", attacker "+l+", defence "+o)},e.addAttack=function(t,a){this.battleMain.printLogFlag&&this.battleMain.printLogDebug("Record.addAttack, attackerId "+t+", skillId "+a);var e=this.battleMain.unitMgr.getUnit(t),i={attacker_id:t,attacker_type:e.data.config.type,attacker_role_id:e.data.roleId,skill_id:a};this.attack_collects.push(i)},e.addHpState=function(t){t.config.type==i.Boss?(this.hp_state_collects[t.unitId]={id:t.unitId,role_id:0,unit_type:t.data.config.type,unit_index:t.hpNum,hp:t.data.currenHp},this.battleMain.printLogFlag&&this.battleMain.printLogDebug("Record.addHpState, unitId "+t.unitId+", unitIndex "+t.hpNum+", hp "+t.data.currenHp)):t.config.type==i.Player&&(this.hp_state_collects[t.unitId]={id:t.unitId,role_id:t.data.roleId,unit_type:t.data.config.type,unit_index:0,hp:t.data.currenHp},this.battleMain.printLogFlag&&this.battleMain.printLogDebug("Record.addHpState, unitId "+t.unitId+", roleId "+t.data.roleId+", hp "+t.data.currenHp))},e.fillCommand=function(t,a){var e=this;void 0===a&&(a=!1),t.forEach((function(t){var i,d;e.commands[t.frame]=null!=(i=e.commands[t.frame])?i:[],e.commands[t.frame].push(t),a&&(t.type=null!=(d=t.type)?d:n)}))},e.updateFrame=function(t){var e=this.commands[t];if(null!=e){this.battleMain.printLogFlag&&this.battleMain.printLogDebug("operator, frame "+t+", list "+e);for(var i,d=a(e);!(i=d()).done;){var r=i.value,l=this.battleMain.unitMgr.getUnit(r.id);if(l&&l.data)switch(r.type){case n:l.addUnlimitSkill(l.data.getSkill(r.skill_id))}}}},t.damagesToArray=function(t){var a=[];for(var e in t)for(var i in t[e])a.push(t[e][i]);return a},t.sumDamage=function(t){var a=0;for(var e in t)for(var i in t[e])a+=t[e][i].damage;return a},t.addDamage=function(t,a,e){t.damage+=a,1==e&&(t.dead=1)},t.hpStateToArray=function(t){var a=[];for(var e in t)a.push(t[e]);return a},t}());e._RF.pop()}}}));

