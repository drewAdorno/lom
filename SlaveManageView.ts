System.register("chunks:///_virtual/SlaveManageView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./MessageView.ts","./FriendControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./SlaveControl.ts","./SlaveDataCache.ts","./SlaveDefine.ts","./SlaveModel.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,r,s,d,h,l,m,f,c,u,v,C,g,p,S,I,x,N,T,_;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.Label,a=t.sys,r=t.HorizontalTextAlignment,s=t.Sprite,d=t.ScrollView,h=t.js},function(t){l=t.ListItem},function(t){m=t.default},function(t){f=t.default},function(t){c=t.default},null,function(t){u=t.ConfigGlobal},function(t){v=t.default},function(t){C=t.default},function(t){g=t.default},function(t){p=t.RoleDataCache},function(t){S=t.PlayerAttr},function(t){I=t.default},function(t){x=t.SlaveDataCache},function(t){N=t.SlaveEventDefine},function(t){T=t.SlaveModel},function(t){_=t.BaseView}],execute:function(){i._RF.push({},"5dfd9E/MFtHsa4DBTNH6io6","SlaveManageView",void 0);var F=u.capture_slave_limit,E=(t("default",function(t){function i(){var e;return(e=t.call(this)||this).infoScroll=void 0,e.nodeNoMaster=void 0,e.nodeMasterName=void 0,e.txtMasterName=void 0,e.txtSlaveNum=void 0,e.txtMasterFightPower=void 0,e.txtMasterChapter=void 0,e.nodeNoSlave=void 0,e.btnSearch=void 0,e.imgHeadFrame=void 0,e.imgHead=void 0,e.txtName=void 0,e.txtFightPower=void 0,e.txtChapter=void 0,e.time=void 0,e.name="SlaveManageView",e.url="ui/module/slave/SlaveManageView",e.fullScreen=!0,e}e(i,t);var l=i.prototype;return l.onInit=function(){var t=this,e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()})),this.nodeNoMaster=this.findChild("root/content/noMaster"),this.nodeMasterName=this.findChild("root/content/masterName"),this.txtMasterName=this.findChildComponent("root/content/masterName/txtName",o),this.nodeNoSlave=this.findChild("root/content/noSlave"),this.btnSearch=this.findChild("root/content/btnSearch"),this.addComponentCallbackListener(this.btnSearch,n.EventType.CLICK,(function(){uiMgr.openView("SlaveFindView")}));var i=this.findChild("root/content/title/btnTip");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){C.showBoxTip({tip:GetLanguage(201711),btnCnt:1,horizontalAlign:a.uiMirror?r.RIGHT:r.LEFT})}));var h=this.findChild("root/content/imgFrame");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){IS(g).reqOtherRoleNotice(IS(p).GetRoleId(),1)}));var l=this.findChild("root/content/btnMaster");this.addComponentCallbackListener(l,n.EventType.CLICK,(function(){null!=IS(x).masterInfo&&IS(g).reqOtherRoleNotice(IS(x).masterInfo.role_id,1)})),this.imgHeadFrame=this.findChildComponent("root/content/imgFrame/imgHeadFrame",s),this.imgHead=this.findChildComponent("root/content/imgFrame/head",s),this.txtName=this.findChildComponent("root/content/txtName",o),this.txtFightPower=this.findChildComponent("root/content/txtFightPower",o),this.txtChapter=this.findChildComponent("root/content/txtChapter",o);var m=this.findChildComponent("root/content/ScrollView",d);this.infoScroll=this.addUIList(m,E),this.txtMasterFightPower=this.findChildComponent("root/content/masterName/txtFightPower",o),this.txtMasterChapter=this.findChildComponent("root/content/masterName/txtChapter",o),this.txtSlaveNum=this.findChildComponent("root/content/txtNum",o);var f=this.findChild("root/content/btnTip");this.addComponentCallbackListener(f,n.EventType.CLICK,(function(){var t=IS(x).slavesInfo?IS(x).slavesInfo.length:0;C.showBoxTip({tip:configCapture_slave_pvp_debuff.getDataByKey(t).desc,btnCnt:1})}))},l.registerUpdateHandler=function(){this.addEvent(N.SLAVE_INFO_BACK,this.onSlaveInfoBack,this),this.addEvent(N.SLAVE_INFO_UPDATE,this.updateInfo,this)},l.updateInfo=function(){this.updateSelfInfo(),this.updateMasterInfo(),this.updateSlaveInfo()},l.updateSelfInfo=function(){var t=IS(x).selfRoleInfo;this.txtName.string=IS(T).getRoleName(t),this.txtFightPower.string=f.GetNumString(IS(T).getAttrNumById(t,S.ROLE_ATTR_POWER_SHOW)),this.txtChapter.string=IS(T).getExtValue(t,1),this.loadRemoteIcon(IS(T).getAttrStrById(t,S.ROLE_ATTR_HEAD_URL),this.imgHead);var e=IS(T).getAttrStrById(t,S.ROLE_ATTR_HEAD_FRAME_ID);if(e>0){this.imgHeadFrame.node.active=!0;var i=configAvatar_frame.getDataByKey(e);this.loadIcon(this.imgHeadFrame,"icon_frame",i.icon)}else this.imgHeadFrame.node.active=!1},l.updateMasterInfo=function(){this.nodeNoMaster.active=v.isEmpty(IS(x).masterInfo),this.nodeMasterName.active=!v.isEmpty(IS(x).masterInfo),this.txtMasterName.string=IS(T).getRoleName(IS(x).masterInfo),this.txtMasterFightPower.string=f.GetNumString(IS(T).getAttrNumById(IS(x).masterInfo,S.ROLE_ATTR_POWER_SHOW)),this.txtMasterChapter.string=IS(T).getExtValue(IS(x).masterInfo,1)},l.onUpdate=function(t){null!=this.time&&(this.time=this.time+t,this.time>=1&&(this.time=0,this.updateTime()))},l.updateTime=function(){this.infoScroll.items.forEach((function(t,e,i){t.updateTime()}))},l.updateSlaveInfo=function(){var t=IS(x).slavesInfo;if(null==t||t.length<=0)return this.nodeNoSlave.active=!0,this.infoScroll.clearData(),void(this.txtSlaveNum.string=f.formatStrWithMirrorDeal(GetLanguage(999100109),h.formatStr("%s/%s",0,F)));this.txtSlaveNum.string=f.formatStrWithMirrorDeal(GetLanguage(999100109),h.formatStr("%s/%s",t.length,F)),this.nodeNoSlave.active=!1,this.infoScroll.datas=t},l.onSlaveInfoBack=function(t,e){t==IS(p).GetRoleId()&&this.updateInfo()},l.onAfterOpen=function(){this.time=0,IS(I).reqCaptureSlaveInfo(0),this.updateInfo()},l.onBeforeClose=function(){this.time=0},l.onDestroy=function(){},i}(_)),function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).imgHeadFrame=void 0,e.imgHead=void 0,e.txtName=void 0,e.txtChapter=void 0,e.txtTime=void 0,e}e(i,t);var a=i.prototype;return a.onInit=function(){var t=this,e=m.findChild(this.node,"imgFrame");this.view.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.data.role_id&&IS(g).reqOtherRoleNotice(t.data.role_id,1)})),this.txtName=m.findChildComponent(this.node,"txtName",o),this.imgHead=m.findChildComponent(this.node,"imgFrame/head",s),this.imgHeadFrame=m.findChildComponent(this.node,"imgFrame/imgHeadFrame",s),this.txtChapter=m.findChildComponent(this.node,"txtChapter",o);var i=m.findChild(this.node,"btnFree");this.txtTime=m.findChildComponent(this.node,"time/txtTime",o),this.view.addComponentCallbackListener(i,n.EventType.CLICK,(function(){C.showBoxTip({tip:GetLanguage(201809),func:function(e){"type_yes"==e&&IS(I).reqCaptureSlaveFree(t.data.role_id)}})}))},a.onRender=function(t,e){this.txtName.string=IS(T).getRoleName(t),this.view.loadRemoteIcon(IS(T).getAttrStrById(t,S.ROLE_ATTR_HEAD_URL),this.imgHead);var i=IS(T).getAttrNumById(t,S.ROLE_ATTR_HEAD_FRAME_ID);if(i>0){this.imgHeadFrame.node.active=!0;var n=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",n.icon)}else this.imgHeadFrame.node.active=!1;this.txtChapter.string=IS(T).getExtValue(t,1),this.updateTime()},a.updateTime=function(){if(null!=this.data){var t=IS(T).getExtValue(this.data,2);this.txtTime.string=c.formatTimeForSecond(Math.max(0,t-c.serverTime))}},i}(l));i._RF.pop()}}}));

