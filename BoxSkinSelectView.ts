System.register("chunks:///_virtual/BoxSkinSelectView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./BaseView.ts","./EquipDataCache.ts","./EquipDefine.ts","./EquipModel.ts"],(function(t){"use strict";var i,e,n,o,s,c,d,a,h,r,u,l,f,k,S,v;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.ScrollView,s=t.Label,c=t.Sprite,d=t.Vec3},function(t){a=t.SelectedType,h=t.ListItem},function(t){r=t.default},function(t){u=t.default},function(t){l=t.default},function(t){f=t.BaseView},function(t){k=t.EquipDataCache},function(t){S=t.EquipEventDefine},function(t){v=t.EquipModel}],execute:function(){e._RF.push({},"19fbcEsHAlADoxKsD7ReScG","BoxSkinSelectView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).nodeCurUse=void 0,i.btnUse=void 0,i.curId=void 0,i.skinList=void 0,i.nodeSkinUnlock=void 0,i.txtSkinLock=void 0,i.name="BoxSkinSelectView",i.url="ui/module/equip/BoxSkinSelectView",i}i(e,t);var c=e.prototype;return c.onInit=function(){var t=this,i=this.findChild("root/imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()})),this.nodeCurUse=this.findChild("root/content/using"),this.btnUse=this.findChild("root/content/btnUse"),this.addComponentCallbackListener(this.btnUse,n.EventType.CLICK,(function(){t.curId!=IS(k).curSkin&&IS(v).checkBoxConditionOk(t.curId,!0)&&IS(v).tryChangeBoxSkin(t.curId)}));var c=this.findChildComponent("root/content/scrollSkinList",o);this.skinList=this.addUIList(c,C),this.skinList.selectedMode=a.SINGLE,this.nodeSkinUnlock=this.findChild("root/content/txtUnlockSkin"),this.txtSkinLock=this.findChildComponent("root/content/txtLockSkin",s)},c.registerUpdateHandler=function(){this.addEvent(S.BOX_SKIN_CHANGE,this.updateUse,this)},c.onAfterOpen=function(){this.curId=IS(k).curSkin,this.showSkinList(),this.updateUse()},c.showSkinList=function(){for(var t=configTreasure_skin.getDatas(),i=new Array,e=0;e<t.length;e++){var n=t[e];n.open_time&&n.open_time.length>0&&!l.checkOpenTime(n.open_time)||(n.close_time&&n.close_time.length>0&&!l.checkCloseTime(n.close_time)||i.push(n))}this.skinList.datas=i},c.updateUse=function(){var t=IS(v).checkBoxConditionOk(this.curId);if(this.nodeCurUse.active=this.curId==IS(k).curSkin,this.btnUse.active=this.curId!=IS(k).curSkin&&t,t)this.nodeSkinUnlock.active=!1,this.txtSkinLock.node.active=!1;else{for(var i,e=configTreasure_skin.getDataByKey(this.curId).condition,n=!0,o=0;o<e.length;o++)2==e[o][0]&&(n=IS(v).checkBoxSingleConditionOk(e[o]),i=e[o]);if(this.nodeSkinUnlock.active=null!=i&&n,this.txtSkinLock.node.active=null!=i&&!n,null!=i&&!n){var s=i[1],c=configGoods.getDataByKey(s);this.txtSkinLock.string=c.desc}}this.skinList.items.forEach((function(t,i,e){t.updateUse()}))},c.onBeforeClose=function(){},c.onDestroy=function(){},c.updateSelect=function(){this.updateUse(),this.skinList.items.forEach((function(t,i,e){t.updateSelect()}))},e}(f));var C=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).nodeCurUse=void 0,i.nodeCurSelect=void 0,i.imgIcon=void 0,i.txtDesc=void 0,i.nodeLock=void 0,i.imgBg=void 0,i.txtTime=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.nodeCurUse=r.findChild(this.node,"cur"),this.nodeCurSelect=r.findChild(this.node,"imgSelect"),this.imgIcon=r.findChildComponent(this.node,"imgIcon",c),this.txtDesc=r.findChildComponent(this.node,"txtDesc",s),this.nodeLock=r.findChild(this.node,"lock"),this.imgBg=r.findChildComponent(this.node,"imgBg",c),this.txtTime=r.findChildComponent(this.node,"txtTime",s)},n.onRender=function(t,i){var e=t.close_time;if(e&&e.length>0){this.txtTime.node.active=!0;var n=l.formatDate(new Date(1e3*l.getActivityTime(e)),"yyyy.MM.dd");this.txtTime.string=u.formatStrWithMirrorDeal(GetLanguage(200773),n)}else this.txtTime.node.active=!1;var o=IS(v).checkBoxConditionOk(t.id);this.nodeLock.active=!o,this.view.loadIcon(this.imgIcon,"equip",t.icon);var s=t.icon_scale/1e4;if(this.imgIcon.node.scale=new d(s,s,s),this.imgBg.grayscale=!o,this.imgIcon.grayscale=!o,o)this.txtDesc.node.active=!1;else{for(var c,a=0;a<t.condition.length;a++)if(1==t.condition[a][0]&&!IS(v).checkBoxSingleConditionOk(t.condition[a],!1)){c=t.condition[a];break}this.txtDesc.node.active=null!=c,c&&(this.txtDesc.string=u.formatStr(GetLanguage(12910006),t.condition[0][1]))}this.updateUse(),this.updateSelect()},n.updateUse=function(){this.nodeCurUse.active=this.data.id==IS(k).curSkin},n.updateSelect=function(){var t=this.view;this.nodeCurSelect.active=this.data.id==t.curId},n.onItemClick=function(){var t=this.view;t.curId!=this.data.id&&(t.curId=this.data.id,t.updateSelect())},e}(h);e._RF.pop()}}}));

