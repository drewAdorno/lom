System.register("chunks:///_virtual/PayGemView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./BagModel.ts","./MainViewModel.ts","./MallDefine.ts","./RoleDataCache.ts","./RoleDefine.ts","./PayDataCache.ts","./PayDefine.ts","./UIDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var i,e,n,o,s,a,d,l,h,r,c,u,p,m,f,g,v,y,C,I,x,N,w,b,P;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.Animation,a=t.ScrollView,d=t.Label,l=t.Sprite,h=t.sys,r=t.Widget,c=t.js,u=t.tween},function(t){p=t.ListItem},function(t){m=t.default},function(t){f=t.default},null,function(t){g=t.IconAseetType},function(t){v=t.BagModel},function(t){y=t.MainViewModel},function(t){C=t.MallType},function(t){I=t.RoleDataCache},function(t){x=t.RoleEventDefine},function(t){N=t.default},function(t){w=t.PayEventDefine},function(t){b=t.PanelTabType},function(t){P=t.BaseSubView}],execute:function(){n._RF.push({},"346ccNlQ0hL4rOAij2u5wE7","PayGemView",void 0);var R=[2],S=(t("default",function(t){function n(){var i;return(i=t.call(this)||this).scroll=void 0,i.content=void 0,i.btnBox=void 0,i.boxRed=void 0,i.animTop=void 0,i.isFirstOpen=void 0,i.nodeResItem=void 0,i.nodeResParent=void 0,i.resItems=void 0,i.name="PayGemView",i.url="ui/module/shop/PayGemView",i.poolTime=3e3,i}i(n,t);var h=n.prototype;return h.onInit=function(){this.nodeResParent=this.findChild("resRoot"),this.nodeResItem=this.findChild("resRoot/resItem"),this.nodeResItem.active=!1,this.boxRed=this.findChild("top/box/red"),this.btnBox=this.findChild("top/box"),this.addComponentCallbackListener(this.btnBox,o.EventType.CLICK,(function(){uiMgr.openView("PayRechargeRewardView")})),this.animTop=this.findChildComponent("top",s),this.content=this.findChild("scrollList/view/content");var t=this.findChildComponent("scrollList",a);this.scroll=this.addUIList(t,S,!0,0),this.initResShow()},h.registerUpdateHandler=function(){this.addEvent(w.PAY_INFO_UPDATE,this.updateInfo,this),this.addEvent(x.ROLE_RES_UPDATE,this.onRoleResUpdate,this)},h.onAfterOpen=function(){var t=this;this.isFirstOpen=!0,this.animTop.play(),this.btnBox.active=!1,this.boxRed.active=!1;for(var i,n=[].concat(configDiamond_mall.getDatas()),o=configMall.getDataByList("type",C.Gem),a=[],d=[],l=[],h=e(o);!(i=h()).done;){var r=i.value;1==r.goods_type?a.push(r):2==r.goods_type?d.push(r):5==r.goods_type&&l.push(r)}n.sort((function(t,i){return t.id-i.id})),a.sort((function(t,i){return t.id-i.id})),d.sort((function(t,i){return t.id-i.id})),l.sort((function(t,i){return t.id-i.id}));var c=[GetLanguage(200474),n],p=[GetLanguage(200477),a],m=[GetLanguage(200478),d],f=[GetLanguage(200479),l],g=[];g.push(c),g.push(m),g.push(f),g.push(p),this.scroll.datas=g,this.content.setPosition(0,0,0);var v=this.parentView.openArgs;null!=v&&v[0]==b.Shop_Gem&&"number"==typeof v[1]&&(this.scroll.scrollTo(v[1]),v.splice(1,1));for(var y=function(i){var e=t.scroll.getItemByListId(i);if(null!=e){var n=e.node.getComponent(s);n.play(),n.pause(),u(e.node).delay(.05+.05*i).call((function(){e.PlayAnim()})).start()}},I=0;I<g.length;I++)y(I);this.addTimer(.05+.05*(g.length-1)+.3,1,(function(){t.isFirstOpen=!1,t.scroll.updateAll()})),this.updateResShow()},h.initResShow=function(){var t=this;this.resItems=new Array;for(var i=function(i){var e=nodeInstantiate.instantiate(t.nodeResItem),n=R[i];t.addComponentCallbackListener(e,o.EventType.CLICK,(function(){1==n?IS(y).TryJumpToMainViewPanel(b.Main_Shop,b.Shop_Gem,[1]):2==n?IS(y).TryJumpToMainViewPanel(b.Main_Shop,b.Shop_Gem,[0]):IS(v).OpenItemTips(n,e)})),e.parent=t.nodeResParent,e.active=!0;var s=m.findChildComponent(e,"imgIcon",l),a=configGoods.getDataByKey(n);t.loadIcon(s,a.icon_group,a.icon),m.findChild(e,"imgAdd").active=1==n||2==n,t.resItems.push({node:e,txtNum:m.findChildComponent(e,"txtNum",d),goodsGtid:n})},e=0;e<R.length;e++)i(e)},h.updateResShow=function(){for(var t=0;t<this.resItems.length;t++)this.resItems[t].txtNum.string=f.GetNumString(IS(v).getGoodsCountByGoodsGtid(this.resItems[t].goodsGtid))},h.onRoleResUpdate=function(){this.updateResShow()},h.onBeforeClose=function(){},h.onDestroy=function(){},h.updateInfo=function(){this.btnBox.active=!1,this.boxRed.active=!1,this.scroll.updateAll()},n}(P)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtTitle=void 0,i.scroll=void 0,i.anim=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.adaptiveSize=!0,this.anim=this.node.getComponent(s),this.txtTitle=m.findChildComponent(this.node,"title/Label",d);var t=m.findChildComponent(this.node,"scroll",a);this.scroll=this.view.addUIList(t,_,!1,0),this.scroll.touchEvent=!1},n.onRender=function(t,i){if(!this.view.isFirstOpen){var e=this.node.position;this.node.setPosition(360,e.y)}this.txtTitle.string=t[0];var n=Math.ceil(t[1].length/2),o=240*n+30*(n-1)+27+.01;this.scroll.height=o,this.scroll.datas=t[1],this.ut.height=75+o},n.PlayAnim=function(){this.anim.play()},e}(p)),_=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).bg=void 0,i.icon=void 0,i.txtName=void 0,i.btnBuy=void 0,i.txtPrice=void 0,i.priceIcon=void 0,i.gemNumNode=void 0,i.txtGemNum=void 0,i.txtGemNumExt=void 0,i.gemExt=void 0,i.nums=[],i.mallNumNode=void 0,i.txtMallNum=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;if(this.bg=m.findChild(this.node,"img2"),this.txtName=m.findChildComponent(this.node,"txtName",d),this.icon=m.findChildComponent(this.node,"icon",l),this.priceIcon=m.findChildComponent(this.node,"btnBuy/Label/icon",l),this.txtPrice=m.findChildComponent(this.node,"btnBuy/Label",d),h.uiMirror){var i=this.priceIcon.getComponent(r);i.alignFlags=32,i.right=-40}this.gemNumNode=m.findChild(this.node,"gemNum"),this.txtGemNum=m.findChildComponent(this.node,"gemNum/txtNum",d),this.gemExt=m.findChild(this.node,"gemNum/ext"),this.mallNumNode=m.findChild(this.node,"mallNum"),this.txtMallNum=m.findChildComponent(this.node,"mallNum/txtNum",d),this.btnBuy=m.findChild(this.node,"btnBuy"),this.view.addComponentCallbackListener(this.btnBuy,o.EventType.CLICK,(function(){null==t.data.goods_type?IS(N).Pay(t.data.id):t.data.condition.length>0&&"openfunc"==t.data.condition[0][0]?IS(I).CheckFuncOpen(t.data.condition[0][1],!0)&&uiMgr.openView("MallTipsView",t.data):uiMgr.openView("MallTipsView",t.data)}))},n.onRender=function(t,i){if(this.bg.active=i%2==0,this.gemNumNode.active=null==t.goods_type,this.priceIcon.node.active=null!=t.goods_type,this.mallNumNode.active=null!=t.goods_type,null==t.goods_type){var e=configPay_mall.getDataByKey(t.id);this.view.loadIcon(this.icon,"pay1",e.pic_back),this.txtName.string=e.name,this.txtPrice.string=IS(N).GetPriceString(e.cost_level),this.txtPrice.node.setPosition(0,0,0),this.txtGemNum.string=c.formatStr("x%s",t.recharge);var n=IS(N).GetPayGiftInfo(e.id);null!=n&&n.bought_times>0?(this.gemExt.active=!1,t.gift):(this.gemExt.active=!0,t.first_gift)}else{this.view.loadIcon(this.icon,"pay1",t.icon);var o=configGoods.getDataByKey(t.price[0]);this.view.loadIcon(this.priceIcon,"icon_item",o.icon,null,g.UI_ATLAS,!0),this.txtName.string=t.name,this.txtPrice.node.setPosition(12,0,0),this.txtPrice.string=t.price[1],this.txtMallNum.string=t.goods[1]}},e}(p);n._RF.pop()}}}));

