System.register("chunks:///_virtual/GvGReportView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./RedPointMgr.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./BaseView.ts","./RoleDataCache.ts","./RoleDefine.ts","./GvGControl.ts","./GvGDefine.ts"],(function(t){"use strict";var i,e,n,o,s,h,a,d,f,r,l,g,v,c,u,m,p,C,b,R,L,I,B;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.ScrollView,s=t.Sprite,h=t.Label,a=t.ProgressBar,d=t.sys,f=t.Layout,r=t.js,l=t.Vec2},function(t){g=t.SelectedType,v=t.ListItem},function(t){c=t.RedPointMgr},function(t){u=t.default},function(t){m=t.default},function(t){p=t.default},function(t){C=t.BaseView},function(t){b=t.RoleDataCache},function(t){R=t.RoleEventDefine,L=t.RoleRedPointSystemEnum},function(t){I=t.default},function(t){B=t.GvGEventDefine}],execute:function(){var k;e._RF.push({},"73c1cUOq3BHb49POz0qVoP8","GvGReportView",void 0);var _=((k={})[1]="Top",k[2]="Middle",k[3]="Bottom",k),w=(t("default",function(t){function e(){var i;return(i=t.call(this)||this).itemList=void 0,i.road=void 0,i.reportList=void 0,i.tabItems=[],i.name="GvGReportView",i.url="ui/module/gvg/GvGReportView",i}i(e,t);var s=e.prototype;return s.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.onMaskClick()}));var e=this.findChild("container/content/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.onMaskClick()}));var s=this.findChildComponent("container/content/scroll",o);this.itemList=this.addUIList(s,w),this.itemList.selectedMode=g.SINGLE,this.initTabItems()},s.initTabItems=function(){for(var t=this,i=function(i){var e=i,o=_[e],s=t.findChild(r.formatStr("tab/scrollTab/view/content/item%s",o));t.addRedPoint(r.formatStr("gvgReport/%s",e),s,new l(70,30)),t.addComponentCallbackListener(s,n.EventType.CLICK,(function(){t.onClickRoad(e)}));var h=u.findChild(s,"selected");h.active=!1,t.tabItems.push({node:s,road:e,nodeSelect:h})},e=1;e<=3;e++)i(e)},s.registerUpdateHandler=function(){this.addEvent(B.GVG_FIGHT_REPORT_BACK,this.onGvGFightReportBack,this),this.addEvent(R.ROLE_RED_POINT_LIST_UPDATE,this.updateTabRedPoint,this),this.addEvent(R.ROLE_RED_DETAIL_UPDATE,this.updateTabRedPoint,this)},s.onMaskClick=function(){this.close()},s.onAfterOpen=function(){this.road=this.openArgs[0]||1,IS(I).reqGvGFightReport(this.road),this.updateTabSelect(),this.updateTabRedPoint()},s.updateTabRedPoint=function(){IS(c).changeValue("gvgReport/1",IS(b).getRedNumByModule(L.System_Guild,2)),IS(c).changeValue("gvgReport/2",IS(b).getRedNumByModule(L.System_Guild,3)),IS(c).changeValue("gvgReport/3",IS(b).getRedNumByModule(L.System_Guild,4))},s.refreshList=function(){null==this.reportList||this.reportList.length<=0?this.itemList.clearData():this.itemList.datas=this.reportList},s.updateTabSelect=function(){for(var t=0;t<this.tabItems.length;t++)this.tabItems[t].nodeSelect.active=this.road&&this.road==this.tabItems[t].road},s.onBeforeClose=function(){this.reportList=null},s.onDestroy=function(){},s.onClickRoad=function(t){this.road!=t&&(this.road=t,this.updateTabSelect(),IS(I).reqGvGFightReport(this.road))},s.onGvGFightReportBack=function(t,i){this.road==t&&(this.reportList=i,this.refreshList())},e}(C)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).imgBg=void 0,i.nodeBtnReview=void 0,i.txtTime=void 0,i.nodeBreak=void 0,i.nodeKill=void 0,i.nodeFight=void 0,i.txtBreakDesc=void 0,i.imgKillIcon=void 0,i.txtKillDesc=void 0,i.imgFightIconLeft=void 0,i.imgFightIconRight=void 0,i.nodeWinMask=void 0,i.nodeLoseMask=void 0,i.imgFlag=void 0,i.txtNameLeft=void 0,i.txtNameRight=void 0,i.pbLeft=void 0,i.pbRight=void 0,i.btnBuffLeft=void 0,i.btnBuffRight=void 0,i.leftBuffId=void 0,i.rightBuffId=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.adaptiveSize=!0,this.imgBg=u.findChildComponent(this.node,"imgBg",s),this.nodeBtnReview=u.findChild(this.node,"time/btnReview"),this.view.addComponentCallbackListener(this.nodeBtnReview,n.EventType.CLICK,(function(){t.onReviewClick()})),this.txtTime=u.findChildComponent(this.node,"time/txtTime",h),this.nodeBreak=u.findChild(this.node,"break"),this.nodeKill=u.findChild(this.node,"kill"),this.nodeFight=u.findChild(this.node,"fight"),this.txtBreakDesc=u.findChildComponent(this.node,"break/txtDesc",h),this.imgKillIcon=u.findChildComponent(this.node,"kill/imgIcon",s),this.txtKillDesc=u.findChildComponent(this.node,"kill/txtDesc",h),this.imgFightIconLeft=u.findChildComponent(this.node,"fight/imgIcon1",s),this.imgFightIconRight=u.findChildComponent(this.node,"fight/imgIcon2",s),this.nodeWinMask=u.findChild(this.node,"fight/winMask"),this.nodeLoseMask=u.findChild(this.node,"fight/loseMask"),this.imgFlag=u.findChildComponent(this.node,"fight/imgFlag",s),this.txtNameLeft=u.findChildComponent(this.node,"fight/txtName1",h),this.txtNameRight=u.findChildComponent(this.node,"fight/txtName2",h),this.pbLeft=u.findChildComponent(this.node,"fight/pbLeft",a),this.pbRight=u.findChildComponent(this.node,"fight/pbRight",a),this.btnBuffLeft=u.findChild(this.node,"fight/btnBuffLeft"),this.view.addComponentCallbackListener(this.btnBuffLeft,n.EventType.CLICK,(function(){if(null!=t.leftBuffId){var i=configFamliy_gvg_bufflist.getDataByKey(t.leftBuffId);uiMgr.openView("JobSkillTipsView",i.buff_desc,t.btnBuffLeft)}})),this.btnBuffRight=u.findChild(this.node,"fight/btnBuffRight"),this.view.addComponentCallbackListener(this.btnBuffRight,n.EventType.CLICK,(function(){if(null!=t.rightBuffId){var i=configFamliy_gvg_bufflist.getDataByKey(t.rightBuffId);uiMgr.openView("JobSkillTipsView",i.buff_desc,t.btnBuffRight)}})),d.uiMirror&&(this.view.loadIcon(this.nodeBtnReview.getComponent(s),"gvg","gvg_btn_huifang"),this.view.dealMirrorLayout(u.findChildComponent(this.node,"time",f)))},o.onRender=function(t,i){this.data=t;var e,n=t.type;switch(this.nodeBtnReview.active=2==n,this.nodeKill.active=1==n,this.nodeFight.active=2==n,this.nodeBreak.active=3==n,this.view.road){case 1:e=GetLanguage(200387);break;case 2:e=GetLanguage(200388);break;case 3:e=GetLanguage(200389)}var o=t.status;if(this.txtTime.string=p.formatDate(new Date(1e3*t.time),"yyyy/MM/dd hh:mm:ss")+p.GetServerTimeZoneStr(),1==n)this.view.loadIcon(this.imgBg,"gvg",0==o?"gvg_img_zhanbao_red":"gvg_img_zhanbao_blue"),this.view.loadRemoteIcon(t.head.url,this.imgKillIcon),this.txtKillDesc.string=m.formatStr(GetLanguage(200397),t.name,e,t.num);else if(2==n){this.view.loadIcon(this.imgBg,"gvg",0==o?"gvg_img_zhanbao_shibai":"gvg_img_zhanbao_shengli"),this.view.loadIcon(this.imgFlag,"gvg",0==o?"gvg_img_shibai":"gvg_img_shengli"),this.nodeWinMask.active=1==o,this.nodeLoseMask.active=0==o;var s=t.battle_report,h=s.atk_role,a=s.def_role;this.view.loadRemoteIcon(h.head.url,this.imgFightIconLeft),this.view.loadRemoteIcon(a.head.url,this.imgFightIconRight),this.txtNameLeft.string=h.name,this.txtNameRight.string=a.name;var d,f,r,l,g=h.ext,v=a.ext;if(g)for(var c=0;c<g.length;c++)4==g[c].k&&(d=g[c].v),5==g[c].k&&(r=g[c].v);if(v)for(var u=0;u<v.length;u++)4==v[u].k&&(f=v[u].v),5==v[u].k&&(l=v[u].v);if(this.pbLeft.progress=r?Math.min(1,d/r):h.left_hp/1e4,this.pbRight.progress=l?Math.min(1,f/l):a.left_hp/1e4,this.btnBuffLeft.active=!1,g)for(var C=0;C<g.length;C++)if(3==g[C].k&&0!=g[C].v){this.btnBuffLeft.active=!0,this.leftBuffId=g[C].v;break}if(this.btnBuffRight.active=!1,v)for(var b=0;b<v.length;b++)if(3==v[b].k&&0!=v[b].v){this.btnBuffRight.active=!0,this.rightBuffId=v[b].v;break}}else 3==n&&(this.view.loadIcon(this.imgBg,"gvg",0==o?"gvg_img_zhanbao02":"gvg_img_zhanbao01"),this.txtBreakDesc.string=0==o?m.formatStrWithMirrorDeal(GetLanguage(200398),e):m.formatStrWithMirrorDeal(GetLanguage(200399),e));this.ut.height=2==n?224:184},o.onReviewClick=function(){var t=this.view;IS(I).reqGvgVideo(this.data.battle_report.vid,0,t.road)},e}(v));e._RF.pop()}}}));

