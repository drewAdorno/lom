System.register("chunks:///_virtual/FriendModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./LoginDefine.ts","./FriendControl.ts","./RedPointMgr.ts","./index57.ts","./ChatDataCache.ts","./RoleDataCache.ts","./FriendDefine.ts","./UIDefine.ts"],(function(i){"use strict";var t,e,n,r,s,f,d,h,L,l;return{setters:[function(i){t=i.createForOfIteratorHelperLoose},function(i){e=i.cclegacy},function(i){n=i.LoginEventDefine},function(i){r=i.default},function(i){s=i.RedPointMgr},null,function(i){f=i.ChatDataCache},function(i){d=i.RoleDataCache},function(i){h=i.FriendListType,L=i.FriendDefine},function(i){l=i.OpenFunction}],execute:function(){e._RF.push({},"b2976IR++xP3pEpD6O3wFA1","FriendModel",void 0);i("FriendModel",function(){var i=e.prototype;function e(){this.friendList=void 0,this.lessRecommendTime=void 0,this.friend_gift_num=0,this.checkOtherType=void 0,this.cacheLookType=0,this.searchList=null,normalEvent.on(n.LOGIN_SUCCESS,this.onLoginCallback,this)}return i.clear=function(){},i.onLoginCallback=function(){this.InitList(),IS(r).reqFriendList(h.FriendList,1),IS(r).reqFriendList(h.FriendRequest,1)},i.InitList=function(){this.friendList=new Array;for(var i=0;i<4;i++)this.friendList.push({type:i+1,friendList:[],total_num:0})},i.InitFriendList=function(i){null==this.friendList&&this.InitList();var t=i.friend_list||{};if(null!=i.refresh_time&&(this.lessRecommendTime=i.refresh_time),1==i.page){for(var e=new Array,n=0;n<t.length;n++)e.push(t[n]);for(var r=0;r<this.friendList.length;r++)this.friendList[r].type==i.type&&(this.friendList[r].friendList=e,this.friendList[r].total_num=i.num||0)}else{for(var s,f=0;f<this.friendList.length;f++)this.friendList[f].type==i.type&&(s=this.friendList[f].friendList);if(s)for(var d=0;d<t.length;d++)s.push(t[d])}this.GetFriendRed(),normalEvent.emit(L.FriendRedChange)},i.updateFriendList=function(i){if(this.friendList){for(var t=[],e=0;e<i.friend_list.length;e++)t[i.friend_list[e].role_id]={is_have:!1,info:i.friend_list[e]},3==i.type&&IS(f).RemoveFriendDataByBlack(i.friend_list[e].role_id);if(1==i.type){for(var n=!1,r=0;r<this.friendList.length;r++)if(this.friendList[r].type==h.FriendList){n=!0;for(var s=0;s<this.friendList[r].friendList.length;s++){var d=this.friendList[r].friendList[s].role_id;null!=t[d]&&(t[d].is_have=!0)}for(var l in t){var o=t[l];o.is_have||this.friendList[r].friendList.push(o.info)}}else if(this.friendList[r].type==h.FriendRequest){for(var a=new Array,u=0;u<this.friendList[r].friendList.length;u++){null==t[this.friendList[r].friendList[u].role_id]&&a.push(this.friendList[r].friendList[u])}this.friendList[r].friendList=a}else if(this.friendList[r].type==h.FriendRecommend)for(var c=0;c<this.friendList[r].friendList.length;c++){var p=this.friendList[r].friendList[c].role_id;null!=t[p]&&(this.friendList[r].friendList[c].type=t[p].info.type)}n||this.friendList.push({type:h.FriendList,friendList:i.friend_list,total_num:i.friend_list.length})}else if(2==i.type){for(var v=[],_=0;_<this.friendList.length;_++)if(this.friendList[_].type==h.FriendList){for(var g=0;g<this.friendList[_].friendList.length;g++){var y=this.friendList[_].friendList[g].role_id;null!=t[y]?t[y].is_have=!0:v.push(this.friendList[_].friendList[g])}this.friendList[_].friendList=v}}else if(3==i.type){for(var m=[],F=0;F<this.friendList.length;F++)if(this.friendList[F].type==h.FriendList){for(var R=0;R<this.friendList[F].friendList.length;R++){null!=t[this.friendList[F].friendList[R].role_id]||m.push(this.friendList[F].friendList[R])}this.friendList[F].friendList=m}else if(this.friendList[F].type==h.FriendBlack){for(var k=0;k<this.friendList[F].friendList.length;k++){var C=this.friendList[F].friendList[k].role_id;null!=t[C]&&(t[C].is_have=!0)}for(var I in t){var G=t[I];G.is_have||this.friendList[F].friendList.push(G.info)}}}else if(4==i.type){for(var D=[],S=0;S<this.friendList.length;S++)if(this.friendList[S].type==h.FriendBlack){for(var T=0;T<this.friendList[S].friendList.length;T++){null!=t[this.friendList[S].friendList[T].role_id]||D.push(this.friendList[S].friendList[T])}this.friendList[S].friendList=D,this.friendList[S].total_num<D.length&&(this.friendList[S].total_num=D.length)}}else if(5==i.type||6==i.type||7==i.type)for(var b=0;b<this.friendList.length;b++)if(this.friendList[b].type==h.FriendRequest){for(var B=[],q=0;q<this.friendList[b].friendList.length;q++){var E=this.friendList[b].friendList[q].role_id;if(null!=t[E]){t[E].is_have=!0;var M=t[E].info.type;1!=M&&2!=M&&3!=M||B.push(t[E].info)}else B.push(this.friendList[b].friendList[q])}for(var O in t){var N=t[O];N.is_have||1!=N.info.type&&2!=N.info.type&&3!=N.info.type||B.push(N.info)}this.friendList[b].friendList=B,this.friendList[b].total_num<B.length&&(this.friendList[b].total_num=B.length)}this.GetFriendRed(),normalEvent.emit(L.FriendRedChange)}},i.updateRecommendList=function(i){if(this.friendList){for(var t=0;t<this.friendList.length;t++)if(this.friendList[t].type==h.FriendRecommend){this.friendList[t].friendList=i.recommend_list;break}this.lessRecommendTime=i.refresh_time}},i.GetLessTime=function(){return this.lessRecommendTime?this.lessRecommendTime:0},i.GetListInfoByType=function(i){if(!this.friendList)return null;for(var t=0;t<this.friendList.length;t++)if(this.friendList[t].type==i)return this.friendList[t];return null},i.GetListByType=function(i){if(!this.friendList)return null;for(var t=0;t<this.friendList.length;t++)if(this.friendList[t].type==i)return this.friendList[t].friendList;return null},i.IsInBlack=function(i){if(!this.friendList)return!1;for(var t=0;t<this.friendList.length;t++)if(this.friendList[t].type==h.FriendBlack){for(var e=0;e<this.friendList[t].friendList.length;e++)if(this.friendList[t].friendList[e].role_id==i)return!0;break}return!1},i.IsFriend=function(i){if(!this.friendList)return!1;for(var t=0;t<this.friendList.length;t++)if(this.friendList[t].type==h.FriendList){for(var e=0;e<this.friendList[t].friendList.length;e++)if(this.friendList[t].friendList[e].role_id==i)return!0;break}return!1},i.DealFriendBack=function(i){if(!this.friendList)return!1;for(var e=0;e<this.friendList.length;e++)for(var n=0;n<this.friendList[e].friendList.length;n++)this.friendList[e].friendList[n].role_id==i.target_id&&1==i.type&&(this.friendList[e].friendList[n].type=1);if(this.searchList)for(var r,s=t(this.searchList);!(r=s()).done;){var f=r.value;f.role_id==i.target_id&&1==i.type&&(f.type=1)}},i.SendFriendGift=function(i){if(this.friendList)for(var t=i.friend_gift_state,e=0;e<this.friendList.length;e++)if(this.friendList[e].type==h.FriendList){for(var n=0;n<this.friendList[e].friendList.length;n++)if(this.friendList[e].friendList[n].role_id==t.k){this.friendList[e].friendList[n].daily_gift_type=t.v;break}break}},i.SendFriendListGiftGet=function(i){for(var t={},e=0;e<i.friend_gift_state.length;e++)t[i.friend_gift_state[e].k]=i.friend_gift_state[e];for(var n=0;n<this.friendList.length;n++)if(this.friendList[n].type==h.FriendList){for(var r=0;r<this.friendList[n].friendList.length;r++){var s=this.friendList[n].friendList[r].role_id;null!=t[s]&&(this.friendList[n].friendList[r].daily_gift_type=t[s].v)}break}},i.UpdateFriendGiftNum=function(i){this.friend_gift_num=i.num,this.GetFriendRed(),normalEvent.emit(L.FriendRedChange)},i.CheckRed=function(){return this.CheckRequestRed()+this.friend_gift_num},i.GetFriendGiftNum=function(){return this.friend_gift_num},i.CheckRequestRed=function(){if(!this.friendList)return 0;if(IS(d).CheckFuncOpen(l.FUNC_FRIEND))for(var i=0;i<this.friendList.length;i++)if(this.friendList[i].type==h.FriendRequest)return this.friendList[i].friendList.length;return 0},i.GetFriendRed=function(){IS(s).changeValue("friend_red",this.CheckRed())},e}());e._RF.pop()}}}));

