System.register("chunks:///_virtual/PvpRecordView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./BagDefine.ts","./ChatDataCache.ts","./ChatDefine.ts","./PvpControl.ts","./PvpDataCache.ts","./PvpDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,s,r,d,c,h,l,u,f,v,p,m,C;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.ScrollView,o=t.Button,a=t.Label,s=t.Sprite,r=t.sys},function(t){d=t.ListItem},function(t){c=t.default},function(t){h=t.default},null,function(t){l=t.BagEventDefine},function(t){u=t.ChatDataCache},function(t){f=t.ChatDefine},function(t){v=t.default},function(t){p=t.PvpDataCache},function(t){m=t.PvpEventDefine},function(t){C=t.BaseView}],execute:function(){i._RF.push({},"d917c8bhrdCTogCCLfrq1eR","PvpRecordView",void 0);t("PvpRecordView",function(t){function i(){var e;return(e=t.call(this)||this).scrollPvpList=void 0,e.nodeBattle=void 0,e.updateList=!1,e.txtTime=void 0,e.name="PvpRecordView",e.url="ui/module/pvp/PvpRecordView",e}e(i,t);var a=i.prototype;return a.onInit=function(){var t=this,e=this.findChild("content"),i=c.findChildComponent(e,"scrollPvp",n);this.scrollPvpList=this.addUIList(i,g),this.scrollPvpList.lackSlide=!0;var a=c.findChild(e,"btnClose");this.addComponentCallbackListener(a,o.EventType.CLICK,(function(){t.close(),uiMgr.openView("PvpMainView")}))},a.registerUpdateHandler=function(){this.addEvent(m.PVP_RECORD_LIST,this.onRecordList,this),this.addEvent(l.GOODS_INFO_UPDATE,this.onGoodsUpdate,this)},a.onAfterOpen=function(){IS(v).reqRecordList()},a.onBeforeClose=function(){this.updateList=!1},a.onDestroy=function(){},a.updateTime=function(){var t=h.getTargetTimestamp(0,0,0)/1e3+86400-h.serverTime;this.txtTime.string=h.msToHMS(1e3*t)},a.onRecordList=function(){IS(p).recordList.sort((function(t,e){return t.time<e.time?1:-1})),this.scrollPvpList.datas=IS(p).recordList},a.onDungeonUpdate=function(){this.updateList=!0},a.onGoodsUpdate=function(t,e){},a.onDungeonEnter=function(){this.nodeBattle.active=!0,uiMgr.close("DungeonLevelView")},i}(C));var g=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).txtName=void 0,e.txtTime=void 0,e.txtScore=void 0,e.btnGo=void 0,e.imgHeadIcon=void 0,e.imgHeadFrame=void 0,e.btnShare=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.txtName=c.findChildComponent(this.node,"txtName",a),this.txtTime=c.findChildComponent(this.node,"txtTime",a),this.txtScore=c.findChildComponent(this.node,"txtScore",a),this.imgHeadIcon=c.findChildComponent(this.node,"imgHeadIcon",s),this.imgHeadFrame=c.findChildComponent(this.node,"imgHeadFrame",s),this.btnGo=c.findChild(this.node,"btnGo"),this.view.addComponentCallbackListener(this.btnGo,o.EventType.CLICK,(function(){IS(v).reqRecordInfo(t.data.vid),battleMain.enterChapter(0),t.view.close(),uiMgr.close("PvpMainView")})),this.btnShare=c.findChild(this.node,"btnShare"),r.uiMirror&&this.view.loadIcon(c.findChild(this.node,"btnShare/icon").getComponent(s),"jjc","jjc_ICON_zhuanfaanniu"),this.view.addComponentCallbackListener(this.btnShare,o.EventType.CLICK,(function(){t.data.atk_role&&t.data.def_role&&IS(u).SendShareData(f.ChatLinkType.PvpShare,t.data)}))},n.onRender=function(t,e){this.txtName.string=t.e_name,this.txtTime.string=h.getDateDiff(t.time),this.txtScore.string=String(t.my_score_change),this.view.loadRemoteIcon(t.e_head.url,this.imgHeadIcon);var i=t.e_head.frame_id;if(i>0){this.imgHeadFrame.node.active=!0;var n=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",n.icon)}else this.imgHeadFrame.node.active=!1},i}(d);i._RF.pop()}}}));

