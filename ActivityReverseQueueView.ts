System.register("chunks:///_virtual/ActivityReverseQueueView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BattleData.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./MathUtil.ts","./BagDefine.ts","./ChapterDataCache.ts","./ChapterDefine.ts","./ResItems.ts","./ActivityDefine.ts","./ActivityReverseControl.ts","./ActivityReverseDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,s,a,r,d,h,c,v,l,u,f,C,p,m,I,g,w,y,L;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.ScrollView,a=t.Sprite,r=t.Label},function(t){d=t.ChapterType,h=t.BattleData},function(t){c=t.ListItem},function(t){v=t.default},function(t){l=t.default},null,function(t){u=t.IconAseetType},function(t){f=t.default},function(t){C=t.BagEventDefine},function(t){p=t.ChapterDataCache},function(t){m=t.ChapterEventDefine},function(t){I=t.ResItems},function(t){g=t.ActivityEventDefine},function(t){w=t.default},function(t){y=t.default},function(t){L=t.BaseView}],execute:function(){n._RF.push({},"ee38eLjPgdMMp/rgdCIAbf4","ActivityReverseQueueView",void 0);var b=[1086],S=(t("default",function(t){function n(){var e;return(e=t.call(this)||this).resItems=void 0,e.monsterScroll=void 0,e.monsterList=[],e.nodeWearMask=void 0,e.openDay=0,e.curChooseUid=0,e.name="ActivityReverseQueueView",e.url="ui/module/reverse/ActivityReverseQueueView",e}e(n,t);var a=n.prototype;return a.onInit=function(){var t=this;this.resItems=new I(this),this.resItems.init(b);var e=this.findChild("view/btnClose");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.close()}));var i=this.findChild("view/bottom/btnOneKeyWear");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){for(var t=IS(y).getMonsterList(),e=IS(y).getInfo(),i=[],n=1,o=0;o<10;o++){var s=t[o];if(s)1==e.monster_list[s.id]&&(i.push({k:n,v:s.id}),n++)}IS(w).send_24_113(i)}));var n=this.findChild("view/bottom/btnFight");this.addComponentCallbackListener(n,o.EventType.CLICK,(function(){t.openArgs[0]&&t.reqTowerDef(t.openArgs[0])})),this.nodeWearMask=this.findChild("btnWearMask"),this.addComponentCallbackListener(this.nodeWearMask,o.EventType.CLICK,(function(){t.selectWear(0)}));for(var a=1;a<=10;a++){var r=new S;r.init(this.findChild("wearParent/item"+a),this,a),this.monsterList.push(r)}var d=this.findChildComponent("view/scroll",s);this.monsterScroll=this.addUIList(d,D)},a.registerUpdateHandler=function(){this.addEvent(g.OnActivityReverseUpdate,this.updateInfo,this),this.addEvent(C.GOODS_INFO_UPDATE,this.updateResShow,this)},a.onAfterOpen=function(){this.updateResShow(),this.openDay=IS(y).getOpenDay(),this.curChooseUid=0,this.nodeWearMask.active=!1,this.monsterScroll.datas=IS(y).getMonsterList(),this.nodeWearMask.active=!1;for(var t,e=i(this.monsterList);!(t=e()).done;){t.value.show()}this.updateInfo},a.onBeforeClose=function(){},a.onDestroy=function(){},a.selectWear=function(t){this.curChooseUid=t,this.nodeWearMask.active=0!=t||!1},a.updateResShow=function(){this.resItems.update()},a.updateInfo=function(){this.monsterScroll.datas=IS(y).getMonsterList();for(var t,e=i(this.monsterList);!(t=e()).done;){t.value.show()}},a.reqTowerDef=function(t){var e=IS(p);e.chapterType=d.TowerDef,e.curDungeonId=t,e.currentLoadType=0;var i=new h;i.chapterId=t,i.chapterType=d.TowerDef,i.chapterMode=0,i.battleCheckout=0,i.seed=f.getRandomInt(1,2e4),e.battleData=i,battleMain.enterChapter(0,!0),normalEvent.emit(m.BATTLE_STATE,d.TowerDef,!0),uiMgr.closeAllView(["MainView","MessageView","GuideView","BattleHubView"])},n}(L)),function(){function t(){this.view=void 0,this.node=void 0,this.index=void 0,this.imgFrame=void 0,this.imgIcon=void 0,this.btnWear=void 0}var e=t.prototype;return e.init=function(t,e,i){this.view=e,this.node=t,this.index=i,this.onInit()},e.onInit=function(){var t=this;this.imgFrame=v.findChildComponent(this.node,"imgFrame",a),this.imgIcon=v.findChildComponent(this.node,"imgFrame/imgIcon",a),this.btnWear=v.findChild(this.node,"btnWear");var e=v.findChild(this.node,"imgFrame/btnRemove");this.view.addComponentCallbackListener(e,o.EventType.CLICK,(function(){IS(w).send_24_113([{k:t.index,v:0}])})),this.view.addComponentCallbackListener(this.node,o.EventType.CLICK,(function(){if(0!=t.view.curChooseUid)return IS(w).send_24_113([{k:t.index,v:t.view.curChooseUid}]),void t.view.selectWear(0);if(t.imgFrame.node.active){var e=IS(y).getInfo().equip_list[t.index];uiMgr.openView("ActivityReverseMonsterInfoView",e,2)}}))},e.show=function(){var t,e=null!=(t=IS(y).getInfo().equip_list[this.index])?t:0;if(0!=e){this.imgFrame.node.active=!0,this.btnWear.active=!1;var i=configReversion_war_chess.getDataByKey(e),n=configColor.getDataByKey(i.quality);this.view.loadIcon(this.imgFrame,"icon_equip",n.path),this.view.loadIcon(this.imgIcon,"icon_reversion_war",i.icon,null,u.ICON_SPRITE)}else this.imgFrame.node.active=!1,this.btnWear.active=!0},t}()),D=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).imgFrame=void 0,e.imgIcon=void 0,e.nodeLock=void 0,e.nodeCost=void 0,e.txtCost=void 0,e.imgCost=void 0,e.txtDesc=void 0,e.btnWear=void 0,e.isSet=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.imgFrame=v.findChildComponent(this.node,"imgFrame",a),this.imgIcon=v.findChildComponent(this.node,"imgIcon",a),this.nodeLock=v.findChild(this.node,"lock"),this.nodeCost=v.findChild(this.node,"cost"),this.imgCost=v.findChildComponent(this.node,"cost/imgIcon",a),this.txtCost=v.findChildComponent(this.node,"cost/txtNum",r),this.txtDesc=v.findChildComponent(this.node,"txtDesc",r),this.isSet=v.findChild(this.node,"isSet"),this.btnWear=v.findChild(this.node,"btnWear"),this.view.addComponentCallbackListener(this.btnWear,o.EventType.CLICK,(function(){t.view.addComponentCallbackListener(t.btnWear,o.EventType.CLICK,(function(){var e=IS(y).getEmptyPos();null==e?t.view.selectWear(t.data.id):IS(w).send_24_113([{k:e,v:t.data.id}])}))}));var e=v.findChild(this.node,"isSet/btnRemove");this.view.addComponentCallbackListener(e,o.EventType.CLICK,(function(){var e=IS(y).monsterEquipPos(t.data.id);e&&IS(w).send_24_113([{k:e,v:0}])})),this.view.addComponentCallbackListener(this.node,o.EventType.CLICK,(function(){uiMgr.openView("ActivityReverseMonsterInfoView",t.data.id,2)}))},n.onRender=function(t,e){var i=configColor.getDataByKey(t.quality);this.view.loadIcon(this.imgFrame,"icon_equip",i.path),this.view.loadIcon(this.imgIcon,"icon_reversion_war",t.icon,null,u.ICON_SPRITE);var n=IS(y).getInfo(),o=1==n.monster_list[t.id];if(t.unlock_day-this.view.openDay>0)this.nodeLock.active=!0,this.nodeCost.active=!1,this.txtDesc.node.active=!0,this.isSet.active=!1,this.btnWear.active=!1,this.txtDesc.string=l.formatStrWithMirrorDeal(GetLanguage(202019),t.unlock_day-this.view.openDay);else if(o){var s;for(var a in this.nodeLock.active=!1,this.nodeCost.active=!1,this.txtDesc.node.active=!1,n.equip_list){var r;if(n.equip_list.hasOwnProperty(a))if((null!=(r=n.equip_list[a])?r:0)==t.id){s=!0;break}}this.isSet.active=s,this.btnWear.active=!s}else if(this.nodeLock.active=!0,this.nodeCost.active=!0,this.txtDesc.node.active=!1,this.isSet.active=!1,this.btnWear.active=!1,t.spend.length>0){var d=configGoods.getDataByKey(t.spend[0][0]);this.view.loadIcon(this.imgCost,d.icon_group,d.icon),this.txtCost.string=t.spend[0][1]}},i}(c);n._RF.pop()}}}));

