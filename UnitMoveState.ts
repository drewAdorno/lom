System.register("chunks:///_virtual/UnitMoveState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FixMath.ts","./Target.ts","./EnumDefine.ts","./State.ts"],(function(t){"use strict";var e,i,n,a,o,r,s,u;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){n=t.FixMath},function(t){a=t.TargetUnit},function(t){o=t.UnitConfig,r=t.PathState,s=t.StateType},function(t){u=t.State}],execute:function(){i._RF.push({},"26872svGHtBzZD9s0zy7TWk","UnitMoveState",void 0);t("UnitMoveState",function(t){function i(e,i){var n;return(n=t.call(this,e,i)||this).type=s.Move,n}e(i,t);var u=i.prototype;return u.moveToTargetPos=function(){var t=this._owner,e=t.curTarget;return null!=e&&(null!=e.unit&&e.pos.set(e.unit.position),!(n.distanceX(e.pos,t.position)<=1)&&t.movectr.startMove())},u.onEnter=function(){var t=this._owner;this.moveToTargetPos()?t.animatorctr.changeState(o.ANIMATOR_MOVE,!1):this.exitState()},u.onUpdate=function(t){var e=this._owner;if(null!=e.curTarget)if(null==e.checkTarget())switch(e.movectr.state){case r.Seeking:e.animatorctr.hasState(o.ANIMATOR_MOVE)||e.animatorctr.changeState(o.ANIMATOR_MOVE);break;case r.Stop:this.exitState()}else this.exitState();else this.exitState()},u.exitState=function(){var t=this._owner;if(t.animatorctr.hasState(o.ANIMATOR_MOVE)){var e=t.curTarget;if(null!=e&&e.type==a.T_Unit){var i=n.distanceX(t.position,e.unit.position);if(i-=t.radiusSize+e.unit.radiusSize,(i=n.round(i))>t.attackDistance&&this.moveToTargetPos())return}}this.changeState()},u.onExit=function(){var t=this._owner;null!=t.curTarget&&(t.curTarget.type==a.T_Unit&&null!=t.curTarget.unit&&t.lookAt(t.curTarget.unit.position),t.applyTarget(!0),t.movectr.stopMove())},i}(u));i._RF.pop()}}}));

