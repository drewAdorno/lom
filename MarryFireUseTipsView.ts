System.register("chunks:///_virtual/MarryFireUseTipsView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./StringUtil.ts","./index57.ts","./ConfigGlobal.ts","./BagModel.ts","./MessageView.ts","./MarryControl.ts","./BaseView.ts"],(function(t){"use strict";var i,n,e,s,o,u,a,r,d,h,c,m,l,f,C;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t.Button,s=t.Label,o=t.RichText,u=t.Sprite,a=t.EditBox,r=t.js},function(t){d=t.ItemGrid},function(t){h=t.default},null,function(t){c=t.ConfigGlobal},function(t){m=t.BagModel},function(t){l=t.default},function(t){f=t.default},function(t){C=t.BaseView}],execute:function(){n._RF.push({},"0f63cDCEZ9DS6TdMwVeUTCG","MarryFireUseTipsView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).txtPrice=void 0,i.editBox=void 0,i.itemGrid=void 0,i.priceIcon=void 0,i.txtName=void 0,i.data=void 0,i.buyNum=1,i.limitNum=0,i.maxEditNum=10,i.txtAddTen=void 0,i.txtMinusTen=void 0,i.curNum=void 0,i.curType=void 0,i.btnBuy=void 0,i.btnUse=void 0,i.priceNode=void 0,i.isEnough=void 0,i.name="MarryFireUseTipsView",i.url="ui/module/marry/MarryFireUseTipsView",i}i(n,t);var C=n.prototype;return C.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.onCloseClick()})),this.itemGrid=new d(this,this.findChild("item/itemGrid")),this.txtName=this.findChildComponent("item/txtName",s),this.txtPrice=this.findChildComponent("price",o),this.priceIcon=this.findChildComponent("price/imgIcon",u),this.editBox=this.findChildComponent("EditBox",a),this.addComponentCallbackListener(this.editBox.node,a.EventType.EDITING_DID_ENDED,(function(){var i=Number(t.editBox.string);(isNaN(i)||i<=1)&&(i=1),t.buyNum=Math.floor(i),t.changeNum()})),this.btnUse=this.findChild("useBuy"),this.addComponentCallbackListener(this.btnUse,e.EventType.CLICK,(function(){IS(f).send_marry_party_action_c2s(2,0,t.buyNum),t.close()})),this.btnBuy=this.findChild("btnBuy"),this.addComponentCallbackListener(this.btnBuy,e.EventType.CLICK,(function(){var i=c.wedding_active_cost;i*=t.buyNum,l.showBoxTip({tip:h.formatStr(GetLanguage(204530),i,t.buyNum),title:GetLanguage(200048),func:function(i){if("type_yes"==i){if(!t.isEnough){var n=configGoods.getDataByKey(2);return void l.showFlyTip(h.formatStrWithMirrorDeal(GetLanguage(200453),n.name))}IS(f).send_marry_party_action_c2s(2,1,t.buyNum),t.close()}}})}));var n=this.findChild("btnAdd");this.addComponentCallbackListener(n,e.EventType.CLICK,(function(){t.changeNum(1)}));var r=this.findChild("btnMinus");this.addComponentCallbackListener(r,e.EventType.CLICK,(function(){t.changeNum(-1)}));var m=this.findChild("btnAddTen");this.addComponentCallbackListener(m,e.EventType.CLICK,(function(){t.changeNum(t.maxEditNum)})),this.txtAddTen=this.findChildComponent("btnAddTen/Label",s);var C=this.findChild("btnMinusTen");this.addComponentCallbackListener(C,e.EventType.CLICK,(function(){t.changeNum(-t.maxEditNum)})),this.txtMinusTen=this.findChildComponent("btnMinusTen/Label",s),this.priceNode=this.findChild("price")},C.onCloseClick=function(){this.close()},C.registerUpdateHandler=function(){},C.onAfterOpen=function(){this.curNum=this.openArgs[0],this.curType=this.curNum>0?1:2,this.buyNum=1;var t=configGoods.getDataByKey(1107),i=t.quality;configColor.getDataByKey(i);this.txtName.string=t.name,this.itemGrid.SetItemId(1107,this.curNum);var n=configGoods.getDataByKey(t.price[0]);this.loadIcon(this.priceIcon,n.icon_group,n.icon),this.curNum>0?this.limitNum=this.curNum:this.limitNum=99999,this.maxEditNum=null!=this.openArgs[1]?this.openArgs[1]:10,this.txtMinusTen.string=r.formatStr("-%s",this.maxEditNum),this.txtAddTen.string=r.formatStr("+%s",this.maxEditNum),this.priceNode.active=!1,this.changeNum(),this.btnUse.active=1==this.curType,this.btnBuy.active=2==this.curType},C.onBeforeClose=function(){},C.onDestroy=function(){},C.changeNum=function(t){null!=t&&(this.buyNum=this.buyNum+t);var i=0!=this.limitNum?this.limitNum:999999;if(this.buyNum=Math.min(i,Math.max(this.buyNum,1)),this.editBox.string=String(this.buyNum),2==this.curType){var n=configGoods.getDataByKey(1107),e=IS(m).getGoodsCountByGoodsGtid(n.price[0]),s=c.wedding_active_cost;s*=this.buyNum,this.isEnough=!0,e<s&&(this.isEnough=!1)}},n}(C));n._RF.pop()}}}));

