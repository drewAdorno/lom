System.register("chunks:///_virtual/GuildView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./FlagItem.ts","./GuildPinItem.ts","./TranslateTips.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./MulLanguageUtil.ts","./MessageView.ts","./FriendControl.ts","./RoleDataCache.ts","./GuildControl.ts","./GuildDataCache.ts","./GuildDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,s,d,l,r,h,u,c,f,p,C,g,m,v,I,w,b,L,G,x,y,T,S;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.sys,a=t.HorizontalTextAlignment,s=t.Label,d=t.ProgressBar,l=t.Sprite,r=t.ScrollView,h=t.js},function(t){u=t.FlagItem},function(t){c=t.GuildPinItem},function(t){f=t.TranslateTips},function(t){p=t.ListItem},function(t){C=t.default},function(t){g=t.default},function(t){m=t.default},null,function(t){v=t.ConfigGlobal},function(t){I=t.default},function(t){w=t.default},function(t){b=t.default},function(t){L=t.RoleDataCache},function(t){G=t.default},function(t){x=t.default},function(t){y=t.PermissionType,T=t.GuildEventDefine},function(t){S=t.BaseView}],execute:function(){i._RF.push({},"0b2adKVlPZAL7C4KfLF2/eX","GuildView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).txtName=void 0,e.btnName=void 0,e.txtNum=void 0,e.txtLev=void 0,e.txtExp=void 0,e.emptyFlag=void 0,e.flagItem=void 0,e.flagBtn=void 0,e.pbExp=void 0,e.txtNotice=void 0,e.btnNotice=void 0,e.btnSettingRed=void 0,e.btnDonateRed=void 0,e.btnHelpRed=void 0,e.memberList=void 0,e.guildPinItem=void 0,e.btnChangePinRed=void 0,e.translateTips=void 0,e.notice=void 0,e.name="GuildView",e.url="ui/module/guild/GuildView",e}e(i,t);var p=i.prototype;return p.onInit=function(){var t=this;this.guildPinItem=new c(this,C.findChild(this.node,"view/GuildPinItem"));var e=this.findChild("imgMask");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var h=this.findChild("view/title/tips");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){var t,e=IS(x).GetGuildInfo(),i=configGuild_level.getDataByKey(e.level),n=g.formatStrWithMirrorDeal(I.GetconfigLanguage_Text(103283).text,null!=(t=null==i?void 0:i.max_exp)?t:0);w.showBoxTip({title:GetLanguage(200282),tip:n,btnCnt:1,horizontalAlign:o.uiMirror?a.RIGHT:a.LEFT})})),this.txtName=this.findChildComponent("view/name/desc",s),this.txtNum=this.findChildComponent("view/num/desc",s),this.txtLev=this.findChildComponent("view/lev/desc",s),this.emptyFlag=this.findChild("view/flag/emptyFlag"),this.flagBtn=this.findChild("view/flag/btn"),this.addComponentCallbackListener(this.flagBtn,n.EventType.CLICK,(function(){uiMgr.openView("FlagSelectView",2)})),this.flagItem=new u(this,this.findChild("view/flag/flag")),this.txtNotice=this.findChildComponent("view/notice/ScrollView/view/content/desc",s),this.txtExp=this.findChildComponent("view/progress/txtProgress",s),this.pbExp=this.findChildComponent("view/progress/pb",d),this.btnName=this.findChild("view/name/desc/btn"),this.addComponentCallbackListener(this.btnName,n.EventType.CLICK,(function(){IS(x).CheckPermissioByType(y.Name)?uiMgr.openView("GuildRenameView"):w.showFlyTip(GetLanguage(200375))})),this.btnNotice=this.findChild("view/notice/btn"),this.loadIcon(this.findChildComponent("view/notice/btn",l),"player","grxx_ui_xiugai"),this.addComponentCallbackListener(this.btnNotice,n.EventType.CLICK,(function(){IS(x).CheckPermissioByType(y.Notice)?uiMgr.openView("GuildNoticeView"):w.showFlyTip(GetLanguage(200375))}));var p=this.findChild("view/btnSetting");this.btnSettingRed=this.findChild("view/btnSetting/red"),this.addComponentCallbackListener(p,n.EventType.CLICK,(function(){uiMgr.openView("GuildSettingTipsView",p)}));var m=this.findChild("view/btnDonate");this.btnDonateRed=this.findChild("view/btnDonate/red"),this.addComponentCallbackListener(m,n.EventType.CLICK,(function(){IS(x).GetDonateNum()<v.guild_donate_cost.length?uiMgr.openView("GuildDonateView"):w.showFlyTip(GetLanguage(200376))}));var b=this.findChild("view/btnMemberDetail");this.addComponentCallbackListener(b,n.EventType.CLICK,(function(){uiMgr.openView("GuildMemberListView",b)}));var L=this.findChild("view/btnHelp");this.btnHelpRed=this.findChild("view/btnHelp/red"),this.addComponentCallbackListener(L,n.EventType.CLICK,(function(){uiMgr.openView("GuildHelpView")}));var G=this.findChildComponent("view/list",r);this.memberList=this.addUIList(G,_);var T=this.findChild("view/btnChangePin");this.loadIcon(this.findChildComponent("view/btnChangePin",l),"player","grxx_ui_xiugai"),this.btnChangePinRed=this.findChild("view/btnChangePin/red"),this.addComponentCallbackListener(T,n.EventType.CLICK,(function(){IS(x).CheckPermissioByType(y.Flag)?uiMgr.openView("GuildPinEditView"):w.showFlyTip(GetLanguage(200375))})),this.translateTips=new f(this,C.findChild(this.node,"view/notice/translateBtn"),(function(){t.txtNotice.string=""==t.notice?GetLanguage(200334):t.translateTips.GetShowContent()}))},p.registerUpdateHandler=function(){this.addEvent(T.GUILD_INFO_UPDATE,this.updateInfo,this),this.addEvent(T.GUILD_APPLY_UPDATE,this.updateRed,this),this.addEvent(T.GUILD_HELP_UPDATE,this.updateRed,this),this.translateTips.AddTranslateEvent()},p.onAfterOpen=function(){IS(G).send_29_1(IS(L).GetGuildId()),this.updateRed(),this.guildPinItem.SetItem(IS(x).GetGuildInfo().guild_flag)},p.onBeforeClose=function(){this.translateTips.ClearInfo()},p.onDestroy=function(){},p.updateRed=function(){this.btnSettingRed.active=IS(x).HasApplyList(),this.btnDonateRed.active=0==IS(x).GetDonateNum(),this.btnChangePinRed.active=IS(x).CheckPermissioByType(y.Flag)&&(!IS(x).GetGuildInfo().guild_flag||IS(x).GetGuildInfo().guild_flag.length<8),this.btnHelpRed.active=IS(x).GetGuildHelpRed()>0},p.updateInfo=function(){this.updateRed();var t=IS(x).GetGuildInfo(),e=configGuild_level.getDataByKey(t.level);this.txtName.string=t.name,this.flagItem.SetFlag(t.country),this.emptyFlag.active=!(t.country&&t.country>0),this.txtNum.string=h.formatStr("%s/%s",t.member_num,e.max_num),this.txtLev.string=g.formatStrWithMirrorDeal(GetLanguage(200333),t.level),0==e.exp?(this.txtExp.string=GetLanguage(200127),this.pbExp.progress=1):(this.txtExp.string=h.formatStr("%s/%s",t.exp,e.exp),this.pbExp.progress=t.exp/e.exp),this.notice!=t.notice&&(this.translateTips.ClearInfo(),this.notice=t.notice,this.translateTips.SetTranslateInfo("GuildView","notice",t.notice),this.txtNotice.string=""==t.notice?GetLanguage(200334):this.translateTips.GetShowContent()),this.btnName.active=IS(x).CheckPermissioByType(y.Name),this.btnNotice.active=IS(x).CheckPermissioByType(y.Notice),this.flagBtn.active=IS(x).CheckPermissioByType(y.NationFlag);var i=IS(x).GetMemberList(),n=[];for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];n.push(a)}n.sort((function(t,e){return t.career!=e.career?IS(x).CompareCareer(t.career,e.career):t.donate_week!=e.donate_week?e.donate_week-t.donate_week:t.join_time!=e.join_time?t.join_time-e.join_time:t.role_id-e.role_id})),this.memberList.datas=n,this.guildPinItem.SetItem(IS(x).GetGuildInfo().guild_flag)},i}(S));var _=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).imgFrame=void 0,e.imgIcon=void 0,e.txtName=void 0,e.txtDonate=void 0,e.txtCareer=void 0,e.txtTime=void 0,e.btn=void 0,e}e(i,t);var o=i.prototype;return o.onInit=function(){var t=this;this.imgFrame=C.findChildComponent(this.node,"imgFrame",l),this.imgIcon=C.findChildComponent(this.node,"imgFrame/imgIcon",l),this.txtName=C.findChildComponent(this.node,"name",s),this.txtDonate=C.findChildComponent(this.node,"donate",s),this.txtCareer=C.findChildComponent(this.node,"career",s),this.txtTime=C.findChildComponent(this.node,"time",s),this.btn=C.findChild(this.node,"btn"),this.view.addComponentCallbackListener(this.btn,n.EventType.CLICK,(function(){uiMgr.openView("GuildMemberView",t.data)})),this.view.addComponentCallbackListener(this.imgFrame.node,n.EventType.CLICK,(function(){IS(b).reqOtherRoleNotice(t.data.role_id)}))},o.onRender=function(t,e){this.view.loadRemoteIcon(t.role_head.url,this.imgIcon),this.txtName.string=t.role_name,this.txtDonate.string=t.donate_week,this.txtCareer.string=configGuild_career.getDataByKey(t.career).name,0==t.is_online?this.txtTime.string=m.getDateDiff(t.offline_time):this.txtTime.string=GetLanguage(200057),this.btn.active=IS(x).CheckLowerSelfCareer(t.career)},i}(p);i._RF.pop()}}}));

