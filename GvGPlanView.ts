System.register("chunks:///_virtual/GvGPlanView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./BaseView.ts","./ConfigGlobal.ts","./MessageView.ts","./EquipDefine.ts","./PetDefine.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./PlanDetailContent.ts","./SkillDefine.ts","./StatueControl.ts","./StatueDefine.ts","./GvGDataCache.ts","./GvGDefine.ts","./UIDefine.ts"],(function(t){"use strict";var n,e,i,a,l,o,s,d,c,h,u,r,P,f,C,p,v,I,m,S,D,w,T,E,b,g,U;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t.Button,a=t.Label,l=t.sys,o=t.Sprite,s=t.Color,d=t.js,c=t.LabelOutline},function(t){h=t.default},function(t){u=t.default},function(t){r=t.default},null,function(t){P=t.BaseView},function(t){f=t.ConfigGlobal},function(t){C=t.default},function(t){p=t.EquipEventDefine},function(t){v=t.PetEventDefine},function(t){I=t.default},function(t){m=t.RoleDataCache},function(t){S=t.RoleEventDefine},function(t){D=t.PlanDetailContent},function(t){w=t.SKILLEventDefine},function(t){T=t.default},function(t){E=t.StatueEventDefine},function(t){b=t.GvGDataCache},function(t){g=t.GvGPresetId},function(t){U=t.OpenFunction}],execute:function(){e._RF.push({},"04058yHLClMQ6p2yx9VNh08","GvGPlanView",void 0);var _=f.suit_tab_limit,L=_.length;t("default",function(t){function e(){var n;return(n=t.call(this)||this).nodeCantAdjust=void 0,n.nodeTime=void 0,n.txtTime=void 0,n.btnSwitch=void 0,n.nodeIsCurTab=void 0,n.curPlanId=void 0,n.nodeContent=void 0,n.nodeNoPlan=void 0,n.txtCurPlan=void 0,n.nodeSelectPlanMask=void 0,n.nodePlanDown=void 0,n.nodePlanUp=void 0,n.nodeSelectPlan=void 0,n.selectItems=[],n.indexToPlanId={},n.btnSelectPlan=void 0,n.isSelect=!1,n.time=0,n.planDetail=void 0,n.name="GvGPlanView",n.url="ui/module/gvg/GvGPlanView",n}n(e,t);var P=e.prototype;return P.onInit=function(){var t=this,n=this.findChild("imgMask");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){t.close()}));var e=this.findChild("content/btnClose");this.addComponentCallbackListener(e,i.EventType.CLICK,(function(){t.close()})),this.nodeCantAdjust=this.findChild("content/txtLock"),this.nodeTime=this.findChild("content/timeInfo"),this.txtTime=this.findChildComponent("content/timeInfo/txtTime",a),this.btnSwitch=this.findChild("container/PlanDetailView/PlanDetailView/content/btnSwitch"),this.addComponentCallbackListener(this.btnSwitch,i.EventType.CLICK,(function(){r.serverTime>=IS(b).endTime?C.showFlyTip(GetLanguage(201625)):IS(I).send_role_change_default_plan_c2s([{k:g,v:t.curPlanId}])})),this.nodeContent=this.findChild("container/PlanDetailView/PlanDetailView/content"),this.nodeNoPlan=this.findChild("container/PlanDetailView/PlanDetailView/noPlan"),this.nodeIsCurTab=this.findChild("container/PlanDetailView/PlanDetailView/content/changeState"),this.btnSelectPlan=this.findChild("container/PlanDetailView/PlanDetailView/btnCurPlan"),this.addComponentCallbackListener(this.btnSelectPlan,i.EventType.CLICK,(function(){t.setSelectPlanActive(!t.isSelect)})),this.txtCurPlan=this.findChildComponent("container/PlanDetailView/PlanDetailView/btnCurPlan/txtPlan",a),this.nodeSelectPlanMask=this.findChild("container/PlanDetailView/PlanDetailView/maskSelectPlan"),this.addComponentCallbackListener(this.nodeSelectPlanMask,i.EventType.CLICK,(function(){t.setSelectPlanActive(!1)})),this.nodePlanDown=this.findChild("container/PlanDetailView/PlanDetailView/btnCurPlan/imgDown"),this.nodePlanUp=this.findChild("container/PlanDetailView/PlanDetailView/btnCurPlan/imgUp"),this.nodeSelectPlan=this.findChild("container/PlanDetailView/PlanDetailView/planSelect");var s=this.findChild("container/PlanDetailView/PlanDetailView/content/btnRename");this.addComponentCallbackListener(s,i.EventType.CLICK,(function(){uiMgr.openView("TabRenameView",t.curPlanId,"plan")})),l.uiMirror&&this.loadIcon(s.getComponent(o),"gvg_map","grxx_ui_xiugai");for(var u=function(n){var e=t.findChild(d.formatStr("container/PlanDetailView/PlanDetailView/planSelect/selectItem%s",n));if(n>L-1)return e.active=!1,"continue";e.active=!0,t.addComponentCallbackListener(e,i.EventType.CLICK,(function(){t.clickSelectPlan(n)})),t.selectItems.push({node:e,nodeLock:h.findChild(e,"lock"),txtName:h.findChildComponent(e,"txtPlan",a),outlineName:h.findChildComponent(e,"txtPlan",c),imgBg:h.findChildComponent(e,"imgBg",o)})},P=1;P<=4;P++)u(P);this.planDetail=new D(this,this.findChild("container/PlanDetailView/PlanDetailView/content/scroll/view/PlanDetailContent")),this.planDetail.init(!0)},P.setSelectPlanActive=function(t){this.nodePlanDown.active=!t,this.nodePlanUp.active=t,this.nodeSelectPlan.active=t,this.nodeSelectPlanMask.active=t,this.isSelect=t},P.registerUpdateHandler=function(){this.addEvent(S.PLAN_NAME_CHANGE,this.updateCurName,this),this.addEvent(S.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(S.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this),this.addEvent(p.EQUIP_LIST_UPDATE,this.updateEquipShow,this),this.addEvent(S.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(w.SKILL_TAB_INFO_UPDATE,this.onSkillTabInfoUpdate,this),this.addEvent(v.PET_TAB_INFO_UPDATE,this.onPetTabInfoUpdate,this),this.addEvent(E.HOME_FARM_STATUE_INFO_BACK,this.onHomeFarmStatueInfoBack,this),this.addEvent(S.PLAN_PRESET_UPDATE,this.onPlanPresetUpdate,this)},P.onAfterOpen=function(){this.curPlanId=IS(m).presetList[g]||1,this.setSelectPlanActive(!1),this.updateContent(),IS(T).reqStatueInfo(),this.updateTimeShow()},P.updateTimeShow=function(){if(IS(b).endTime<=0)return this.nodeCantAdjust.active=!0,void(this.nodeTime.active=!1);var t=r.serverTime,n=IS(b).endTime-t;if(n<=0)return this.nodeCantAdjust.active=!0,void(this.nodeTime.active=!1);this.nodeCantAdjust.active=!1,this.nodeTime.active=!0,this.txtTime.string=r.formatTimeForSecond(n)},P.updateContent=function(){this.nodeContent.active=0!=this.curPlanId,this.nodeNoPlan.active=0==this.curPlanId,this.btnSelectPlan.active=0!=this.curPlanId,0!=this.curPlanId?(this.updateIndexToPlan(),this.updatePlanItems(),this.updateCurName(),this.showContent(),this.updateUsePlan()):this.setSelectPlanActive(!1)},P.updateIndexToPlan=function(){for(var t=1,n=1;n<=L;n++)n!=this.curPlanId&&(this.indexToPlanId[t]=n,t+=1)},P.updatePlanItems=function(){for(var t=0;t<this.selectItems.length;t++){var n=t+1,e=this.indexToPlanId[n],i=this.selectItems[t];i.txtName.string=IS(m).getPlanName(e);var a=IS(m).checkPlanUnlock(e);i.nodeLock.active=!a,i.imgBg.grayScale=!a,i.outlineName.color=a?new s(60,42,28):new s(59,59,59)}},P.updateCurName=function(){this.txtCurPlan.string=IS(m).getPlanName(this.curPlanId)},P.updateUsePlan=function(){this.nodeIsCurTab.active=IS(m).presetList[g]==this.curPlanId,this.btnSwitch.active=IS(m).presetList[g]!=this.curPlanId},P.showContent=function(){this.planDetail.showContent(this.curPlanId)},P.updateEquipShow=function(){this.planDetail.updateEquipShow()},P.onRoleOpenFunctionUpdate=function(t){t==U.FUNC_EQUIP_SKIN&&this.planDetail.updateEquipShow(),t==U.FUNC_LEGACY&&this.showContent()},P.onSkillTabInfoUpdate=function(t){this.planDetail.tryUpdateTabSkill(t)},P.onPetTabInfoUpdate=function(t){this.planDetail.tryUpdateTabPet(t)},P.onHomeFarmStatueInfoBack=function(t){this.planDetail.curStatueInfo=t,this.showContent()},P.onUpdate=function(t){null!=this.time&&(this.time=this.time+t,this.time>=1&&(this.time=0,this.updateTimeShow()))},P.onBeforeClose=function(){this.time=0},P.onDestroy=function(){},P.OnPlanInfoBack=function(){this.updateContent()},P.onPlanInfoUpdate=function(t){t==this.curPlanId&&(this.updateCurName(),this.showContent())},P.onPlanPresetUpdate=function(){this.updateUsePlan()},P.clickSelectPlan=function(t){var n=this.indexToPlanId[t];if(IS(m).checkPlanUnlock(n))this.curPlanId=n,this.setSelectPlanActive(!1),this.updateContent();else{for(var e=0,i=0;i<L;i++)if(_[i][0]==n){e=_[i][1];break}C.showFlyTip(u.formatStrWithMirrorDeal(GetLanguage(201091),e))}},e}(P));e._RF.pop()}}}));

