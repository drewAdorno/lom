System.register("chunks:///_virtual/ChapterCrossWarCC.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BattleData.ts","./ChapterCrossWar.ts","./EnumDefine.ts","./FixMath.ts","./BattleDefine.ts","./ChapterDataCache.ts","./MessageView.ts","./CrossWarSceneControl.ts","./RoleDataCache.ts"],(function(t){"use strict";var e,a,n,r,i,s,o,u,c,h,p,l;return{setters:[function(t){e=t.inheritsLoose,a=t.regeneratorRuntime},function(t){n=t.cclegacy},function(t){r=t.ChapterType},function(t){i=t.ChapterCrossWar},function(t){s=t.RunState},function(t){o=t.FixMath},function(t){u=t.BattleEventDefine},function(t){c=t.ChapterDataCache},function(t){h=t.default},function(t){p=t.default},function(t){l=t.RoleDataCache}],execute:function(){n._RF.push({},"5b65b1mjc5HhraIVoN2M2z+","ChapterCrossWarCC",void 0);t("ChapterCrossWarCC",function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.init=function(){t.prototype.init.call(this);var e=this.battleMain;normalEvent.emit(u.BATTLE_PVP_VS,e.data)},i.endPvp=a().mark((function t(e,n,i,s,o,u){var h;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h=this.battleMain,t.next=3,coroutine.wait(1);case 3:h.stopChapter(),h.toResult(e,n,i,o,u),h.runningToPart=!1,IS(c).chapterType=r.Main,0==i?IS(p).reqBattleResult(n,IS(l).GetRoleId()):IS(p).reqBattleResult(n,h.data.playerList[2].id);case 8:case"end":return t.stop()}}),t,this)})),i.start=function(){t.prototype.start.call(this);var e=this.battleMain;if(e.timeScale=1,e.data.passTime>0){var a=Math.ceil((1e3*e.data.passTime+1e3)/33.333);a=Math.min(a,3600),e.runState,s.Running;for(var n=0;n<a&&(e.update(e.frameTime,!0),!this.over&&e.runState==s.Running);n++);this.chapterTime=o.round(this.maxChapterTime-e.data.passTime)}else e.runState=s.Wait,e.hub.showPvpTimer(),e.battleTimer.start(2,1,(function(){e.runState=s.Running}))},i.toResult=function(t,e){void 0===e&&(e=!1);var a=this.battleMain,n=this.config;0==t&&a.checkCheat()&&(t=1,h.showBoxTip({tip:GetLanguage(200998),btnCnt:1,func:function(t){},ensure:GetLanguage(200129)})),coroutine.start(this.endPvp(n.id,r.CrossWarPvp,t,a.runMode,e,a.data.source),"battle")},n}(i));n._RF.pop()}}}));

