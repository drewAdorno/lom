System.register("chunks:///_virtual/EventInvoker.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ObjectPool.ts","./ObjectUtil.ts"],(function(a){"use strict";var t,e,l,n;return{setters:[function(a){t=a.createClass},function(a){e=a.cclegacy},function(a){l=a.ObjectPool},function(a){n=a.default}],execute:function(){e._RF.push({},"b5a4eqlTphKPpreO5DMnShe","EventInvoker",void 0);var c=n.fastRemoveAt;function i(){}var r=new l(function(){function a(){this.callback=i,this.target=void 0,this.once=!1}var t=a.prototype;return t.set=function(a,t,e){this.callback=a||i,this.target=t,this.once=!!e},t.reset=function(){this.target=void 0,this.callback=i,this.once=!1},a}(),32),s=a("CallbackList",function(){function a(){this.callbackInfos=[],this.isInvoking=!1,this.containCanceled=!1}var t=a.prototype;return t.removeByCallback=function(a){for(var t=0;t<this.callbackInfos.length;++t){var e=this.callbackInfos[t];e&&e.callback===a&&(e.reset(),r.free(e),c(this.callbackInfos,t),--t)}},t.removeByTarget=function(a){for(var t=0;t<this.callbackInfos.length;++t){var e=this.callbackInfos[t];e&&e.target===a&&(e.reset(),r.free(e),c(this.callbackInfos,t),--t)}},t.cancel=function(a){var t=this.callbackInfos[a];t&&(t.reset(),this.isInvoking?this.callbackInfos[a]=null:c(this.callbackInfos,a),r.free(t)),this.containCanceled=!0},t.cancelAll=function(){for(var a=0;a<this.callbackInfos.length;a++){var t=this.callbackInfos[a];t&&(t.reset(),r.free(t),this.callbackInfos[a]=null)}this.containCanceled=!0},t.purgeCanceled=function(){for(var a=this.callbackInfos.length-1;a>=0;--a){this.callbackInfos[a]||c(this.callbackInfos,a)}this.containCanceled=!1},t.clear=function(){this.cancelAll(),this.callbackInfos.length=0,this.isInvoking=!1,this.containCanceled=!1},a}()),o=new l(s,16);a("EventInvoker",function(){function a(a){this._name=void 0,this._callbackTable=n.createMap(!0),this._name=a||""}var e=a.prototype;return e.on=function(a,t,e,l){if(!this.hasEventListener(a,t,e)){var n=this._callbackTable[a];n||(n=this._callbackTable[a]=o.alloc());var c=r.alloc();c.set(t,e,l),n.callbackInfos.push(c)}return t},e.has=function(a){return!(!this._callbackTable||!this._callbackTable[a])},e.hasEventListener=function(a,t,e){var l=this._callbackTable&&this._callbackTable[a];if(!l)return!1;var n=l.callbackInfos;if(!t){if(l.isInvoking){for(var c=0;c<n.length;++c)if(n[c])return!0;return!1}return n.length>0}for(var i=0;i<n.length;++i){var r=n[i];if(r&&r.callback===t&&r.target===e)return!0}return!1},e.removeAll=function(a){var t=typeof a;if("string"===t||"number"===t){var e=this._callbackTable&&this._callbackTable[a];e&&(e.isInvoking?e.cancelAll():(e.clear(),o.free(e),delete this._callbackTable[a]))}else if(a)for(var l in this._callbackTable){var n=this._callbackTable[l];if(n.isInvoking)for(var c=n.callbackInfos,i=0;i<c.length;++i){var r=c[i];r&&r.target===a&&n.cancel(i)}else n.removeByTarget(a)}},e.off=function(a,t,e){var l=this._callbackTable&&this._callbackTable[a];if(l){var n=l.callbackInfos;if(t)for(var c=0;c<n.length;++c){var i=n[c];if(i&&i.callback===t&&i.target===e){l.cancel(c);break}}else this.removeAll(a)}},e.emit=function(a,t,e,l,n,c,i){var r=this._callbackTable&&this._callbackTable[a];if(r){var s=!r.isInvoking;r.isInvoking=!0;for(var o=r.callbackInfos,f=0,h=o.length;f<h;++f){var b=o[f];if(b){var v=b.callback,k=b.target;b.once&&this.off(a,v,k);try{k?v.call(k,t,e,l,n,c,i):v(t,e,l,n,c,i)}catch(t){printLogException(t,"event:"+a)}}}s&&(r.isInvoking=!1,r.containCanceled&&r.purgeCanceled())}},e.clear=function(){for(var a in this._callbackTable){var t=this._callbackTable[a];t&&(t.clear(),o.free(t),delete this._callbackTable[a])}},t(a,[{key:"name",get:function(){return this._name}}]),a}());e._RF.pop()}}}));

