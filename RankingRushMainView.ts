System.register("chunks:///_virtual/RankingRushMainView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./ItemGrid.ts","./RankTitle.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./CommonModel.ts","./MessageView.ts","./FriendControl.ts","./PayControl.ts","./PayDataCache.ts","./PayDefine.ts","./FrameDataCache.ts","./RankControl.ts","./RankDefine.ts","./RankModel.ts","./RoleDataCache.ts","./RoleDefine.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./RankingRushDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,a,o,s,h,r,d,c,f,l,v,u,m,g,I,p,k,C,y,T,R,x,_,b,w,L,G,S,P,D,B,F,M,A,U,N,E,O,H,K;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,a=t.sys,o=t.HorizontalTextAlignment,s=t.Sprite,h=t.Label,r=t.ScrollView,d=t.js,c=t.ProgressBar},function(t){f=t.V2},function(t){l=t.ItemGrid},function(t){v=t.RankTitle,u=t.TitleType},function(t){m=t.ListItem},function(t){g=t.default},function(t){I=t.default},function(t){p=t.default},null,function(t){k=t.ConfigGlobal},function(t){C=t.CommonModel},function(t){y=t.default,T=t.TYPE_YES,R=t.TYPE_CANCEL},function(t){x=t.default},function(t){_=t.default},function(t){b=t.default},function(t){w=t.GiftType,L=t.PayEventDefine},function(t){G=t.FrameDataCache},function(t){S=t.default},function(t){P=t.RankDefine},function(t){D=t.RankModel},function(t){B=t.RoleDataCache},function(t){F=t.PlayerAttr},function(t){M=t.default},function(t){A=t.default},function(t){U=t.ActivityState,N=t.RankRushRes,E=t.ActivityEventDefine,O=t.ActivityTaskState},function(t){H=t.RankingRushDataCache},function(t){K=t.BaseView}],execute:function(){var q;e._RF.push({},"a2e36JXo/1MDKuLwi7MhF3m","RankingRushMainView",void 0);var V=1,j=2,W=3,Y=4,z="",J=((q={})[1]=new f(0,0),q[2]=new f(0,0),q[3]=new f(0,0),q),X=(t("default",function(t){function e(){var i;return(i=t.call(this)||this).tabBtns=[],i.taskRed=void 0,i.curIndex=0,i.topBg=void 0,i.txtTitle=void 0,i.nodeReward=void 0,i.nodeRank=void 0,i.nodeTask=void 0,i.nodeGift=void 0,i.nodeTopRank=void 0,i.nodeMyRank=void 0,i.giftList=void 0,i.rankList=void 0,i.rewardList=void 0,i.taskTopInfo=void 0,i.txtMyRank=void 0,i.txtMyScore=void 0,i.myFrame=void 0,i.myIcon=void 0,i.imgHeadFrame=void 0,i.txtMyName=void 0,i.txtLeftTime=void 0,i.deltaTime=0,i.leftTime=0,i.canUpdate=!1,i.roleList={},i.actInfo=void 0,i.rankId=void 0,i.rankInfo=void 0,i.curRankPage=void 0,i.canGetCount=0,i.name="RankingRushMainView",i.url="ui/module/activity/RankingRushMainView",i.poolTime=3e3,i}i(e,t);var c=e.prototype;return c.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var c=this.findChild("root/btnTips");this.addComponentCallbackListener(c,n.EventType.CLICK,(function(){for(var i=k.LIMITED_RANK_SYSTEM_DETAILS,e="",n=0;n<i.length;n++)null!=t.actInfo&&i[n][0]==t.actInfo.type&&(e=GetLanguage(i[n][1]));""!=e&&y.showBoxTip({tip:e,btnCnt:1,horizontalAlign:a.uiMirror?o.RIGHT:o.LEFT})})),this.taskRed=this.findChild("root/bg/bottomBtn/item3/red");for(var f=function(i){var e=g.findChild(t.node,d.formatStr("root/bg/bottomBtn/item%s",i)),a={itemGo:e,normalGo:g.findChild(e,"normal"),selectedGo:g.findChild(e,"selected"),index:i};t.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.SetIndex(a.index)})),t.tabBtns[i]=a},l=1;l<=4;l++)f(l);this.nodeGift=this.findChild("root/nodeGift"),this.nodeReward=this.findChild("root/nodeReward"),this.nodeRank=this.findChild("root/nodeRank"),this.nodeTask=this.findChild("root/nodeTask"),this.nodeTopRank=this.findChild("root/nodeTopRank"),this.nodeMyRank=this.findChild("root/myRank"),this.topBg=this.findChildComponent("root/bg/imgBanner",s),this.txtTitle=this.findChildComponent("root/txtTitle",h),this.txtLeftTime=this.findChildComponent("root/txtTime",h),this.txtMyRank=this.findChildComponent("root/myRank/rankNum",h),this.txtMyScore=this.findChildComponent("root/myRank/score",h),this.txtMyName=this.findChildComponent("root/myRank/name",h),this.myFrame=this.findChildComponent("root/myRank/imgFrame",s),this.myIcon=this.findChildComponent("root/myRank/imgFrame/imgIcon",s),this.imgHeadFrame=this.findChildComponent("root/myRank/imgFrame/imgHeadFrame",s);var v=this.findChildComponent("root/nodeRank/rankList",r);this.rankList=this.addUIList(v,Z),this.addComponentCallbackListener(v.node,r.EventType.SCROLL_TO_BOTTOM,(function(){if(t.curRankPage<t.rankInfo.max_page){t.curRankPage++;var i=new Array;i.push({type:t.rankId,server:1,page:t.curRankPage}),IS(S).reqRankList(i)}}));var u=this.findChildComponent("root/nodeReward/rankList",r);this.rewardList=this.addUIList(u,Q,!0),this.taskTopInfo=new et,this.taskTopInfo.init(this.findChild("root/nodeTask"),this);for(var m=1;m<=3;m++){var I=new $;I.init(this.findChild("root/nodeTopRank/rank"+m),this,m),this.roleList[m]=I}var p=this.findChildComponent("root/nodeGift/payList",r);this.giftList=this.addUIList(p,tt,!0)},c.onAfterOpen=function(){var t;for(var i in this.roleList)this.roleList.hasOwnProperty(i)&&this.roleList[i].show();this.txtMyName.string=IS(B).GetRoleAttr(F.ROLE_ATTR_NAME),this.loadRemoteIcon(IS(B).GetRoleAttr(F.ROLE_ATTR_HEAD_URL),this.myIcon),this.actInfo=this.openArgs[0],IS(M).send_24_14(this.actInfo.type);var e=null!=(t=this.actInfo.state_time[this.actInfo.state])?t:this.actInfo.state_time[U.Open];if(this.leftTime=e.end_time-p.serverTime,this.leftTime>0){this.canUpdate=!0;var n=p.getTimeData(this.leftTime);Math.floor(this.leftTime/86400)>0?this.txtLeftTime.string=I.formatStrWithMirrorDeal(GetLanguage(200080),n[3],n[2]):this.txtLeftTime.string=GetLanguage(200081)+p.formatTimeForSecond(this.leftTime)}else this.txtLeftTime.string=GetLanguage(200026);switch(this.loadIcon(this.topBg,"xscb_icon",N[this.actInfo.type].bg2),this.actInfo.type){case 6:this.txtTitle.string=GetLanguage(999000008);break;case 7:this.txtTitle.string=GetLanguage(999000010);break;case 8:this.txtTitle.string=GetLanguage(999000005);break;case 9:this.txtTitle.string=GetLanguage(999000013);break;case 10:this.txtTitle.string=GetLanguage(999000007);break;case 11:this.txtTitle.string=GetLanguage(999000009);break;case 12:this.txtTitle.string=GetLanguage(999000006);break;case 13:this.txtTitle.string=GetLanguage(999000012);break;case 14:this.txtTitle.string=GetLanguage(999000011);break;default:this.txtTitle.string="Unknown Rush Type"}this.rankId=this.actInfo.roundCfg.rank_id;var a=configRanktype.getDataByKey(this.rankId);z=a.prefix;var o=new Array;o.push({type:this.rankId,server:1,page:1}),this.curRankPage=1,IS(S).reqRankList(o);var s=IS(H).getRankRewardList(this.actInfo);this.rewardList.datas=s,this.actInfo.roundCfg.task_list.length>0?(this.tabBtns[W].itemGo.active=!0,this.taskTopInfo.setTaskList(this.actInfo.group_task_list),this.taskRed.active=IS(A).GetTaskRedNum(this.actInfo.type)>0):this.tabBtns[W].itemGo.active=!1;var h=IS(b).GetAcivityGift(w.Activity,this.actInfo.type,this.actInfo.round);h.length>0?(this.tabBtns[Y].itemGo.active=!0,h.sort((function(t,i){var e=IS(b).GetPayGiftInfo(t.id),n=IS(b).GetPayGiftInfo(i.id),a=e&&e.bought_times&&e.bought_times>=e.payCfg.buy_times;return a!=(n&&n.bought_times&&n.bought_times>=n.payCfg.buy_times)?a?1:-1:t.id-i.id})),this.giftList.datas=h):this.tabBtns[Y].itemGo.active=!1,this.tabBtns[W].itemGo.active?this.SetIndex(W):this.SetIndex(V);var r=IS(G).curFrameId;if(r>0){var d=configAvatar_frame.getDataByKey(r);this.loadIcon(this.imgHeadFrame,"icon_frame",d.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1},c.registerUpdateHandler=function(){this.addEvent(P.RankInfoBack,this.UpdateRankInfo,this),this.addEvent(E.OnActivityInfoTaskUpdate,this.OnTaskUpdate,this),this.addEvent(E.OnActivityInfoUpdate,this.OnTaskUpdate,this),this.addEvent(E.OnActivityInfoUpdate,this.OnViewUpdate,this),this.addEvent(L.PAY_INFO_UPDATE,this.OnPayGiftInfoUpdate,this)},c.onBeforeClose=function(){this.canUpdate=!1,this.taskTopInfo.clear(),this.rankId=0,this.rankList.clearData(),this.curIndex>0&&(this.tabBtns[this.curIndex].normalGo.active=!0,this.tabBtns[this.curIndex].selectedGo.active=!1,this.curIndex=0)},c.onDestroy=function(){},c.OnPayGiftInfoUpdate=function(){var t=IS(b).GetAcivityGift(w.Activity,this.actInfo.type,this.actInfo.round);t.sort((function(t,i){var e=IS(b).GetPayGiftInfo(t.id),n=IS(b).GetPayGiftInfo(i.id),a=e&&e.bought_times&&e.bought_times>=e.payCfg.buy_times;return a!=(n&&n.bought_times&&n.bought_times>=n.payCfg.buy_times)?a?1:-1:t.id-i.id})),this.giftList.datas=t},c.onUpdate=function(t){if(this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1))if(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0){this.canUpdate=!0;var i=p.getTimeData(this.leftTime);Math.floor(this.leftTime/86400)>0?this.txtLeftTime.string=I.formatStrWithMirrorDeal(GetLanguage(200080),i[3],i[2]):this.txtLeftTime.string=GetLanguage(200081)+p.formatTimeForSecond(this.leftTime)}else this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1},c.SetIndex=function(t){this.curIndex!=t&&(this.curIndex>0&&(this.tabBtns[this.curIndex].selectedGo.active=!1,this.tabBtns[this.curIndex].normalGo.active=!0),this.curIndex=t,this.tabBtns[this.curIndex].normalGo.active=!1,this.tabBtns[this.curIndex].selectedGo.active=!0,this.curIndex==V?(this.nodeReward.active=!0,this.nodeRank.active=!1,this.nodeTask.active=!1,this.nodeTopRank.active=!0,this.nodeMyRank.active=!0,this.nodeGift.active=!1,this.txtTitle.node.active=!1,this.rewardList.updateAll()):this.curIndex==j?(this.nodeReward.active=!1,this.nodeRank.active=!0,this.nodeTask.active=!1,this.nodeTopRank.active=!0,this.nodeMyRank.active=!0,this.nodeGift.active=!1,this.txtTitle.node.active=!1,this.rankList.updateAll()):this.curIndex==W?(this.nodeReward.active=!1,this.nodeRank.active=!1,this.nodeTask.active=!0,this.nodeTopRank.active=!1,this.nodeMyRank.active=!1,this.nodeGift.active=!1,this.txtTitle.node.active=!0):this.curIndex==Y&&(this.nodeReward.active=!1,this.nodeRank.active=!1,this.nodeTask.active=!1,this.nodeTopRank.active=!0,this.nodeMyRank.active=!1,this.nodeGift.active=!0,this.txtTitle.node.active=!1))},c.UpdateRankInfo=function(){if(this.rankInfo=IS(D).GetRankInfoByType(this.rankId),this.rankInfo){var t;this.txtMyRank.string=0!=this.rankInfo.my_info.rank?this.rankInfo.my_info.rank:GetLanguage(200037),this.txtMyScore.string=d.formatStr("%s%s",z,I.GetNumString(null!=(t=this.rankInfo.my_info.score)?t:0)),this.rankList.datas=this.rankInfo.rank_list;for(var i=1;i<=3;i++)this.roleList[i].show(this.rankInfo.rank_list[i-1])}},c.OnViewUpdate=function(){this.actInfo.state!=U.Open&&this.close()},c.OnTaskUpdate=function(){this.taskRed.active=IS(A).GetTaskRedNum(this.actInfo.type)>0,this.taskTopInfo.checkPage()},e}(K)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).txtDesc=void 0,i.btnGet=void 0,i.received=void 0,i.undone=void 0,i.pb=void 0,i.schedule=void 0,i.rewardScroll=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.txtDesc=g.findChildComponent(this.node,"txtDesc",h),a.uiMirror&&(this.txtDesc.isBold=!1),this.pb=g.findChildComponent(this.node,"ProgressBar",c),this.schedule=g.findChildComponent(this.node,"ProgressBar/schedule",h),this.received=g.findChild(this.node,"received"),this.undone=g.findChild(this.node,"undone"),this.btnGet=g.findChild(this.node,"btnGet"),this.view.addComponentCallbackListener(this.btnGet,n.EventType.CLICK,(function(){t.view.canGetCount>=2?y.showBoxTip({tip:GetLanguage_UI(899000023),func:function(i){i==T?IS(M).send_24_120(t.view.actInfo.type,t.data.group_id):i==R&&IS(M).send_24_15(t.view.actInfo.type,t.data.task_id,t.data.group_id)}}):IS(M).send_24_15(t.view.actInfo.type,t.data.task_id,t.data.group_id)}));var i=g.findChildComponent(this.node,"rewardScroll",r);this.rewardScroll=this.view.addUIList(i,it)},o.onRender=function(t,i){this.txtDesc.string=t.cfg.desc,this.rewardScroll.datas=t.cfg.reward;var e=t.cfg.condition[2]-t.cfg.difference,n=Math.min(Math.max(0,t.count-t.cfg.difference),e);this.schedule.string=d.formatStr("%s/%s",n,e),this.pb.progress=n/e,t.state==O.CanGet?(this.received.active=!1,this.undone.active=!1,this.btnGet.active=!0):t.state==O.HadGet?(this.received.active=!0,this.undone.active=!1,this.btnGet.active=!1):(this.received.active=!1,this.undone.active=!0,this.btnGet.active=!1)},e}(m)),Q=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).rewardScroll=void 0,i.txtRank=void 0,i.rankIcon=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.txtRank=g.findChildComponent(this.node,"rankNum",h),this.rankIcon=g.findChildComponent(this.node,"rankIcon",s);var t=g.findChildComponent(this.node,"rewardScroll",r);this.rewardScroll=this.view.addUIList(t,it,!1),this.rewardScroll.touchEvent=!1},n.onRender=function(t,i){this.rewardScroll.datas=t.rank_reward;var e=t.rank_range[0],n=t.rank_range[1];e==n&&e<=3?(this.rankIcon.node.active=!0,this.txtRank.node.active=!1,this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+e)):(this.rankIcon.node.active=!1,this.txtRank.node.active=!0,t.show&&""!=t.show?this.txtRank.string=t.show:this.txtRank.string=d.formatStr("%s-%s",e,n))},n.onItemClick=function(){},e}(m),Z=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).imgFrame=void 0,i.imgIcon=void 0,i.txtRank=void 0,i.rankIcon=void 0,i.titleIcon=void 0,i.imgHeadFrame=void 0,i.txtName=void 0,i.txtScore=void 0,i}i(e,t);var a=e.prototype;return a.onInit=function(){var t=this;this.imgFrame=g.findChildComponent(this.node,"imgFrame",s),this.imgIcon=g.findChildComponent(this.node,"imgFrame/imgIcon",s),this.txtRank=g.findChildComponent(this.node,"rankNum",h),this.rankIcon=g.findChildComponent(this.node,"rankIcon",s),this.titleIcon=g.findChild(this.node,"title"),this.imgHeadFrame=g.findChildComponent(this.node,"imgFrame/imgHeadFrame",s),this.txtName=g.findChildComponent(this.node,"name",h),this.txtScore=g.findChildComponent(this.node,"score",h),this.view.addComponentCallbackListener(this.imgFrame.node,n.EventType.CLICK,(function(){IS(x).reqOtherRoleNotice(t.data.belong_id)}))},a.onRender=function(t,i){this.view.loadRemoteIcon(t.head.url,this.imgIcon),this.txtName.string=t.name,this.txtScore.string=z+I.GetNumString(t.score),t.rank<=3?(this.rankIcon.node.active=!0,this.txtRank.node.active=!1,this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+t.rank)):(this.rankIcon.node.active=!1,this.txtRank.node.active=!0,this.txtRank.string=t.rank);var e=t.figure.current_title;e>0?(this.titleIcon.active=!0,this.txtScore.node.setPosition(535,-80),new v(this.view,this.titleIcon).SetRankTitle(e,u.NORMAL)):(this.titleIcon.active=!1,this.txtScore.node.setPosition(535,-53));var n=t.head.frame_id;if(n>0){var a=configAvatar_frame.getDataByKey(n);this.view.loadIcon(this.imgHeadFrame,"icon_frame",a.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1},a.onItemClick=function(){1004==this.data.rank_id?IS(x).reqOtherRoleNotice(this.data.info.belong_id,2):IS(x).reqOtherRoleNotice(this.data.info.belong_id)},e}(m),$=function(){function t(){this.view=void 0,this.node=void 0,this.rank=void 0,this.txtName=void 0,this.txtScore=void 0,this.imgFrame=void 0,this.imgIcon=void 0,this.imgHeadFrame=void 0,this.rankIcon=void 0,this.titleIcon=void 0,this.job=void 0,this.data=void 0,this.role=void 0}var i=t.prototype;return i.init=function(t,i,e){this.view=i,this.node=t,this.rank=e,this.onInit()},i.onInit=function(){var t=this;this.job=g.findChild(this.node,"role"),this.txtName=g.findChildComponent(this.node,"name",h),this.txtScore=g.findChildComponent(this.node,"score",h),this.imgFrame=g.findChild(this.node,"imgFrame"),this.imgIcon=g.findChildComponent(this.node,"imgFrame/imgIcon",s),this.imgHeadFrame=g.findChildComponent(this.node,"imgFrame/imgHeadFrame",s),this.titleIcon=g.findChild(this.node,"title"),this.view.addComponentCallbackListener(this.imgFrame,n.EventType.CLICK,(function(){t.data&&IS(x).reqOtherRoleNotice(t.data.belong_id)}));var i=g.findChild(this.node,"role/click");this.view.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.data&&IS(x).reqOtherRoleNotice(t.data.belong_id)})),this.rankIcon=g.findChildComponent(this.node,"imgFrame/rank_icon",s),this.view.loadIcon(this.rankIcon,"common","common_ICON_paiming0"+this.rank)},i.show=function(t){if(this.data=t,this.txtName.string=GetLanguage(200038),this.txtScore.string=z+"0",this.imgIcon.node.active=!1,this.titleIcon.active=!1,null!=this.role&&(this.view.removeUnitModel(this.role),this.role=null),t){for(var i=t.figure,e=0,n=i.skin_list||[],o=0;o<n.length;o++)2==n[o].k&&(e=n[o].v);this.role=this.view.addUnitModel({job:i.job_figure,dressId:e,gender:i.gender,parent:this.job,color:i.hair_figure,weapon:IS(C).GetKvListByK(i.equip_list,0),ornaments:IS(C).GetKvListByK(i.equip_list,1),face:IS(C).GetKvListByK(i.equip_list,2),mount:i.mount_figure,shenqi:i.artifact_figure,wing:IS(C).GetKvListByK(i.equip_list,4)},null,.9),this.view.getUnitModel(this.role).mount=i.mount_figure,a.uiMirror&&(this.view.getUnitModel(this.role).dir=-1),this.imgIcon.node.active=!0,this.view.loadRemoteIcon(t.head.url,this.imgIcon),i.mount_figure<=0&&(this.view.getUnitModel(this.role).position=J[this.rank]),this.view.loadRemoteIcon(t.head.url,this.imgIcon),this.txtName.string=t.name,this.txtScore.string=z+I.GetNumString(t.score);var s=t.figure.current_title;if(s>0){var h=this.view.getUnitModel(this.role).modelHeight;this.titleIcon.setPosition(0,h+50),this.titleIcon.active=!0,new v(this.view,this.titleIcon).SetRankTitle(s,u.NORMAL)}else this.titleIcon.active=!1;var r=t.head.frame_id;if(r>0){this.imgHeadFrame.node.active=!0;var d=configAvatar_frame.getDataByKey(r);this.view.loadIcon(this.imgHeadFrame,"icon_frame",d.icon)}else this.imgHeadFrame.node.active=!1}},t}(),tt=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).txtName=void 0,i.txtDesc=void 0,i.txtPrice=void 0,i.btnBuy=void 0,i.out=void 0,i.rewardScroll=void 0,i}i(e,t);var a=e.prototype;return a.onInit=function(){var t=this;this.txtName=g.findChildComponent(this.node,"title/Label",h),this.txtDesc=g.findChildComponent(this.node,"txtDesc",h),this.txtPrice=g.findChildComponent(this.node,"btnBuy/Label",h),this.out=g.findChild(this.node,"out"),this.btnBuy=g.findChild(this.node,"btnBuy"),this.view.addComponentCallbackListener(this.btnBuy,n.EventType.CLICK,(function(){var i=IS(A).GetActivityInfo(t.view.actInfo.type);i&&i.state==U.Open&&(0==t.data.price?IS(_).send_19_2(t.data.id):IS(b).Pay(t.data.id))}));var i=g.findChildComponent(this.node,"rewardScroll",r);this.rewardScroll=this.view.addUIList(i,it,!1),this.rewardScroll.touchEvent=!1},a.onRender=function(t,i){this.txtName.string=t.name,this.rewardScroll.datas=t.reward;var e=IS(b).GetPayGiftInfo(t.id);0==t.price?(this.txtPrice.string=GetLanguage(200045),e&&2==e.rewardState?(this.out.active=!0,this.btnBuy.active=!1,this.txtDesc.node.active=!1):(this.out.active=!1,this.btnBuy.active=!0,this.txtDesc.node.active=!0,this.txtDesc.string=I.formatStrWithMirrorDeal(GetLanguage(200046),t.buy_times))):(this.txtPrice.string=IS(b).GetPriceString(t.cost_level),0==t.buy_times?(this.out.active=!1,this.btnBuy.active=!0,this.txtDesc.node.active=!1):e&&e.bought_times?e.bought_times>=e.payCfg.buy_times?(this.out.active=!0,this.btnBuy.active=!1,this.txtDesc.node.active=!1):(this.out.active=!1,this.btnBuy.active=!0,this.txtDesc.node.active=!0,this.txtDesc.string=I.formatStrWithMirrorDeal(GetLanguage(200028),t.buy_times-e.bought_times,t.buy_times)):(this.out.active=!1,this.btnBuy.active=!0,this.txtDesc.node.active=!0,this.txtDesc.string=I.formatStrWithMirrorDeal(GetLanguage(200028),t.buy_times,t.buy_times)))},e}(m),it=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.itemGridNode=g.findChild(this.node,"itemGrid"),this.itemGrid=new l(this.view,this.itemGridNode)},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1])},e}(m),et=function(){function t(){this.view=void 0,this.node=void 0,this.btnLeft=void 0,this.btnRight=void 0,this.taskList=void 0,this.txtDesc=void 0,this.rewardScroll=void 0,this.btnGet=void 0,this.received=void 0,this.undone=void 0,this.maxPage=0,this.curPage=0,this.taskInfo=[],this.nodeFinish=void 0,this.txtFinish=void 0}var i=t.prototype;return i.init=function(t,i){this.view=i,this.node=t,this.onInit()},i.onInit=function(){var t=this;this.txtDesc=g.findChildComponent(this.node,"nodeTop/txtDesc",h),this.received=g.findChild(this.node,"nodeTop/received"),this.undone=g.findChild(this.node,"nodeTop/undone"),this.btnGet=g.findChild(this.node,"nodeTop/btnGet"),this.view.addComponentCallbackListener(this.btnGet,n.EventType.CLICK,(function(){0!=t.curPage&&(t.view.canGetCount>=2?y.showBoxTip({tip:GetLanguage_UI(899000023),func:function(i){i==T?IS(M).send_24_15(t.view.actInfo.type,0,t.taskInfo[t.curPage-1].group_id):i==R&&IS(M).send_24_120(t.view.actInfo.type,t.taskInfo[t.curPage-1].group_id)}}):IS(M).send_24_15(t.view.actInfo.type,0,t.taskInfo[t.curPage-1].group_id))})),this.btnLeft=g.findChild(this.node,"nodeTop/btnLeft"),this.view.addComponentCallbackListener(this.btnLeft,n.EventType.CLICK,(function(){t.switchPage(-1)})),this.btnRight=g.findChild(this.node,"nodeTop/btnRight"),this.view.addComponentCallbackListener(this.btnRight,n.EventType.CLICK,(function(){t.switchPage(1)})),this.btnLeft.active=!1,this.btnRight.active=!1;var i=g.findChildComponent(this.node,"nodeTop/rewardScroll",r);this.rewardScroll=this.view.addUIList(i,it);var e=g.findChildComponent(this.node,"taskList",r);this.taskList=this.view.addUIList(e,X),this.nodeFinish=g.findChild(this.node,"nodeTop/finishTips"),this.txtFinish=g.findChildComponent(this.node,"nodeTop/finishTips/Label",h)},i.setTaskList=function(t){for(var i=[],e=0;e<this.view.actInfo.roundCfg.task_list.length;e++){var n=this.view.actInfo.roundCfg.task_list[e];t[n]&&i.push(t[n])}this.taskInfo=i,this.maxPage=this.taskInfo.length,0!=this.maxPage&&this.checkPage()},i.updateInfo=function(){if(0!=this.curPage){var t=this.taskInfo[this.curPage-1];this.txtDesc.string=I.formatStrWithMirrorDeal(GetLanguage(200082),this.curPage,this.taskInfo.length),this.rewardScroll.datas=t.cfg.reward,this.nodeFinish.active=!1,t.state==O.CanGet?(this.received.active=!1,this.undone.active=!1,this.btnGet.active=!0,this.nodeFinish.active=!0,this.txtFinish.string=I.formatStrWithMirrorDeal(GetLanguage_UI(899000022),this.curPage)):t.state==O.HadGet?(this.received.active=!0,this.undone.active=!1,this.btnGet.active=!1):(this.received.active=!1,this.undone.active=!0,this.btnGet.active=!1),this.updateSubTask()}},i.updateSubTask=function(){var t=this.taskInfo[this.curPage-1],i=this.view.actInfo,e=[];for(var n in this.view.canGetCount=0,i.task_list)i.task_list.hasOwnProperty(n)&&i.task_list[n].group_id==t.group_id&&(i.task_list[n].state==O.CanGet&&(this.view.canGetCount+=1),e.push(i.task_list[n]));e.sort((function(t,i){return t.state==O.CanGet&&i.state!=O.CanGet?-1:t.state!=O.CanGet&&i.state==O.CanGet?1:t.state!=i.state?t.state-i.state:t.id-i.id})),this.taskList.datas=e},i.checkPage=function(){for(var t=this.taskInfo.length,i=0;i<this.taskInfo.length;i++){var e=this.taskInfo[i];if(e.state!=O.HadGet){t=i+1;break}var n=e.group_id,a=this.view.actInfo,o=void 0;for(var s in a.task_list)if(a.task_list.hasOwnProperty(s)){var h=a.task_list[s];if(h.group_id==n&&h.state!=O.HadGet){t=i+1,o=!0;break}}if(o)break}this.curPage==t?this.updateInfo():this.setPage(t)},i.switchPage=function(t){if(t>0){if(this.curPage>=this.maxPage)return}else if(this.curPage<=1)return;var i=this.curPage+t;this.setPage(i)},i.updateSwitchBtn=function(){this.maxPage>1?(this.btnLeft.active=this.curPage>1,this.btnRight.active=this.curPage<this.maxPage):(this.btnLeft.active=!1,this.btnRight.active=!1)},i.setPage=function(t){this.curPage!=t&&(this.curPage=t,this.updateInfo())},i.clear=function(){this.maxPage=0,this.curPage=0,this.taskInfo=[]},t}();e._RF.pop()}}}));

