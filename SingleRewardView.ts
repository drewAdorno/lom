System.register("chunks:///_virtual/SingleRewardView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./AudioMgr.ts","./index3.ts","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./SpineSkeleton.ts","./EaseMethod.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,h,d,a,r,l,u,c,w,p,f,v;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.Label,h=t.ScrollView,d=t.Vec3,a=t.js},null,function(t){r=t.audioMgr},null,function(t){l=t.ItemGrid},function(t){u=t.ListItem},function(t){c=t.default},function(t){w=t.default},function(t){p=t.SpineSkeleton},function(t){f=t.EasingMethod},function(t){v=t.BaseView}],execute:function(){var m;n._RF.push({},"8d48ccy8HNHo56wtXoP80jD","SingleRewardView",void 0);var g=((m={})[2]="green",m[3]="blue",m[4]="purple",m[5]="golden",m[6]="orange",m[7]="red",m[8]="pink",m[9]="color",m),S=(t("default",function(t){function n(){var i;return(i=t.call(this)||this).txtNum1=void 0,i.txtNum2=void 0,i.txtNum3=void 0,i.txtLevel=void 0,i.data=void 0,i.RewardUIList=void 0,i.needShow=void 0,i.FinishShow=void 0,i.indexToShowTime={},i.showCount=void 0,i.time=0,i.name="SingleRewardView",i.url="ui/module/guildwar/SingleRewardView",i.poolTime=3e3,i}i(n,t);var d=n.prototype;return d.onInit=function(){var t=this;this.FinishShow=!1,this.needShow=!1;var i=this.findChild("imgMask");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()})),this.txtNum1=this.findChildComponent("content/node/node1/num",s),this.txtNum2=this.findChildComponent("content/node/node2/num",s),this.txtNum3=this.findChildComponent("content/node/node3/num",s),this.txtLevel=this.findChildComponent("content/imgBoss/txtLevel",s);var e=this.findChildComponent("content/nodeReward/ScrollView",h);this.RewardUIList=this.addUIList(e,S,!0,0,0)},d.onAfterOpen=function(){r.playSound("common_shendengshengji"),this.time=0,this.indexToShowTime={},this.needShow=!1,this.FinishShow=!1,this.data=this.openArgs[0];for(var t,i=e(this.data.ext);!(t=i()).done;){var n=t.value,o=n.k,s=n.v;2==o?this.txtNum1.string=w.GetNumString(s):3==o?this.txtNum2.string=w.GetNumString(s):4==o?this.txtNum3.string=w.GetNumString(s):5==o&&(this.txtLevel.string=s>100?"Lv.âˆž":"Lv."+s)}this.showGoodsList()},d.registerUpdateHandler=function(){},d.onBeforeClose=function(){this.needShow=!1,this.FinishShow=!1,this.indexToShowTime={},this.time=0},d.onDestroy=function(){},d.onUpdate=function(t){if(null!=this.showCount&&null!=this.data.reward_list){var i=this.data.reward_list.length;if(!(i<=0||(this.showCount>=15&&(this.FinishShow=!0),this.showCount>=i))){var e=this.indexToShowTime[this.showCount];null!=e&&this.time>=e&&this.oneByOneShow(),this.time=this.time+t}}},d.showGoodsList=function(){for(var t,i={},n=e(this.data.reward_list);!(t=n()).done;){var o=t.value;o.gtid in i?i[o.gtid].num+=o.num:i[o.gtid]=o}var s=[];for(var h in i)"2"!=h&&"7001"!=h&&s.push(i[h]);s.length>1&&s.sort((function(t,i){return configGoods.getDataByKey(t.gtid).quality>configGoods.getDataByKey(i.gtid).quality?-1:1})),"2"in i&&s.unshift(i[2]),"7001"in i&&s.unshift(i[7001]),this.RewardUIList.datas=s,this.needShow=!0,this.showCount=0;for(var d=0,a=0;a<this.data.reward_list.length;a++)d>0&&(.05,d+=.05,d=Math.floor(1e3*d)/1e3,this.indexToShowTime[a]=d),0==a&&(d+=.05,d=Math.floor(1e3*d)/1e3,this.indexToShowTime[a]=d),.05,d+=.05},d.oneByOneShow=function(){this.RewardUIList.updateItem([this.showCount]),this.showCount=this.showCount+1},n}(v)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).spine=void 0,i.spineLoop=void 0,i.scaleTween=void 0,i.opacityTween=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.node.setScale(new d(0,0,0)),this.spine=c.findChildComponent(this.node,"MX_tx_chouka_gaoji",p),this.spineLoop=c.findChildComponent(this.node,"MX_tx_chouka_gaoji_loop",p),this.spine.node.active=!1,this.spineLoop.node.active=!1},n.onRender=function(t,i){var e=this,n=c.findChild(this.node,"itemGrid");new l(this.view,n).SetItemId(t.gtid,t.num);var o=configGoods.getDataByKey(t.gtid).quality,s=this.view;if(this.node.active=s.needShow||!1,this.node.setScale(0,0,0),this.spine.node.active=!1,this.spineLoop.node.active=!1,s.needShow&&!s.FinishShow){this.clearTween();var h=!1,d=!1;this.scaleTween=this.view.addTween(0,1,.2,(function(t,i){i>=.5&&!h&&(o>1&&(e.spine.node.active=!0,e.spine.setAnimation(0,g[o],!1)),h=!0),i>=.7&&!d&&(o>3&&(e.spineLoop.node.active=!0,e.spineLoop.setAnimation(0,a.formatStr("%s_loop",g[o]),!0)),d=!0),e.node.setScale(i,i,i)})).easing(f.BACK_OUT).call((function(){})).start()}else s.FinishShow&&(this.node.active=!0,this.node.setScale(1,1,1),o>3&&(this.spineLoop.node.active=!0,this.spineLoop.setAnimation(0,a.formatStr("%s_loop",g[o]),!0)))},n.clearTween=function(){this.scaleTween&&(this.scaleTween.stop(),this.scaleTween=null),this.opacityTween&&(this.opacityTween.stop(),this.opacityTween=null)},e}(u));n._RF.pop()}}}));

