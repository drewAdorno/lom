System.register("chunks:///_virtual/SeasonUseActionPointView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./StringUtil.ts","./index57.ts","./ActivityDefine.ts","./BagModel.ts","./SeasonSceneControl.ts","./BaseView.ts"],(function(t){"use strict";var i,n,e,s,o,d,u,a,h,r,c,m;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t.Button,s=t.Label,o=t.EditBox,d=t.sys},function(t){u=t.ItemGrid},function(t){a=t.default},null,function(t){h=t.ActivityType},function(t){r=t.BagModel},function(t){c=t.default},function(t){m=t.BaseView}],execute:function(){n._RF.push({},"b9834WVmiZBjJn8ME0YEqtH","SeasonUseActionPointView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).editBox=void 0,i.itemGrid=void 0,i.txtName=void 0,i.txtDesc=void 0,i.buyNum=1,i.maxEditNum=10,i.txtAddTen=void 0,i.txtMinusTen=void 0,i.nodeUse=void 0,i.nodeNoUse=void 0,i.name="SeasonUseActionPointView",i.url="ui/module/season/scene-view/SeasonUseActionPointView",i}i(n,t);var m=n.prototype;return m.onInit=function(){var t=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,e.EventType.CLICK,(function(){t.onCloseClick()})),this.itemGrid=new u(this,this.findChild("item/itemGrid")),this.txtName=this.findChildComponent("item/txtName",s),this.txtDesc=this.findChildComponent("item/txtDesc",s),this.nodeUse=this.findChild("use"),this.editBox=this.findChildComponent("use/EditBox",o),this.addComponentCallbackListener(this.editBox.node,o.EventType.EDITING_DID_ENDED,(function(){var i=Number(t.editBox.string);(isNaN(i)||i<=1)&&(i=1),t.buyNum=Math.floor(i),t.changeNum()}));var n=this.findChild("use/btnUse");this.addComponentCallbackListener(n,e.EventType.CLICK,(function(){t.onUse()}));var d=this.findChild("use/btnAdd");this.addComponentCallbackListener(d,e.EventType.CLICK,(function(){t.changeNum(1)}));var a=this.findChild("use/btnMinus");this.addComponentCallbackListener(a,e.EventType.CLICK,(function(){t.changeNum(-1)}));var r=this.findChild("use/btnAddTen");this.addComponentCallbackListener(r,e.EventType.CLICK,(function(){t.changeNum(t.maxEditNum)})),this.txtAddTen=this.findChildComponent("use/btnAddTen/Label",s);var c=this.findChild("use/btnMinusTen");this.addComponentCallbackListener(c,e.EventType.CLICK,(function(){t.changeNum(-t.maxEditNum)})),this.txtMinusTen=this.findChildComponent("use/btnMinusTen/Label",s),this.nodeNoUse=this.findChild("noUse");var m=this.findChild("noUse/btnDraw");this.addComponentCallbackListener(m,e.EventType.CLICK,(function(){uiMgr.openView("SeasonGiftView",h.Season),t.close()}))},m.onCloseClick=function(){this.close()},m.registerUpdateHandler=function(){},m.onAfterOpen=function(){this.buyNum=1;var t=270004,i=configGoods.getDataByKey(t);this.txtName.string=i.name,this.txtDesc.string=i.desc;var n=IS(r).getGoodsCountByGoodsGtid(t);this.itemGrid.SetItemId(270004,n),this.nodeUse.active=n>0,this.nodeNoUse.active=n<=0,this.maxEditNum=10,this.txtMinusTen.string=a.formatStr(d.uiMirror?"##1-":"-##1",this.maxEditNum),this.txtAddTen.string=a.formatStr(d.uiMirror?"##1+":"+##1",this.maxEditNum),this.changeNum()},m.onBeforeClose=function(){},m.onDestroy=function(){},m.onUse=function(){var t=IS(r).getGoodsCountByGoodsGtid(270004);this.buyNum=Math.min(t,Math.max(this.buyNum,1)),IS(c).reqActionPointItem(this.buyNum),this.close()},m.changeNum=function(t){null!=t&&(this.buyNum=this.buyNum+t);var i=IS(r).getGoodsCountByGoodsGtid(270004);this.buyNum=Math.min(i,Math.max(this.buyNum,1)),this.editBox.string=String(this.buyNum)},n}(m));n._RF.pop()}}}));

