System.register("chunks:///_virtual/ParkingBattleLogView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./ChatDataCache.ts","./ChatDefine.ts","./MessageView.ts","./RoleDefine.ts","./ParkingControl.ts","./ParkingDataCache.ts","./ParkingDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var i,e,n,o,a,s,r,d,h,f,l,g,c,v,_,m,L,u,R,C,T;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.ScrollView,a=t.Sprite,s=t.Label,r=t.Button},function(t){d=t.ListItem},function(t){h=t.default},function(t){f=t.default},function(t){l=t.default},null,function(t){g=t.ConfigGlobal},function(t){c=t.ChatDataCache,v=t.EPvpShareType},function(t){_=t.ChatDefine},function(t){m=t.default},function(t){L=t.PlayerAttr},function(t){u=t.default},function(t){R=t.ParkingDataCache},function(t){C=t.ParkingEventDefine},function(t){T=t.BaseSubView}],execute:function(){n._RF.push({},"6d2d1NAc3VAf4SYaHrdcBFT","ParkingBattleLogView",void 0);t("default",function(t){function e(){var i;return(i=t.call(this)||this).scrollList=void 0,i.curPage=1,i.uidMap=new Map,i.isEnd=!1,i.isRequesting=!1,i.name="ParkingBattleLogView",i.url="ui/module/parking/sub/ParkingBattleLogView",i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this.findChildComponent("scroll",o);this.scrollList=this.addUIList(t,I)},n.registerUpdateHandler=function(){this.addEvent(C.PARKING_RECORD_UPDATE,this.onUpdateHistoryList,this)},n.onAfterOpen=function(){this.trySetParent(),IS(u).reqParkReport(),this.onUpdateHistoryList()},n.onBeforeClose=function(){},n.onDestroy=function(){},n.onUpdateHistoryList=function(){var t=IS(R).history_list;this.scrollList.datas=t},n.trySetParent=function(){var t=uiMgr.getOpenView("ParkingLogView");t&&t.nodeSubRoot&&this.node.setParent(t.nodeSubRoot)},e}(T));var I=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).left={},i.right={},i.txtTime=void 0,i.txtPlace=void 0,i.imgLeftWin=void 0,i.imgRightWin=void 0,i.nodeNew=void 0,i.atkInfoList={},i.defInfoList={},i}i(n,t);var o=n.prototype;return o.onInit=function(){var t=this;this.imgLeftWin=h.findChild(this.node,"imgLeftWin"),this.imgRightWin=h.findChild(this.node,"imgRightWin"),this.left.imgLose=h.findChild(this.node,"left/imgLose"),this.left.imgIcon=h.findChildComponent(this.node,"left/imgIcon",a),this.left.imgHeadFrame=h.findChildComponent(this.node,"left/imgHeadFrame",a),this.left.txtName=h.findChildComponent(this.node,"left/txtName",s),this.left.txtPower=h.findChildComponent(this.node,"left/txtPower",s),this.right.imgLose=h.findChild(this.node,"right/imgLose"),this.right.imgIcon=h.findChildComponent(this.node,"right/imgIcon",a),this.right.imgHeadFrame=h.findChildComponent(this.node,"right/imgHeadFrame",a),this.right.txtName=h.findChildComponent(this.node,"right/txtName",s),this.right.txtPower=h.findChildComponent(this.node,"right/power/txtPower",s),this.txtTime=h.findChildComponent(this.node,"txtTime",s),this.txtPlace=h.findChildComponent(this.node,"txtPlace",s),this.nodeNew=h.findChild(this.node,"imgNew"),this.nodeNew.active=!1,this.view.adjustMirrorNode(h.findChild(this.node,"imgVs"),0,!0),this.view.adjustMirrorNode(h.findChild(this.node,"imgNew"),0,!0),this.view.adjustMirrorNode(h.findChild(this.node,"imgLeftWin"),0,!0),this.view.adjustMirrorNode(h.findChild(this.node,"imgRightWin"),0,!0),this.view.adjustMirrorNode(h.findChild(this.node,"btnShare/jjc_ICON_zhuanfaanniu"),0,!0);var i=h.findChild(this.node,"btnShare");this.view.addComponentCallbackListener(i,r.EventType.CLICK,(function(){if(IS(c).IsOpenInput()){if(t.data.atk_info_list&&t.data.def_info_list){var i={win_id:t.data.win_id,vid:t.data.vid,atk_role:{id:t.atkInfoList[L.ROLE_ATTR_ID],name:t.atkInfoList[L.ROLE_ATTR_NAME],lev:t.atkInfoList[L.ROLE_ATTR_LVL],power:t.atkInfoList[L.ROLE_ATTR_POWER_SHOW],job:t.atkInfoList[L.ROLE_ATTR_CUR_JOB],sex:t.atkInfoList[L.ROLE_ATTR_GENDER]},def_role:{id:t.defInfoList[L.ROLE_ATTR_ID],name:t.defInfoList[L.ROLE_ATTR_NAME],lev:t.defInfoList[L.ROLE_ATTR_LVL],power:t.defInfoList[L.ROLE_ATTR_POWER_SHOW],job:t.defInfoList[L.ROLE_ATTR_CUR_JOB],sex:t.defInfoList[L.ROLE_ATTR_GENDER]}};IS(c).SendShareData(_.ChatLinkType.PvpShare,i,void 0,void 0,v.parkingBattle)}}else m.showFlyTip(f.formatStrWithMirrorDeal(GetLanguage(200490),g.chat_level))}));var e=h.findChild(this.node,"btnPlayRecord");this.view.addComponentCallbackListener(e,r.EventType.CLICK,(function(){IS(u).reqParkVideoPlay(t.data.vid,t.view.parentView.openArgs[0]),battleMain.enterChapter(0),uiMgr.closeAllView(["MainView","MessageView","GuideView","BattleHubView"]),uiMgr.getOpenView("MainView").setIndex(0)}))},o.onRender=function(t,i){for(var n,o=e(t.atk_info_list.ks);!(n=o()).done;){var a=n.value;this.atkInfoList[a.k]=a.s}for(var s,r=e(t.atk_info_list.kv);!(s=r()).done;){var d=s.value;this.atkInfoList[d.k]=d.v}for(var h,f=e(t.def_info_list.ks);!(h=f()).done;){var g=h.value;this.defInfoList[g.k]=g.s}for(var c,v=e(t.def_info_list.kv);!(c=v()).done;){var _=c.value;this.defInfoList[_.k]=_.v}var m=this.atkInfoList[L.ROLE_ATTR_ID]==t.win_id;this.imgLeftWin.active=m,this.imgRightWin.active=!m,this.left.imgLose.active=!m,this.right.imgLose.active=m;var R=[this.atkInfoList,this.defInfoList],C=R[0],T=R[1];this.left.txtName.string="["+C[L.ROLE_ATTR_SERVER]+"]"+C[L.ROLE_ATTR_NAME],this.left.txtPower.string=C[L.ROLE_ATTR_POWER_SHOW];var I=C[L.ROLE_ATTR_HEAD_FRAME_ID];if(null!=I)if(this.view.loadRemoteIcon(C[L.ROLE_ATTR_HEAD_URL],this.left.imgIcon),I>0){var p=configAvatar_frame.getDataByKey(I);this.view.loadIcon(this.left.imgHeadFrame,"icon_frame",p.icon),this.left.imgHeadFrame.node.active=!0}else this.left.imgHeadFrame.node.active=!1;if(this.right.txtName.string="["+T[L.ROLE_ATTR_SERVER]+"]"+T[L.ROLE_ATTR_NAME],this.right.txtPower.string=T[L.ROLE_ATTR_POWER_SHOW],null!=(I=T[L.ROLE_ATTR_HEAD_FRAME_ID]))if(this.view.loadRemoteIcon(T[L.ROLE_ATTR_HEAD_URL],this.right.imgIcon),I>0){var E=configAvatar_frame.getDataByKey(I);this.view.loadIcon(this.right.imgHeadFrame,"icon_frame",E.icon),this.right.imgHeadFrame.node.active=!0}else this.right.imgHeadFrame.node.active=!1;for(var w,k=e(t.ext);!(w=k()).done;){var A=w.value;1==A.k&&(this.nodeNew.active=1==A.v,1==A.v&&IS(u).sendLookList([this.data.vid]))}this.txtTime.string=l.formatDate(l.ServerDate(1e3*t.time),"yyyy/MM/dd hh:mm:ss")+l.GetServerTimeZoneStr();for(var O,P="",S=e(t.others);!(O=S()).done;){var y=O.value;1==y.k&&(P=y.s)}this.txtPlace.string=P},n}(d);n._RF.pop()}}}));

