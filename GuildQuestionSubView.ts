System.register("chunks:///_virtual/GuildQuestionSubView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./GuildDataCache.ts","./GuildDefine.ts","./RoleDataCache.ts","./BaseSubView.ts"],(function(t){"use strict";var i,e,n,s,o,r,u,a,h,l,d;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Label,s=t.js},function(t){o=t.default},function(t){r=t.default},function(t){u=t.default},null,function(t){a=t.default},function(t){h=t.GuildEventDefine},function(t){l=t.RoleDataCache},function(t){d=t.BaseSubView}],execute:function(){e._RF.push({},"031cdZDfWdGOrAxv0hhLxV2","GuildQuestionSubView",void 0);t("GuildQuestionSubView",function(t){function e(){for(var i,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).titleSelect=void 0,i.titleQues=void 0,i.num=void 0,i.time=void 0,i.countDownTimer=void 0,i.selectNode=void 0,i.selectList=[],i.rankList=[],i.numStrList=["","st","nd","rd","th"],i}i(e,t);var o=e.prototype;return o.onInit=function(){this.titleSelect=this.findChildComponent("titleSelect",n),this.titleQues=this.findChildComponent("titleQues",n),this.num=this.findChildComponent("num",n),this.time=this.findChildComponent("time",n),this.selectNode=this.findChild("select");for(var t=0;t<4;t++)this.selectList.push(this.findChildComponent("select/answer"+(t+1),n));for(var i=0;i<4;i++)this.rankList[i]=new c(this,this.findChild("rank/"+(i+1)));this.time=this.findChildComponent("time",n)},o.registerUpdateHandler=function(){this.addEvent(h.GUIDE_UPDATE_QUESTION,this.updateQues),this.addEvent(h.GUIDE_UPDATE_QUESTION_RANK,this.updateRank)},o.onAfterOpen=function(){this.updateQues()},o.updateQues=function(){var t=this,i=IS(a).GetGuildQuestion();if(i&&i.question>0){this.num.string=s.formatStr("%s",i.number),this.countDownTimer&&(this.removeTimer(this.countDownTimer),this.countDownTimer=null);var e="";i.is_show&&1==i.is_show&&(e=GetLanguage(200191)),this.time.string=r.formatStrWithMirrorDeal(GetLanguage(200192),Math.floor(i.countdown-u.serverTime))+e,this.countDownTimer=this.addTimer(1,i.countdown-u.serverTime,(function(){var n=Math.floor(i.countdown-u.serverTime);t.time.string=r.formatStrWithMirrorDeal(GetLanguage(200192),n)+e}));var n=i.question,o=configQuiz.getDataByKey(n);if(1==o.type){this.titleSelect.string=o.question_text,this.selectNode.active=!0;for(var h=0;h<4;h++)this.selectList[h].string=o.options[h];this.titleQues.string=""}else this.titleSelect.string="",this.selectNode.active=!1,this.titleQues.string=o.question_text;this.updateRank()}},o.updateRank=function(){var t=IS(a).GetGuildQuestion();if(t&&t.rank_list){var i,e=2==uiMgr.getOpenView("ChatView").getContentType();t.rank_list.sort((function(t,i){return t.rank-i.rank}));for(var n=0;n<this.rankList.length;n++){var s=!0;if(n>1&&(s=e),t.rank_list&&t.rank_list[n]&&s){if(t.rank_list[n].score>0)this.rankList[n].show(t.rank_list[n]);else if(t.rank_list[n].guild_id==IS(l).GetGuildId()){i=!0;break}}else this.rankList[n].show()}if(i)for(var o=0;o<this.rankList.length;o++)this.rankList[o].show()}},o.getNumStr=function(t){if(0==t)return t;var i=t%10;return t>4&&(i=4),t+this.numStrList[i]},o.onBeforeClose=function(){this.countDownTimer&&(this.removeTimer(this.countDownTimer),this.countDownTimer=null)},o.onDestroy=function(){},e}(d));var c=function(){function t(t,i){this.view=void 0,this.node=void 0,this.rank=void 0,this.guildName=void 0,this.score=void 0,this.view=t,this.node=i,this.rank=o.findChildComponent(i,"rank",n),this.guildName=o.findChildComponent(i,"guildName",n),this.score=o.findChildComponent(i,"scroe/num",n)}return t.prototype.show=function(t){void 0===t&&(t=null),t?(this.node.active=!0,this.rank.string=this.view.getNumStr(t.rank),this.guildName.string=t.guild_name,this.score.string=t.score):this.node.active=!1},t}();e._RF.pop()}}}));

