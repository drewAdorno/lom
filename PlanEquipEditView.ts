System.register("chunks:///_virtual/PlanEquipEditView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./EquipDataCache.ts","./EquipDefine.ts","./EquipModel.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./UIDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,u,s,p,d,l,f,c,r,h,m,I,C,g,v,q,E;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.UITransform,a=t.js,u=t.Vec2,s=t.Label,p=t.Sprite},function(t){d=t.default},null,function(t){l=t.IconAseetType},function(t){f=t.ConfigGlobal},function(t){c=t.default},function(t){r=t.EquipDataCache},function(t){h=t.EquipEventDefine},function(t){m=t.EquipModel},function(t){I=t.default},function(t){C=t.RoleDataCache},function(t){g=t.RoleEventDefine},function(t){v=t.PanelTabType,q=t.OpenFunction},function(t){E=t.BaseView}],execute:function(){i._RF.push({},"e901ehdmBpBIIJySst0u/tm","PlanEquipEditView",void 0);var _=f.equip_tab_limit,y=[{equipType:1,spriteName:"zjm_ui_wuqi"},{equipType:2,spriteName:"zjm_ui_goushi"},{equipType:3,spriteName:"zjm_ui_mianshi"},{equipType:4,spriteName:"zjm_ui_hujian"},{equipType:5,spriteName:"zjm_ui_kaijia"},{equipType:6,spriteName:"zjm_ui_bijia"},{equipType:7,spriteName:"zjm_ui_shoutao"},{equipType:8,spriteName:"zjm_ui_yaodai"},{equipType:9,spriteName:"zjm_ui_hutui"},{equipType:10,spriteName:"zjm_ui_xiezi"}];t("default",function(t){function i(){var e;return(e=t.call(this)||this).infoItems=[],e.curPlanId=void 0,e.utContent=void 0,e.nodeItem=void 0,e.nodeContent=void 0,e.name="PlanEquipEditView",e.url="ui/module/role/PlanEquipEditView",e}e(i,t);var f=i.prototype;return f.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var i=this.findChild("content/btnGoTo");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){null==uiMgr.getOpenView("RolePlanView")?uiMgr.openView("RolePlanView",2):normalEvent.emit(g.PLAN_JUMP_SET_INDEX,v.EQUIP_SWITCH),t.close()})),this.utContent=this.findChildComponent("content/scroll/view/content",o),this.nodeContent=this.utContent.node,this.nodeItem=this.findChild("content/scroll/view/content/equipRoot"),this.nodeItem.active=!1;for(var a=function(e){var i=nodeInstantiate.instantiate(t.nodeItem);i.parent=t.nodeContent;var o=d.findChild(i,"btnSwitch");t.addComponentCallbackListener(o,n.EventType.CLICK,(function(){IS(I).send_role_update_plan_c2s(t.curPlanId,[{k:1,v:e}])}));var a=d.findChild(i,"equipParent"),u=d.findChild(i,"equipParent/equipItem");u.active=!1;for(var l=[],f=void 0,r=function(i){var o=y[i].equipType;f=y[i].spriteName;var r=nodeInstantiate.instantiate(u);r.parent=a,r.name=String(i+1);var h={node:r,imgType:d.findChildComponent(r,"imgEquipType",p),nodeEquip:d.findChild(r,"equipInfo"),imgFrame:d.findChildComponent(r,"equipInfo/imgFrame",p),imgIcon:d.findChildComponent(r,"equipInfo/imgIcon",p),imgFigure:d.findChildComponent(r,"equipInfo/imgFigure",p),txtLevel:d.findChildComponent(r,"equipInfo/txtLevel",s),equipType:o};t.addComponentCallbackListener(r,n.EventType.CLICK,(function(){var t=IS(m).getEquipByLocation(o,e);c.isEmpty(t)||uiMgr.openView("EquipDetailView",null==t?void 0:t.equip_id)})),t.loadIcon(h.imgType,"equip",f),r.active=!0,l.push(h)},h=0;h<y.length;h++)r(h);t.infoItems.push({nodeEquipRoot:i,txtName:d.findChildComponent(i,"name/txtName",s),nodeCur:d.findChild(i,"nodeCur"),btnSwitch:o,suitId:e,equipItems:l})},u=1;u<=_.length;u++)a(u)},f.registerUpdateHandler=function(){this.addEvent(h.EQUIP_LIST_UPDATE,this.onEquipListUpdate,this),this.addEvent(g.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(g.PLAN_INFO_BACK,this.OnPlanInfoBack,this),this.addEvent(g.PLAN_INFO_UPDATE,this.onPlanInfoUpdate,this)},f.onAfterOpen=function(){this.curPlanId=this.openArgs[0],this.updateContent()},f.updateContent=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSingleInfo(this.infoItems[t]),this.updateSelect(this.infoItems[t]);this.updateContentHeight()},f.updateContentHeight=function(){var t=IS(r).tabInfo.unlock_list,e=t?t.length:0;this.utContent.height=e<=0?0:8+326.25*e+16*(e-1)},f.updateSingleInfo=function(t){t.txtName.string=IS(m).getEquipTabName(t.suitId),this.updateEquipShow(t)},f.updateSelect=function(t){for(var e=IS(r).tabInfo.unlock_list,i={},n=0;n<e.length;n++)i[e[n].k]=!0;t.nodeEquipRoot.active=i[t.suitId];for(var o,a=IS(C).planIdToInfo[this.curPlanId].detail,u=0;u<a.length;u++)if(1==a[u].k){o=a[u].v;break}t.nodeCur.active=t.suitId==o,t.btnSwitch.active=t.suitId!=o},f.updateEquipShow=function(t){for(var e=0;e<t.equipItems.length;e++)this.updateSingleEquip(t.equipItems[e],t.suitId)},f.updateSingleEquip=function(t,e){t.effect&&(this.removeUIEffect(t.effect),t.effect=null);var i=t.equipType,n=IS(m).getEquipByLocation(i,e);if(c.isEmpty(n))t.nodeEquip.active=!1;else{var o=configEquipment.getDataByKey(n.config_id);t.nodeEquip.active=!0,this.loadIcon(t.imgIcon,o.atlas,o.icon,null,l.ICON_SPRITE),this.loadIcon(t.imgFrame,"icon_equip",configColor.getDataByKey(o.quality).path);var s=configColor.getDataByKey(o.quality).effect_path;null!=s&&""!=s&&(t.effect=this.addUIEffect(a.formatStr("prefab/ui-effect/%s",s),t.imgIcon.node,-1,new u(0,0))),t.txtLevel.string=a.formatStr("Lv.%s",n.equip_lv),t.imgFigure.node.active=IS(m).checkFigureTipShow(i)||!1;var p=IS(m).getEquipFigureByLocation(i);t.imgFigure.grayscale=0==p||-1==p}},f.onEquipListUpdate=function(){for(var t=0;t<this.infoItems.length;t++)this.updateEquipShow(this.infoItems[t])},f.onRoleOpenFunctionUpdate=function(t){if(t==q.FUNC_EQUIP_SKIN)for(var e=0;e<this.infoItems.length;e++)this.updateEquipShow(this.infoItems[e])},f.OnPlanInfoBack=function(){for(var t=0;t<this.infoItems.length;t++)this.updateSelect(this.infoItems[t]);this.updateContentHeight()},f.onPlanInfoUpdate=function(t){if(t==this.curPlanId){for(var e=0;e<this.infoItems.length;e++)this.updateSelect(this.infoItems[e]);this.updateContentHeight()}},f.onBeforeClose=function(){},f.onDestroy=function(){},i}(E));i._RF.pop()}}}));

