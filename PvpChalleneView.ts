System.register("chunks:///_virtual/PvpChalleneView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./ItemIcon.ts","./ConfigGlobal.ts","./BagDefine.ts","./BagModel.ts","./MessageView.ts","./FriendControl.ts","./PrivilegeDataCache.ts","./PrivilegeDefine.ts","./RoleDataCache.ts","./PvpControl.ts","./PvpDataCache.ts","./PvpDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,n,i,o,a,d,r,s,l,c,h,f,u,C,v,p,m,g,I,w,P,L,y,S,x,D;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose},function(t){i=t.cclegacy,o=t.ScrollView,a=t.Label,d=t.Button,r=t.sys,s=t.Layout,l=t.Sprite,c=t.Color},function(t){h=t.ListItem},function(t){f=t.default},function(t){u=t.default},null,function(t){C=t.IconAseetType},function(t){v=t.ConfigGlobal},function(t){p=t.BagEventDefine},function(t){m=t.BagModel},function(t){g=t.default},function(t){I=t.default},function(t){w=t.PrivilegeDataCache},function(t){P=t.PrivilegeCardEffect},function(t){L=t.RoleDataCache},function(t){y=t.default},function(t){S=t.PvpDataCache},function(t){x=t.PvpEventDefine},function(t){D=t.BaseView}],execute:function(){i._RF.push({},"dca59qvnglBVZ05ECPDeY6E","PvpChalleneView",void 0);t("PvpChalleneView",function(t){function i(){var e;return(e=t.call(this)||this).scrollPvpList=void 0,e.nodeBattle=void 0,e.updateList=!1,e.txtTime=void 0,e.txtCount=void 0,e.txtPower=void 0,e.name="PvpChalleneView",e.url="ui/module/pvp/PvpChalleneView",e}e(i,t);var c=i.prototype;return c.onInit=function(){var t=this,e=this.findChild("content"),n=f.findChildComponent(e,"scrollPvp",o);this.scrollPvpList=this.addUIList(n,G),this.scrollPvpList.lackSlide=!0,this.txtCount=this.findChildComponent("content/nodeTicket/txtCount",a),this.txtPower=this.findChildComponent("content/nodePower/txtPower",a);var i=f.findChild(e,"btnRefresh");this.addComponentCallbackListener(i,d.EventType.CLICK,(function(){t.findChild("nodeCD").active=!0,r.uiMirror&&t.findChild("nodeCD/imgMask/common_ui_jzdi01/Label").setScale(1,1,1),IS(y).reqArenaRefresh(),t.addTimer(2,1,(function(){t.findChild("nodeCD").active=!1}))})),this.dealMirrorLayout(this.findChildComponent("nodeCD/imgMask/common_ui_jzdi01",s));var c=f.findChild(e,"btnClose");this.addComponentCallbackListener(c,d.EventType.CLICK,(function(){t.close(),uiMgr.openView("PvpMainView")}));var h=f.findChild(e,"nodeTicket/btnBuyTicket");if(this.loadIcon(this.findChildComponent("content/nodeTicket/1006",l),"icon_item","1006"),this.addComponentCallbackListener(h,d.EventType.CLICK,(function(){IS(S).buy_times>=5?g.showFlyTip(GetLanguage(200558)):uiMgr.openView("PvpBuyView",{goods:[1006,1],price:[2,500]})})),r.uiMirror){var u=this.findChildComponent("content/nodeReward",s);u.horizontalDirection=1,u.node.setScale(-1,1,1),this.findChildComponent("content/nodeReward/Layout",s).horizontalDirection=1,this.findChild("content/nodeReward/Label-001").setScale(1,1,1)}},c.registerUpdateHandler=function(){this.addEvent(x.PVP_INFO,this.onPvpInfo,this),this.addEvent(x.PVP_BUY_TIME,this.onPvpInfo,this),this.addEvent(p.GOODS_INFO_UPDATE,this.onGoodsUpdate,this)},c.onAfterOpen=function(){this.txtPower.string=u.GetNumString(IS(L).GetPowerInfoByID(0)),IS(y).reqArenaInfo(),this.refreshReward()},c.refreshReward=function(){for(var t,e=v.pvp_win_reward,i=n(e.entries());!(t=i()).done;){var o=t.value,d=o[0],s=o[1],c=this.findChild("content/nodeReward/Layout/item"+d),h=configGoods.getDataByKey(s[0]);this.loadIcon(f.findChildComponent(c,"imgIcon",l),h.icon_group,h.icon,null,C.UI_ATLAS,!0),f.findChildComponent(c,"num",a).string=s[1]+"",c.active=!0,r.uiMirror&&f.findChild(c,"num").setScale(1,1,1)}},c.onBeforeClose=function(){this.updateList=!1},c.onDestroy=function(){},c.onPvpInfo=function(){this.scrollPvpList.datas=IS(S).enemyList;var t=v.pvp_ticket_max+IS(w).getPrivilegeCardValue(P.CHALLENGE),e=IS(m).getGoodsCountByGoodsGtid(1006);this.txtCount.string=e+"/"+t},c.onDungeonUpdate=function(){this.updateList=!0},c.onGoodsUpdate=function(t,e){},c.onDungeonEnter=function(){this.nodeBattle.active=!0,uiMgr.close("DungeonLevelView")},i}(D));var G=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).txtName=void 0,e.txtLevel=void 0,e.txtPower=void 0,e.txtScore=void 0,e.btnGo=void 0,e.imgHeadIcon=void 0,e.imgHeadFrame=void 0,e}e(n,t);var i=n.prototype;return i.onInit=function(){var t=this;this.txtName=f.findChildComponent(this.node,"txtName",a),this.txtLevel=f.findChildComponent(this.node,"txtLevel",a),this.txtPower=f.findChildComponent(this.node,"txtPower",a),this.txtScore=f.findChildComponent(this.node,"txtScore",a),this.imgHeadIcon=f.findChildComponent(this.node,"imgHeadIcon",l),this.imgHeadFrame=f.findChildComponent(this.node,"imgHeadIconFrame",l),this.btnGo=f.findChild(this.node,"btnGo"),this.view.addComponentCallbackListener(this.btnGo,d.EventType.CLICK,(function(){IS(m).getGoodsCountByGoodsGtid(1006)?(IS(y).reqArenaCombat(t.data.id),battleMain.enterChapter(0),t.view.close(),uiMgr.close("PvpMainView")):g.showFlyTip(GetLanguage(200559))}))},i.onRender=function(t,e){this.txtName.string=t.name,this.txtPower.string=u.GetNumString(t.power),this.txtScore.string=String(t.score),this.view.loadRemoteIcon(t.head.url,this.imgHeadIcon);var n=f.findChild(this.node,"imgHeadIcon");this.view.addComponentCallbackListener(n,d.EventType.CLICK,(function(){IS(I).reqOtherRoleNotice(t.id,2)}));var i=t.head.frame_id;if(i>0){this.imgHeadFrame.node.active=!0;var o=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",o.icon)}else this.imgHeadFrame.node.active=!1;this.txtPower.color=t.power<=IS(L).GetPowerInfoByID(0)?new c(39,153,22):new c(214,26,48)},n}(h);i._RF.pop()}}}));

