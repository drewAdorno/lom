System.register("chunks:///_virtual/WingBookView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./UIRichText.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./WingControl.ts","./WingDataCache.ts","./WingDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,n,e,o,s,a,d,c,r,l,h,u,f,g,v,C;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy,e=t.Button,o=t.ScrollView,s=t.Label,a=t.js,d=t.sys,c=t.Sprite},function(t){r=t.ListItem},function(t){l=t.UIRichText},function(t){h=t.default},function(t){u=t.default},null,function(t){f=t.default},function(t){g=t.WingDataCache},function(t){v=t.WingEvent},function(t){C=t.BaseView}],execute:function(){n._RF.push({},"f52850x+jBNELnAIwPzFP6U","WingBookView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).scrollView=void 0,i.name="WingBookView",i.url="ui/module/wing/WingBookView",i.poolTime=3e3,i}i(n,t);var s=n.prototype;return s.onInit=function(){var t=this;this.addComponentCallbackListener(this.findChild("imgMask"),e.EventType.CLICK,(function(){t.close()})),this.addComponentCallbackListener(this.findChild("container/btnClose"),e.EventType.CLICK,(function(){t.close()})),this.scrollView=this.addUIList(this.findChildComponent("container/taskList",o),m)},s.onAfterOpen=function(){this.UpdateList()},s.registerUpdateHandler=function(){this.addEvent(v.TYPE_WING_CHANGE,this.UpdateList,this)},s.UpdateList=function(){for(var t=[],i=configBack_book.getDatas(),n=0;n<i.length;n++)t.push(i[n]);t.sort((function(t,i){var n=0,e=0;return IS(g).GetCollectionRedById(t.id)&&(n+=1e6),IS(g).GetCollectionRedById(t.id)&&(e+=1e6),IS(g).GetCollectionIsActive(t.id)||(n+=1e4),IS(g).GetCollectionIsActive(t.id)||(e+=1e4),t.id<i.id?n+=100:t.id>i.id&&(e+=100),n<e?1:-1})),this.scrollView.datas=t},s.onBeforeClose=function(){},s.onDestroy=function(){},n}(C));var m=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).itemList=void 0,i.txtDesc=void 0,i.getBtn=void 0,i.received=void 0,i.undone=void 0,i}i(n,t);var c=n.prototype;return c.onInit=function(){var t=this;this.itemList=this.view.addUIList(h.findChildComponent(this.node,"ScrollView",o),p),this.txtDesc=h.findChildComponent(this.node,"txtDesc",l),this.getBtn=h.findChild(this.node,"btnGet"),this.view.addComponentCallbackListener(this.getBtn,e.EventType.CLICK,(function(){IS(f).send_wing_collection_active_c2s(t.data.id)})),this.received=h.findChild(this.node,"received"),this.undone=h.findChildComponent(this.node,"undone",s)},c.onRender=function(t,i){this.data=t;var n=u.formatStr(GetLanguage(201820),a.formatStr(d.uiMirror?"<color=#00a100>%s+</color>":"<color=#00a100>+%s</color>",t.level));this.txtDesc.string=a.formatStr("<b><color=#624324>%s</color></b>",n);var e=IS(g).GetCollectionRedById(t.id),o=IS(g).GetCollectionIsActive(t.id);if(this.itemList.datas=this.data.condition,this.received.active=o,this.getBtn.active=e,e||o)this.undone.string="";else{for(var s=0,c=0;c<this.data.condition.length;c++){var r=this.data.condition[c];IS(g).getWingState(r)>1&&s++}this.undone.string=a.formatStr("(%s/%s)",s,this.data.condition.length)}},n}(r),p=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).imgFrame=void 0,i.imgIcon=void 0,i.imgMask=void 0,i}i(n,t);var o=n.prototype;return o.onInit=function(){this.imgFrame=h.findChildComponent(this.node,"itemGrid/imgFrame",c),this.imgIcon=h.findChildComponent(this.node,"itemGrid/imgIcon",c),this.imgMask=h.findChild(this.node,"itemGrid/mask");var t=h.findChild(this.node,"itemGrid");this.view.addComponentCallbackListener(t,e.EventType.CLICK,(function(){}))},o.onRender=function(t,i){this.data=t;var n=configBack_decoration.getDataByKey(this.data).icon_small,e=configBack_decoration.getDataByKey(this.data).quality,o=configColor.getDataByKey(e).path;this.view.loadIcon(this.imgFrame,"icon_equip",o),this.view.loadIcon(this.imgIcon,"icon_item",n),this.imgMask.active=IS(g).getWingState(this.data)<=1},n}(r);n._RF.pop()}}}));

