System.register("chunks:///_virtual/ChatFriendSubView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./ObjectUtil.ts","./FriendControl.ts","./FriendDefine.ts","./FriendModel.ts","./ChatDataCache.ts","./ChatDefine.ts","./BaseSubView.ts"],(function(t){"use strict";var e,i,n,o,a,s,d,h,r,l,c,m,f,p,v,u,I,g,C,S,L,w;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Widget,o=t.Button,a=t.ScrollView,s=t.Vec2,d=t.Label,h=t.Sprite},function(t){r=t.ListItem},function(t){l=t.RedPointType},function(t){c=t.RedPointMgr},function(t){m=t.default},function(t){f=t.default},null,function(t){p=t.default},function(t){v=t.default},function(t){u=t.FriendListType,I=t.FriendDefine},function(t){g=t.FriendModel},function(t){C=t.ChatDataCache},function(t){S=t.ChatEventDefine,L=t.ChatDefine},function(t){w=t.BaseSubView}],execute:function(){i._RF.push({},"c6e8f0bl8RNNbIJAjNR4LtR","ChatFriendSubView",void 0);t("ChatFriendSubView",function(t){function i(){var e;return(e=t.call(this)||this).chatBtn=void 0,e.scrollView=void 0,e.widge=void 0,e.datasLength=0,e.page=1,e.isSendToServer=!1,e.name="ChatFriendSubView",e}e(i,t);var d=i.prototype;return d.onInit=function(){var t=this;this.widge=this.findChildComponent("",n),this.chatBtn=this.findChild("priviateChatBtn"),this.addComponentCallbackListener(this.chatBtn,o.EventType.CLICK,(function(){t.parentView.showPrivateChatType(1)}));var e=this.findChildComponent("ScrollView",a);this.scrollView=this.addUIList(e,F),this.addComponentCallbackListener(e.node,a.EventType.SCROLL_TO_BOTTOM,(function(){t.isSendToServer||(t.page+=1,IS(v).reqFriendList(u.FriendList,t.page),t.isSendToServer=!0)}))},d.registerUpdateHandler=function(){this.addEvent(I.FriendInfoBack,this.UpdateScroll,this),this.addEvent(S.UpdateGmList,this.UpdateScroll,this),this.addEvent(S.UpdateGmOpenInfo,this.UpdateScroll,this)},d.onAfterOpen=function(){this.widge.updateAlignment(),this.scrollView.scrollTo(-1,-1),this.page=1,this.datasLength=0,this.isSendToServer=!1,IS(v).reqFriendList(u.FriendList,this.page),this.addRedPoint("private_red",this.chatBtn,new s(31,16),l.Dot,.7),IS(c).changeValue("private_red",IS(C).GetPrivateRed())},d.UpdateScroll=function(){var t=IS(g).GetListByType(u.FriendList),e=t,i=IS(C).GetKfList();if(IS(C).GetGmIsOpen()&&i&&i[0]){var n=i[0];e=[{name:n.name,is_online:n.online_state,kf_uid:n.uid,role_id:L.VIPGmUid}];var o=p.copyArray(t);e=e.concat(o)}this.scrollView.datas=e,this.datasLength!=e.length&&(this.isSendToServer=!1),this.datasLength=e.length},d.onBeforeClose=function(){},d.onDestroy=function(){},i}(w));var F=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).btn=void 0,e.headIcon=void 0,e.imgHeadFrame=void 0,e.lineIcon=void 0,e.name=void 0,e.battle=void 0,e.time=void 0,e.chatBtn=void 0,e.gmIcon=void 0,e.normalItem=void 0,e.gmItem=void 0,e.gmName=void 0,e.poolInfo=void 0,e}e(i,t);var n=i.prototype;return n.onInit=function(){var t=this;this.chatBtn=m.findChild(this.node,"chatBtn"),this.view.addComponentCallbackListener(this.chatBtn,o.EventType.CLICK,(function(){t.view.parentView.showPrivateChatConetnt(t.poolInfo.role_id)})),this.view.addComponentCallbackListener(m.findChild(this.node,"head"),o.EventType.CLICK,(function(){t.poolInfo.role_id!=L.VIPGmUid&&IS(v).reqOtherRoleNotice(t.poolInfo.role_id)})),this.normalItem=m.findChild(this.node,"normaltem"),this.gmItem=m.findChild(this.node,"gmItem"),this.gmName=m.findChildComponent(this.node,"gmItem/name",d),this.lineIcon=m.findChildComponent(this.node,"lineState",h),this.headIcon=m.findChildComponent(this.node,"head/image",h),this.imgHeadFrame=m.findChildComponent(this.node,"head/imgHeadFrame",h),this.gmIcon=m.findChild(this.node,"head/gmIcon"),this.name=m.findChildComponent(this.node,"normaltem/name",d),this.time=m.findChildComponent(this.node,"normaltem/time",d),this.battle=m.findChildComponent(this.node,"normaltem/battle",d)},n.onRender=function(t,e){this.poolInfo=t,t.kf_uid?(this.normalItem.active=!1,this.gmItem.active=!0,this.gmIcon.active=!0,this.gmName.string=this.poolInfo.name):(this.normalItem.active=!0,this.gmItem.active=!1,this.gmIcon.active=!1,this.name.string=this.poolInfo.name+"    Lv."+this.poolInfo.lv,this.view.loadRemoteIcon(this.poolInfo.head.url,this.headIcon),this.battle.string=GetLanguage(200170)+this.poolInfo.cur_power,this.time.string=0==this.poolInfo.is_online?f.getDateDiff(this.poolInfo.offline_time)+GetLanguage(200171):""),this.lineIcon.grayscale=0==this.poolInfo.is_online;var i=0;if(this.poolInfo.head&&(i=this.poolInfo.head.frame_id),i>0){this.imgHeadFrame.node.active=!0;var n=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",n.icon)}else this.imgHeadFrame.node.active=!1},i}(r);i._RF.pop()}}}));

