System.register("chunks:///_virtual/GuildQuesDiceSubView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./SpineSkeleton.ts","./GuildControl.ts","./GuildDataCache.ts","./GuildDefine.ts","./BaseSubView.ts"],(function(i){"use strict";var t,e,n,s,r,o,u,a,d,h,l,c;return{setters:[function(i){t=i.inheritsLoose},function(i){e=i.cclegacy,n=i.Label,s=i.js,r=i.Button},function(i){o=i.default},function(i){u=i.default},null,function(i){a=i.SpineSkeleton},function(i){d=i.default},function(i){h=i.default},function(i){l=i.GuildEventDefine},function(i){c=i.BaseSubView}],execute:function(){e._RF.push({},"ef1e6N6CwxGdID9VjEMgtg5","GuildQuesDiceSubView",void 0);i("GuildQuesDiceSubView",function(i){function e(){for(var t,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(t=i.call.apply(i,[this].concat(n))||this).timeNode=void 0,t.bottomNode=void 0,t.time=void 0,t.timer=void 0,t.isFinish=void 0,t.rewardList=void 0,t.diceList=[],t}t(e,i);var c=e.prototype;return c.onInit=function(){var i=this;this.timeNode=this.findChild("time"),this.bottomNode=this.findChild("bottom"),this.time=this.findChildComponent("time/num",n);for(var t=0;t<3;t++)this.diceList.push(this.findChildComponent(s.formatStr("shaiz_%s",t+1),a));this.addComponentCallbackListener(this.findChild("click"),r.EventType.CLICK,(function(){i.timer&&(i.removeTimer(i.timer),i.timer=null),i.isFinish?i.setActive(!1):IS(d).send_29_34()}))},c.registerUpdateHandler=function(){this.addEvent(l.GUILD_DICE_RESULT_UPDATE,this.playDiceAnim,this)},c.onAfterOpen=function(){var i=this;this.rewardList=null;for(var t=0;t<3;t++){this.diceList[t].setAnimation(0,"6",!1)}this.timeNode.active=!0,this.bottomNode.active=!0;var e=IS(h).GetGuildDiceTime();this.time.string=o.formatStrWithMirrorDeal(GetLanguage(200005),Math.floor(e-u.serverTime)),e-u.serverTime>0&&(this.timer=this.addTimer(1,e-u.serverTime,(function(){var t=Math.floor(e-u.serverTime);i.time.string=o.formatStrWithMirrorDeal(GetLanguage(200005),t),t<=0&&i.setActive(!1)}))),this.isFinish=!1},c.playDiceAnim=function(i){for(var t=this,e=0;e<3;e++){var n=this.diceList[e];n.setAnimation(0,"chixu",!1),n.addAnimation(0,i.point[e].toString(),!1)}this.timer&&(this.removeTimer(this.timer),this.timer=null),this.timer=this.addTimer(10,1,(function(){t.timer=null,t.setActive(!1)})),this.timeNode.active=!1,this.bottomNode.active=!1,this.isFinish=!0,this.rewardList=i.reward_list},c.onBeforeClose=function(){this.timer&&(this.removeTimer(this.timer),this.timer=null),this.rewardList&&(uiMgr.openView("GoodsGetView",this.rewardList),this.rewardList=null)},c.onDestroy=function(){},e}(c));e._RF.pop()}}}));

