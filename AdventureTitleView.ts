System.register("chunks:///_virtual/AdventureTitleView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./BaseView.ts","./ItemIcon.ts","./ConfigGlobal.ts","./GuideModel.ts","./MessageView.ts","./MainViewModel.ts","./RoleDataCache.ts","./RoleDefine.ts","./TaskControl.ts","./TaskDataCache.ts","./TaskDefine.ts","./AdventureTitleControl.ts","./AdventureTitleDataCache.ts","./AdventureTitleDefine.ts","./UIDefine.ts"],(function(t){"use strict";var e,i,o,n,s,a,d,r,h,l,v,c,u,b,p,g,f,C,x,L,m,T,J,I,y,E,D,S,w,_,k;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,o=t.ProgressBar,n=t.Label,s=t.Sprite,a=t.ScrollView,d=t.Button,r=t.UITransform,h=t.Vec3,l=t.js},function(t){v=t.ItemGrid},function(t){c=t.ListItem},function(t){u=t.default},function(t){b=t.default},null,function(t){p=t.BaseView},function(t){g=t.IconAseetType},function(t){f=t.ConfigGlobal},function(t){C=t.GuideModel},function(t){x=t.default},function(t){L=t.MainViewModel},function(t){m=t.RoleDataCache},function(t){T=t.RoleEventDefine},function(t){J=t.default},function(t){I=t.TaskDataCache},function(t){y=t.TaskEventDefine,E=t.TaskType,D=t.TaskState},function(t){S=t.default},function(t){w=t.AdventureTitleDataCache},function(t){_=t.AdventureTitleEventDefine},function(t){k=t.PanelTabType}],execute:function(){i._RF.push({},"cb50biERSpDm7jzJrQRI9yC","AdventureTitleView",void 0);t("default",function(t){function i(){var e,i;return(i=t.call(this)||this).taskList=void 0,i.imgCurTitle=void 0,i.imgNextTitle=void 0,i.txtCurTitle=void 0,i.txtNextTitle=void 0,i.arrow=void 0,i.btnEvolve=void 0,i.btnUpgrade=void 0,i.btnAttr=void 0,i.nodeGray=void 0,i.txtDescList=[],i.playerLevel=void 0,i.playerJob=void 0,i.nextJob=void 0,i.upgradePosX=((e={})[0]=0,e[1]=135,e),i.targetLevel=void 0,i.pbLevel=void 0,i.txtLevel=void 0,i.txtEvolve1=void 0,i.txtEvolve2=void 0,i.isJobLimit=void 0,i.index=void 0,i.imgCurJob=void 0,i.txtCurJob=void 0,i.imgNextJob=void 0,i.txtNextJob=void 0,i.nodeCurJob=void 0,i.nodeNextJob=void 0,i.jobArrow=void 0,i.count=0,i.btnEvolveRed=void 0,i.btnRed=void 0,i.btnTitle=void 0,i.name="AdventureTitleView",i.url="ui/module/adventuretitle/AdventureTitleView",i.fullScreen=!1,i}e(i,t);var l=i.prototype;return l.onInit=function(){var t=this;this.pbLevel=this.findChildComponent("root/content/nodeEvolution/nodePb",o),this.txtLevel=this.findChildComponent("root/content/nodeEvolution/nodePb/txtLevel",n);for(var e=0;e<=2;e++){var i=this.findChildComponent("root/content/nodeEvolution/nodeDesc/txtDesc_"+e,n);this.txtDescList.push(i)}this.nodeCurJob=this.findChild("root/content/nodeEvolution/nodeEvolve/nodeJob/nodeCurJob"),this.nodeNextJob=this.findChild("root/content/nodeEvolution/nodeEvolve/nodeJob/nodeNextJob"),this.jobArrow=this.findChild("root/content/nodeEvolution/nodeEvolve/nodeJob/arrow"),this.imgCurJob=this.findChildComponent("root/content/nodeEvolution/nodeEvolve/nodeJob/nodeCurJob/imgJob",s),this.txtCurJob=this.findChildComponent("root/content/nodeEvolution/nodeEvolve/nodeJob/nodeCurJob/txtName/Label",n),this.imgNextJob=this.findChildComponent("root/content/nodeEvolution/nodeEvolve/nodeJob/nodeNextJob/imgJob",s),this.txtNextJob=this.findChildComponent("root/content/nodeEvolution/nodeEvolve/nodeJob/nodeNextJob/txtName/Label",n);var r=this.findChildComponent("root/content/taskList",a);this.taskList=this.addUIList(r,N),this.imgCurTitle=this.findChildComponent("root/content/nodeTitle/curTitle",s),this.imgNextTitle=this.findChildComponent("root/content/nodeTitle/nextTitle",s),this.txtCurTitle=this.findChildComponent("root/content/nodeTitle/curTitle/Label",n),this.txtNextTitle=this.findChildComponent("root/content/nodeTitle/nextTitle/Label",n),this.arrow=this.findChild("root/content/nodeTitle/arrow");var h=this.findChild("root/btnClose");this.addComponentCallbackListener(h,d.EventType.CLICK,(function(){t.close()})),this.btnAttr=this.findChild("root/content/nodeTitle/btnAttr"),this.addComponentCallbackListener(this.btnAttr,d.EventType.CLICK,(function(){uiMgr.openView("AdventureTitleInfoView")})),this.btnEvolve=this.findChild("root/btnEvolve"),this.btnUpgrade=this.findChild("root/btnUpgrade"),this.txtEvolve1=this.findChildComponent("root/btnEvolve/Label1",n),this.txtEvolve2=this.findChildComponent("root/btnEvolve/Label2",n),this.nodeGray=this.findChild("root/btnUpgrade/nodeGray"),this.btnEvolveRed=this.findChild("root/btnEvolve/red"),this.btnRed=this.findChild("root/btnUpgrade/red"),this.btnTitle=this.findChild("root/content/adventureTitle"),this.addComponentCallbackListener(this.btnUpgrade,d.EventType.CLICK,(function(){IS(w).canLevUp()?(uiMgr.openView("AdventureTitleUpgradeView"),t.addUIEffect("prefab/ui-effect/MX_tx_jinjietouxian",t.btnTitle,1.5),IS(S).send_49_2()):x.showFlyTip(GetLanguage(201039))})),this.addComponentCallbackListener(this.btnEvolve,d.EventType.CLICK,(function(){t.targetLevel>100&&(t.btnEvolveRed.active=!1,IS(w).evolveRed=!1),IS(L).TryJumpToMainViewPanel(k.Main_Role),t.close()}))},l.registerUpdateHandler=function(){this.addEvent(_.OnAdventureTitleUpdate,this.updateInfo,this),this.addEvent(y.TASK_INFO_UPDATE,this.updateTask,this),this.addEvent(T.ROLE_INFO_UPDATE,this.updateRoleInfo,this)},l.onAfterOpen=function(){IS(S).send_49_1(),this.updateRoleInfo(),IS(w).updateRed()},l.onBeforeClose=function(){IS(w).updateRed()},l.onDestroy=function(){},l.onUpdate=function(t){if(5==this.count){var e=this.imgCurJob.node.getComponent(r).contentSize.y,i=this.imgNextJob.node.getComponent(r).contentSize.y,o=this.imgCurJob.node.parent.getComponent(r).contentSize.y;this.imgCurJob.node.position=new h(this.imgCurJob.node.position.x,(e-o)/2+50,0),this.imgNextJob.node.position=new h(this.imgNextJob.node.position.x,(i-o)/2+50,0),this.count=0}else this.count++},l.updateRoleInfo=function(){var t=this;this.playerLevel=IS(m).GetLevel(),this.playerJob=IS(m).GetJob();var e,i=configJobs.getDataByKey(this.playerJob).change_times,o=configJobs.getDataByKey(this.playerJob).name,n=f.transfer_job_level;this.targetLevel=n[i];var s=IS(w).lastJobLevel;(null==this.targetLevel||i>=5)&&(this.targetLevel=f.jobs_wakeup_condition,e=!0),IS(w).targetLevel=this.targetLevel;var a=this.playerLevel<=this.targetLevel?this.playerLevel:this.targetLevel,d="job_"+this.playerJob;this.nextJob=0==i?1002:1==i?1111:parseInt(this.playerJob)+100;var r="job_"+this.nextJob.toString();switch(this.nextJob<1600?(this.nodeCurJob.setPosition(-180,-70),this.nodeNextJob.active=!0,this.jobArrow.active=!0,this.loadIcon(this.imgCurJob,"icon_job",d,(function(e){t.updateCurRoleJob(e)}),g.ICON_SPRITE),this.loadIcon(this.imgNextJob,"icon_job",r,(function(e){t.updateNextRoleJob(e)}),g.ICON_SPRITE),this.txtCurJob.string=o,this.txtNextJob.string=configJobs.getDataByKey(this.nextJob.toString()).name):(this.nodeCurJob.setPosition(0,-70),this.nodeNextJob.active=!1,this.jobArrow.active=!1,this.loadIcon(this.imgCurJob,"icon_job",d,(function(e){t.updateCurRoleJob(e)}),g.ICON_SPRITE),this.loadIcon(this.imgNextJob,"icon_job",r,(function(e){t.updateNextRoleJob(e)}),g.ICON_SPRITE),this.txtCurJob.string=o),i<5?(this.index=0,this.pbLevel.node.active=!0,this.pbLevel.progress=this.playerLevel/this.targetLevel,this.txtLevel.string=a+"/"+this.targetLevel,this.playerLevel<this.targetLevel?(this.btnEvolve.active=!1,this.btnUpgrade.position=new h(this.upgradePosX[0],this.btnUpgrade.position.y,this.btnUpgrade.position.z)):(this.index=1,s!=i&&(IS(w).evolveRed=!0,this.btnEvolveRed.active=!0,IS(w).lastJobLevel=i,IS(w).updateRed()),this.btnEvolve.active=!0,this.txtEvolve1.node.active=!0,this.txtEvolve2.node.active=!1,this.btnUpgrade.position=new h(this.upgradePosX[1],this.btnUpgrade.position.y,this.btnUpgrade.position.z))):e&&5==i?(this.index=2,this.pbLevel.node.active=!0,this.pbLevel.progress=this.playerLevel/this.targetLevel,this.txtLevel.string=a+"/"+this.targetLevel,this.playerLevel<this.targetLevel?(this.btnEvolve.active=!1,this.btnUpgrade.position=new h(this.upgradePosX[0],this.btnUpgrade.position.y,this.btnUpgrade.position.z)):(this.index=3,s!=i&&(IS(w).lastJobLevel=i),this.btnEvolve.active=!0,this.txtEvolve1.node.active=!1,this.txtEvolve2.node.active=!0,this.btnUpgrade.position=new h(this.upgradePosX[1],this.btnUpgrade.position.y,this.btnUpgrade.position.z))):(this.index=4,this.pbLevel.node.active=!1,this.btnEvolve.active=!1,this.btnUpgrade.position=new h(this.upgradePosX[0],this.btnUpgrade.position.y,this.btnUpgrade.position.z)),this.index){case 0:this.txtDescList[0].node.active=!0,this.txtDescList[1].node.active=!1,this.txtDescList[2].node.active=!1,this.txtDescList[0].string=b.formatStrWithMirrorDeal(GetLanguage(201138),this.targetLevel);break;case 1:this.txtDescList[0].node.active=!1,this.txtDescList[1].node.active=!0,this.txtDescList[2].node.active=!1,this.txtDescList[1].string=GetLanguage(201139);break;case 2:this.txtDescList[0].node.active=!0,this.txtDescList[1].node.active=!1,this.txtDescList[2].node.active=!1,this.txtDescList[0].string=GetLanguage(201140);break;case 3:this.txtDescList[0].node.active=!1,this.txtDescList[1].node.active=!0,this.txtDescList[2].node.active=!1,this.txtDescList[1].string=GetLanguage(201141);break;default:this.txtDescList[0].node.active=!1,this.txtDescList[1].node.active=!1,this.txtDescList[2].node.active=!0,this.txtDescList[1].string=GetLanguage(201142)}},l.updateCurRoleJob=function(t){var e=this.imgCurJob.node.getComponent(r).contentSize.y,i=this.imgCurJob.node.parent.getComponent(r).contentSize.y,o=configJobs.getDataByKey(this.playerJob).change_times>1?30:0;this.imgCurJob.node.position=new h(o,(e-i)/2+50,0)},l.updateNextRoleJob=function(t){var e=this.imgNextJob.node.getComponent(r).contentSize.y,i=this.imgCurJob.node.parent.getComponent(r).contentSize.y;if(this.nextJob<1600){var o=configJobs.getDataByKey(this.nextJob).change_times>1?30:0;this.imgNextJob.node.position=new h(o,(e-i)/2+50,0)}},l.updateInfo=function(){this.btnEvolveRed.active=IS(w).evolveRed,this.btnRed.active=IS(w).canLevUp(),this.nodeGray.active=!IS(w).canLevUp();var t=IS(w).level,e=configAdventure_level.getDataByKey(t);if(0==e.next_id)this.btnUpgrade.active=!1,this.arrow.active=!1,this.imgNextTitle.node.active=!1,this.imgCurTitle.node.setPosition(-100,-6),this.btnAttr.setPosition(100,-6),this.loadIcon(this.imgCurTitle,"adventuretitle",e.icon),this.txtCurTitle.string=GetLanguage(e.language_id),this.taskList.clearData();else{this.btnUpgrade.active=!0,this.arrow.active=!0,this.imgNextTitle.node.active=!0,this.imgCurTitle.node.setPosition(-215,-6),this.btnAttr.setPosition(215,-6),this.loadIcon(this.imgCurTitle,"adventuretitle",e.icon),this.txtCurTitle.string=GetLanguage(e.language_id);var i=configAdventure_level.getDataByKey(e.next_id);this.loadIcon(this.imgNextTitle,"adventuretitle",i.icon),this.txtNextTitle.string=GetLanguage(i.language_id),this.updateTask()}},l.updateTask=function(){var t=IS(w).level,e=configAdventure_level.getDataByKey(t);0!=e.next_id&&(this.taskList.datas=e.task_group)},i}(p));var N=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).txtTask=void 0,e.txtDesc=void 0,e.pb=void 0,e.canGet=void 0,e.complete=void 0,e.itemGrid=void 0,e.btnTask=void 0,e.guideId=void 0,e.state=void 0,e}e(i,t);var s=i.prototype;return s.onInit=function(){var t=this;this.txtTask=u.findChildComponent(this.node,"taskTarget/txtTask",n),this.txtDesc=u.findChildComponent(this.node,"taskTarget/progressbar/Label",n),this.pb=u.findChildComponent(this.node,"taskTarget/progressbar",o),this.itemGrid=new v(this.view,u.findChild(this.node,"reward/itemGrid")),this.complete=u.findChild(this.node,"complete"),this.canGet=u.findChild(this.node,"canGet"),this.view.addComponentCallbackListener(this.canGet,d.EventType.CLICK,(function(){IS(J).send_10_2(E.AdventureTitle,t.data)})),this.btnTask=u.findChild(this.node,""),this.view.addComponentCallbackListener(this.btnTask,d.EventType.CLICK,(function(){t.guideId&&1==t.state&&(IS(C).openGuide(t.guideId),t.view.close())}))},s.onRender=function(t,e){var i=configAdventure_task.getDataByKey(t);this.txtTask.string=i.desc,this.guideId=i.guide,this.itemGrid.SetItemId(i.reward[0][0],i.reward[0][1]);var o=IS(I).GetTaskItem(E.AdventureTitle,t);if(this.state=o.state,null==o)this.pb.progress=0,this.txtDesc.string=l.formatStr("%s/%s",0,i.condition[2]),this.canGet.active=!1,this.complete.active=!1;else if(o.state==D.Normal){var n=o.count<=i.condition[2]?o.count:i.condition[2];this.pb.progress=n/i.condition[2],this.txtDesc.string=l.formatStr("%s/%s",n,i.condition[2]),this.canGet.active=!1,this.complete.active=!1}else o.state==D.Complete?(this.pb.progress=1,this.txtDesc.string=l.formatStr("%s/%s",i.condition[2],i.condition[2]),this.canGet.active=!0,this.complete.active=!1):(this.pb.progress=1,this.txtDesc.string=l.formatStr("%s/%s",i.condition[2],i.condition[2]),this.canGet.active=!1,this.complete.active=!0)},i}(c);i._RF.pop()}}}));

