System.register("chunks:///_virtual/SceneUnit7.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./PolyNavAgent.ts","./CommonModel.ts","./RunningGameDefine.ts"],(function(e){"use strict";var t,i,o,n,s,r,c,h,a,d;return{setters:[function(e){t=e.inheritsLoose,i=e.createClass},function(e){o=e.cclegacy,n=e.Vec2,s=e.Rect},function(e){r=e.V2},function(e){c=e.PolyNavAgent},function(e){h=e.CommonModel},function(e){a=e.TrackEdge,d=e.RoleLevel}],execute:function(){o._RF.push({},"cf878TuKk5MCIfOJ1HnTzw0","SceneUnit",void 0);var l=e("SceneUnit",function(){function e(){this.id=void 0,this.uid=0,this.del=!1,this.isDestroy=!1,this.type=1,this.rect=new s,this.inQuene=0}var t=e.prototype;return t.update=function(e){this.del||this.onUpdate(e)},t.destroy=function(){this.isDestroy||(this.isDestroy=!0,this.del=!0,this.onDestroy())},e}());e("SceneRole",function(e){function o(t,i){var o;(o=e.call(this)||this).map=void 0,o.info=void 0,o.agent=void 0,o.model=void 0,o.moveType=0,o.velocity=void 0,o.infoView=void 0,o.target=void 0,o.info=i,o.uid=i.role_id,o.map=t;var s=new r(i.pos.x,i.pos.y),a=1.3;return i.role_level==d.Level6&&(a=1.5),1!=i.role_id?(o.model=IS(h).createRoleModel(i.figure,t.nodeUnit,s,a),i.inQuene>0&&(o.model.aniName="run")):(o.model=IS(h).createRoleModel(i.figure,t.nodePlayer,s,a),o.model.aniName="run"),o.agent=new c(t.polyNav),o.agent.pos.set(s.x,s.y),o.agent.maxSpeed=300,o.rect.width=200,o.rect.height=200,o.rect.center=s,o.id="role:"+i.role_id,o.velocity=new n(0,0),o}t(o,e);var s=o.prototype;return s.onUpdate=function(e){if(!this.del){this.agent.onUpdate(e);var t=this.agent.pos.x;this.velocity.equals2f(0,0,.1)||this.agent.setDirPos(this.velocity,e),this.agent.pos.x>a.Left&&this.agent.pos.x<a.Right?(this.rect.center=this.agent.pos,this.model.position=this.agent.pos):this.agent.pos.x=t;var i=this.agent.dir;this.model.direction=i}},s.moveToTarget=function(e){return!(n.distance(this.position,e)<1)&&(this.agent.activePath.push(e),this.moveType=2,this.agent.isMove=!0,!0)},s.moveToDir=function(e){this.moveType=2,this.model.aniName="run",this.velocity=new n(e.x,e.y)},s.onDestroy=function(){this.infoView&&this.infoView.free(),this.model&&this.model.free()},i(o,[{key:"position",get:function(){return this.model.position},set:function(e){this.model.position=e,this.agent.pos.set(e.x,e.y),this.rect.center=e}},{key:"depth",get:function(){return this.model.depth},set:function(e){this.model.depth=e}}]),o}(l));o._RF.pop()}}}));

