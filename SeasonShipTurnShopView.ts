System.register("chunks:///_virtual/SeasonShipTurnShopView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./index57.ts","./BagDefine.ts","./ResItems.ts","./MessageView.ts","./MallControl.ts","./MallDataCache.ts","./MallDefine.ts","./RoleDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,a,r,u,d,h,l,c,f,p,m,v,y,C,S,w;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.ScrollView,s=t.Label,a=t.Sprite,r=t.sys},function(t){u=t.ItemGrid},function(t){d=t.ListItem},function(t){h=t.default},function(t){l=t.default},null,function(t){c=t.BagEventDefine},function(t){f=t.ResItems},function(t){p=t.default},function(t){m=t.default},function(t){v=t.default},function(t){y=t.MallEventDefine,C=t.MallType},function(t){S=t.RoleEventDefine},function(t){w=t.BaseView}],execute:function(){e._RF.push({},"829b4TJfmpCgKGwPiVisQlg","SeasonShipTurnShopView",void 0);var I=[270018],L=(t("default",function(t){function e(){var i;return(i=t.call(this)||this).scroll=void 0,i.resItems=void 0,i.name="SeasonShipTurnShopView",i.url="ui/module/season/SeasonShipTurnShopView",i.poolTime=3e3,i}i(e,t);var s=e.prototype;return s.onInit=function(){var t=this,i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()}));var e=this.findChild("view/ruleTips");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){uiMgr.openView("SeasonShipTurnTransView")}));var s=this.findChildComponent("view/scrollList",o);this.scroll=this.addUIList(s,L),this.resItems=new f(this,"view/resRoot"),this.resItems.init(I)},s.registerUpdateHandler=function(){this.addEvent(y.MAll_INFO_UPDATE,this.updateInfo,this),this.addEvent(c.GOODS_INFO_UPDATE,this.updateResShow,this),this.addEvent(S.ROLE_RES_UPDATE,this.updateResShow,this)},s.onAfterOpen=function(){this.updateResShow(),IS(m).send_27_1(C.SeasonTurn);var t=[].concat(configMall.getDataByList("type",C.SeasonTurn)),i=[];for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];i.push(n)}i.sort((function(t,i){return t.id-i.id})),this.scroll.datas=i},s.updateResShow=function(){this.resItems.update()},s.updateInfo=function(){this.scroll.updateAll()},s.onBeforeClose=function(){},s.onDestroy=function(){},e}(w)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtName=void 0,i.txtPrice=void 0,i.priceIcon=void 0,i.btnBuy=void 0,i.out=void 0,i.txtRest=void 0,i.txtLimit=void 0,i.itemGrid=void 0,i.buyLimit=void 0,i}i(e,t);var o=e.prototype;return o.onInit=function(){var t=this;this.txtPrice=h.findChildComponent(this.node,"btnBuy/Label",s),this.priceIcon=h.findChildComponent(this.node,"btnBuy/Label/icon",a),this.txtName=h.findChildComponent(this.node,"txtName",s),this.buyLimit=h.findChild(this.node,"buyLimit"),this.out=h.findChild(this.node,"out"),this.out.active=!1,this.txtRest=h.findChildComponent(this.node,"buyLimit/numRest",s),this.txtLimit=h.findChildComponent(this.node,"buyLimit/numLimit",s),this.itemGrid=new u(this.view,h.findChild(this.node,"itemGrid")),this.btnBuy=h.findChild(this.node,"btnBuy"),this.view.addComponentCallbackListener(this.btnBuy,n.EventType.CLICK,(function(){t.out.active?p.showFlyTip(GetLanguage(200039)):uiMgr.openView("MallTipsView",t.data)}))},o.onRender=function(t,i){this.txtName.string=t.name;var e=configGoods.getDataByKey(t.price[0]);this.txtPrice.string=t.price[1],this.view.loadIcon(this.priceIcon,"icon_item",e.icon),this.itemGrid.SetItemId(t.goods[0],t.goods[1]),this.out.active=!1;var n=IS(v).GetBuyInfoByType(t.type);if(-1!=t.limit){var o;this.buyLimit.active=!0;var s=null!=(o=n[t.id])?o:0;this.txtRest.string=String(t.limit-s),this.txtLimit.string=l.formatStr(r.uiMirror?"##1/":"/##1",t.limit),this.out.active=s>=t.limit}else this.buyLimit.active=!1},e}(d));e._RF.pop()}}}));

