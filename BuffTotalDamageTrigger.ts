System.register("chunks:///_virtual/BuffTotalDamageTrigger.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ObjectPool.ts","./FixMath.ts","./Buff.ts","./EnumDefine.ts"],(function(t){"use strict";var a,e,i,r,n,o;return{setters:[function(t){a=t.inheritsLoose},function(t){e=t.cclegacy},function(t){i=t.ObjectPool},function(t){r=t.FixMath},function(t){n=t.Buff},function(t){o=t.SpBuffState}],execute:function(){e._RF.push({},"aec67xNkzxFbqQZV12Qgb6t","BuffTotalDamageTrigger",void 0);var s=t("BuffTotalDamageTrigger",function(t){function e(){for(var a,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return(a=t.call.apply(t,[this].concat(i))||this).hasTrigger=!1,a._calType=void 0,a._value=void 0,a._targetType=void 0,a._addlasttime=void 0,a._addBuffList=void 0,a}a(e,t);var i=e.prototype;return i.onBegin=function(){this.owner.data.AddBuffState(o.TotalDamageTrigger,1)},i.onDestroy=function(){this.owner.data.AddBuffState(o.TotalDamageTrigger,-1),e._pool.free(this)},i.onTotalDamage=function(t){if(!this.hasTrigger){var a=this.owner.data.totalDamage;if(0==this._calType){if(a<this._value)return}else if(1==this._calType&&r.round(a/this.owner.data.maxHp)<r.round(this._value/1e4))return;for(var e=0==this._targetType?this.owner:this.runner.battleMain.unitMgr.getUnit(t),i=0;i<this._addBuffList.length;i++)this.runner.addBuff(e,this._addBuffList[i],this._addlasttime,this.skillPar);this.hasTrigger=!0}},e.alloc=function(t){var a=e._pool.alloc();return a.config=t,a._calType=t.param1,a._value=t.param2,a._targetType=t.param3,a._addlasttime=t.param4,a._addBuffList=t.param5,a.hasTrigger=!1,a},e}(n));s._pool=new i(s,10),e._RF.pop()}}}));

