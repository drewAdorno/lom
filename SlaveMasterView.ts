System.register("chunks:///_virtual/SlaveMasterView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./ChatDataCache.ts","./ChatDefine.ts","./MessageView.ts","./FriendControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./SlaveControl.ts","./SlaveDataCache.ts","./SlaveDefine.ts","./SlaveModel.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,r,s,l,h,d,f,c,m,u,C,v,p,g,S,I,_,x,N,R;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.Label,a=t.Sprite,r=t.ScrollView,s=t.js},function(t){l=t.ListItem},function(t){h=t.default},function(t){d=t.default},function(t){f=t.default},null,function(t){c=t.ConfigGlobal},function(t){m=t.default},function(t){u=t.ChatDataCache},function(t){C=t.ChatDefine},function(t){v=t.default},function(t){p=t.default},function(t){g=t.RoleDataCache},function(t){S=t.PlayerAttr},function(t){I=t.default},function(t){_=t.SlaveDataCache},function(t){x=t.SlaveEventDefine},function(t){N=t.SlaveModel},function(t){R=t.BaseView}],execute:function(){i._RF.push({},"904c1O9weFEcYoREtq0HAaX","SlaveMasterView",void 0);var y=c.capture_slave_limit,L=(t("default",function(t){function i(){var e;return(e=t.call(this)||this).infoScroll=void 0,e.nodeNoMaster=void 0,e.nodeMasterName=void 0,e.txtMasterName=void 0,e.txtSlaveNum=void 0,e.txtMasterFightPower=void 0,e.txtMasterChapter=void 0,e.nodeNoSlave=void 0,e.btnCatch=void 0,e.btnHelp=void 0,e.btnRun=void 0,e.imgHeadFrame=void 0,e.imgHead=void 0,e.txtName=void 0,e.txtFightPower=void 0,e.txtChapter=void 0,e.nodeChapterTitle=void 0,e.roleId=void 0,e.info=void 0,e.name="SlaveMasterView",e.url="ui/module/slave/SlaveMasterView",e.fullScreen=!0,e}e(i,t);var l=i.prototype;return l.onInit=function(){var t=this,e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()})),this.nodeNoMaster=this.findChild("root/content/noMaster"),this.nodeMasterName=this.findChild("root/content/masterName"),this.txtMasterName=this.findChildComponent("root/content/masterName/txtName",o),this.nodeNoSlave=this.findChild("root/content/noSlave"),this.btnCatch=this.findChild("root/content/btnCatch"),this.addComponentCallbackListener(this.btnCatch,n.EventType.CLICK,(function(){var e=IS(_).slavesInfo;if(null!=t.info)if(e&&e.length>=y)v.showFlyTip(GetLanguage(201772));else{var i=IS(N).getExtValue(t.info.role_info,4);if(i&&i>0&&f.serverTime<i)v.showFlyTip(GetLanguage(201892));else{var n=m.isEmpty(t.info.master_info)?GetLanguage(201810):GetLanguage(999100110);v.showBoxTip({tip:n,func:function(e){"type_yes"==e&&IS(I).reqCaptureSlaveCombat(1,t.info.role_info.role_id)}})}}}));var i=this.findChild("root/content/imgFrame");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){null!=t.info&&IS(p).reqOtherRoleNotice(t.info.role_info.role_id,1)}));var s=this.findChild("root/content/btnMaster");this.addComponentCallbackListener(s,n.EventType.CLICK,(function(){null!=t.info&&null!=t.info.master_info&&IS(p).reqOtherRoleNotice(t.info.master_info.role_id,1)})),this.btnHelp=this.findChild("root/content/btnHelp"),this.addComponentCallbackListener(this.btnHelp,n.EventType.CLICK,(function(){IS(u).IsOpenInput()?uiMgr.openView("ChatView",null,null,{contentType:C.ChatContentType.Share,linkType:C.ChatLinkType.SlaveHelp,cacheData:{targetId:t.info.role_info.role_id,slaveId:IS(g).GetRoleId(),endTime:IS(N).getExtValue(IS(_).selfRoleInfo,2)},showString:GetLanguage(201787)}):v.showFlyTip(d.formatStrWithMirrorDeal(GetLanguage(200490),c.chat_level))})),this.btnRun=this.findChild("root/content/btnRun"),this.addComponentCallbackListener(this.btnRun,n.EventType.CLICK,(function(){IS(I).reqCaptureSlaveCombat(1,IS(g).GetRoleId())})),this.imgHeadFrame=this.findChildComponent("root/content/imgFrame/imgHeadFrame",a),this.imgHead=this.findChildComponent("root/content/imgFrame/head",a),this.txtName=this.findChildComponent("root/content/txtName",o),this.txtFightPower=this.findChildComponent("root/content/txtFightPower",o),this.txtChapter=this.findChildComponent("root/content/txtChapter",o),this.nodeChapterTitle=this.findChild("root/content/txtChapterTitle");var l=this.findChildComponent("root/content/ScrollView",r);this.infoScroll=this.addUIList(l,L),this.txtMasterFightPower=this.findChildComponent("root/content/masterName/txtFightPower",o),this.txtMasterChapter=this.findChildComponent("root/content/masterName/txtChapter",o),this.txtSlaveNum=this.findChildComponent("root/content/txtNum",o);var h=this.findChild("root/content/btnTip");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){var e=0;t.info&&t.info.slaves_info&&(e=t.info.slaves_info.length),v.showBoxTip({tip:configCapture_slave_pvp_debuff.getDataByKey(e).desc,btnCnt:1})}))},l.registerUpdateHandler=function(){this.addEvent(x.SLAVE_INFO_BACK,this.onSlaveInfoBack,this)},l.updateInfo=function(){this.updateSelfInfo(),this.updateMasterInfo(),this.updateSlaveInfo()},l.updateSelfInfo=function(){var t=this.info.role_info;this.txtName.string=IS(N).getRoleName(t),this.txtFightPower.string=d.GetNumString(IS(N).getAttrNumById(t,S.ROLE_ATTR_POWER_SHOW)),this.txtChapter.string=IS(N).getExtValue(t,1),this.loadRemoteIcon(IS(N).getAttrStrById(t,S.ROLE_ATTR_HEAD_URL),this.imgHead);var e=IS(N).getAttrStrById(t,S.ROLE_ATTR_HEAD_FRAME_ID);if(e>0){this.imgHeadFrame.node.active=!0;var i=configAvatar_frame.getDataByKey(e);this.loadIcon(this.imgHeadFrame,"icon_frame",i.icon)}else this.imgHeadFrame.node.active=!1},l.updateMasterInfo=function(){this.nodeNoMaster.active=m.isEmpty(this.info.master_info),this.nodeMasterName.active=!m.isEmpty(this.info.master_info),this.txtMasterName.string=IS(N).getRoleName(this.info.master_info),this.txtMasterFightPower.string=d.GetNumString(IS(N).getAttrNumById(this.info.master_info,S.ROLE_ATTR_POWER_SHOW)),this.txtMasterChapter.string=IS(N).getExtValue(this.info.master_info,1)},l.updateSlaveInfo=function(){var t=this.info.slaves_info;if(null==t||t.length<=0)return this.nodeNoSlave.active=!0,this.infoScroll.clearData(),void(this.txtSlaveNum.string=d.formatStrWithMirrorDeal(GetLanguage(999100109),s.formatStr("%s/%s",0,y)));this.nodeNoSlave.active=!1,this.infoScroll.datas=t,this.txtSlaveNum.string=d.formatStrWithMirrorDeal(GetLanguage(999100109),s.formatStr("%s/%s",t.length,y))},l.updateBtnStatus=function(){var t=IS(_).masterInfo&&IS(_).masterInfo.role_id==this.roleId;this.txtChapter.node.active=!t,this.nodeChapterTitle.active=!t,this.btnCatch.active=!t,this.btnHelp.active=t,this.btnRun.active=t},l.onSlaveInfoBack=function(t,e){t==IS(g).GetRoleId()&&this.updateBtnStatus(),t==this.roleId&&(this.info=e,this.updateInfo())},l.onAfterOpen=function(){this.roleId=this.openArgs[0],IS(I).reqCaptureSlaveInfo(this.roleId),this.updateBtnStatus()},l.onBeforeClose=function(){this.info=null},l.onDestroy=function(){},i}(R)),function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).imgHeadFrame=void 0,e.imgHead=void 0,e.txtName=void 0,e.txtChapter=void 0,e}e(i,t);var r=i.prototype;return r.onInit=function(){var t=this;this.txtName=h.findChildComponent(this.node,"txtName",o);var e=h.findChild(this.node,"imgFrame");this.view.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.data.role_id&&IS(p).reqOtherRoleNotice(t.data.role_id,1)})),this.imgHead=h.findChildComponent(this.node,"imgFrame/head",a),this.imgHeadFrame=h.findChildComponent(this.node,"imgFrame/imgHeadFrame",a),this.txtChapter=h.findChildComponent(this.node,"txtChapter",o)},r.onRender=function(t,e){this.txtName.string=IS(N).getRoleName(t),this.view.loadRemoteIcon(IS(N).getAttrStrById(t,S.ROLE_ATTR_HEAD_URL),this.imgHead);var i=IS(N).getAttrNumById(t,S.ROLE_ATTR_HEAD_FRAME_ID);if(i>0){this.imgHeadFrame.node.active=!0;var n=configAvatar_frame.getDataByKey(i);this.view.loadIcon(this.imgHeadFrame,"icon_frame",n.icon)}else this.imgHeadFrame.node.active=!1;this.txtChapter.string=IS(N).getExtValue(t,1)},i}(l));i._RF.pop()}}}));

