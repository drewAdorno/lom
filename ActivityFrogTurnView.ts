System.register("chunks:///_virtual/ActivityFrogTurnView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./AudioMgr.ts","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StorageUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./SpineSkeleton.ts","./BagDefine.ts","./BagModel.ts","./RoleDefine.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./HorseCarnivalControl.ts","./HorseCarnivalDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,o,n,r,s,a,d,c,h,l,f,u,p,g,m,v,w,y,C,T,S,I,b,_,G,L,k,R,x,V,D,N,E;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose,o=t.regeneratorRuntime},function(t){n=t.cclegacy,r=t.Vec2,s=t.Button,a=t.Sprite,d=t.Label,c=t.ScrollView,h=t.RichText,l=t.Toggle,f=t.js,u=t.Vec3,p=t.UITransform},function(t){g=t.V2},function(t){m=t.audioMgr},function(t){v=t.ItemGrid},function(t){w=t.ListItem},function(t){y=t.default},function(t){C=t.default},function(t){T=t.default},function(t){S=t.default},null,function(t){I=t.SpineSkeleton},function(t){b=t.BagEventDefine},function(t){_=t.BagModel},function(t){G=t.RoleEventDefine},function(t){L=t.default},function(t){k=t.ActivityType,R=t.ActivityEventDefine,x=t.ActivityState},function(t){V=t.default},function(t){D=t.HorseCarnivalDataCache},function(t){N=t.ViewEvent,E=t.BaseView}],execute:function(){var A,B,j;n._RF.push({},"d82a2nKAOFBvaq/D0cQrLGJ","ActivityFrogTurnView",void 0);var M=((A={})[1]="bsw_icon_jiangpin03",A[2]="bsw_icon_jiangpin02",A[3]="bsw_icon_jiangpin01",A),O=((B={})[1]=700,B[2]=1e3,B[3]=500,B),P={},F=((j={})[2]=5,j[3]=0,j),K=["ArtifactGetView","HorseGetView","PlayerSkinGetView","FateNewView","GoodsGetView2","WingGetView"],U=(t("default",function(t){function n(){var e;return(e=t.call(this)||this).actType=void 0,e.nodeResParent=void 0,e.nodeResItem=void 0,e.nodeRolling=void 0,e.rollEff=void 0,e.bgEff=void 0,e.bgEffNode=void 0,e.bgPos=void 0,e.turnEff=void 0,e.resItems=void 0,e.btnGift=void 0,e.btnStore=void 0,e.togSkip=void 0,e.skipAnim=void 0,e.iconTen=void 0,e.iconOne=void 0,e.txtOne=void 0,e.txtTen=void 0,e.redOne=void 0,e.redTen=void 0,e.txtNumReward=void 0,e.numScroll=void 0,e.tipsGo=void 0,e.tipsScroll=void 0,e.imgPreview=void 0,e.preDescNum=void 0,e.preDescGet=void 0,e.onlyRewardNum=0,e.iconRewardOne=void 0,e.iconRewardTen=void 0,e.txtRewardOne=void 0,e.txtRewardTen=void 0,e.preViewCount=0,e.refreshTimer=void 0,e.curTips=0,e.tipsTimer=0,e.txtLeftTime=void 0,e.deltaTime=0,e.leftTime=0,e.canUpdate=!1,e.jackpot=0,e.jackpotType=0,e.curIndex=0,e.finalIndex=0,e.reward_list=[],e.actionTime=1,e.moveTween=void 0,e.rerwardList=[],e.waitRewardList=[],e.rewardNum=11,e.extraReward=void 0,e.name="ActivityFrogTurnView",e.url="ui/module/activityFrog/ActivityFrogTurnView",e.poolTime=3e3,e.fullScreen=!0,e.actType=k.FrogTurn,e}e(n,t);var v=n.prototype;return v.onInit=function(){var t=this;this.bgEffNode=this.findChild("root/eff"),this.bgPos=new r(this.bgEffNode.position.x,this.bgEffNode.position.y),this.initResShow(),this.btnStore=this.findChild("root/bottomBtn/btnStore"),this.addComponentCallbackListener(this.btnStore,s.EventType.CLICK,(function(){uiMgr.openView("ActivityFrogStoreView",k.Frog)})),this.btnGift=this.findChild("root/bottomBtn/btnGift"),this.addComponentCallbackListener(this.btnGift,s.EventType.CLICK,(function(){uiMgr.openView("ActivityFrogGiftView",t.actType)}));var e=this.findChild("root/btnClose");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){t.close()}));var i=this.findChild("root/btnShow/btnShow");this.addComponentCallbackListener(i,s.EventType.CLICK,(function(){uiMgr.openView("SlumberPartyTipsView",i,t.actType)}));var o=this.findChild("root/turn/img/preDesc/tips");this.addComponentCallbackListener(o,s.EventType.CLICK,(function(){uiMgr.openView("CommonPopTipsView",GetLanguage(400204),o)}));var n=this.findChild("root/turn/img/nodeTips/btnTips");this.addComponentCallbackListener(n,s.EventType.CLICK,(function(){IS(L).ShowSysTips(t.actType)})),this.nodeRolling=this.findChild("root/turn/img/nodeRolling"),this.imgPreview=this.findChildComponent("root/turn/img/imgPreview",a),this.preDescNum=this.findChild("root/turn/img/preDesc/num"),this.preDescGet=this.findChild("root/turn/img/preDesc/get"),this.addComponentCallbackListener(this.imgPreview.node,s.EventType.CLICK,(function(){t.onClickPreview()})),this.txtLeftTime=this.findChildComponent("root/top/nodeTime/txtTime",d),this.txtNumReward=this.findChildComponent("root/numReward/num",d);var f=this.findChildComponent("root/numReward/ScrollView",c);this.numScroll=this.addUIList(f,U),this.tipsGo=this.findChild("root/top/tips");var u=this.findChildComponent("root/top/tips/ScrollView",c);this.tipsScroll=this.addUIList(u,H),this.iconOne=this.findChildComponent("root/btnOne/icon",a),this.iconTen=this.findChildComponent("root/btnTen/icon",a),this.txtOne=this.findChildComponent("root/btnOne/num",h),this.txtTen=this.findChildComponent("root/btnTen/num",h),this.redOne=this.findChild("root/btnOne/red"),this.redTen=this.findChild("root/btnTen/red"),this.iconRewardOne=this.findChildComponent("root/btnOne/back/iconBack",a),this.iconRewardTen=this.findChildComponent("root/btnTen/back/iconBack",a),this.txtRewardOne=this.findChildComponent("root/btnOne/back/numBack",d),this.txtRewardTen=this.findChildComponent("root/btnTen/back/numBack",d);var p=this.findChild("root/btnOne");this.addComponentCallbackListener(p,s.EventType.CLICK,(function(){t.onLottery(1)}));var g=this.findChild("root/btnTen");this.addComponentCallbackListener(g,s.EventType.CLICK,(function(){t.onLottery(2)})),this.togSkip=this.findChildComponent("root/toggleSkip",l),this.addComponentCallbackListener(this.togSkip.node,l.EventType.TOGGLE,(function(){t.togSkip.isChecked?C.set("SkipSpringTurnAnim","1"):C.set("SkipSpringTurnAnim","0")})),this.skipAnim=this.findChild("skipAnim"),this.addComponentCallbackListener(this.skipAnim,s.EventType.CLICK,(function(){t.SkipAnim()}));for(var m=function(){var e=t.findChild("root/turn/itemRoll/itemGrid"+v),i={node:e,index:v,item_id:0,cfg_id:0,imgFram:y.findChildComponent(e,"imgFrame",a),imgIcon:y.findChildComponent(e,"imgIcon",a),num:y.findChildComponent(e,"num",d),select:y.findChild(e,"select"),light:y.findChild(e,"light"),limit:y.findChild(e,"nodeLimit"),only:y.findChild(e,"nodeOnly"),eff:null};t.addComponentCallbackListener(e,s.EventType.CLICK,(function(){0!=i.item_id&&IS(_).OpenItemTips(i.item_id,e)})),t.rerwardList.push(i)},v=0;v<this.rewardNum;v++)m()},v.initResShow=function(){var t=this;this.nodeResParent=this.findChild("resRoot"),this.nodeResItem=this.findChild("resRoot/resItem"),this.nodeResItem.active=!1;var e=[IS(D).GetCost(this.actType)[0]];this.resItems=new Array;for(var i=function(i){var o=nodeInstantiate.instantiate(t.nodeResItem),n=e[i];t.addComponentCallbackListener(o,s.EventType.CLICK,(function(){IS(_).OpenItemTips(n,y.findChild(o,"txtNum"))})),o.parent=t.nodeResParent,o.active=!0;var r=y.findChildComponent(o,"imgIcon",a),c=configGoods.getDataByKey(n);t.loadIcon(r,"icon_item",c.icon),t.resItems.push({node:o,txtNum:y.findChildComponent(o,"txtNum",d),goodsGtid:n})},o=0;o<e.length;o++)i(o)},v.registerUpdateHandler=function(){this.addEvent(R.OnHorseCarnivalUpdate,this.updateInfo,this),this.addEvent(R.OnHorseCarnivalReward,this.updateReward,this),this.addEvent(R.OnHorseCarnivalLottery,this.updateLotteryResult,this),this.addEvent(b.GOODS_INFO_UPDATE,this.updateResShow,this),this.addEvent(G.ROLE_RES_UPDATE,this.updateResShow,this),this.addEvent(N.ViewClose,this.onViewClose,this)},v.onAfterOpen=function(){var t,e=this;this.rollEff=null,this.bgEff=null,this.turnEff=null,this.updateResShow(),IS(V).send_24_16(this.actType),this.togSkip.isChecked="1"==C.get("SkipSpringTurnAnim"),this.skipAnim.active=!1,this.nodeRolling.active=!1;var i=IS(L).GetActivityInfo(this.actType),o=null!=(t=i.state_time[i.state])?t:i.state_time[x.Open];this.leftTime=o.end_time-S.serverTime,this.leftTime>0?(this.canUpdate=!0,this.txtLeftTime.string=S.formatTimeStringForSecond(this.leftTime)):this.txtLeftTime.string=GetLanguage(200026);var n=IS(D).GetCost(this.actType),r=configGoods.getDataByKey(n[0]);this.loadIcon(this.iconOne,r.icon_group,r.icon),this.loadIcon(this.iconTen,r.icon_group,r.icon);var s=IS(D).GetDrawReward(this.actType),a=configGoods.getDataByKey(s[0]);this.loadIcon(this.iconRewardOne,a.icon_group,a.icon),this.loadIcon(this.iconRewardTen,a.icon_group,a.icon),this.txtRewardOne.string=f.formatStr("x%s",s[1]),this.txtRewardTen.string=f.formatStr("x%s",10*s[1]);var d=configMount_draw_cumulative_times.getDatas(),c=[];for(var l in d)if(d.hasOwnProperty(l)){var p=d[l];p.type==i.type&&p.group_id==i.roundCfg.group_id&&c.push(p)}this.numScroll.datas=c;var m=configMount_draw.getDatas(),v=[];for(var w in m)if(m.hasOwnProperty(w)){var y=m[w];y.type==i.type&&y.group_id==i.roundCfg.group_id&&v.push(y)}v.sort((function(t,e){return t.id-e.id}));for(var b=0;b<v.length;b++){var _=v[b],G=this.rerwardList[_.order-1];G.item_id=_.reward[0],G.num.string=_.reward[1],G.cfg_id=_.id;var k=configGoods.getDataByKey(G.item_id);this.loadIcon(G.imgIcon,k.icon_group,k.icon),G.limit&&(G.limit.active=!1),G.only&&(G.only.active=!1),G.select.active=!1,G.light.active=!1}this.clearTimer();var R=function(){e.preViewCount=3==e.preViewCount?1:e.preViewCount+1;var t=M[e.preViewCount];if(e.loadIcon(e.imgPreview,"act_frog_turn",t),1!=e.preViewCount){var i=O[e.preViewCount];e.preDescNum.active=!0,e.preDescGet.active=!1;var o=f.formatStr("<b><outline width = 2 color=#943b30><color=#fffeea>%s</color></outline></b>",GetLanguage(400187));e.findChildComponent("root/turn/img/preDesc/num/num",h).string=T.formatStr(o,f.formatStr("<color=#fff71e>%s</color>",i))}else if(e.onlyRewardNum>0){e.preDescNum.active=!0,e.preDescGet.active=!1;var n=f.formatStr("<b><outline width = 2 color=#943b30><color=#fffeea>%s</color></outline></b>",GetLanguage(400205));e.findChildComponent("root/turn/img/preDesc/num/num",h).string=T.formatStr(n,f.formatStr("<color=#fff71e>%s</color>",e.onlyRewardNum))}else e.preDescNum.active=!1,e.preDescGet.active=!0;var r=IS(D).getInfo(e.actType),s=e.findChildComponent("root/turn/img/preDesc/jackPotNum",h),a=F[e.preViewCount];if(null!=a){var d,c=null!=(d=r.guaranteed_list[e.rerwardList[a].cfg_id])?d:0;if(c>0){s.node.active=!0;var l=f.formatStr("<b><outline color=#5C2E1A width=2><color=#FFF8C6>%s</color></outline></b>",GetLanguage(400202));s.string=T.formatStr(l,f.formatStr("<b><outline color=#943B30 width=2><color=#FFF71E>%s</color></outline></b>",c))}else s.node.active=!1}else s.node.active=!1};if(R(),this.refreshTimer=this.addTimer(5,-1,R),null==this.bgEff){this.bgEff=this.addUIEffect("prefab/ui-effect/MX_tx_bsw_daodan",this.bgEffNode,-1,new g(-180,0),1,(function(t){var e=t.node;e.setRotationFromEuler(new u(0,0,-90)),e.getComponent(I).needAnimation="idle"}))}this.bgEffNode.active=!1},v.clearTimer=function(){null!=this.refreshTimer&&(this.removeTimer(this.refreshTimer),this.refreshTimer=null)},v.onBeforeClose=function(){this.canUpdate=!1,this.curIndex=0,this.tipsTimer=0;for(var t=0;t<this.rerwardList.length;t++)this.rerwardList[t].select.active=!1,this.rerwardList[t].light.active=!1;this.jackpot=0,this.jackpotType=0,this.waitRewardList=[],this.extraReward=null,this.clearTimer(),coroutine.stopGroup("ActTurn"),this.bgEffNode.setPosition(this.bgPos.x,this.bgPos.y)},v.onDestroy=function(){for(var t=0;t<this.resItems.length;t++)this.resItems[t].node.destroy();this.resItems={}},v.onUpdate=function(t){this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1&&(this.deltaTime=0,this.leftTime=this.leftTime-1,this.leftTime>0?this.txtLeftTime.string=S.formatTimeStringForSecond(this.leftTime):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},v.updateResShow=function(){for(var t=0;t<this.resItems.length;t++)this.resItems[t].txtNum.string=T.GetNumString(IS(_).getGoodsCountByGoodsGtid(this.resItems[t].goodsGtid));var e,i,o=IS(D).GetCost(this.actType),n=IS(_).getGoodsCountByGoodsGtid(o[0]);this.redOne.active=n>=o[1],this.redTen.active=n>=10*o[1],n>=o[1]?(i="#5aff42",e="#27720d"):(i="#ff1f1f",e="#891000"),this.txtOne.string=f.formatStr("<b><outline color=%s width=2><color=%s>%s<color></outline></b>",e,i,o[1]),n>=10*o[1]?(i="#5aff42",e="#27720d"):(i="#ff1f1f",e="#891000"),this.txtTen.string=f.formatStr("<b><outline color=%s width=2><color=%s>%s<color></outline></b>",e,i,10*o[1])},v.updateInfo=function(){var t=this,e=IS(D).getInfo(this.actType);this.tipsGo.active=e.lucky_list.length>0,0!=this.tipsTimer&&this.removeTimer(this.tipsTimer),this.tipsGo.active&&(this.tipsScroll.datas=e.lucky_list,this.curTips=0,this.tipsTimer=this.addTimer(1,-1,(function(){t.curTips=t.curTips+1,t.curTips==e.lucky_list.length&&(t.curTips=0);var i=0==t.curTips?.2:1;t.tipsScroll.scrollTo(t.curTips,i)}))),this.updateReward()},v.updateReward=function(){var t=IS(D).getInfo(this.actType);this.txtNumReward.string=t.count+"",this.numScroll.updateAll(),this.findChildComponent("root/turn/img/nodeTips/drawNum",d).string=T.formatStr(GetLanguage_UI(899000013),IS(D).getInfo(this.actType).remain_draw);for(var e,o=i(this.rerwardList);!(e=o()).done;){var n=e.value,r=configMount_draw.getDataByKey(n.cfg_id);if(r.num){n.limit.active=!0;var s=IS(D).getInfo(this.actType),a=y.findChildComponent(n.limit,"Node",d);if(a.string=T.formatStrWithMirrorDeal(GetLanguage(400014),r.num),s.get_drop.length>0)for(var c,l=i(s.get_drop);!(c=l()).done;){var u=c.value,p=u.k,g=u.v;p==n.cfg_id&&(a.string=T.formatStrWithMirrorDeal(GetLanguage(400014),r.num-g))}}if(5==r.quality){n.only.active=!0;var m=r.guaranteed-t.count;this.onlyRewardNum=m}if(r.reward_replace.length>0){var v,w,C=null!=(v=null==(w=t.choose_list[n.cfg_id])?void 0:w[1])?v:0;if(C>0){5==r.quality&&(n.only.active=!1,this.onlyRewardNum=0);for(var S,I=i(r.reward_replace);!(S=I()).done;){var b=S.value;if(b[0]==C){n.num.string=b[1][1],n.item_id=b[1][0];var _=configGoods.getDataByKey(n.item_id);this.loadIcon(n.imgIcon,_.icon_group,_.icon)}}}}if(1==this.preViewCount)if(this.onlyRewardNum>0){this.preDescNum.active=!0,this.preDescGet.active=!1;var G=f.formatStr("<b><outline width = 2 color=#943b30><color=#fffeea>%s</color></outline></b>",GetLanguage(400205));this.findChildComponent("root/turn/img/preDesc/num/num",h).string=T.formatStr(G,f.formatStr("<color=#fff71e>%s</color>",this.onlyRewardNum))}else this.preDescNum.active=!1,this.preDescGet.active=!0;var L=this.findChildComponent("root/turn/img/preDesc/jackPotNum",h),k=F[this.preViewCount];if(null!=k){var R,x=null!=(R=t.guaranteed_list[this.rerwardList[k].cfg_id])?R:0;if(x>0){L.node.active=!0;var V=f.formatStr("<b><outline color=#5C2E1A width=2><color=#FFF8C6>%s</color></outline></b>",GetLanguage(400202));L.string=T.formatStr(V,f.formatStr("<b><outline color=#943B30 width=2><color=#FFF71E>%s</color></outline></b>",x))}else L.node.active=!1}else L.node.active=!1}},v.onClickPreview=function(){var t=P[this.preViewCount];null!=t&&uiMgr.openView("PlayerSkinLookView",t,!0)},v.onLottery=function(t){var e=IS(D).GetCost(this.actType),i=e[0],o=e[1];2==t&&(o*=10),IS(_).getGoodsCountByGoodsGtid(i)>=o?IS(V).send_24_17(this.actType,t):uiMgr.openView("ActivityFrogGiftView",this.actType)},v.updateLotteryResult=function(t){var e=this;if(t.act_type==this.actType){this.nodeRolling.active=!1;var i=IS(D).GetDrawReward(this.actType),o=1==t.type?i[1]:10*i[1];if(this.extraReward=[i[0],o],this.checkJackpot(t.drop_id_list),this.togSkip.isChecked)0!=this.jackpot?(this.openTypeView(this.jackpot,this.jackpotType),this.waitRewardList=t.reward_list,this.jackpot=0,this.jackpotType=0):(uiMgr.openView("GoodsGetView",t.reward_list,this.extraReward),this.extraReward=null);else{var n=t.drop_id_list[t.drop_id_list.length-1];this.finalIndex=configMount_draw.getDataByKey(n).order-1,this.reward_list=t.reward_list,this.skipAnim.active=!0,this.nodeRolling.active=!0,coroutine.stopGroup("ActTurn"),1==t.drop_id_list.length?coroutine.start(this.doLotteryTween(this.finalIndex,(function(){for(var i=0;i<e.rerwardList.length;i++)e.rerwardList[i].select.active=!1,e.rerwardList[i].light.active=!1;e.rerwardList[e.finalIndex].select.active=!0,e.rerwardList[e.finalIndex].light.active=!0,e.curIndex=e.finalIndex,0!=e.jackpot?(e.waitRewardList=t.reward_list,e.openTypeView(e.jackpot,e.jackpotType),e.jackpot=0,e.jackpotType=0):(uiMgr.openView("GoodsGetView",t.reward_list,e.extraReward),e.extraReward=null),e.skipAnim.active=!1,e.nodeRolling.active=!1,e.bgEffNode.active=!1})),"ActTurn"):this.lotteryNext(0,t)}}},v.lotteryNext=function(t,e){var i,o=this,n=configMount_draw.getDataByKey(e.drop_id_list[t]).order-1;i=t<e.drop_id_list.length-1?function(){o.curIndex=n,o.lotteryNext(t+1,e)}:function(){for(var t=0;t<o.rerwardList.length;t++)o.rerwardList[t].select.active=!1,o.rerwardList[t].light.active=!1;o.rerwardList[n].select.active=!0,o.rerwardList[n].light.active=!0,o.curIndex=n,0!=o.jackpot?(o.waitRewardList=e.reward_list,o.openTypeView(o.jackpot,o.jackpotType),o.jackpot=0,o.jackpotType=0):(uiMgr.openView("GoodsGetView",e.reward_list,o.extraReward),o.extraReward=null),o.skipAnim.active=!1,o.nodeRolling.active=!1,coroutine.stopGroup("ActTurn"),o.bgEffNode.active=!1},coroutine.start(this.doLotteryTween(n,i),"ActTurn")},v.doLotteryTween=o().mark((function t(e,i){var n,s,a,d,c,h,l,f,u,v,w,y,C,T,S=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null!=this.moveTween&&this.moveTween.stop(),m.playSound("bsw_chouka"),n=2*this.rewardNum+e-this.curIndex,s=0;case 4:if(!(s<n)){t.next=14;break}for(a=n*(s/n),d=Math.floor((a+this.curIndex)%this.rewardNum),c=0;c<this.rerwardList.length;c++)this.rerwardList[c].select.active=!1,this.rerwardList[c].light.active=!1;return this.rerwardList[d].select.active=!0,t.next=11,coroutine.wait(.1);case 11:s++,t.next=4;break;case 14:for(c=0;c<this.rerwardList.length;c++)this.rerwardList[c].select.active=!1,this.rerwardList[c].light.active=!1;this.rerwardList[e].light.active=!0,this.bgEffNode.active=!0,this.bgEffNode.setPosition(this.bgPos.x,this.bgPos.y),h=new r,l=this.rerwardList[e].node,f=l.worldPosition,u=this.findChildComponent("root",p).convertToNodeSpaceAR(f),v=new r(u.x,u.y),w=.001*g.distance(this.bgPos,v),y=g.subtract(new g,v,this.bgPos),C=y.signAngle(r.UNIT_X),T=C/Math.PI*180,this.bgEffNode.angle=-T,this.moveTween=this.addTween(0,1,w,(function(t,e){var i=g.subtract(new g,v,S.bgPos);h.set(S.bgPos).add2f(i.x*e,i.y*e),S.bgEffNode.setPosition(h.x,h.y)})).call((function(){S.bgEffNode.active=!1,i()})).start();case 29:case"end":return t.stop()}}),t,this)})),v.SkipAnim=function(){null!=this.moveTween&&this.moveTween.stop();for(var t=0;t<this.rerwardList.length;t++)this.rerwardList[t].select.active=!1,this.rerwardList[t].light.active=!1;this.rerwardList[this.finalIndex].select.active=!0,this.rerwardList[this.finalIndex].light.active=!0,this.curIndex=this.finalIndex,0!=this.jackpot?(this.waitRewardList=this.reward_list,this.openTypeView(this.jackpot,this.jackpotType),this.jackpot=0,this.jackpotType=0):(uiMgr.openView("GoodsGetView",this.reward_list,this.extraReward),this.extraReward=null),this.skipAnim.active=!1,this.nodeRolling.active=!1,coroutine.stopGroup("ActTurn"),this.bgEffNode.active=!1},v.checkJackpot=function(t){this.jackpot=0,this.jackpotType=0;for(var e,o=i(t);!(e=o()).done;){var n=e.value,r=configMount_draw.getDataByKey(n);if(r.goods_type)if(r.reward_replace.length>0){var s,a,d=null!=(s=null==(a=IS(D).getInfo(this.actType).choose_list[r.id])?void 0:a[1])?s:0;if(d>0)for(var c,h=i(r.reward_replace);!(c=h()).done;){var l=c.value;if(l[0]==d&&r.goods_type)return this.jackpot=l[1][0],this.jackpotType=r.goods_type,!0}else if(r.goods_type)return this.jackpot=r.reward[0],this.jackpotType=r.goods_type,!0}else if(r.goods_type)return this.jackpot=r.reward[0],this.jackpotType=r.goods_type,!0}return!1},v.onViewClose=function(t){this.waitRewardList.length<=0||K.includes(t)&&(uiMgr.openView("GoodsGetView",this.waitRewardList,this.extraReward),this.extraReward=null,this.waitRewardList=[])},v.openTypeView=function(t,e){switch(e){case 1:return void uiMgr.openView("ArtifactGetView",configGoods.getDataByKey(t).effect[0],!0);case 2:return void uiMgr.openView("HorseGetView",configGoods.getDataByKey(t).effect[0],!0);case 3:return void uiMgr.openView("PlayerSkinGetView",configGoods.getDataByKey(t).effect[0],!0);case 4:return void uiMgr.openView("FateNewView",configGoods.getDataByKey(t).effect[0]);case 5:switch(configGoods.getDataByKey(t).type){case 28:uiMgr.openView("ArtifactGetView",configGoods.getDataByKey(t).effect[0],!0);break;case 27:uiMgr.openView("HorseGetView",configGoods.getDataByKey(t).effect[0],!0);break;case 11:uiMgr.openView("PlayerSkinGetView",configGoods.getDataByKey(t).effect[0],!0);break;case 12:uiMgr.openView("FateNewView",configGoods.getDataByKey(t).effect[0]);break;case 32:uiMgr.openView("WingGetView",configGoods.getDataByKey(t).effect[0],!0);break;default:uiMgr.openView("GoodsGetView2",t)}}},n}(E)),function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).txtDesc=void 0,e.itemGridNode=void 0,e.effNode=void 0,e.itemGrid=void 0,e.isReward=void 0,e.eff=void 0,e}e(i,t);var o=i.prototype;return o.onInit=function(){var t=this;this.txtDesc=y.findChildComponent(this.node,"desc",h),this.itemGridNode=y.findChild(this.node,"itemGrid"),this.effNode=y.findChild(this.node,"eff"),this.itemGrid=new v(this.view,this.itemGridNode,(function(){var e=t.view,i=IS(D).getInfo(e.actType);!t.isReward&&i.count>=t.data.cumulative_times?IS(V).send_24_18(e.actType,t.data.id):IS(_).OpenItemTips(t.data.reward[0],t.itemGridNode)}))},o.onRender=function(t,e){this.itemGrid.SetItemId(t.reward[0],t.reward[1]);var i=this.view,o=IS(D).getInfo(i.actType);this.isReward=o.gotReward[t.id],this.view.removeUIEffect(this.eff),this.isReward?this.txtDesc.string=f.formatStr("<color=#4fd581>%s</color>",GetLanguage(200314)):o.count>=t.cumulative_times?(this.txtDesc.string=f.formatStr("<color=#d5594f>%s</color>",GetLanguage(200732)),this.eff=this.view.addUIEffect("prefab/ui-effect/MX_tx_tongyong_daojulingqu",this.effNode,-1)):this.txtDesc.string=f.formatStr("<b><color=#ff1c1c>%s</color><color=#ff1c1c>/%s</color></b>",o.count,t.cumulative_times)},i}(w)),H=function(t){function i(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this).txt=void 0,e}e(i,t);var o=i.prototype;return o.onInit=function(){this.txt=y.findChildComponent(this.node,"txt",h)},o.onRender=function(t,e){var i,o=null==(i=configGoods.getDataByKey(t.k))?void 0:i.name;this.txt.string=T.formatStrWithMirrorDeal(GetLanguage(200050),t.s,o)},i}(w);n._RF.pop()}}}));

