System.register("chunks:///_virtual/ComposeGameMapSceneView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./ComposeGameMapScene.ts","./NodeUtil.ts","./BaseView.ts"],(function(e){"use strict";var o,n,t,a,i,d,s,l,p,c,r;return{setters:[function(e){o=e.inheritsLoose,n=e.assertThisInitialized},function(e){t=e.cclegacy,a=e.Vec2,i=e.Vec3,d=e.UITransform,s=e.Button,l=e.Node},null,function(e){p=e.ComposeGameMapScene},function(e){c=e.default},function(e){r=e.BaseView}],execute:function(){t._RF.push({},"d4bb9gDLEVPMJB+v2CPlWmH","ComposeGameMapSceneView",void 0);var h=new a,u=new i;e("default",function(e){function t(){var o;return(o=e.call(this)||this).mapScene=void 0,o.txtName=void 0,o.content=void 0,o.face=void 0,o.nodeHandle=void 0,o.nodeShow=void 0,o.utShow=void 0,o.utHandle=void 0,o.handleBall=void 0,o.ballPos=new i(0,0,0),o.startTouchPos=new i,o.startTouch=!1,o.name="ComposeGameMapSceneView",o.url="ui/module/composeGame/ComposeGameMapSceneView",o.fullScreen=!0,o.mapScene=new p(n(o)),o}o(t,e);var r=t.prototype;return r.onInit=function(){var e=this;this.nodeHandle=this.findChild("nodeHandle"),this.nodeShow=c.findChild(this.nodeHandle,"nodeShow"),this.utShow=this.nodeShow.getComponent(d),this.utHandle=this.nodeHandle.getComponent(d),this.handleBall=c.findChild(this.nodeHandle,"nodeShow/nodeBall");var o=this.findChild("bottom/btnClose");this.addComponentCallbackListener(o,s.EventType.CLICK,(function(){e.destroy()})),this.addComponentCallbackListener(this.nodeHandle,l.EventType.TOUCH_START,(function(o){var n=o.getUILocation();u.set(n.x,n.y);var t=e.utHandle.convertToNodeSpaceAR(u);t.z=0,e.startTouchPos.set(t),e.startTouch=!0,o.preventSwallow=!0})),this.addComponentCallbackListener(this.nodeHandle,l.EventType.TOUCH_MOVE,(function(o){if(e.startTouch){var n=o.getUILocation();if(u.set(n.x,n.y),e.nodeShow.active){var t=e.utShow.convertToNodeSpaceAR(u);t.z=0,o.propagationStopped=!0,o.propagationImmediateStopped=!0;var a=t;return t.length()>50&&(a=t.normalize().multiplyScalar(50)),e.handleBall.position=a,e.mapScene.moveOwner(h.set(a.x,a.y)),void(e.ballPos=a)}var d=e.utHandle.convertToNodeSpaceAR(u);i.subtract(new i,e.startTouchPos,d).length()>50?(e.nodeShow.active=!0,e.nodeShow.position=e.startTouchPos,e.handleBall.position=i.ZERO,o.propagationStopped=!0,o.propagationImmediateStopped=!0):o.preventSwallow=!0}})),this.addComponentCallbackListener(this.nodeHandle,l.EventType.TOUCH_END,(function(o){if(e.startTouch=!1,e.nodeShow.active)return e.nodeShow.active=!1,o.propagationStopped=!0,o.propagationImmediateStopped=!0,void e.mapScene.moveOwner(a.ZERO);o.preventSwallow=!0}))},r.registerUpdateHandler=function(){},r.onAfterOpen=function(){this.mapScene.open()},r.onBeforeClose=function(){this.mapScene.close()},r.onDestroy=function(){this.mapScene.destroy()},r.onUpdate=function(e){this.mapScene.onUpdate(e)},t}(r));t._RF.pop()}}}));

