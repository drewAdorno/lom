System.register("chunks:///_virtual/ParkingFriendSpaceView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./FriendControl.ts","./RoleDefine.ts","./ParkingControl.ts","./ParkingDataCache.ts","./ParkingDefine.ts","./BaseSubView.ts"],(function(i){"use strict";var t,e,n,o,a,r,s,d,f,l,c,u,h,v,g,p,m;return{setters:[function(i){t=i.inheritsLoose,e=i.createForOfIteratorHelperLoose},function(i){n=i.cclegacy,o=i.ScrollView,a=i.Button,r=i.Sprite,s=i.Label},function(i){d=i.ListItem},function(i){f=i.default},function(i){l=i.default},null,function(i){c=i.default},function(i){u=i.PlayerAttr},function(i){h=i.default},function(i){v=i.ParkingDataCache},function(i){g=i.ParkingEventDefine,p=i.ParkingListName},function(i){m=i.BaseSubView}],execute:function(){n._RF.push({},"890f4F3pZRLtJviMTdpi0AH","ParkingFriendSpaceView",void 0);i("default",function(i){function n(){var t;return(t=i.call(this)||this).scrollList=void 0,t.curPage=1,t.list=[],t.uidMap=new Map,t.isEnd=!1,t.isRequesting=!1,t.name="ParkingFriendSpaceView",t.url="ui/module/parking/sub/ParkingFriendSpaceView",t}t(n,i);var a=n.prototype;return a.onInit=function(){var i=this.findChildComponent("scroll",o);this.scrollList=this.addUIList(i,L)},a.registerUpdateHandler=function(){this.addEvent(g.PARKING_SPACE_UPDATE,this.onUpdateLogList,this)},a.onAfterOpen=function(){this.trySetParent(),IS(h).reqParkSearch(p.friendSpaceList,"")},a.onBeforeClose=function(){},a.onDestroy=function(){},a.onUpdateLogList=function(i){var t=IS(v).null_space;t.sort((function(i,t){for(var n,o=0,a=0,r=e(i.ext);!(n=r()).done;){var s=n.value;2==s.k&&(o=s.v)}for(var d,f=e(t.ext);!(d=f()).done;){var l=d.value;2==l.k&&(a=l.v)}return a-o})),this.scrollList.datas=t},a.onGotoOtherParkingSpace=function(i){uiMgr.openView("ParkingMainView",i),this.parentView.close()},a.trySetParent=function(){var i=uiMgr.getOpenView("ParkingSpaceView");i&&i.nodeSubRoot&&this.node.setParent(i.nodeSubRoot)},n}(m));var L=i("ParkingSpaceItemMaker",function(i){function n(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=i.call.apply(i,[this].concat(n))||this).btnRoleInfo=void 0,t.imgIcon=void 0,t.imgHeadFrame=void 0,t.nodeFull=void 0,t.nodeCD=void 0,t.txtLevel=void 0,t.txtName=void 0,t.txtTime=void 0,t.buffList=[],t.infoList={},t.btnParkingSpace=void 0,t}t(n,i);var o=n.prototype;return o.onInit=function(){var i=this;this.nodeCD=f.findChild(this.node,"nodecd"),this.btnRoleInfo=f.findChild(this.node,"imgFrame"),this.view.addComponentCallbackListener(this.btnRoleInfo,a.EventType.CLICK,(function(){i.data.master_id&&IS(c).reqOtherRoleNotice(i.data.master_id,1)})),this.imgIcon=f.findChildComponent(this.node,"imgFrame/imgIcon",r),this.imgHeadFrame=f.findChildComponent(this.node,"imgFrame/imgHeadFrame",r),this.nodeFull=f.findChild(this.node,"imgFrame/nodeFull"),this.txtLevel=f.findChildComponent(this.node,"txtLevel",s),this.txtName=f.findChildComponent(this.node,"txtName",s),this.view.adjustMirrorNode(this.imgIcon.node,0,!0),this.view.adjustMirrorNode(f.findChild(this.node,"btnParkingSpace/node1"),0,!0),this.view.adjustMirrorNode(f.findChild(this.node,"btnParkingSpace/node"),0,!0);for(var t=f.findChild(this.node,"nodeBuff"),e=1;e<=3;e++){var n={node:f.findChild(t,"buff"+e),icon:f.findChildComponent(t,"buff"+e+"/icon",r),txtBuff:f.findChildComponent(t,"buff"+e+"/buff/txtBuff",s)};this.view.adjustMirrorNode(n.icon.node,0,!0),this.buffList[e]=n}this.btnParkingSpace=f.findChild(this.node,"btnParkingSpace"),this.view.addComponentCallbackListener(this.btnParkingSpace,a.EventType.CLICK,(function(){i.view.parentView.close(),IS(h).reqParkingInfo(i.data.park_type,i.data.master_id,i.data.ceng)}))},o.onRender=function(i,t){if(null!=i){if(i.info_list){for(var n,o=e(i.info_list.ks);!(n=o()).done;){var a=n.value;this.infoList[a.k]=a.s}for(var r,s=e(i.info_list.kv);!(r=s()).done;){var d=r.value;this.infoList[d.k]=d.v}}if(this.infoList[u.ROLE_ATTR_HEAD_URL]&&this.view.loadRemoteIcon(this.infoList[u.ROLE_ATTR_HEAD_URL],this.imgIcon),this.txtName.string=this.infoList[u.ROLE_ATTR_NAME],this.txtLevel.string="Lv."+this.infoList[u.ROLE_ATTR_LVL],0==i.null_num?this.nodeFull.active=!0:this.nodeFull.active=!1,this.infoList[u.ROLE_ATTR_HEAD_FRAME_ID]>0){var c=configAvatar_frame.getDataByKey(this.infoList[u.ROLE_ATTR_HEAD_FRAME_ID]);this.view.loadIcon(this.imgHeadFrame,"icon_frame",c.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1;for(var h=1;h<4;h++)this.buffList[h].txtBuff.string="+0%";for(var g,p=e(i.skin_plus);!(g=p()).done;){var m=g.value;1==m.k?this.buffList[1].txtBuff.string="+"+m.v/100+"%":2==m.k?this.buffList[2].txtBuff.string="+"+m.v/100+"%":3==m.k&&(this.buffList[3].txtBuff.string="+"+m.v/100+"%")}f.findChild(this.btnParkingSpace,"node1").active=!1,f.findChild(this.btnParkingSpace,"node").active=!0;for(var L,k=e(IS(v).getParkingCarList());!(L=k()).done;){var C=L.value,_=IS(v).car_list[C];if(_.parking_data.master_id==this.infoList[u.ROLE_ATTR_ID]&&_.parking_data.type==i.park_type){f.findChild(this.btnParkingSpace,"node1").active=!0,f.findChild(this.btnParkingSpace,"node").active=!1;break}}for(var P,S=0,b=e(i.ext);!(P=b()).done;){var R=P.value;1==R.k&&(S=R.v)}this.nodeCD.active=S-l.serverTime>0}},n}(d));n._RF.pop()}}}));

