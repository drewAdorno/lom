System.register("chunks:///_virtual/MarryControl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MessageView.ts","./ControlMgr.ts","./RoleDataCache.ts","./MarryDataCache.ts","./MarryDefine.ts","./MarryDialogDataCache.ts"],(function(r){"use strict";var e,n,_,a,t,s,o,i,c;return{setters:[function(r){e=r.createForOfIteratorHelperLoose},function(r){n=r.cclegacy},function(r){_=r.default},function(r){a=r.controlMgr},function(r){t=r.RoleDataCache},function(r){s=r.default},function(r){o=r.MarryEventDefine,i=r.RoleUpdateFlag},function(r){c=r.default}],execute:function(){n._RF.push({},"c6e75K37qZHjrk8w4fi9s4G","MarryControl",void 0);r("default",function(){var r=n.prototype;function n(){this.favor_lv=0,netManager.addEventListener("marry.marry_status_s2c",this.on_marry_status_s2c,this),netManager.addEventListener("marry.marry_resp_s2c",this.on_marry_resp_s2c,this),netManager.addEventListener("marry.marry_break_up_s2c",this.on_marry_break_up_s2c,this),netManager.addEventListener("marry.marry_scene_enter_s2c",this.on_marry_scene_enter_s2c,this),netManager.addEventListener("marry.marry_party_fire_val_s2c",this.on_marry_party_fire_val_s2c,this),netManager.addEventListener("marry.marry_party_main_answer_s2c",this.on_marry_party_main_answer_s2c,this),netManager.addEventListener("marry.marry_scene_exit_s2c",this.on_marry_scene_exit_s2c,this),netManager.addEventListener("marry.marry_scene_move_s2c",this.on_marry_scene_move_s2c,this),netManager.addEventListener("marry.marry_scene_broadcast_s2c",this.on_marry_scene_broadcast_s2c,this),netManager.addEventListener("marry.marry_scene_box_info_s2c",this.on_marry_scene_box_info_s2c,this),netManager.addEventListener("marry.marry_scene_box_open_s2c",this.on_marry_scene_box_open_s2c,this),netManager.addEventListener("marry.marry_party_reserve_s2c",this.on_marry_party_reserve_s2c,this),netManager.addEventListener("marry.marry_party_reserve_list_s2c",this.on_marry_party_reserve_list_s2c,this),netManager.addEventListener("marry.marry_divorce_force_s2c",this.on_marry_divorce_force_s2c,this),netManager.addEventListener("marry.marry_divorce_resp_s2c",this.on_marry_divorce_resp_s2c,this),netManager.addEventListener("marry.marry_party_info_s2c",this.on_marry_party_info_s2c,this),netManager.addEventListener("marry.marry_party_action_s2c",this.on_marry_party_action_s2c,this),netManager.addEventListener("marry.marry_party_photo_s2c",this.on_marry_party_photo_s2c,this),netManager.addEventListener("marry.marry_photo_album_s2c",this.on_marry_photo_album_s2c,this),netManager.addEventListener("marry.marry_party_stage_s2c",this.on_marry_party_stage_s2c,this),netManager.addEventListener("marry.marry_party_figure_s2c",this.on_marry_party_figure_s2c,this),netManager.addEventListener("marry.marry_party_main_question_s2c",this.on_marry_party_main_question_s2c,this),netManager.addEventListener("marry.marry_party_action_all_s2c",this.on_marry_party_action_all_s2c,this),netManager.addEventListener("marry.marry_cancel_divorce_s2c",this.on_marry_cancel_divorce_s2c,this),netManager.addEventListener("marry.marry_direct_s2c",this.on_marry_direct_s2c,this),netManager.addEventListener("marry.on_marry_cancel_wedding_s2c",this.on_marry_cancel_wedding_s2c,this),netManager.addEventListener("marry.marry_scene_status_s2c",this.on_marry_scene_status_s2c,this),netManager.addEventListener("marry.favor_friend_info_s2c",this.on_favor_friend_info_s2c,this),netManager.addEventListener("marry.favor_reward_info_s2c",this.on_favor_reward_info_s2c,this),netManager.addEventListener("marry.favor_buy_flower_s2c",this.on_favor_buy_flower_s2c,this),netManager.addEventListener("marry.marry_ring_info_s2c",this.on_marry_ring_info_s2c,this),netManager.addEventListener("marry.marry_mark_info_s2c",this.on_marry_mark_info_s2c,this),netManager.addEventListener("marry.favor_give_flower_s2c",this.on_favor_give_flower_s2c,this),netManager.addEventListener("marry.favor_friend_lv_s2c",this.on_favor_friend_lv_s2c,this),netManager.addEventListener("marry.marry_invite_friend_s2c",this.on_marry_invite_friend_s2c,this),netManager.addEventListener("marry.marry_ring_levup_s2c",this.on_marry_ring_levup_s2c,this),netManager.addEventListener("marry.marry_ring_use_skill_s2c",this.on_marry_ring_use_skill_s2c,this),a.addControl(this)}return r.clear=function(){},r.onLogin=function(){this.send_marry_party_info_c2s(),this.send_marry_ring_info_c2s()},r.onReconnect=function(){this.send_marry_party_info_c2s(),this.send_marry_ring_info_c2s()},r.send_marry_status_c2s=function(){netManager.send("marry.marry_status_c2s",{},!0)},r.on_marry_status_s2c=function(r){IS(c).UpdateMarryStatus(r)},r.send_marry_resp_c2s=function(r,e){netManager.send("marry.marry_resp_c2s",{target_id:r,resp:e},!0)},r.on_marry_resp_s2c=function(r){IS(c).UpdateMarryResp(r)},r.send_marry_break_up_c2s=function(){netManager.send("marry.marry_break_up_c2s",{},!0)},r.on_marry_break_up_s2c=function(r){1==r.code&&normalEvent.emit(o.MARRY_BREAK_UP)},r.send_marry_scene_enter_c2s=function(r,e){r.x=Math.floor(r.x),r.y=Math.floor(r.y),netManager.send("marry.marry_scene_enter_c2s",{pos:r,break:e},!0)},r.on_marry_scene_enter_s2c=function(r){var n=r.member_list,_=IS(s);_.roleMap={};for(var a,t=e(n);!(a=t()).done;){var c=a.value;_.roleMap[c.role_id]=c}_.clearRoleActions(),_.roleUpdateFlag=i.All,_.SetMarryStageInfo(r),normalEvent.emit(o.MARRY_SCENE_ENTER)},r.send_marry_scene_exit_c2s=function(){netManager.send("marry.marry_scene_exit_c2s",{},!0)},r.on_marry_scene_exit_s2c=function(r){uiMgr.close("MarryMapSceneView")},r.send_marry_scene_move_c2s=function(r){r.forEach((function(r){r.x=Math.floor(r.x),r.y=Math.floor(r.y)})),netManager.send("marry.marry_scene_move_c2s",{pos_list:r},!0)},r.on_marry_scene_move_s2c=function(r){},r.on_marry_scene_broadcast_s2c=function(r){var e=IS(s);if(1==r.type){e.roleUpdateFlag=i.Add;for(var n=0;n<r.action_member.length;n++){var _=r.action_member[n];e.roleActions[i.Add].add(_.role_id),e.roleActions[i.Move].delete(_.role_id),e.roleActions[i.Del].delete(_.role_id),e.roleActions[i.Break].delete(_.role_id),e.roleActions[i.SetPos].delete(_.role_id),e.roleMap[_.role_id]=_}}else if(2==r.type){if(!e.roleMap[r.action_member.role_id])return;e.roleUpdateFlag|=i.Break;for(var a=0;a<r.action_member.length;a++){var o=r.action_member[a];e.roleMap[o.role_id].break=o.break,e.roleActions[i.Break].add(o.role_id)}}else if(3==r.type){for(var c=!1,y=0;y<r.action_member.length;y++){var d=r.action_member[y];e.roleMap[d.role_id]&&(d.role_id!=IS(t).GetRoleId()&&(e.roleActions[i.Move].add(d.role_id),e.roleActions[i.SetPos].delete(d.role_id),e.roleMap[d.role_id].pos_list=r.pos_list,c=!0))}if(!c)return;e.roleUpdateFlag|=i.Move}else if(4==r.type){for(var m=!1,f=0;f<r.action_member.length;f++){var l=r.action_member[f];if(!e.roleMap[l.role_id])return;delete e.roleMap[l.role_id],e.roleActions[i.Del].add(l.role_id),e.roleActions[i.Move].delete(l.role_id),e.roleActions[i.Add].delete(l.role_id),e.roleActions[i.Break].delete(l.role_id),e.roleActions[i.SetPos].delete(l.role_id),m=!0}if(!m)return;e.roleUpdateFlag|=i.Del}else if(5==r.type){for(var u=!1,v=0;v<r.action_member.length;v++){var p=r.action_member[v];e.roleMap[p.role_id]&&(e.roleActions[i.SetPos].add(p.role_id),e.roleMap[p.role_id]=p,u=!0)}if(!u)return;e.roleUpdateFlag|=i.SetPos}},r.on_marry_scene_box_info_s2c=function(r){for(var n,_=IS(s).boxMap,a=e(r.box_list);!(n=a()).done;){var t=n.value;_[t.n]=t,_[t.n].round=r.round}var i=[];for(var c in _){for(var y,d=!1,m=e(r.box_list);!(y=m()).done;){var f=y.value;f.n==Number(c)&&(d=!0,_[f.n]=f,_[f.n].round=r.round)}d||i.push(c)}for(var l=0,u=i;l<u.length;l++){delete _[u[l]]}IS(s).boxInfo=r,normalEvent.emit(o.MARRY_BOX_SHOW)},r.send_marry_scene_box_open_c2s=function(r){null!=r&&netManager.send("marry.marry_scene_box_open_c2s",{n:r.n,round:r.round},!0)},r.on_marry_scene_box_open_s2c=function(r){var e=IS(s).boxMap;e[r.n]&&(delete e[r.n],normalEvent.emit(o.MARRY_BOX_SHOW))},r.send_marry_party_reserve_c2s=function(r){netManager.send("marry.marry_party_reserve_c2s",{cfg_id:r},!0)},r.on_marry_party_reserve_s2c=function(r){IS(c).UpdateMarryPartyReserve(r)},r.send_marry_party_reserve_list_c2s=function(){netManager.send("marry.marry_party_reserve_list_c2s",{},!0)},r.on_marry_party_reserve_list_s2c=function(r){IS(c).UpdateMarryPartyReserveList(r)},r.send_marry_divorce_force_c2s=function(){netManager.send("marry.marry_divorce_force_c2s",{},!0)},r.on_marry_divorce_force_s2c=function(r){1==r.code&&normalEvent.emit(o.MARRY_BREAK_UP_FORCE)},r.send_marry_party_info_c2s=function(){netManager.send("marry.marry_party_info_c2s",{},!0)},r.on_marry_party_info_s2c=function(r){IS(s).SetMarryStateInfo(r)},r.send_marry_party_action_c2s=function(r,e,n){netManager.send("marry.marry_party_action_c2s",{action:r,is_buy:e,num:n},!0)},r.on_marry_party_action_s2c=function(r){IS(s).UpdateStageTimesInfo(r)},r.on_marry_party_action_all_s2c=function(r){normalEvent.emit(o.MARRY_OPERATE_CHANGE,r)},r.send_marry_party_photo_c2s=function(r,e,n){netManager.send("marry.marry_party_photo_c2s",{wedding_id:r,photo:e,word:n},!0)},r.on_marry_party_photo_s2c=function(r){0==r.code&&_.showBoxTip({tip:GetLanguage(301085),btnCnt:1})},r.send_marry_photo_album_c2s=function(r){netManager.send("marry.marry_photo_album_c2s",{page:r},!0)},r.on_marry_photo_album_s2c=function(r){IS(s).SetPhotoData(r)},r.send_marry_party_stage_c2s=function(){netManager.send("marry.marry_party_stage_c2s",{},!0)},r.on_marry_party_stage_s2c=function(r){IS(s).UpdateMarryStageInfo(r)},r.send_marry_party_figure_c2s=function(r){netManager.send("marry.marry_party_figure_c2s",{figure:r},!0)},r.on_marry_party_figure_s2c=function(r){IS(s).SetPartyFigure(r)},r.send_marry_party_main_question_c2s=function(){netManager.send("marry.marry_party_main_question_c2s",{},!0)},r.on_marry_party_main_question_s2c=function(r){IS(s).SetQuestion(r)},r.send_marry_party_main_answer_c2s=function(r){netManager.send("marry.marry_party_main_answer_c2s",{answer:r},!0)},r.on_marry_party_main_answer_s2c=function(r){IS(s).UpdateQuestion(r)},r.send_marry_invite_friend_c2s=function(){netManager.send("marry.marry_invite_friend_c2s",{})},r.on_marry_invite_friend_s2c=function(r){IS(c).UpdateInviteFriendInfo(r)},r.send_marry_party_resp_invite_c2s=function(r,e){netManager.send("marry.marry_party_resp_invite_c2s",{target_id:r,resp:e},!0)},r.on_marry_party_resp_invite_s2c=function(){},r.send_marry_direct_c2s=function(){netManager.send("marry.marry_direct_c2s",{})},r.on_marry_direct_s2c=function(){},r.send_marry_cancel_divorce_c2s=function(){netManager.send("marry.marry_cancel_divorce_c2s",{})},r.on_marry_cancel_divorce_s2c=function(){},r.send_marry_cancel_wedding_c2s=function(){netManager.send("marry.marry_cancel_wedding_c2s",{})},r.on_marry_cancel_wedding_s2c=function(){},r.send_marry_divorce_resp_c2s=function(r){netManager.send("marry.marry_divorce_resp_c2s",{choose:r},!0)},r.on_marry_divorce_resp_s2c=function(){},r.send_marry_scene_status_c2s=function(){netManager.send("marry.marry_scene_status_c2s",{},!0)},r.on_marry_scene_status_s2c=function(r){normalEvent.emit(o.MARRY_IS_CAN_ENTER,r)},r.send_marry_ring_info_c2s=function(){netManager.send("marry.marry_ring_info_c2s",{})},r.on_marry_ring_info_s2c=function(r){IS(c).UpdateRingInfo(r)},r.send_marry_ring_levup_c2s=function(r){netManager.send("marry.marry_ring_levup_c2s",{type:r},!0)},r.on_marry_ring_levup_s2c=function(r){IS(c).UpdateCurRingExp(r)},r.send_marry_ring_use_c2s=function(r){netManager.send("marry.marry_ring_use_c2s",{use:r},!0)},r.on_marry_ring_use_s2c=function(r){IS(c).UpdateCurRingUse(r)},r.send_marry_ring_use_skill_c2s=function(r){netManager.send("marry.marry_ring_use_skill_c2s",{use:r},!0)},r.on_marry_ring_use_skill_s2c=function(r){IS(c).UpdateCurRingUseSkill(r)},r.send_favor_friend_info_c2s=function(r){netManager.send("marry.favor_friend_info_c2s",{page:r},!0)},r.on_favor_friend_info_s2c=function(r){IS(c).UpdateFavorFriendInfo(r)},r.send_favor_give_flower_c2s=function(r,e,n){netManager.send("marry.favor_give_flower_c2s",{friend_id:r,flower_id:e,num:n},!0)},r.on_favor_give_flower_s2c=function(r){IS(c).UpdateFavorSingleFriendInfo(r)},r.send_favor_reward_info_c2s=function(r){netManager.send("marry.favor_reward_info_c2s",{friend_id:r},!0)},r.on_favor_reward_info_s2c=function(r){IS(c).UpdateFavorRewardSingleFriendInfo(r),normalEvent.emit(o.MARRY_FAVOR_FRIEND_INFO_DETAIL_UPDATE,r)},r.send_favor_reward_fetch_c2s=function(r,e){netManager.send("marry.favor_reward_fetch_c2s",{friend_id:r,favor_lv:e},!0)},r.send_favor_buy_flower_c2s=function(r){netManager.send("marry.favor_buy_flower_c2s",{buy_count:r},!0)},r.on_favor_buy_flower_s2c=function(r){IS(c).UpdateFlowerBuyCount(r),normalEvent.emit(o.MARRY_FAVOR_FRIEND_BUY_FLOWER)},r.send_marry_mark_info_c2s=function(){netManager.send("marry.marry_mark_info_c2s",{},!0)},r.on_marry_mark_info_s2c=function(r){normalEvent.emit(o.MARRY_FAVOR_MARK_INFO_UPDATE,r)},r.on_marry_party_fire_val_s2c=function(r){IS(s).UpdateFireValue(r)},r.send_favor_friend_lv_c2s=function(r){netManager.send("marry.favor_friend_lv_c2s",{role_id:r},!0)},r.on_favor_friend_lv_s2c=function(r){IS(c).favor_lv=r.favor_lv,normalEvent.emit(o.MARRY_FAVOR_FRIEND_LV_BACK,r)},n}());n._RF.pop()}}}));

