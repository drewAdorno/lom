System.register("chunks:///_virtual/RunningGameMapSceneView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index57.ts","./RunningGameMapScene.ts","./NodeUtil.ts","./BaseView.ts"],(function(e){"use strict";var n,t,o,a,i,d,s,l,c,r,p;return{setters:[function(e){n=e.inheritsLoose,t=e.assertThisInitialized},function(e){o=e.cclegacy,a=e.Vec2,i=e.Vec3,d=e.UITransform,s=e.Button,l=e.Node},null,function(e){c=e.RunningGameMapScene},function(e){r=e.default},function(e){p=e.BaseView}],execute:function(){o._RF.push({},"e5a432beXRG1598/Ep5QTTM","RunningGameMapSceneView",void 0);var u=new a,h=new i;e("default",function(e){function o(){var n;return(n=e.call(this)||this).mapScene=void 0,n.txtName=void 0,n.content=void 0,n.face=void 0,n.nodeHandle=void 0,n.nodeShow=void 0,n.utShow=void 0,n.utHandle=void 0,n.handleBall=void 0,n.ballPos=new i(0,0,0),n.startTouchPos=new i,n.startTouch=!1,n.name="RunningGameMapSceneView",n.url="ui/module/runningGame/RunningGameMapSceneView",n.fullScreen=!0,n.mapScene=new c(t(n)),n}n(o,e);var p=o.prototype;return p.onInit=function(){var e=this;this.nodeHandle=this.findChild("nodeHandle"),this.nodeShow=r.findChild(this.nodeHandle,"nodeShow"),this.utShow=this.nodeShow.getComponent(d),this.utHandle=this.nodeHandle.getComponent(d),this.handleBall=r.findChild(this.nodeHandle,"nodeShow/nodeBall");var n=this.findChild("bottom/btnClose");this.addComponentCallbackListener(n,s.EventType.CLICK,(function(){e.destroy()})),this.addComponentCallbackListener(this.nodeHandle,l.EventType.TOUCH_START,(function(n){var t=n.getUILocation();h.set(t.x,t.y);var o=e.utHandle.convertToNodeSpaceAR(h);o.z=0,e.startTouchPos.set(o),e.startTouch=!0,n.preventSwallow=!0})),this.addComponentCallbackListener(this.nodeHandle,l.EventType.TOUCH_MOVE,(function(n){if(e.startTouch){var t=n.getUILocation();if(h.set(t.x,t.y),e.nodeShow.active){var o=e.utShow.convertToNodeSpaceAR(h);o.z=0,n.propagationStopped=!0,n.propagationImmediateStopped=!0;var a=o;return o.length()>50&&(a=o.normalize().multiplyScalar(50)),e.handleBall.position=a,a.y=0,e.mapScene.moveOwner(u.set(a.x,a.y)),void(e.ballPos=a)}var d=e.utHandle.convertToNodeSpaceAR(h);i.subtract(new i,e.startTouchPos,d).length()>50?(e.nodeShow.active=!0,e.nodeShow.position=e.startTouchPos,e.handleBall.position=i.ZERO,n.propagationStopped=!0,n.propagationImmediateStopped=!0):n.preventSwallow=!0}})),this.addComponentCallbackListener(this.nodeHandle,l.EventType.TOUCH_END,(function(n){if(e.startTouch=!1,e.nodeShow.active)return e.nodeShow.active=!1,n.propagationStopped=!0,n.propagationImmediateStopped=!0,void e.mapScene.moveOwner(a.ZERO);n.preventSwallow=!0}))},p.registerUpdateHandler=function(){},p.onAfterOpen=function(){this.mapScene.open()},p.onBeforeClose=function(){this.mapScene.close()},p.onDestroy=function(){this.mapScene.destroy()},p.onUpdate=function(e){this.mapScene.onUpdate(e)},o}(p));o._RF.pop()}}}));

