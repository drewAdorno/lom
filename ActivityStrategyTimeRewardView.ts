System.register("chunks:///_virtual/ActivityStrategyTimeRewardView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./ObjectUtil.ts","./MessageView.ts","./ActivityDefine.ts","./ActivityStrategyControl.ts","./ActivityStrategyDataCache.ts","./BaseView.ts"],(function(t){"use strict";var e,i,r,n,o,a,s,d,c,l,h,u,f,m,v,y,g,p,w,S,_,C;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,r=t.Button,n=t.Sprite,o=t.Vec2,a=t.HorizontalTextAlignment,s=t.ScrollView,d=t.Label},function(t){c=t.ItemGrid},function(t){l=t.ListItem},function(t){h=t.RedPointType},function(t){u=t.RedPointMgr},function(t){f=t.default},function(t){m=t.default},function(t){v=t.default},null,function(t){y=t.ConfigGlobal},function(t){g=t.default},function(t){p=t.default},function(t){w=t.ActivityEventDefine},function(t){S=t.default},function(t){_=t.default},function(t){C=t.BaseView}],execute:function(){i._RF.push({},"86e52p4CjpIx4hgVf/9O8vs","ActivityStrategyTimeRewardView",void 0);t("ActivityStrategyTimeRewardView",function(t){function i(){var e;return(e=t.call(this)||this).rewardBtn=void 0,e.time=void 0,e.rewardScroll=void 0,e.timer=void 0,e.name="ActivityStrategyTimeRewardView",e.url="ui/module/ActivityStrategy/ActivityStrategyTimeRewardView",e}e(i,t);var c=i.prototype;return c.onInit=function(){var t=this;this.addComponentCallbackListener(this.findChild("imgMask"),r.EventType.CLICK,(function(){t.close()})),this.rewardBtn=this.findChildComponent("content/btnReward",n),this.addComponentCallbackListener(this.rewardBtn.node,r.EventType.CLICK,(function(){IS(_).hour_reward_next_time-v.serverTime>0||IS(S).send_act_strategy_hour_reward_claim_c2s()})),this.addRedPoint("ActivityStrategy/timeReward",this.rewardBtn.node,new o(90,25),h.Dot),IS(u).updateRed("ActivityStrategy/timeReward"),this.addComponentCallbackListener(this.findChild("content/tipBtn"),r.EventType.CLICK,(function(){var t=GetLanguage(104367);""!=t&&p.showBoxTip({tip:t,btnCnt:1,horizontalAlign:a.LEFT})}));var e=this.findChildComponent("content/rewardScroll",s);this.rewardScroll=this.addUIList(e,I,!1),this.rewardScroll.lackCenter=!0,this.time=this.findChildComponent("content/time",d)},c.registerUpdateHandler=function(){this.addEvent(w.OnStrategyInfoUpdate,this.RefreshInfo,this),this.addEvent(w.OnStrategyHoureRewardUpdate,this.RefreshInfo,this)},c.onAfterOpen=function(){IS(S).send_act_strategy_dungeon_info_c2s(),this.RefreshInfo()},c.RefreshInfo=function(){var t=this,e=IS(_).hour_reward_id,i=g.clone(y.strategy_activity_basic_supply);if(e>0){for(var r=configStrategy_activity_chapter.getDataByKey(e),n={},o=0;o<i.length;o++)n[i[o][0]]=i[o];for(var a=0;a<r.extra_supply.length;a++){var s=n[r.extra_supply[a][0]];s?s[1]=s[1]+r.extra_supply[a][1]:i.push(r.extra_supply[a])}}this.rewardScroll.datas=i;var d=IS(_).hour_reward_next_time;this.timer&&(this.removeTimer(this.timer),this.timer=null),d-v.serverTime>0?(this.rewardBtn.grayscale=!0,this.time.string=m.formatStrWithMirrorDeal(GetLanguage(200113),v.formatTimeStringForSecond(d-v.serverTime)),this.timer=this.addTimer(1,d-v.serverTime,(function(){var e=d-v.serverTime;t.time.string=m.formatStrWithMirrorDeal(GetLanguage(200113),v.formatTimeStringForSecond(e)),d-v.serverTime<=0&&(t.removeTimer(t.timer),t.timer=null,t.RefreshInfo())}))):(this.rewardBtn.grayscale=!1,this.time.string="")},c.onBeforeClose=function(){this.timer&&(this.removeTimer(this.timer),this.timer=null)},c.onDestroy=function(){},i}(C));var I=function(t){function i(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).itemGridNode=void 0,e.itemGrid=void 0,e}e(i,t);var r=i.prototype;return r.onInit=function(){this.itemGridNode=f.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode)},r.onRender=function(t,e){this.itemGrid.SetItemId(t[0],t[1])},i}(l);i._RF.pop()}}}));

