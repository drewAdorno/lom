System.register("chunks:///_virtual/ActivityAutumnOperateView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StringUtil.ts","./index57.ts","./ConfigGlobal.ts","./BagModel.ts","./MessageView.ts","./ActivityControl.ts","./ActivityAutumnDataCache.ts","./ActivityAutumnDefine.ts","./BaseView.ts"],(function(t){"use strict";var e,i,n,o,a,s,d,r,u,h,c,l,f,m,g,v;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t.Button,o=t.Sprite,a=t.Label,s=t.RichText,d=t.js},function(t){r=t.default},null,function(t){u=t.ConfigGlobal},function(t){h=t.BagModel},function(t){c=t.default},function(t){l=t.default},function(t){f=t.default},function(t){m=t.ActivityAutumnEventDefine,g=t.CardItemIcon},function(t){v=t.BaseView}],execute:function(){i._RF.push({},"d1035jbpmJHiLQJ6bGN2gL1","ActivityAutumnOperateView",void 0);t("default",function(t){function i(){var e;return(e=t.call(this)||this).tabList=void 0,e.curIndex=void 0,e.itemId=void 0,e.sendPrivateTxt=void 0,e.sendChannelTxt=void 0,e.item=void 0,e.cardName=void 0,e.haveNum=void 0,e.times=void 0,e.isTimesEnough=void 0,e.name="ActivityAutumnOperateView",e.url="ui/module/autumn/ActivityAutumnOperateView",e}e(i,t);var v=i.prototype;return v.onInit=function(){var t=this,e=this.findChild("imgMask");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var i=this.findChild("bg/btnClose");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){t.close()})),this.tabList=[];for(var d=function(e){var i={itemGo:t.findChild("select/item"+(e+1)),select:t.findChild("select/item"+(e+1)+"/select")};t.addComponentCallbackListener(i.itemGo,n.EventType.CLICK,(function(){t.RefreshSelectItem(e)})),t.tabList[e]=i},u=0;u<2;u++)d(u);this.item=this.findChildComponent("item",o),this.times=this.findChildComponent("times",a),this.haveNum=this.findChildComponent("haveNum",s),this.cardName=this.findChildComponent("item/name/Label",a);var f=this.findChild("sendPrivateBtn");this.addComponentCallbackListener(f,n.EventType.CLICK,(function(){if(0==t.curIndex){if(!t.isTimesEnough)return void c.showFlyTip(GetLanguage(200749));if(IS(h).getGoodsCountByGoodsGtid(t.itemId)<=1)return void c.showFlyTip(GetLanguage(200748));uiMgr.openView("ActivityAutumnCardSendView",t.itemId,1)}else{if(!t.isTimesEnough)return void c.showFlyTip(GetLanguage(200750));uiMgr.openView("ActivityAutumnCardSendView",t.itemId,2)}}));var m=this.findChild("sendChannelBtn");this.addComponentCallbackListener(m,n.EventType.CLICK,(function(){if(0==t.curIndex){if(!t.isTimesEnough)return void c.showFlyTip(GetLanguage(200749));if(IS(h).getGoodsCountByGoodsGtid(t.itemId)<=1)return void c.showFlyTip(GetLanguage(200748));var e=configGoods.getDataByKey(t.itemId),i=r.formatStrWithMirrorDeal(GetLanguage(200751),e.name);c.showBoxTip({tip:i,title:GetLanguage(200048),func:function(e){"type_yes"==e&&IS(l).send_24_60(t.itemId,2,0,0)}})}else{if(!t.isTimesEnough)return void c.showFlyTip(GetLanguage(200750));var n=configGoods.getDataByKey(t.itemId),o=r.formatStrWithMirrorDeal(GetLanguage(200771),n.name);c.showBoxTip({tip:o,title:GetLanguage(200048),func:function(e){"type_yes"==e&&IS(l).send_24_59(t.itemId,0,0)}})}})),this.sendPrivateTxt=this.findChildComponent("sendPrivateBtn/Label",a),this.sendChannelTxt=this.findChildComponent("sendChannelBtn/Label",a)},v.RefreshSelectItem=function(t){if(this.curIndex!=t){for(var e=0;e<this.tabList.length;e++)this.tabList[e].select.active=t==e;this.curIndex=t,this.sendPrivateTxt.string=0==this.curIndex?GetLanguage(200787):GetLanguage(200789),this.sendChannelTxt.string=0==this.curIndex?GetLanguage(200788):GetLanguage(200790),this.updateInfo()}},v.registerUpdateHandler=function(){this.addEvent(m.UpdateActCardInfo,this.updateInfo)},v.onAfterOpen=function(){this.itemId=this.openArgs[0];var t=configGoods.getDataByKey(this.itemId);this.loadIcon(this.item,"autumn2",g[this.itemId]),this.cardName.string=t.name,this.RefreshSelectItem(0),this.updateInfo()},v.onBeforeClose=function(){},v.onDestroy=function(){},v.updateInfo=function(){0==this.curIndex?u.autumn_card_dailygift:u.autumn_card_dailyask;var t=0==this.curIndex?IS(f).send_times:IS(f).ask_times,e=IS(h).getGoodsCountByGoodsGtid(this.itemId),i="";i=e>1?d.formatStr("<color=#5ade47>%s</color>/1<color=#5ade47>%s</color>",e,r.formatStrWithMirrorDeal(GetLanguage(200791),e-1)):e>0?d.formatStr("<color=#5ade47>%s</color>/1",e):d.formatStr("<color=#f33f08>%s</color>/1",e),this.haveNum.string=d.formatStr("<outline width = 2 color=#00000><b>%s</b></outline>",r.formatStrWithMirrorDeal(GetLanguage(200792),i)),this.times.string=d.formatStr(0==this.curIndex?GetLanguage(200819):GetLanguage(200793),Math.max(0,t)),this.isTimesEnough=t>0},v.updateTask=function(){},i}(v));i._RF.pop()}}}));

