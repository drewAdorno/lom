System.register("chunks:///_virtual/BattleTeam20Info.ts",["cc","./BattleData.ts","./NodeUtil.ts","./ChapterDefine.ts","./ChatDataCache.ts","./ChatDefine.ts","./IBattleChapterPanel.ts"],(function(t){"use strict";var e,n,i,a,o,h,s,c,C,d,f,l,p,u;return{setters:[function(t){e=t.cclegacy,n=t.Button,i=t.UITransform,a=t.Label,o=t.NodeEventType,h=t.Sprite,s=t.Vec3},function(t){c=t.ChapterType},function(t){C=t.default},function(t){d=t.ChapterEventDefine},function(t){f=t.ChatDataCache},function(t){l=t.ChatDefine,p=t.ChatEventDefine},function(t){u=t.BattleInfoType}],execute:function(){e._RF.push({},"7d88fzBKR1E6JwGWWxZ2GvH","BattleTeam20Info",void 0);t("BattleTeam20Info",function(){function t(t,e){this.view=void 0,this.node=void 0,this.type=void 0,this.btnChatRoot=void 0,this.imgChatIcon=void 0,this.txtName=void 0,this.content=void 0,this.face=void 0,this.faceOriScale=void 0,this.curType=void 0,this.view=t,this.node=e,this.type=u.Team20,this.onInit()}var e=t.prototype;return e.onInit=function(){this.btnChatRoot=C.findChild(this.node,"btnChatRoot"),this.view.addComponentCallbackListener(this.btnChatRoot,n.EventType.CLICK,(function(){uiMgr.openView("ChatView",l.ViewType.Guild,null,null,null,1)}));var t=C.findChild(this.node,"btnChatRoot/name/messageContent"),e=C.findChildComponent(this.node,"btnChatRoot/name",i);this.txtName=C.findChildComponent(this.node,"btnChatRoot/name",a),this.txtName.node.on(o.SIZE_CHANGED,(function(){t.setPosition(e.width+7,-1.389)})),this.content=C.findChildComponent(this.node,"btnChatRoot/name/messageContent/content",a),this.face=C.findChildComponent(this.node,"btnChatRoot/name/messageContent/face",h),this.faceOriScale=this.face.node.scale,this.view.addEvent(p.InsertNewMsg,this.updateMessage,this),this.view.addEvent(p.UpdateChatMsg,this.updateMessage,this),this.view.addEvent(d.BATTLE_STATE,this.onBattleState,this,!0)},e.onUpdate=function(t){},e.updateMessage=function(t){var e,n,i,a,o=IS(f).GetChatInfo(l.Channel.World,0);o&&o.length>0&&(e=o[o.length-1]);var h=IS(f).GetChatInfo(l.Channel.Guild,0);h&&h.length>0&&(n=h[h.length-1]),i=IS(f).GetNewestPrivateInfo();var c=IS(f).GetChatInfo(l.Channel.News,0);c&&c.length>0&&(a=c[c.length-1]);var C,d,p=0;if(this.curType=null,e&&e.time>p&&(p=e.time,C=GetLanguage(200443),d=e,this.curType=l.ViewType.World),n&&n.time>p&&(p=n.time,C=GetLanguage(200444),d=n,this.curType=l.ViewType.Guild),i&&i.time>p&&(p=i.time,C=GetLanguage(200445),d=i,this.curType=l.ViewType.Private),a&&a.time>p&&(p=a.time,C=GetLanguage(200446),d=a,this.curType=l.ViewType.News),d){if(this.txtName.string=C+d.name+"ï¼š",d.type==l.ChatContentType.Conetnt||d.type==l.ChatContentType.Share||d.type==l.ChatContentType.Pic||d.type==l.ChatContentType.Voice){var u=d.content;this.face.node.active=!1,d.type==l.ChatContentType.Pic?this.content.string=GetLanguage(200179):d.type==l.ChatContentType.Voice?this.content.string=GetLanguage(999000624):this.content.string=u}else if(d.type==l.ChatContentType.Face){this.face.node.active=!0,this.content.string="";var r=IS(f).GetFaceIconByContent(d.content),v=r[0],g=r[1],m=this.faceOriScale.y*g.scale;this.face.node.scale=new s(m,m,m),this.view.loadIcon(this.face,"icon_chat",v)}this.txtName.node.active=!0}else this.txtName.string="",this.content.string=""},e.reset=function(){},e.onLoad=function(){this.updateMessage()},e.onBattleState=function(t,e){t==c.Team20&&0==e&&uiMgr.close("ChatView")},t}());e._RF.pop()}}}));

