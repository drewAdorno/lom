System.register("chunks:///_virtual/SeasonShipTurnView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StorageUtil.ts","./StringUtil.ts","./index57.ts","./SpineSkeleton.ts","./ActivityDefine.ts","./BagDefine.ts","./BagModel.ts","./MessageView.ts","./SeasonControl.ts","./SeasonDataCache.ts","./SeasonDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,r,a,d,h,u,f,l,p,c,C,S,m,g,T,v,w,I,L,k;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.Button,o=t.sys,s=t.HorizontalTextAlignment,r=t.RichText,a=t.Toggle,d=t.Sprite,h=t.js,u=t.Label},function(t){f=t.default},function(t){l=t.default},function(t){p=t.default},null,function(t){c=t.SpineSkeleton},function(t){C=t.ActivityType},function(t){S=t.BagEventDefine},function(t){m=t.BagModel},function(t){g=t.default},function(t){T=t.default},function(t){v=t.SeasonDataCache},function(t){w=t.SeasonShipEventDefind,I=t.TREASURE_QUALITY_TO_EFFLIGHT,L=t.ShipEquipQuality},function(t){k=t.BaseView}],execute:function(){e._RF.push({},"7dcddiuc51GCJDIi/dApriW","SeasonShipTurnView",void 0);var G=[270012];t("default",function(t){function e(){var i;return(i=t.call(this)||this).nodeResParent=void 0,i.nodeResItem=void 0,i.resItems=void 0,i.btnOne=void 0,i.btnTen=void 0,i.txtOne=void 0,i.txtTen=void 0,i.togSkip=void 0,i.skipAnim=void 0,i.txtCount=void 0,i.eff=void 0,i.rewardList=[],i.showTimer=0,i.name="SeasonShipTurnView",i.url="ui/module/season/SeasonShipTurnView",i.poolTime=3e3,i}i(e,t);var k=e.prototype;return k.onInit=function(){var t=this,i=this.findChild("root/title/btnRule");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){g.showBoxTip({tip:GetLanguage(104426),btnCnt:1,horizontalAlign:o.uiMirror?s.RIGHT:s.LEFT})}));var e=this.findChild("root/btnClose");this.addComponentCallbackListener(e,n.EventType.CLICK,(function(){t.close()}));var h=this.findChild("root/btnGift");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){uiMgr.openView("SeasonShipTurnGiftView",C.SeasonTurn)}));var u=this.findChild("root/btnShop");this.addComponentCallbackListener(u,n.EventType.CLICK,(function(){uiMgr.openView("SeasonShipTurnShopView")})),this.txtOne=this.findChildComponent("root/btnOne/num",r),this.txtTen=this.findChildComponent("root/btnTen/num",r),this.btnOne=this.findChild("root/btnOne"),this.addComponentCallbackListener(this.btnOne,n.EventType.CLICK,(function(){IS(m).getGoodsCountByGoodsGtid(G[0])<1?uiMgr.openView("ItemGetWayView",G[0]):IS(T).reqShipDrawCard(1,2)})),this.btnTen=this.findChild("root/btnTen"),this.addComponentCallbackListener(this.btnTen,n.EventType.CLICK,(function(){IS(m).getGoodsCountByGoodsGtid(G[0])<10?uiMgr.openView("ItemGetWayView",G[0]):IS(T).reqShipDrawCard(2,2)})),this.togSkip=this.findChildComponent("root/toggleSkip",a),this.addComponentCallbackListener(this.togSkip.node,a.EventType.TOGGLE,(function(){t.togSkip.isChecked?l.set("SkipSeasonTurnAnim",1):l.set("SkipSeasonTurnAnim",2)})),this.skipAnim=this.findChild("skipAnim"),this.addComponentCallbackListener(this.skipAnim,n.EventType.CLICK,(function(){t.SkipAnim()}));var f=this.findChild("root/btnShow/btnShow");this.addComponentCallbackListener(f,n.EventType.CLICK,(function(){uiMgr.openView("SeasonShipTurnTipsView")})),this.txtCount=this.findChildComponent("root/nodeTip/Label",r),this.eff=this.findChildComponent("root/eff",c),this.initResShow(),o.uiMirror&&this.loadIcon(this.findChildComponent("root/toggleSkip/Checkmark",d),"season_treasure","zqkh_ui_gouxuan01")},k.initResShow=function(){var t=this;this.nodeResParent=this.findChild("root/resRoot"),this.nodeResItem=this.findChild("root/resRoot/resItem"),this.nodeResItem.active=!1,this.resItems=new Array;for(var i=function(i){var e=nodeInstantiate.instantiate(t.nodeResItem),o=G[i];t.addComponentCallbackListener(e,n.EventType.CLICK,(function(){IS(m).OpenItemTips(o,f.findChild(e,"imgIcon"))})),e.parent=t.nodeResParent,e.active=!0;var s=f.findChildComponent(e,"imgIcon",d),r=configGoods.getDataByKey(o);t.loadIcon(s,"icon_item",r.icon),t.resItems.push({node:e,txtNum:f.findChildComponent(e,"txtNum",u),goodsGtid:o})},e=0;e<G.length;e++)i(e)},k.registerUpdateHandler=function(){this.addEvent(S.GOODS_INFO_UPDATE,this.updateResShow,this),this.addEvent(w.TYPE_TREASURE_DRAW_INFO_UPDATE,this.updateResShow,this),this.addEvent(w.TYPE_TREASURE_DRAW_RESULT,this.updateResult,this)},k.updateResShow=function(){for(var t,i=0;i<this.resItems.length;i++)this.resItems[i].txtNum.string=p.GetNumString(IS(m).getGoodsCountByGoodsGtid(G[i]));this.txtCount.string=p.formatStrWithMirrorDeal(GetLanguage(204764),null!=(t=IS(v).drawCount2)?t:100);var e=configGoods.getDataByKey(G[0]),n=f.findChildComponent(this.btnOne,"icon",d);this.loadIcon(n,"icon_item",e.icon);var o=f.findChildComponent(this.btnTen,"icon",d);this.loadIcon(o,"icon_item",e.icon);var s,r,a=IS(m).getGoodsCountByGoodsGtid(G[0]);a>=1?(r="#5aff42",s="#27720d"):(r="#ff1f1f",s="#891000"),this.txtOne.string=h.formatStr("<b><outline color=%s width=2><color=%s>%s<color></outline></b>",s,r,1),a>=10?(r="#5aff42",s="#27720d"):(r="#ff1f1f",s="#891000"),this.txtTen.string=h.formatStr("<b><outline color=%s width=2><color=%s>%s<color></outline></b>",s,r,10)},k.updateResult=function(t){var i=this;this.rewardList=t.reward_list,this.txtCount.string=p.formatStrWithMirrorDeal(GetLanguage(204764),IS(v).drawCount2),this.togSkip.isChecked?(uiMgr.openView("GoodsGetView",this.rewardList),this.rewardList=[],this.eff.node.active=!1):(this.skipAnim.active=!0,this.eff.node.active=!0,this.eff.setAnimation(0,I[L.GOLD].eff,!1),this.showTimer&&this.removeTimer(this.showTimer),this.showTimer=this.addTimer(4.5,1,(function(){i.eff.node.active=!1,i.skipAnim.active=!1,uiMgr.openView("GoodsGetView",i.rewardList),i.rewardList=[]})))},k.SkipAnim=function(){this.txtCount.string=p.formatStrWithMirrorDeal(GetLanguage(204764),IS(v).drawCount2),this.skipAnim.active=!1,this.eff.node.active=!1,this.showTimer&&this.removeTimer(this.showTimer),uiMgr.openView("GoodsGetView",this.rewardList),this.rewardList=[]},k.onAfterOpen=function(){IS(T).reqShipDrawCardInfo(2),this.togSkip.isChecked=1==l.get("SkipSeasonTurnAnim"),this.eff.node.active=!1,this.skipAnim.active=!1,this.updateResShow(),this.rewardList.length>0&&uiMgr.openView("GoodsGetView",this.rewardList)},k.onBeforeClose=function(){},k.onDestroy=function(){},e}(k));e._RF.pop()}}}));

