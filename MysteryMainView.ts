System.register("chunks:///_virtual/MysteryMainView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./index57.ts","./BaseSubView.ts","./SpineSkeleton.ts","./ConfigGlobal.ts","./ResItems.ts","./MessageView.ts","./MarryDataCache.ts","./MarryDialogDataCache.ts","./ParkingDataCache.ts","./PlantDataCache.ts","./PlantDefine.ts","./PlantModel.ts","./RoleDataCache.ts","./RoleDefine.ts","./ScienceDataCache.ts","./ScienceDefine.ts","./ScienceModel.ts","./SlaveDataCache.ts","./StatueDataCache.ts","./MysteryDataCache.ts","./index52.ts","./UIDefine.ts","./ParkingDefine.ts"],(function(e){"use strict";var t,i,n,a,o,r,s,c,d,u,l,h,m,S,f,p,g,M,v,I,P,F,C,R,E,N,_,y,D,w,L,V,k,U,A;return{setters:[function(e){t=e.inheritsLoose,i=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,a=e.js,o=e.Vec2,r=e.Sprite,s=e.Button},function(e){c=e.audioMgr},function(e){d=e.RedPointType},function(e){u=e.RedPointMgr},function(e){l=e.default},null,function(e){h=e.BaseSubView},function(e){m=e.SpineSkeleton},function(e){S=e.ConfigGlobal},function(e){f=e.ResItems},function(e){p=e.default},function(e){g=e.default},function(e){M=e.default},function(e){v=e.ParkingDataCache},function(e){I=e.PlantDataCache},function(e){P=e.PlantEventDefine,F=e.CropState},function(e){C=e.PlantModel},function(e){R=e.RoleDataCache},function(e){E=e.RoleEventDefine,N=e.PlayerAttr},function(e){_=e.ScienceDataCache},function(e){y=e.ScienceEventDefine},function(e){D=e.ScienceModel},function(e){w=e.SlaveDataCache},function(e){L=e.StatueDataCache},function(e){V=e.MysteryDataCache},null,function(e){k=e.PanelTabType,U=e.OpenFunction},function(e){A=e.ParkingEventDefine}],execute:function(){n._RF.push({},"9adbeIaV3hAXqnWUxG6RjgF","MysteryMainView",void 0);var O=["Science","Mine","Farm","FarmStatue","CarPark","Slave","MarryScene","Marry"],T={Science:{goodsGtid:S.mine_ore,redPath:a.formatStr("MainView/tab-%s/science",k.Main_Mystery),openFuncId:U.FUNC_SCIENCE_AND_TECHNOLOGY},Mine:{goodsGtid:S.mine_pickaxe,redPath:a.formatStr("MainView/tab-%s/mine",k.Main_Mystery),openFuncId:U.FUNC_MINE},Farm:{redPath:a.formatStr("MainView/tab-%s/farm",k.Main_Mystery),openFuncId:U.FUNC_FARM,spineName:"MX_tx_toucaifangzi"},FarmStatue:{redPath:a.formatStr("MainView/tab-%s/farmstatue",k.Main_Mystery),openFuncId:U.FUNC_STATUE},CarPark:{redPath:a.formatStr("MainView/tab-%s/parking",k.Main_Mystery),openFuncId:U.FUNC_PARKING},Slave:{redPath:a.formatStr("MainView/tab-%s/slave",k.Main_Mystery),openFuncId:U.FUNC_CAPTURE_SLAVE},MarryScene:{openFuncId:U.FUNC_HOME},Marry:{redPath:a.formatStr("MainView/tab-%s/marry",k.Main_Marry),openFuncId:U.FUNC_HOME,redPos:new o(53,18)}},b=[1,2];e("default",function(e){function n(){var t;return(t=e.call(this)||this).itemList=void 0,t.resItems=void 0,t.name="MysteryMainView",t.url="ui/module/mystery/MysteryMainView",t.fullScreen=!0,t}t(n,e);var a=n.prototype;return a.onInit=function(){var e=this;this.resItems=new f(this),this.resItems.init(b),this.itemList=[];for(var t=this.findChild("items"),i=function(i){var n=O[i],a=l.findChild(t,n),c=T[n],u=c.openFuncId,h=l.findChild(a,"imgName");if(c.redPath){var S=c.redPos?c.redPos:new o(70,25);e.addRedPoint(c.redPath,h,S,d.Dot)}e.itemList.push({node:a,itemName:n,goodsGtid:c.goodsGtid,redPath:c.redPath,imgIcon:l.findChildComponent(a,"imgIcon",r),imgLock:l.findChild(a,"imgLock"),openFuncId:u,nodeSelect:l.findChild(a,"imgSelect"),nodeState:l.findChild(a,"txtState"),spine:c.spineName?l.findChildComponent(a,c.spineName,m):null});a.getComponent(s);e.addComponentCallbackListener(a,s.EventType.CLICK,(function(){if(!u||IS(R).CheckFuncOpen(u))e.onEnterClick(e.itemList[i]);else{var t=configNewFuncOpen.getDataByKey(u);p.showFlyTip(t.openCondition)}}))},n=0;n<O.length;n++)i(n)},a.registerUpdateHandler=function(){this.addEvent(E.ROLE_RES_UPDATE,this.onRoleResUpdate,this),this.addEvent(E.ROLE_OPEN_FUNCTION_UPDATE,this.onRoleOpenFunctionUpdate,this),this.addEvent(P.ROLE_LAND_INFO_UPDATE,this.onRoleLandUpdate,this),this.addEvent(P.HOME_FARM_INFO_INIT,this.onHomeFarmInfoInit,this),this.addEvent(y.SCIENCE_TREE_UPDATE,this.onScienceTreeUpdate,this),this.addEvent(P.FARM_LAND_HARVEST_FINISH,this.onFarmLandHarvestFinish,this),this.addEvent(A.PARKING_RECORD_READ,this.showRedPoint,this),this.addEvent(E.ROLE_RED_POINT_LIST_UPDATE,this.showRedPoint,this),this.addEvent(E.ROLE_RED_DETAIL_UPDATE,this.showRedPoint,this)},a.onAfterOpen=function(){c.playMusic("home_mix2"),this.resItems.update(),this.updateLock(),this.showRedPoint(),this.updateSelect(),this.updateState()},a.showRedPoint=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;"Science"==n.itemName?IS(u).changeValue(n.redPath,IS(_).getAllScienceRedPoint()):"Mine"==n.itemName?IS(u).changeValue(n.redPath,IS(V).getMineRedPoint()):"FarmStatue"==n.itemName?IS(L).setRedPoint(n.redPath):"Farm"==n.itemName?IS(u).changeValue(n.redPath,IS(I).getFarmRedPoint()):"Slave"==n.itemName?IS(u).changeValue(n.redPath,IS(w).getSlaveRedPoint()):"CarPark"==n.itemName?IS(u).changeValue(n.redPath,IS(v).getParkingRedPoint()):"Marry"==n.itemName&&IS(u).changeValue(n.redPath,IS(M).getFavorRedPoint())}},a.updateSingleLock=function(e){var t=IS(R).CheckFuncOpen(e.openFuncId);e.imgIcon.grayscale=!t,e.imgLock.active=!t},a.updateLock=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;n.openFuncId&&this.updateSingleLock(n)}},a.updateSingleSelect=function(e){if(e.nodeSelect&&(e.nodeSelect.active=!1),"Farm"==e.itemName&&e.spine){var t=this.getShowFarmAni();null!=t&&e.spine.setAnimation(0,t,!0),e.imgIcon.node.active=null==t,e.spine.node.active=null!=t}},a.getShowFarmAni=function(){if(IS(R).CheckFuncOpen(U.FUNC_FARM))return IS(C).checkBeStealing()?"toucai_jinggao":IS(I).checkLandHasTargetStatus(F.MATURE)?"shouhuo":IS(C).checkRemindCanPlant()?"bozhong":void 0},a.updateSelect=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;this.updateSingleSelect(n)}},a.updateSingleState=function(e){null!=e.nodeState&&("Farm"==e.itemName?e.nodeState.active=IS(I).checkShowGrowing():"Science"==e.itemName&&(e.nodeState.active=IS(D).checkIsUpgrading()))},a.updateState=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;"Farm"!=n.itemName&&"Science"!=n.itemName||this.updateSingleState(n)}},a.onRoleOpenFunctionUpdate=function(e){for(var t,n=i(this.itemList);!(t=n()).done;){var a=t.value;if(a.openFuncId&&a.openFuncId==e){this.updateSingleLock(a),"Farm"==a.itemName&&this.updateSingleSelect(a);break}}},a.onRoleLandUpdate=function(e){if(e==IS(R).GetRoleId())for(var t,n=i(this.itemList);!(t=n()).done;){var a=t.value;if("Farm"==a.itemName){this.updateSingleSelect(a),this.updateSingleState(a);break}}},a.onHomeFarmInfoInit=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;if("Farm"==n.itemName){this.updateSingleSelect(n),this.updateSingleState(n);break}}},a.onScienceTreeUpdate=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;if("Science"==n.itemName){this.updateSingleState(n);break}}},a.onFarmLandHarvestFinish=function(){for(var e,t=i(this.itemList);!(e=t()).done;){var n=e.value;if("Farm"==n.itemName){this.updateSingleSelect(n),this.updateSingleState(n);break}}},a.onBeforeClose=function(){},a.onDestroy=function(){},a.onRoleResUpdate=function(e){if(this.resItems.updateGtid(e),e==N.ROLE_SEED_BUY||e==N.ROLE_SEED_GET||e==N.ROLE_SEED_RARE)for(var t,n=i(this.itemList);!(t=n()).done;){var a=t.value;if("Farm"==a.itemName){this.updateSingleSelect(a);break}}},a.onEnterClick=function(e){if("Science"==e.itemName)uiMgr.openView("ScienceView");else if("Mine"==e.itemName)uiMgr.openView("MysteryMineView");else if("Farm"==e.itemName)uiMgr.openView("PlantMainView");else if("FarmStatue"==e.itemName)IS(L).offRedPoint(),uiMgr.openView("StatueView"),IS(u).changeValue(e.redPath,0);else if("CarPark"==e.itemName)uiMgr.openView("ParkingMainView");else if("Slave"==e.itemName)uiMgr.openView("SlaveMainView");else if("Marry"==e.itemName)uiMgr.openView("MarryDialogView");else if("MarryScene"==e.itemName){var t=IS(g).GetMarryStateInfo();t&&t.stage>0?uiMgr.openView("MarryWeddingInfoView"):uiMgr.openView("MarryMapSceneView")}},n}(h));n._RF.pop()}}}));

