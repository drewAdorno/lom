System.register("chunks:///_virtual/FlagSelectView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./index57.ts","./GuildControl.ts","./RoleControl.ts","./RoleDataCache.ts","./RoleDefine.ts","./BaseView.ts"],(function(e){"use strict";var t,n,i,o,s,l,a,d,c,h,r,f,u,p,v;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e.Button,o=e.Sprite,s=e.UITransform,l=e.NodeEventType,a=e.ScrollView},function(e){d=e.ListItem},function(e){c=e.default},null,function(e){h=e.default},function(e){r=e.default},function(e){f=e.RoleDataCache},function(e){u=e.PlayerAttr,p=e.RoleEventDefine},function(e){v=e.BaseView}],execute:function(){n._RF.push({},"66f55O3Vq1JXZWMRmZG9uBo","FlagSelectView",void 0);e("default",function(e){function n(){var t;return(t=e.call(this)||this).showType=void 0,t.showFlag=void 0,t.flagNode=void 0,t.empty=void 0,t.list=void 0,t.selectedId=void 0,t.name="FlagSelectView",t.url="ui/module/player/FlagSelectView",t}t(n,e);var d=n.prototype;return d.onInit=function(){var e=this,t=this.findChild("node/btnClose");this.addComponentCallbackListener(t,i.EventType.CLICK,(function(){e.close()}));var n=this.findChild("imgMask");this.addComponentCallbackListener(n,i.EventType.CLICK,(function(){e.close()}));var d=this.findChild("node/use");this.addComponentCallbackListener(d,i.EventType.CLICK,(function(){if(1==e.showType){if(e.selectedId==IS(f).GetRoleAttr(u.ROLE_ATTR_FLAG))return;var t=[];t.push({k:u.ROLE_ATTR_FLAG,v:e.selectedId});var n={kv:t};IS(r).send_3_22(n)}else IS(h).send_29_6(6,e.selectedId);e.close()})),this.flagNode=this.findChild("node/flag"),this.showFlag=this.findChildComponent("node/flag/icon",o);var c=this.findChildComponent("node/flag/icon",s),p=this.findChildComponent("node/flag/flagBg",s);this.addComponentCallbackListener(c.node,l.SIZE_CHANGED,(function(){p.contentSize=c.contentSize})),this.empty=this.findChild("node/empty"),this.list=this.addUIList(this.findChildComponent("node/ScrollView",a),C)},d.registerUpdateHandler=function(){this.addEvent(p.ROLE_INFO_UPDATE,this.refreshShowFlag,this)},d.onAfterOpen=function(){var e,t=this;this.showType=this.openArgs[0],this.selectedId=null!=(e=IS(f).GetRoleAttr(u.ROLE_ATTR_FLAG))?e:1;for(var n=configNation_flag.getDatas(),i=[],o=0;o<n.length;o++)i.push(n[o]);i.sort((function(e,n){return 1==t.showType?e.person_rank<n.person_rank?-1:1:e.family_rank<n.family_rank?-1:1})),this.list.datas=i,this.refreshShowFlag()},d.refreshShowFlag=function(){if(this.selectedId>0){this.empty.active=!1,this.flagNode.active=!0;var e=configNation_flag.getDataByKey(this.selectedId);this.loadIcon(this.showFlag,"icon_flag",e.flag_name)}else this.empty.active=!0,this.flagNode.active=!1},d.onBeforeClose=function(){},d.onDestroy=function(){},n}(v));var C=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).icon=void 0,t.showSelected=void 0,t}t(n,e);var a=n.prototype;return a.onInit=function(){var e=this;this.icon=c.findChildComponent(this.node,"icon",o),this.showSelected=c.findChild(this.node,"selected"),this.view.addComponentCallbackListener(this.node,i.EventType.CLICK,(function(){e.view.selectedId=e.data.id,e.view.list.updateAll(),e.view.refreshShowFlag()}));var t=c.findChildComponent(this.node,"flagBg",s),n=c.findChildComponent(this.node,"icon",s);this.view.addComponentCallbackListener(this.icon.node,l.SIZE_CHANGED,(function(){t.contentSize=n.contentSize}))},a.onRender=function(e,t){this.view.loadIcon(this.icon,"icon_flag",e.flag_name),this.showSelected.active=e.id==this.view.selectedId},n}(d);n._RF.pop()}}}));

