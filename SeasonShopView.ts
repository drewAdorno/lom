System.register("chunks:///_virtual/SeasonShopView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./BagDefine.ts","./ResItems.ts","./MessageView.ts","./MallControl.ts","./MallDataCache.ts","./MallDefine.ts","./RoleDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,d,r,a,h,l,u,c,f,v,p,m,C,S,w,L,y,I,g;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.sys,d=t.HorizontalTextAlignment,r=t.ScrollView,a=t.Sprite,h=t.Label,l=t.Widget,u=t.js},function(t){c=t.ItemGrid},function(t){f=t.ListItem},function(t){v=t.default},null,function(t){p=t.BagEventDefine},function(t){m=t.ResItems},function(t){C=t.default},function(t){S=t.default},function(t){w=t.default},function(t){L=t.MallEventDefine,y=t.MallType},function(t){I=t.RoleEventDefine},function(t){g=t.BaseView}],execute:function(){n._RF.push({},"56619MfVPpPdZsMmL0TjRhe","SeasonShopView",void 0);var b=[270016],R=[270017],x=(t("default",function(t){function n(){var i;return(i=t.call(this)||this).curSel=void 0,i.scroll=void 0,i.resItems=void 0,i.resItems2=void 0,i.btnList=[],i.node1=void 0,i.node2=void 0,i.name="SeasonShopView",i.url="ui/module/season/SeasonShopView",i.poolTime=3e3,i}i(n,t);var h=n.prototype;return h.onInit=function(){var t=this,i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.close()}));var e=this.findChild("view/node1/ruleTips");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){C.showBoxTip({tip:GetLanguage(204151),btnCnt:1,horizontalAlign:s.uiMirror?d.RIGHT:d.LEFT})}));var n=this.findChildComponent("view/scrollList",r);this.scroll=this.addUIList(n,x);for(var h=function(i){var e=t.findChild("view/content/item"+i),n={normal:v.findChild(e,"normal"),select:v.findChild(e,"selected"),index:i};t.btnList.push(n),t.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.switchNodeShow(i)}))},l=1;l<3;l++)h(l);if(this.node1=this.findChild("view/node1"),this.node2=this.findChild("view/node2"),this.resItems=new m(this,"view/node1/resRoot"),this.resItems.init(b),this.resItems2=new m(this,"view/node2/resRoot"),this.resItems2.init(R),s.uiMirror){var u=this.findChildComponent("view/node1/ruleTips/icon",a);this.loadIcon(u,"season","dhh_ui_huoquguize")}},h.registerUpdateHandler=function(){this.addEvent(L.MAll_INFO_UPDATE,this.updateInfo,this),this.addEvent(p.GOODS_INFO_UPDATE,this.updateResShow,this),this.addEvent(I.ROLE_RES_UPDATE,this.updateResShow,this)},h.onAfterOpen=function(){this.switchNodeShow(1),this.updateResShow(),this.updateScroll()},h.updateScroll=function(){var t=2==this.curSel?y.SeasonSea:y.Season;IS(S).send_27_1(t);var i=[].concat(configMall.getDataByList("type",t)),e=[];for(var n in i)if(i.hasOwnProperty(n)){var o=i[n];e.push(o)}e.sort((function(t,i){return t.id-i.id})),this.scroll.datas=e},h.updateResShow=function(){this.resItems.update(),this.resItems2.update()},h.updateInfo=function(){this.scroll.updateAll()},h.switchNodeShow=function(t){if(t!=this.curSel){this.curSel=t,this.node1.active=1==this.curSel,this.node2.active=2==this.curSel;for(var i,n=e(this.btnList);!(i=n()).done;){var o=i.value;o.select.active=o.index==this.curSel}this.updateScroll()}},h.onBeforeClose=function(){this.curSel=0},h.onDestroy=function(){},n}(g)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).txtName=void 0,i.txtPrice=void 0,i.priceIcon=void 0,i.btnBuy=void 0,i.out=void 0,i.txtRest=void 0,i.txtLimit=void 0,i.itemGrid=void 0,i.buyLimit=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;if(this.txtPrice=v.findChildComponent(this.node,"btnBuy/Label",h),this.priceIcon=v.findChildComponent(this.node,"btnBuy/Label/icon",a),this.txtName=v.findChildComponent(this.node,"txtName",h),this.buyLimit=v.findChild(this.node,"buyLimit"),this.out=v.findChild(this.node,"out"),this.out.active=!1,this.txtRest=v.findChildComponent(this.node,"buyLimit/numRest",h),this.txtLimit=v.findChildComponent(this.node,"buyLimit/numLimit",h),this.itemGrid=new c(this.view,v.findChild(this.node,"itemGrid")),this.btnBuy=v.findChild(this.node,"btnBuy"),this.view.addComponentCallbackListener(this.btnBuy,o.EventType.CLICK,(function(){t.out.active?C.showFlyTip(GetLanguage(200039)):uiMgr.openView("MallTipsView",t.data)})),s.uiMirror){var i=v.findChildComponent(this.node,"btnBuy/Label/icon",l);i.alignFlags=32,i.right=-45}},n.onRender=function(t,i){this.txtName.string=t.name;var e=configGoods.getDataByKey(t.price[0]);this.txtPrice.string=t.price[1],this.view.loadIcon(this.priceIcon,"icon_item",e.icon),this.itemGrid.SetItemId(t.goods[0],t.goods[1]),this.out.active=!1;var n=IS(w).GetBuyInfoByType(t.type);if(-1!=t.limit){var o;this.buyLimit.active=!0;var s=null!=(o=n[t.id])?o:0;this.txtRest.string="",this.txtLimit.string=u.formatStr("%s/%s",String(t.limit-s),String(t.limit)),this.out.active=s>=t.limit}else this.buyLimit.active=!1},e}(f));n._RF.pop()}}}));

