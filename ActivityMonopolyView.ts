System.register("chunks:///_virtual/ActivityMonopolyView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./RedPoint.ts","./RedPointMgr.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./SpineSkeleton.ts","./ObjectUtil.ts","./BagDefine.ts","./BagModel.ts","./ResItems.ts","./MessageView.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./MonopolyControl.ts","./MonopolyDataCache.ts","./MonopolyDefine.ts","./BaseView.ts"],(function(e){"use strict";var t,i,o,n,s,a,d,r,c,f,l,h,p,u,y,m,g,v,w,C,I,D,E,T,M,S,P,_,R,B,G,x,A,V;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,o=e.Color,n=e.Button,s=e.Vec2,a=e.Label,d=e.Node,r=e.UITransform,c=e.Sprite,f=e.js,l=e.Vec3,h=e.LabelOutline},function(e){p=e.audioMgr},function(e){u=e.RedPointType},function(e){y=e.RedPointMgr},function(e){m=e.default},function(e){g=e.default},function(e){v=e.default},null,function(e){w=e.SpineSkeleton},function(e){C=e.default},function(e){I=e.BagEventDefine},function(e){D=e.BagModel},function(e){E=e.ResItems},function(e){T=e.default},function(e){M=e.default},function(e){S=e.ActivityType,P=e.ActivityState,_=e.ActivityEventDefine},function(e){R=e.default},function(e){B=e.MonopolyDataCache},function(e){G=e.MonopolyEventDefine,x=e.MonopolyEventType},function(e){A=e.ViewEvent,V=e.BaseView}],execute:function(){var k,L;i._RF.push({},"d89e3sQlAFLu6OnPeda52DD","ActivityMonopolyView",void 0);var b=[1401],U=((k={})[1]=new o(107,107,107),k[2]=new o(0,157,83),k[3]=new o(0,177,217),k[4]=new o(189,52,230),k[5]=new o(229,111,6),k),N=((L={})[1]="jzmgt_zjm_qipanhui",L[2]="jzmgt_zjm_qipanlv",L[3]="jzmgt_zjm_qipanlan",L[4]="jzmgt_zjm_qipanfen",L[5]="jzmgt_zjm_qipanhuang",L),O=[1,6,11,16];e("default",function(e){function i(){var t;return(t=e.call(this)||this).resItems=void 0,t.txtLeftTime=void 0,t.leftTime=0,t.canUpdate=!1,t.time=0,t.shop=void 0,t.btnDoubleCard=void 0,t.task=void 0,t.gridItems=void 0,t.nodeRole=void 0,t.nodeEffectRole=void 0,t.nodeDiceCur=void 0,t.nodeDicing=void 0,t.txtDiceNum=void 0,t.txtDiceDesc=void 0,t.nodeDiceDescBg=void 0,t.isWaiting=!1,t.waitPlayyEffectDic={},t.event=void 0,t.circle=void 0,t.pos=void 0,t.nodeView=void 0,t.txtCircle=void 0,t.moveTween=void 0,t.moveTween2=void 0,t.curRoleEffectName=void 0,t.curRoleEffect=void 0,t.curRoleSpine=void 0,t.diceItemCfg=void 0,t.hasPlayPos={},t.skipAnim=void 0,t.curData=void 0,t.diceAniTimer=void 0,t.diceWaitTimer=void 0,t.diceSpine=void 0,t.noMove=!1,t.curResNum=void 0,t.effectDice=void 0,t.name="ActivityMonopolyView",t.url="ui/module/activity/ActivityMonopolyView",t.fullScreen=!0,t}t(i,e);var o=i.prototype;return o.onInit=function(){var e=this,t=this.findChild("view/btnClose");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){e.close()})),this.nodeView=this.findChild("view");var i=this.findChild("bg/title/btnTips");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){uiMgr.openView("GvGRuleTips",[GetLanguage(700000006),GetLanguage(700000007)])})),this.btnDoubleCard=this.findChild("view/btnDoubleCard"),this.addComponentCallbackListener(this.btnDoubleCard,n.EventType.CLICK,(function(){e.isWaiting||uiMgr.openView("MonopolyDoubleCardView")})),this.shop=this.findChild("view/shop"),this.addComponentCallbackListener(this.shop,n.EventType.CLICK,(function(){IS(M).GetActivityInfo(S.Monopoly).state==P.Open?uiMgr.openView("MonopolyStoreView",S.Monopoly):T.showFlyTip(GetLanguage(200026))})),this.task=this.findChild("view/task"),this.addRedPoint("monopoly_task",this.task,new s(30,25),u.Dot),this.addComponentCallbackListener(this.task,n.EventType.CLICK,(function(){IS(M).GetActivityInfo(S.Monopoly).state==P.Open?uiMgr.openView("MonopolyTaskView",S.Monopoly):T.showFlyTip(GetLanguage(200026))})),this.resItems=new E(this),this.resItems.init(b),this.txtLeftTime=this.findChildComponent("view/nodeTime/txtTime",a),this.gridItems=new Array;for(var o=function(t){var i=e.findChild(f.formatStr("view/map/gridContent/grid%s",t));e.addComponentCallbackListener(i,n.EventType.CLICK,(function(){e.onClickPos(t)})),e.gridItems.push({node:i,pos:t,nodeEffect:m.findChild(i,"effect1"),nodeEffect2:m.findChild(i,"effect2"),imgBottom:m.findChildComponent(i,"imgBottom",c),nodeICON:m.findChild(i,"imgIcon"),txtName:m.findChildComponent(i,"txtName",a),nodeReward:m.findChild(i,"reward"),txtReward:m.findChildComponent(i,"reward/txtReward",a),outlineReward:m.findChildComponent(i,"reward/txtReward",h)})},l=1;l<=20;l++)o(l);this.nodeRole=this.findChild("view/map/role"),this.nodeEffectRole=this.findChild("view/map/role/effect"),this.nodeDiceCur=this.findChild("view/cur");var p=this.findChild("view/cur/imgDice");this.addComponentCallbackListener(p,n.EventType.CLICK,(function(){if(IS(M).GetActivityInfo(S.Monopoly).state==P.Open){if(!e.isWaiting)if(IS(D).getGoodsCountByGoodsGtid(1402)<=0)T.showFlyTip(GetLanguage(200069));else{if(e.event&&e.event.times>0)if(8==configMonopoly_random.getDataByKey(e.event.id).type[0])return;IS(R).reqMonopolyDice(),e.isWaiting=!0}}else T.showFlyTip(GetLanguage(200026))})),this.nodeDicing=this.findChild("view/dicing"),this.txtDiceNum=this.findChildComponent("view/cur/txtNum",a),this.nodeDiceDescBg=this.findChild("view/cur/imgBg-002"),this.txtDiceDesc=this.findChildComponent("view/cur/txtDesc",a),this.addComponentCallbackListener(this.txtDiceDesc.node,d.EventType.SIZE_CHANGED,(function(){e.nodeDiceDescBg.getComponent(r).height=e.txtDiceDesc.node.getComponent(r).height+2,e.nodeDiceDescBg.getComponent(c).updateRenderer()})),this.txtCircle=this.findChildComponent("view/map/txtCircle",a),this.skipAnim=this.findChild("skipAnim"),this.addComponentCallbackListener(this.skipAnim,n.EventType.CLICK,(function(){e.SkipAnim()}))},o.registerUpdateHandler=function(){this.addEvent(I.GOODS_INFO_UPDATE,this.onGoodsInfoUpdate,this),this.addEvent(_.OnActivityInfoTaskUpdate,this.updateRed,this),this.addEvent(_.OnActivityInfoUpdate,this.updateRed,this),this.addEvent(G.MONO_INFO_BACK,this.updateInfo,this),this.addEvent(G.MONO_DICE_TIME_UPDATE,this.updateDiceTime,this),this.addEvent(G.MONO_GRID_DICE_BACK,this.onMonoGridDiceBack,this),this.addEvent(G.MONO_GRID_UPDATE,this.onMonoGridUpdate,this),this.addEvent(A.ViewClose,this.onViewClose,this),this.addEvent(G.MONO_POLICE_UPDATE_RES,this.updateResShow,this)},o.onAfterOpen=function(){this.diceItemCfg||(this.diceItemCfg=configGoods.getDataByKey(1402)),this.skipAnim.active=!1,p.playMusic("bgm_dafuweng"),IS(R).reqMonoInfo(),this.nodeDiceCur.active=!0,this.nodeDicing.active=!1,this.updateResShow();var e=IS(M).GetActivityInfo(S.Monopoly);if(e){var t,i=null!=(t=e.state_time[e.state])?t:e.state_time[P.Open];this.leftTime=i.end_time-v.serverTime,this.leftTime>0?(this.txtLeftTime.string=f.formatStr("%s",v.formatTimeStringForSecond(this.leftTime)),this.canUpdate=!0):this.txtLeftTime.string=GetLanguage(200026)}this.updateRed()},o.SkipAnim=function(){var e=this;this.diceAniTimer&&(this.removeTimer(this.diceAniTimer),this.diceAniTimer=null),this.diceWaitTimer&&(this.removeTimer(this.diceWaitTimer),this.diceWaitTimer=null),this.skipAnim.active=!1,this.diceSpine.setAnimation(0,String(this.curData.dice_num),!1),this.addTimer(1,1,(function(){e.effectDice&&(e.removeUIEffect(e.effectDice),e.effectDice=null),e.playMove(e.curData),e.diceSpine=null,e.diceWaitTimer=null}))},o.updateDoubleCard=function(){this.btnDoubleCard.active=1!=IS(B).monopolyInfo.double_card_open},o.updateDiceTime=function(){var e=IS(B).monopolyInfo.dice_time;if(!(e<=0)){var t=Math.max(0,e-v.serverTime);this.diceItemCfg||(this.diceItemCfg=configGoods.getDataByKey(1402)),this.txtDiceDesc.string=g.formatStr(GetLanguage(700000014),v.formatTimeForSecond(t),this.diceItemCfg.name)}},o.playMove=function(e){var t=this;if(this.noMove)return T.showFlyTip(GetLanguage(700000322),!1,{time1:.6,time2:.6}),this.nodeDiceCur.active=!0,this.nodeDicing.active=!1,this.isWaiting=!1,this.hasPlayPos={},void this.updateResShow();for(var i,o,n,s=e.pos>this.pos?e.pos-this.pos:20-this.pos+e.pos,a=!1,d=new Array,r=1;r<=s;r++)i=this.pos+r-1,(o=this.pos+r)>20&&(o-=20),i>20&&(i-=20),1==o&&(a=!0,n=r-1),d.push({startPos:i,endPos:o,start:this.getGridItemByPos(i).node.position,end:this.getGridItemByPos(o).node.position});if(this.circle=e.circle,this.pos=e.pos,this.event=e.event,this.moveTween&&(this.moveTween.stop(),this.moveTween=null),p.playSound("dfw_yidong"),!a)return this.txtCircle.string=String(this.circle),this.curRoleSpine&&this.curRoleSpine.setAnimation(0,"run",!0),void(this.moveTween=normalTween.to(0,s,.5*s,(function(e,i){var o=Math.floor(i),n=i-o;o>=s&&(o=s-1,n=1);var a=d[o],r=a.startPos,c=a.endPos;!t.hasPlayPos[c]&&n>=t.getNeedEffectProgress(r,c)&&(t.hasPlayPos[c]=!0,t.addUIEffect("prefab/ui-effect/MX_tx_dafuweng_yidong",t.getGridItemByPos(c).nodeEffect,.5,null,t.getProgressEffectScaleByPos(c)));var f=a.start.x+(a.end.x-a.start.x)*n,h=a.start.y+(a.end.y-a.start.y)*n,p=a.end.x-a.start.x>0?-1:1,u=t.getUIEffect(t.curRoleEffect);u.dir!=p&&(u.dir=p),t.nodeRole.position=new l(f,h,0)})).call((function(){t.tryOpenEventTip(e.event,e.pos,!1,e.reward),t.nodeDiceCur.active=!0,t.nodeDicing.active=!1,t.isWaiting=!1,t.getUIEffect(t.curRoleEffect).dir=t.getDirByPos(d[s-1].endPos),t.curRoleSpine&&t.curRoleSpine.setAnimation(0,"idle",!0),t.hasPlayPos={},t.updateResShow()})).start());for(var c=new Array,f=new Array,h=0;h<d.length;h++)h<=n?c.push(d[h]):f.push(d[h]);var u=c.length,y=f.length;this.curRoleSpine&&this.curRoleSpine.setAnimation(0,"run",!0),this.moveTween=normalTween.to(0,u,.5*u,(function(e,i){var o=Math.floor(i),n=i-o;o>=u&&(o=u-1,n=1);var s=c[o],a=s.startPos,d=s.endPos;!t.hasPlayPos[d]&&n>=t.getNeedEffectProgress(a,d)&&(t.hasPlayPos[d]=!0,t.addUIEffect("prefab/ui-effect/MX_tx_dafuweng_yidong",t.getGridItemByPos(d).nodeEffect,.5,null,t.getProgressEffectScaleByPos(d)));var r=s.start.x+(s.end.x-s.start.x)*n,f=s.start.y+(s.end.y-s.start.y)*n,h=s.end.x-s.start.x>0?-1:1,p=t.getUIEffect(t.curRoleEffect);p.dir!=h&&(p.dir=h),t.nodeRole.position=new l(r,f,0)})).call((function(){if(t.curRoleSpine&&t.curRoleSpine.setAnimation(0,"idle",!0),t.playWaitPlayEffectByType(1),t.txtCircle.string=String(t.circle),y>0){for(var i,o=0;o<e.reward.length;o++)1==e.reward[o].type&&(i=e.reward[o].goods_list[0]);i&&(t.showRewardEffect(i),t.forceUpdateRes(t.curResNum+i.num))}})).start(),y<=0?this.addTimer(.5*u,1,(function(){var i;t.tryOpenEventTip(e.event,e.pos,!1,e.reward),t.nodeDiceCur.active=!0,t.nodeDicing.active=!1,t.isWaiting=!1,t.hasPlayPos={};for(var o=0;o<e.reward.length;o++)1==e.reward[o].type&&(i=e.reward[o].goods_list[0]);i&&(t.showRewardEffect(i),t.forceUpdateRes(t.curResNum+i.num)),t.updateResShow()})):(this.moveTween2&&(this.moveTween2.stop(),this.moveTween2=null),this.addTimer(.5*u+1.5,1,(function(){t.curRoleSpine&&t.curRoleSpine.setAnimation(0,"run",!0),t.moveTween=normalTween.to(0,y,.5*y,(function(e,i){var o=Math.floor(i),n=i-o;o>=y&&(o=y-1,n=1);var s=f[o],a=s.startPos,d=s.endPos;!t.hasPlayPos[d]&&n>=t.getNeedEffectProgress(a,d)&&(t.hasPlayPos[d]=!0,t.addUIEffect("prefab/ui-effect/MX_tx_dafuweng_yidong",t.getGridItemByPos(d).nodeEffect,.5,null,t.getProgressEffectScaleByPos(d)));var r=s.start.x+(s.end.x-s.start.x)*n,c=s.start.y+(s.end.y-s.start.y)*n,h=s.end.x-s.start.x>0?-1:1,p=t.getUIEffect(t.curRoleEffect);p.dir!=h&&(p.dir=h),t.nodeRole.position=new l(r,c,0)})).call((function(){t.tryOpenEventTip(e.event,e.pos,!1,e.reward),t.nodeDiceCur.active=!0,t.nodeDicing.active=!1,t.isWaiting=!1,t.getUIEffect(t.curRoleEffect).dir=t.getDirByPos(d[y-1].endPos),t.curRoleSpine&&t.curRoleSpine.setAnimation(0,"idle",!0),t.hasPlayPos={},t.updateResShow()})).start()})))},o.onMonoGridDiceBack=function(e){var t=this;if((this.curData=e,this.noMove=!1,this.event&&this.event.times>0)&&8==configMonopoly_random.getDataByKey(this.event.id).type[0])return void(this.event=e.event);this.nodeDiceCur.active=!1,this.nodeDicing.active=!0;var i=e.dice_num,o=!1;this.event&&this.event.times>0&&(6==configMonopoly_random.getDataByKey(this.event.id).type[0]&&(o=!0,this.event=e.event));this.noMove=o,p.playSound("dfw_zhitouzi"),this.effectDice=this.addUIEffect("prefab/ui-effect/MX_shaizi_dafuweng",this.nodeDicing,3,new s(0,0),1,(function(e){var o=e.node.getComponent(w);t.diceSpine=o,o.needAnimation="chixu",t.skipAnim.active=!0,t.diceAniTimer=t.addTimer(2,1,(function(){t.skipAnim.active=!1,o.setAnimation(0,String(i),!1),t.diceAniTimer=null}))})),this.diceWaitTimer=this.addTimer(3,1,(function(){t.playMove(e),t.diceSpine=null,t.diceWaitTimer=null}))},o.onMonoGridUpdate=function(e){var t=e.type||1;1!=t&&2!=t&&3!=t&&6!=t&&7!=t&&8!=t||this.addWaitPlayEffectByType(t,e)},o.onViewClose=function(e){"MonopolyLuckyEventView"==e?this.playWaitPlayEffectByType(2):"MonopolyGiftView"==e?(this.playWaitPlayEffectByType(7),this.playWaitPlayEffectByType(8)):"MonopolyDoubleCardView"==e&&(null==uiMgr.getOpenView("MonopolyGiftView")&&this.playWaitPlayEffectByType(8),this.playWaitPlayEffectByType(3))},o.addWaitPlayEffectByType=function(e,t){null==this.waitPlayyEffectDic[e]&&(this.waitPlayyEffectDic[e]=new Array);for(var i=0;i<t.grid.length;i++)this.waitPlayyEffectDic[e].push(t.grid[i].pos)},o.playWaitPlayEffectByType=function(e,t){var i=this.waitPlayyEffectDic[e];if(!(null==i||i.length<=0)){for(var o=0;o<i.length;o++)t?this.showSingleGrids(i[o]):this.showGridUpgradeEffect(i[o]);this.waitPlayyEffectDic[e]=new Array}},o.showRewardEffect=function(e){var t=this;p.playSound("common_reward"),this.addUIEffect("prefab/ui-effect/MX_tx_dafuweng_jiesuan_zizhi",this.nodeView,1.5,new s(0,350),1,(function(i){var o=i.node,n=m.findChildComponent(o,"Node/imgIcon",c),s=configGoods.getDataByKey(e.gtid);t.loadIcon(n,s.icon_group,s.icon),m.findChildComponent(o,"Node/flyLabel",a).string=f.formatStr("+%s",e.num)}))},o.getGridItemByPos=function(e){for(var t=0;t<this.gridItems.length;t++){var i=this.gridItems[t];if(i.pos==e)return i}},o.showGridUpgradeEffect=function(e){var t=this,i=this.getGridItemByPos(e);this.addUIEffect("prefab/ui-effect/MX_tx_dafuweng_shengji",i.nodeEffect2,1,null,1,(function(){t.showSingleGrids(e)}))},o.updateInfo=function(){var e=this;this.circle=IS(B).monopolyInfo.circle,this.txtCircle.string=String(this.circle),this.pos=IS(B).monopolyInfo.pos,this.event=IS(B).monopolyInfo.event,this.updateDoubleCard();var t=1!=IS(B).monopolyInfo.double_card_open?"MX_tx_dafuwengjuese":"MX_tx_dafuwengjuese2";this.curRoleEffectName&&this.curRoleEffectName==t||(this.curRoleEffect&&(this.removeUIEffect(this.curRoleEffect),this.curRoleEffect=null),this.curRoleEffect=this.addUIEffect(f.formatStr("prefab/ui-effect/%s",t),this.nodeEffectRole,-1,new s(0,0),1,(function(t){e.curRoleSpine=t.node.getComponent(w),e.curRoleSpine.needAnimation="idle",t.dir=e.getDirByPos(e.pos)}))),this.curRoleEffectName=t,this.updateDiceTime(),this.showGrids(),this.checkNeedAlertEvent();var i=this.getGridItemByPos(this.pos);this.nodeRole.position=new l(i.node.position.x,i.node.position.y,0)},o.checkIfBigBottom=function(e){return O.includes(e)},o.getNeedEffectProgress=function(e,t){return this.checkIfBigBottom(e)&&this.checkIfBigBottom(t)||!this.checkIfBigBottom(e)&&!this.checkIfBigBottom(t)?.5:this.checkIfBigBottom(e)&&!this.checkIfBigBottom(t)?.6:!this.checkIfBigBottom(e)&&this.checkIfBigBottom(t)?.4:void 0},o.getDirByPos=function(e){return e>=1&&e<=3||5==e||7==e||14==e||14==e||16==e||e>=18&&e<=20?1:-1},o.checkNeedAlertEvent=function(){var e=IS(B).monopolyInfo.event;!e||e.times<=0||this.tryOpenEventTip(e,null,!0)},o.tryOpenEventTip=function(e,t,i,o){if(void 0===i&&(i=!1),i){var n=configMonopoly_random.getDataByKey(e.id).type[0];n==x.Stop?uiMgr.openView("MonopolyPrisonView",e.id):n==x.Fail&&uiMgr.openView("MonopolyPoliceView",e)}else{var s=IS(B).getGridInfo(t),a=configMonopoly.getDataByKey(s.id);if(2==a.type){if(4==a.id){for(var d,r=0;r<o.length;r++)2==o[r].type&&(d=o[r].goods_list[0]);C.isEmpty(d)||this.showRewardEffect(d);var c=configMonopoly_random.getDataByKey(e.id);3==c.type[0]&&T.showFlyTip(g.formatStr(GetLanguage(700000325),c.type[2]),!1,{time1:.6,time2:.6}),uiMgr.openView("MonopolyLuckyEventView",e.id,d)}else if(14==a.id){for(var f,l=0;l<o.length;l++)6==o[l].type&&(f=o[l].goods_list[0]);if(!C.isEmpty(f)){var h=configGoods.getDataByKey(f.gtid);T.showFlyTip(g.formatStr(GetLanguage(700000323),h.name,f.num),!1,{time1:.6,time2:.6})}5==configMonopoly_random.getDataByKey(e.id).type[0]&&(T.showFlyTip(GetLanguage(700000324),!1,{time1:.6,time2:.6}),this.playWaitPlayEffectByType(6,!0)),uiMgr.openView("MonopolyBadEventView",e.id,f)}}else if(3==a.type)uiMgr.openView("MonopolyPrisonView",e.id);else if(4==a.type)uiMgr.openView("MonopolyPoliceView",e);else if(5==a.type){for(var p,u=0;u<o.length;u++)5==o[u].type&&(p=o[u].index);uiMgr.openView("MonopolyRouletteView",e,p)}else if(6==a.type){var y;uiMgr.openView("MonopolyTaxView",e.id);for(var m=0;m<o.length;m++)6==o[m].type&&(y=o[m].goods_list[0]);if(!C.isEmpty(y)){var v=configGoods.getDataByKey(y.gtid);T.showFlyTip(g.formatStr(GetLanguage(700000323),v.name,y.num),!1,{time1:.6,time2:.6})}}else if(7==a.type)uiMgr.openView("MonopolyGiftView");else if(8==a.type){for(var w,I=0;I<o.length;I++)4==o[I].type&&(w=o[I].goods_list[0]);this.showRewardEffect(w)}}},o.showGrids=function(){for(var e,t=0;t<this.gridItems.length;t++){e=this.gridItems[t].pos,this.showSingleGrids(e)}},o.showSingleGrids=function(e){var t=this.getGridItemByPos(e),i=IS(B).getGridInfo(e),o=i.id,n=configMonopoly.getDataByKey(o);if(t.txtName.string=n.name,8==n.type){t.nodeReward.active=!0;for(var s=0;s<n.city_lvl_reward.length;s++)if(n.city_lvl_reward[s][0]==i.level){t.txtReward.string=f.formatStr("+%s",1!=IS(B).monopolyInfo.double_card_open?n.city_lvl_reward[s][1][1]:2*n.city_lvl_reward[s][1][1]);break}this.loadIcon(t.imgBottom,"act_monopoly",N[i.level]),t.outlineReward.color=U[i.level],t.nodeICON.active=!1}else t.nodeReward.active=!1,t.nodeICON.active=!0},o.getProgressEffectScaleByPos=function(e){return O.includes(e)?1.6:1},o.updateResShow=function(){this.resItems.updateGtid(1401);var e=IS(D).getGoodsCountByGoodsGtid(1402);this.txtDiceNum.string=e,this.txtDiceDesc.node.active=e<=0,this.nodeDiceDescBg.active=e<=0,this.curResNum=IS(D).getGoodsCountByGoodsGtid(1401),this.updateRed()},o.onGoodsInfoUpdate=function(e,t,i){1401==t&&i&&10600039==i||this.updateResShow()},o.forceUpdateRes=function(e){e&&this.resItems.updateGtid(1401,e)},o.onClickPos=function(e){var t=IS(B).getGridInfo(e),i=configMonopoly.getDataByKey(t.id);if(7!=i.type||e!=this.pos){var o=this.getGridItemByPos(e);uiMgr.openView("CommonPopTipsView",i.desc,o.nodeEffect2)}else uiMgr.openView("MonopolyGiftView")},o.updateRed=function(){IS(y).changeValue("monopoly_task",IS(M).GetTaskRedNum(S.Monopoly))},o.onBeforeClose=function(){this.effectDice=null,this.curData=null,this.noMove=!1,this.hasPlayPos={},p.playMusic("battle"),this.canUpdate=!1,this.isWaiting=!1,this.waitPlayyEffectDic={},this.curRoleEffectName=null,this.curRoleSpine=null,this.moveTween&&(this.moveTween.stop(),this.moveTween=null),this.moveTween2&&(this.moveTween2.stop(),this.moveTween2=null)},o.onUpdate=function(e){this.canUpdate&&(this.time=this.time+e,this.time>=1&&(this.time=0,this.leftTime=this.leftTime-1,this.updateDiceTime(),this.leftTime>0?this.txtLeftTime.string=f.formatStr("%s",v.formatTimeStringForSecond(this.leftTime)):(this.txtLeftTime.string=GetLanguage(200026),this.canUpdate=!1)))},o.onDestroy=function(){},i}(V));i._RF.pop()}}}));

