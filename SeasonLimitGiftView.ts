System.register("chunks:///_virtual/SeasonLimitGiftView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./PayDataCache.ts","./PayDefine.ts","./SeasonDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,o,s,r,a,d,c,f,l,u,h,v,p,I,C,y;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,o=t.Button,s=t.Label,r=t.ScrollView,a=t.sys,d=t.Sprite},function(t){c=t.ItemGrid},function(t){f=t.ListItem},function(t){l=t.default},null,function(t){u=t.default},function(t){h=t.ActivityType},function(t){v=t.default},function(t){p=t.PayEventDefine,I=t.GiftType},function(t){C=t.gift_list},function(t){y=t.BaseView}],execute:function(){n._RF.push({},"5f7a07xDLdHcJ4wugCQIv8Y","SeasonLimitGiftView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).rewardScroll=void 0,i.txtPrice=void 0,i.giftInfo=void 0,i.name="SeasonLimitGiftView",i.url="ui/module/season/SeasonLimitGiftView",i}i(n,t);var c=n.prototype;return c.onInit=function(){var t=this,i=this.findChild("content/btnBuy");this.addComponentCallbackListener(i,o.EventType.CLICK,(function(){t.giftInfo&&IS(v).Pay(t.giftInfo.id)})),this.txtPrice=this.findChildComponent("content/btnBuy/Label",s);var e=this.findChild("content/btnClose");this.addComponentCallbackListener(e,o.EventType.CLICK,(function(){t.close()}));var n=this.findChildComponent("content/ScrollView",r);if(this.rewardScroll=this.addUIList(n,m),this.rewardScroll.lackCenter=!0,a.uiMirror){this.loadIcon(this.findChildComponent("content/imgBg",d),"season_gift","dhh_icon_bg");var c=this.findChild("content/title-001"),f=this.findChild("content/title-002");this.adjustMirrorNode(c,-2*c.position.x,!1),this.adjustMirrorNode(f,-2*f.position.x,!1)}},c.registerUpdateHandler=function(){this.addEvent(p.PAY_INFO_UPDATE,this.updateInfo,this),this.addEvent(p.PAY_REWARD_UPDATE,this.updateInfo,this),this.addEvent(p.PAY_RECHARGE_SUCCESS,this.close,this)},c.onAfterOpen=function(){this.updateInfo()},c.updateInfo=function(){var t,i,n=IS(u).GetActivityInfo(h.Season);if(n){for(var o,s,r=IS(v).GetAcivityGift(I.Activity,n.type,n.round),a=e(r);!(s=a()).done;){var d=s.value;if(C.includes(d.id)){o=d;break}}o&&0==(null!=(t=null==(i=IS(v).GetPayGiftInfo(o.id))?void 0:i.bought_times)?t:0)?(this.giftInfo=o,this.rewardScroll.datas=o.reward,this.txtPrice.string=IS(v).GetPriceString(o.cost_level)):this.close()}else this.rewardScroll.clearData()},c.onBeforeClose=function(){},c.onDestroy=function(){},n}(y));var m=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.itemGridNode=l.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode)},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1])},e}(f);n._RF.pop()}}}));

