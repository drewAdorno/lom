System.register("chunks:///_virtual/DevelopStageView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./MessageView.ts","./PayControl.ts","./PayDataCache.ts","./PayDefine.ts","./PrivilegeDataCache.ts","./PrivilegeDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,s,a,o,d,h,r,f,g,l,c,m,u,y,v,p,I,C;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.ScrollView,s=t.Button,a=t.sys,o=t.HorizontalTextAlignment,d=t.Label,h=t.Sprite},function(t){r=t.ItemGrid},function(t){f=t.ListItem},function(t){g=t.default},function(t){l=t.default},function(t){c=t.default},null,function(t){m=t.default},function(t){u=t.default},function(t){y=t.default},function(t){v=t.PayEventDefine},function(t){p=t.PrivilegeDataCache},function(t){I=t.PrivilegeEventDefine},function(t){C=t.BaseView}],execute:function(){e._RF.push({},"1dca63YzSdBSqCGVyylOwYk","DevelopStageView",void 0);var T=19002,G=(t("default",function(t){function e(){var i;return(i=t.call(this)||this).giftList=void 0,i.imgBox1=void 0,i.imgBox2=void 0,i.curPayId=T,i.txtResetTime=void 0,i.endTime=void 0,i.leftTime=0,i.deltaTime=0,i.canUpdate=!1,i.hasBought=!1,i.listInited=!1,i.gift7payId=19008,i.gift7rewardList=void 0,i.gift7btnBuy=void 0,i.gift7imgGrey=void 0,i.gift7txtPrice=void 0,i.gift7imgHint=void 0,i.gift7txtHint=void 0,i.gift7txtRatio=void 0,i.name="DevelopStageView",i.url="ui/module/recharge/DevelopStageView",i.poolTime=3e3,i}i(e,t);var h=e.prototype;return h.onInit=function(){var t=this;this.imgBox1=this.findChild("root/content/top/btnBox/img1"),this.imgBox2=this.findChild("root/content/top/btnBox/img2");var i=this.findChildComponent("root/content/ScrollView",n);this.giftList=this.addUIList(i,G),this.giftList.virtual=!1;var e=this.findChild("root/content/btnClose");this.addComponentCallbackListener(e,s.EventType.CLICK,(function(){t.onCloseClick()}));var h=this.findChild("root/content/top/btnBox");this.addComponentCallbackListener(h,s.EventType.CLICK,(function(){IS(u).send_19_2(19009)}));var r=this.findChild("root/content/top/btnTips");this.addComponentCallbackListener(r,s.EventType.CLICK,(function(){m.showBoxTip({tip:GetLanguage_UI(999000511),btnCnt:1,horizontalAlign:a.uiMirror?o.RIGHT:o.LEFT})})),this.gift7rewardList=this.addUIList(this.findChildComponent("root/content/gift7/RewardScroll",n),P),this.gift7rewardList.lackCenter=!0,this.gift7btnBuy=this.findChild("root/content/gift7/btnBuy"),this.addComponentCallbackListener(this.gift7btnBuy,s.EventType.CLICK,(function(){var i=IS(y).GetPayGiftInfo(t.gift7payId);i?i.bought_times>=i.payCfg.buy_times?m.showFlyTip(GetLanguage(200039)):IS(y).Pay(t.gift7payId):m.showFlyTip(GetLanguage(200039))})),this.gift7imgGrey=this.findChild("root/content/gift7/btnBuy/imgGrey"),this.gift7txtPrice=this.findChildComponent("root/content/gift7/btnBuy/Label",d),this.gift7imgHint=this.findChild("root/content/gift7/imgHint"),this.gift7txtHint=this.findChildComponent("root/content/gift7/imgHint/Label",d),this.gift7txtRatio=this.findChildComponent("root/content/gift7/imgRatio/txtRatio",d)},h.onAfterOpen=function(){this.listInited=!1,this.onGiftListUpdate(),this.UpdateBtn()},h.registerUpdateHandler=function(){this.addEvent(v.PAY_INFO_UPDATE,this.onGiftListUpdate,this),this.addEvent(v.PAY_INFO_UPDATE,this.UpdateBtn,this),this.addEvent(v.PAY_REWARD_UPDATE,this.onGiftListUpdate,this)},h.onCloseClick=function(){this.close()},h.onBeforeClose=function(){},h.onDestroy=function(){},h.onUpdate=function(t){if(this.listInited||6==this.giftList.items.length&&(this.InitList(),this.listInited=!0),this.canUpdate&&(this.deltaTime=this.deltaTime+t,this.deltaTime>=1)){if(this.deltaTime=0,this.leftTime=this.leftTime-1,!this.txtResetTime)return;this.leftTime>0?this.txtResetTime.string=l.formatStr(GetLanguage_UI(999000509),c.formatTimeStringForSecond(this.leftTime)):(this.txtResetTime.string=GetLanguage(200026),this.canUpdate=!1)}},h.InitList=function(){var t=this.curPayId-T,i=IS(y).GetPayGiftInfo(this.curPayId);i&&i.bought_times>=i.payCfg.buy_times&&t++,t=t>4?4:t,this.giftList.content.setPosition(0,245*t)},h.UpdateBtn=function(){var t=IS(y).GetPayGiftInfo(19009);if(t&&t.rewardState<2)return this.imgBox1.active=!0,this.imgBox2.active=!1,IS(p).DevelopStageRedPoint=1,void normalEvent.emit(I.ACITVITY_RED_UPDATE);IS(p).DevelopStageRedPoint=0,this.imgBox1.active=!1,this.imgBox2.active=!0,normalEvent.emit(I.ACITVITY_RED_UPDATE)},h.onGiftListUpdate=function(){var t=this;this.hasBought=!1;for(var i=0;i<7;i++){if(IS(y).GetPayGiftInfo(T+i)){this.curPayId=T+i;break}}for(var e,n=[],s=0;s<7;s++){var a={payId:T+s,curPayId:this.curPayId};6!=s?n.push(a):e=a}console.error(n),this.giftList.datas=n,this.addTimer(.2,0,(function(){t.updateGift7(e)}))},h.updateGift7=function(t){var i=configPay_mall.getDataByKey(this.gift7payId),e=IS(y).GetPayGiftInfo(this.gift7payId),n=null;if(0==i.pre_id&&(n=configPay_mall.getDataByKey(this.gift7payId-1)),this.gift7rewardList.datas=i.reward,this.gift7txtRatio.string=100*i.ratio+"%",this.gift7payId==t.curPayId){if(this.gift7btnBuy.active=!0,this.gift7imgGrey.active=!1,this.gift7imgHint.active=!1,this.gift7txtPrice.string=IS(y).GetPriceString(i.cost_level),!e)return void(this.gift7imgGrey.active=!0);e.bought_times>=e.payCfg.buy_times&&(this.gift7imgGrey.active=!1,this.hasBought=!0,this.gift7btnBuy.active=!1,this.gift7imgHint.active=!0,this.txtResetTime=this.gift7txtHint,this.endTime=e.end_time,this.leftTime=this.endTime-c.serverTime,this.leftTime>0&&(this.canUpdate=!0))}if(this.gift7payId>t.curPayId)if(this.gift7btnBuy.active=!1,this.gift7imgHint.active=!0,this.gift7payId==t.curPayId+1&&this.hasBought){var s=IS(y).GetPayGiftInfo(t.curPayId);this.txtResetTime=this.gift7txtHint,this.endTime=s.end_time,this.leftTime=this.endTime-c.serverTime,this.leftTime>0&&(this.canUpdate=!0)}else this.gift7txtHint.string=l.formatStr(GetLanguage_UI(999000508),n.name)},e}(C)),function(t){function e(){for(var i,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).imgBg=void 0,i.payId=void 0,i.txtTitle=void 0,i.rewardList=void 0,i.btnBuy=void 0,i.imgGrey=void 0,i.txtPrice=void 0,i.imgHint=void 0,i.txtHint=void 0,i.txtRatio=void 0,i}i(e,t);var a=e.prototype;return a.onInit=function(){var t=this;this.txtTitle=g.findChildComponent(this.node,"imgBg/txtTitle",d);var i=g.findChildComponent(this.node,"RewardScroll",n);this.rewardList=this.view.addUIList(i,P),this.rewardList.lackCenter=!0,this.btnBuy=g.findChild(this.node,"btnBuy"),this.imgGrey=g.findChild(this.node,"btnBuy/imgGrey"),this.view.addComponentCallbackListener(this.btnBuy,s.EventType.CLICK,(function(){var i=IS(y).GetPayGiftInfo(t.payId);i?i.bought_times>=i.payCfg.buy_times?m.showFlyTip(GetLanguage(200039)):IS(y).Pay(t.payId):m.showFlyTip(GetLanguage(200039))})),this.txtPrice=g.findChildComponent(this.btnBuy,"Label",d),this.imgHint=g.findChild(this.node,"imgHint"),this.imgBg=g.findChildComponent(this.node,"imgBg",h),this.txtHint=g.findChildComponent(this.imgHint,"Label",d),this.txtRatio=g.findChildComponent(this.node,"imgRatio/txtRatio",d)},a.onRender=function(t,i){var e=this.view;this.payId=t.payId;var n=configPay_mall.getDataByKey(this.payId),s=IS(y).GetPayGiftInfo(this.payId),a=null;if(0==n.pre_id&&(a=configPay_mall.getDataByKey(this.payId-1)),this.txtTitle.string=n.name,this.rewardList.datas=n.reward,this.txtRatio.string=100*n.ratio+"%",this.payId<=t.curPayId){if(this.btnBuy.active=!0,this.imgGrey.active=!1,this.imgHint.active=!1,this.txtPrice.string=IS(y).GetPriceString(n.cost_level),!s)return void(this.imgGrey.active=!0);s.bought_times>=s.payCfg.buy_times?(this.imgGrey.active=!0,e.hasBought=!0,19008==this.payId&&(this.btnBuy.active=!1,this.imgHint.active=!0,e.txtResetTime=this.txtHint,e.endTime=s.end_time,e.leftTime=e.endTime-c.serverTime,e.leftTime>0&&(e.canUpdate=!0))):this.imgGrey.active=!1}if(this.payId>t.curPayId)if(this.btnBuy.active=!1,this.imgHint.active=!0,this.payId==t.curPayId+1&&e.hasBought){var o=IS(y).GetPayGiftInfo(t.curPayId);e.txtResetTime=this.txtHint,e.endTime=o.end_time,e.leftTime=e.endTime-c.serverTime,e.leftTime>0&&(e.canUpdate=!0)}else this.txtHint.string=l.formatStr(GetLanguage_UI(999000508),a.name)},e}(f)),P=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.itemGridNode=g.findChild(this.node,"itemGrid"),this.itemGrid=new r(this.view,this.itemGridNode)},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1])},e}(f);e._RF.pop()}}}));

