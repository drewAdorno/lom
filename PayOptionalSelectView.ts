System.register("chunks:///_virtual/PayOptionalSelectView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./index57.ts","./PayControl.ts","./PayDefine.ts","./PayDataCache.ts","./BagModel.ts","./MessageView.ts","./BaseView.ts"],(function(e){"use strict";var t,i,n,o,s,h,d,c,a,l,r,v,u,f,C;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,n=e.Button,o=e.ScrollView,s=e.Label,h=e.Node},function(e){d=e.ItemGrid},function(e){c=e.ListItem},function(e){a=e.default},null,function(e){l=e.default},function(e){r=e.PayEventDefine},function(e){v=e.default},function(e){u=e.BagModel},function(e){f=e.default},function(e){C=e.BaseView}],execute:function(){i._RF.push({},"49a0e7ThbZKmroeS8Twq8LL","PayOptionalSelectView",void 0);e("default",function(e){function i(){var t;return(t=e.call(this)||this).chooseList=void 0,t.gift_id=void 0,t.selectIndex=-1,t.chooseIndex=1,t.saveChoose=[],t.chooseScroll=void 0,t.rewardScroll=void 0,t.txtTitle=void 0,t.time=0,t.isTouch=void 0,t.itemId=0,t.showNode=0,t.name="PayOptionalSelectView",t.url="ui/module/shop/PayOptionalSelectView",t}t(i,e);var h=i.prototype;return h.onInit=function(){var e=this,t=this.findChild("imgMask");this.addComponentCallbackListener(t,n.EventType.CLICK,(function(){e.close()}));var i=this.findChild("view/btnCancel");this.addComponentCallbackListener(i,n.EventType.CLICK,(function(){e.close()}));var h=this.findChild("view/btnSave");this.addComponentCallbackListener(h,n.EventType.CLICK,(function(){var t=[];for(var i in e.saveChoose)e.saveChoose.hasOwnProperty(i)&&function(){var n=e.saveChoose[i],o=Number(i),s=e.chooseList.find((function(e){return e[0]==o}))[1][n-1];t.push({k:o,v:s[0]})}();0!=t.length?(IS(l).send_19_9({id:e.gift_id,list:t}),e.close()):f.showFlyTip(GetLanguage(202017))}));var d=this.findChildComponent("view/chooseScroll",o);this.chooseScroll=this.addUIList(d,m),this.chooseScroll.lackCenter=!0;var c=this.findChildComponent("view/rewardScroll",o);this.rewardScroll=this.addUIList(c,w),this.txtTitle=this.findChildComponent("view/imgBg/title/txtTitle",s)},h.registerUpdateHandler=function(){this.addEvent(r.PAY_CUSTOM_INFO_SET,this.close,this)},h.onAfterOpen=function(){var e,t,i=this;this.gift_id=this.openArgs[0],this.chooseIndex=null!=(e=this.openArgs[1])?e:1,this.txtTitle.string=configPay_mall.getDataByKey(this.gift_id).name;var n=configCustom_mall.getDataByKey(this.gift_id);this.chooseList=n.custom_reward;var o=null!=(t=IS(v).GetCustomInfoList(this.gift_id))?t:[];for(var s in o)o.hasOwnProperty(s)&&function(){var e=o[s],t=e.v,n=i.chooseList.find((function(t){return t[0]==e.k}))[1].findIndex((function(e){return e[0]==t}));i.saveChoose[e.k]=n+1}();this.chooseScroll.datas=this.chooseList,this.changeChoose(this.chooseIndex)},h.onBeforeClose=function(){this.saveChoose=[],this.selectIndex=0,this.chooseIndex=1,this.selectIndex=-1},h.onDestroy=function(){},h.onUpdate=function(e){this.isTouch&&(this.time=this.time+e,0!=this.itemId&&this.time>=.5&&IS(u).OpenItemTips(this.itemId,this.showNode))},h.changeChoose=function(e){var t;this.chooseIndex=e;var i=null!=(t=this.saveChoose[e])?t:0;this.selectIndex=i,this.rewardScroll.datas=this.chooseList.find((function(t){return t[0]==e}))[1],this.chooseScroll.updateAll()},h.setChoose=function(e){this.selectIndex=e,this.saveChoose[this.chooseIndex]=e,this.chooseScroll.updateAll(),this.rewardScroll.updateAll()},i}(C));var m=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).itemGrid=void 0,t.notSet=void 0,t.select=void 0,t.itemId=0,t}t(i,e);var n=i.prototype;return n.onInit=function(){var e=this;this.itemGrid=new d(this.view,a.findChild(this.node,"itemGrid")),this.notSet=a.findChild(this.node,"notSet"),this.select=a.findChild(this.node,"select"),this.view.addComponentCallbackListener(this.node,h.EventType.TOUCH_START,(function(){e.view.itemId=e.itemId,e.view.showNode=e.node,e.view.time=0,e.view.isTouch=!0})),this.view.addComponentCallbackListener(this.node,h.EventType.TOUCH_CANCEL,(function(){e.view.time=0,e.view.isTouch=!1})),this.view.addComponentCallbackListener(this.node,h.EventType.TOUCH_END,(function(){e.view.time<.5&&e.view.changeChoose(e.index+1),e.view.time=0,e.view.isTouch=!1}))},n.onRender=function(e,t){var i,n=null!=(i=this.view.saveChoose[t+1])?i:0;if(n){this.notSet.active=!1,this.itemGrid.node.active=!0;var o=this.view.chooseList.find((function(e){return e[0]==t+1}))[1][n-1];this.itemGrid.SetItemId(o[0],o[1]),this.itemId=o[0]}else this.itemId=0,this.notSet.active=!0,this.itemGrid.node.active=!1;this.SetSelect()},n.SetSelect=function(){this.select.active=this.index==this.view.chooseIndex-1},i}(c),w=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).itemGridNode=void 0,t.itemGrid=void 0,t.select=void 0,t.itemId=0,t}t(i,e);var n=i.prototype;return n.onInit=function(){var e=this;this.itemGridNode=a.findChild(this.node,"itemGrid"),this.itemGrid=new d(this.view,this.itemGridNode),this.select=a.findChild(this.node,"select"),this.view.addComponentCallbackListener(this.node,h.EventType.TOUCH_START,(function(){e.view.itemId=e.itemId,e.view.showNode=e.node,e.view.time=0,e.view.isTouch=!0})),this.view.addComponentCallbackListener(this.node,h.EventType.TOUCH_CANCEL,(function(){e.view.time=0,e.view.isTouch=!1})),this.view.addComponentCallbackListener(this.node,h.EventType.TOUCH_END,(function(){e.view.time<.5&&e.view.setChoose(e.index+1),e.view.time=0,e.view.isTouch=!1}))},n.onRender=function(e,t){this.itemId=e[0],this.itemGrid.SetItemId(e[0],e[1]),this.SetSelect()},n.SetSelect=function(){this.select.active=this.index==this.view.selectIndex-1},i}(c);i._RF.pop()}}}));

