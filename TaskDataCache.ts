System.register("chunks:///_virtual/TaskDataCache.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RedPointMgr.ts","./index57.ts","./AchievementDataCache.ts","./FlyPetDataCache.ts","./RoleDataCache.ts","./TaskDefine.ts","./UIDefine.ts"],(function(t){"use strict";var i,e,a,n,s,l,r,o,u,d,c;return{setters:[function(t){i=t.createForOfIteratorHelperLoose},function(t){e=t.cclegacy},function(t){a=t.RedPointMgr},null,function(t){n=t.AchievementDataCache},function(t){s=t.default},function(t){l=t.RoleDataCache},function(t){r=t.TaskType,o=t.TaskState,u=t.TaskEventDefine,d=t.DailyBoxState},function(t){c=t.OpenFunction}],execute:function(){e._RF.push({},"b48d8I/PCJOO6w2CU8MaC8O","TaskDataCache",void 0);t("TaskDataCache",function(){function t(){this.taskList={},this.dailyPoint=0,this.dailyBoxList=[],this.curMainTaskId=1}var e=t.prototype;return e.clear=function(){},e.UpdateTaskInfo=function(t){this.taskList={};for(var i=0;i<t.length;i++){var e=t[i];null==this.taskList[e.type]&&(this.taskList[e.type]={}),this.taskList[e.type][e.task_id]=e}var a=this.taskList[r.Main];if(this.curMainTaskId=0,null!=a)for(var n in a){var s=a[n];if(s.state!=o.Received){this.curMainTaskId=s.task_id;break}}normalEvent.emit(u.TASK_INFO_UPDATE),this.UpdateMainDailyTaskRed()},e.UpdateTaskInfoAdd=function(t){for(var i=!1,e=0;e<t.length;e++){var a=t[e];null==this.taskList[a.type]&&(this.taskList[a.type]={}),this.taskList[a.type][a.task_id]=a,a.type==r.Main&&(i=!0)}if(i){var n=this.taskList[r.Main];if(null!=n)for(var s in this.curMainTaskId=0,n){var l=n[s];if(l.state!=o.Received){this.curMainTaskId=l.task_id;break}}}normalEvent.emit(u.TASK_INFO_UPDATE),this.UpdateMainDailyTaskRed()},e.UpdateDailyBox=function(t){if(this.dailyPoint=t.daily_point,this.dailyBoxList=[],null!=t.box_list)for(var e,a=i(t.box_list);!(e=a()).done;){var n=e.value;this.dailyBoxList[n.k]=n.v}normalEvent.emit(u.TASK_DAILY_UPDATE),this.UpdateMainDailyTaskRed()},e.UpdateDailyBoxReceive=function(t){for(var e,a=i(t);!(e=a()).done;){var n=e.value;this.dailyBoxList[n]=d.Received}normalEvent.emit(u.TASK_DAILY_UPDATE),this.UpdateMainDailyTaskRed()},e.GetTaskList=function(t){return this.taskList[t]},e.GetCurMainTaskId=function(){return this.curMainTaskId},e.GetCurMainTask=function(){return this.GetTaskItem(r.Main,this.curMainTaskId)},e.GetTaskItem=function(t,i){return null==this.taskList[t]?null:this.taskList[t][i]},e.GetDailyBoxList=function(){return this.dailyBoxList},e.GetDailyPoint=function(){return this.dailyPoint},e.UpdateMainDailyTaskRed=function(){IS(a).changeValue("MainDailyTask",this.GetMainDailyTaskRed()),IS(a).changeValue("MainTaskAndAchieve",this.GetTaskAndAchieveRed()),this.updateFlyPetRed()},e.updateFlyPetRed=function(){IS(a).changeValue("TaskFlyPetRed",this.GetFlyPetRed()),IS(a).changeValue("TaskFlyPetAllRed",this.GetFlyPetAllRed())},e.GetFlyPetAllRed=function(){var t=this.GetFlyPetRed();return t+=IS(s).CheckHaveFinishRedPoint(),t+=IS(s).CheckIsHaveEggRedPoint(),IS(l).CheckFuncOpen(c.FUNC_FLY_PET)||(t=0),t},e.GetFlyPetRed=function(){var t=0,i=this.taskList[r.FlyPet];if(null!=i)for(var e in i){if(i.hasOwnProperty(e))i[e].state==o.Complete&&(t+=1)}return t+=IS(s).GetAchievementInfoRedPoint()},e.GetMainDailyTaskRed=function(){var t=0,e=this.taskList[r.Daily];if(null!=e)for(var a in e){if(e.hasOwnProperty(a))e[a].state==o.Complete&&(t+=1)}var n=this.dailyPoint,s=configDaily_task_reward.getDatas();if(null==s)return t;for(var l,u=i(s);!(l=u()).done;){var c=l.value;n>=c.point&&this.dailyBoxList[c.box_id]==d.Normal&&(t+=1)}return t},e.GetTaskAndAchieveRed=function(){return this.GetMainDailyTaskRed()+IS(n).GetHasRed()+IS(n).GetAccomplishmentRed()},t}());e._RF.pop()}}}));

