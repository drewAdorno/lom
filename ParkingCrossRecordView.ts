System.register("chunks:///_virtual/ParkingCrossRecordView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIList.ts","./NodeUtil.ts","./TimeUtil.ts","./index57.ts","./StringUtil.ts","./ChatDataCache.ts","./ChatDefine.ts","./FrameDataCache.ts","./RoleDefine.ts","./ParkingControl.ts","./ParkingDataCache.ts","./ParkingDefine.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,a,o,s,f,h,r,d,l,R,u,_,c,v,g,m,L,C;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,a=t.ScrollView,o=t.Button,s=t.Label,f=t.Sprite},function(t){h=t.ListItem},function(t){r=t.default},function(t){d=t.default},null,function(t){l=t.default},function(t){R=t.ChatDataCache,u=t.EPvpShareType},function(t){_=t.ChatDefine},function(t){c=t.FrameDataCache},function(t){v=t.PlayerAttr},function(t){g=t.default},function(t){m=t.ParkingDataCache},function(t){L=t.ParkingEventDefine},function(t){C=t.BaseView}],execute:function(){n._RF.push({},"614fcBJ/sJKp7iMjQKXEXLi","ParkingCrossRecordView",void 0);t("ParkingCrossRecordView",function(t){function e(){var i;return(i=t.call(this)||this).scrollPvpList=void 0,i.nodeBattle=void 0,i.updateList=!1,i.txtTime=void 0,i.name="ParkingCrossRecordView",i.url="ui/module/parking/ParkingCrossRecordView",i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this,i=this.findChild("content"),e=r.findChildComponent(i,"scrollPvp",a);this.scrollPvpList=this.addUIList(e,p);var n=this.findChild("btnClose");this.addComponentCallbackListener(n,o.EventType.CLICK,(function(){t.close()}))},n.registerUpdateHandler=function(){this.addEvent(L.PARKING_CROSS_PVP_HISTORY,this.onRecordList,this)},n.onAfterOpen=function(){IS(g).reqCrossParkReportList(IS(m).master_id)},n.onBeforeClose=function(){this.updateList=!1},n.onDestroy=function(){},n.onRecordList=function(t){var i=t.history_list;i.sort((function(t,i){return t.time<i.time?1:-1})),this.scrollPvpList.datas=i},e}(C));var p=function(t){function n(){for(var i,e,n,a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=t.call.apply(t,[this].concat(o))||this).leftName=void 0,n.rightName=void 0,n.time=void 0,n.stateLeft=void 0,n.stateRight=void 0,n.headLeft=void 0,n.headRight=void 0,n.btnGo=void 0,n.btnShare=void 0,n.successState=void 0,n.headLeftFrame=void 0,n.headRightFrame=void 0,n.txtBuffLeft=void 0,n.txtBuffRight=void 0,n.btnBuffLeft=void 0,n.btnBuffRight=void 0,n.leftBuffId=void 0,n.rightBuffId=void 0,n.isAtk=!0,n.roleInfoRight=((i={})[v.ROLE_ATTR_LVL]=0,i[v.ROLE_ATTR_ID]=0,i[v.ROLE_ATTR_NAME]="",i[v.ROLE_ATTR_SERVER]=0,i[v.ROLE_ATTR_CUR_POWER]=0,i[v.ROLE_ATTR_POWER_SHOW]=0,i[v.ROLE_ATTR_HEAD_ID]=0,i[v.ROLE_ATTR_HEAD_FRAME_ID]=0,i[v.ROLE_ATTR_HEAD_URL]="",i),n.roleInfoLeft=((e={})[v.ROLE_ATTR_LVL]=0,e[v.ROLE_ATTR_ID]=0,e[v.ROLE_ATTR_NAME]="",e[v.ROLE_ATTR_SERVER]=0,e[v.ROLE_ATTR_CUR_POWER]=0,e[v.ROLE_ATTR_POWER_SHOW]=0,e[v.ROLE_ATTR_HEAD_ID]=0,e[v.ROLE_ATTR_HEAD_FRAME_ID]=0,e[v.ROLE_ATTR_HEAD_URL]="",e),n}i(n,t);var a=n.prototype;return a.onInit=function(){var t=this;this.leftName=r.findChildComponent(this.node,"leftName",s),this.rightName=r.findChildComponent(this.node,"rightName",s),this.time=r.findChildComponent(this.node,"time",s),this.stateLeft=r.findChildComponent(this.node,"imgFrameLeft/state",f),this.stateRight=r.findChildComponent(this.node,"imgFrameRight/state",f),this.successState=r.findChildComponent(this.node,"successState",f),this.view.adjustMirrorNode(r.findChild(this.node,"vs"),0,!0),this.headLeftFrame=r.findChildComponent(this.node,"imgFrameLeft/imgHeadFrame",f),this.headRightFrame=r.findChildComponent(this.node,"imgFrameRight/imgHeadFrame",f),this.headLeft=r.findChildComponent(this.node,"imgFrameLeft/imgIcon",f),this.headRight=r.findChildComponent(this.node,"imgFrameRight/imgIcon",f),this.btnGo=r.findChild(this.node,"btnGo"),this.view.addComponentCallbackListener(this.btnGo,o.EventType.CLICK,(function(){IS(g).reqCrossVideoPlay(t.data.vid),battleMain.enterChapter(0),uiMgr.closeAllView(["MainView","MessageView","GuideView","BattleHubView"]),uiMgr.getOpenView("MainView").setIndex(0)})),this.btnShare=r.findChild(this.node,"btnShare"),this.view.addComponentCallbackListener(this.btnShare,o.EventType.CLICK,(function(){t.data.atk_role&&t.data.def_role&&IS(R).SendShareData(_.ChatLinkType.PvpShare,t.data,null,null,u.parkingBattle)})),this.txtBuffLeft=r.findChildComponent(this.node,"btnBuffRight/num",s),this.btnBuffLeft=r.findChild(this.node,"btnBuffRight"),this.view.addComponentCallbackListener(this.btnBuffLeft,o.EventType.CLICK,(function(){if(null!=t.leftBuffId){var i=configPark_pvp_debuff.getDataByKeys("type",t.isAtk?3:4,"num",t.leftBuffId);uiMgr.openView("JobSkillTipsView",l.formatStr.apply(l,[i.debuff_desc].concat(i.desc_parm)),t.btnBuffLeft)}})),this.txtBuffRight=r.findChildComponent(this.node,"btnBuffLeft/num",s),this.btnBuffRight=r.findChild(this.node,"btnBuffLeft"),this.view.addComponentCallbackListener(this.btnBuffRight,o.EventType.CLICK,(function(){if(null!=t.rightBuffId){var i=configPark_pvp_debuff.getDataByKeys("type",t.isAtk?4:3,"num",t.rightBuffId);uiMgr.openView("JobSkillTipsView",l.formatStr.apply(l,[i.debuff_desc].concat(i.desc_parm)),t.btnBuffRight)}}))},a.onRender=function(t,i){this.loadInfo();var e=this.roleInfoLeft,n=this.roleInfoRight;this.leftName.string="["+n[v.ROLE_ATTR_SERVER]+"]"+n[v.ROLE_ATTR_NAME],this.rightName.string="["+e[v.ROLE_ATTR_SERVER]+"]"+e[v.ROLE_ATTR_NAME],this.view.loadIcon(this.stateLeft,"gvg",t.win_id==n[v.ROLE_ATTR_ID]?"gvg_img_shengli":"gvg_img_shibai"),this.view.loadIcon(this.stateRight,"gvg",t.win_id==e[v.ROLE_ATTR_ID]?"gvg_img_shengli":"gvg_img_shibai"),this.time.string=d.formatDate(d.ServerDate(1e3*t.time),"yyyy/MM/dd hh:mm:ss"),this.view.loadRemoteIcon(n[v.ROLE_ATTR_HEAD_URL],this.headLeft),this.view.loadRemoteIcon(e[v.ROLE_ATTR_HEAD_URL],this.headRight);var a=IS(c).curFrameId;if(a>0){var o=configAvatar_frame.getDataByKey(a);this.view.loadIcon(this.headLeftFrame,"icon_frame",o.icon),this.headLeftFrame.node.active=!0}else this.headLeftFrame.node.active=!1;var s=e[v.ROLE_ATTR_HEAD_FRAME_ID];if(s>0){this.headRightFrame.node.active=!0;var f=configAvatar_frame.getDataByKey(s);this.view.loadIcon(this.headRightFrame,"icon_frame",f.icon)}else this.headRightFrame.node.active=!1;var h=t.atk_data_list,r=t.def_data_list;if(this.isAtk||(r=t.atk_data_list,h=t.def_data_list),this.btnBuffLeft.active=!1,r)for(var l=0;l<r.length;l++)if(1==r[l].k&&0!=r[l].v){this.btnBuffLeft.active=!0,this.leftBuffId=r[l].v,this.txtBuffLeft.string=r[l].v;break}if(this.btnBuffRight.active=!1,h)for(var R=0;R<h.length;R++)if(1==h[R].k&&0!=h[R].v){this.btnBuffRight.active=!0,this.rightBuffId=h[R].v,this.txtBuffRight.string=h[R].v;break}},a.loadInfo=function(){var t=this.data.atk_info_list.kv,i=this.data.atk_info_list.ks;if(null!=t)for(var n,a=e(t);!(n=a()).done;){var o=n.value;this.roleInfoRight[o.k]=o.v}if(null!=i)for(var s,f=e(i);!(s=f()).done;){var h=s.value;this.roleInfoRight[h.k]=h.s}var r=this.data.def_info_list.kv,d=this.data.def_info_list.ks;if(null!=t)for(var l,R=e(r);!(l=R()).done;){var u=l.value;this.roleInfoLeft[u.k]=u.v}if(null!=i)for(var _,c=e(d);!(_=c()).done;){var v=_.value;this.roleInfoLeft[v.k]=v.s}},n}(h);n._RF.pop()}}}));

