System.register("chunks:///_virtual/SlotEquip.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./StringUtil.ts","./EquipAsset.ts","./ShenQiAsset.ts","./WingAsset.ts"],(function(i){"use strict";var t,n,s,e,h,a,u,o,l,c,r;return{setters:[function(i){t=i.inheritsLoose,n=i.createForOfIteratorHelperLoose},function(i){s=i.cclegacy,e=i._decorator,h=i.Layers,a=i.Component},function(i){u=i.default},function(i){o=i.default},function(i){l=i.EquipAsset},function(i){c=i.ShenQiAsset},function(i){r=i.WingAsset}],execute:function(){var p;s._RF.push({},"b0cc34KHfRFEKykbY9CGMQr","SlotEquip",void 0);var f=e.ccclass;e.property,i("SlotEquip",f("SlotEquip")(p=function(i){function s(){for(var t,n=arguments.length,s=new Array(n),e=0;e<n;e++)s[e]=arguments[e];return(t=i.call.apply(i,[this].concat(s))||this).unit=void 0,t.bindPos=void 0,t.shenqi=void 0,t.wuqiPath=void 0,t.shenqiAsset=void 0,t.wing=void 0,t.wingPath=void 0,t.wingAsset=void 0,t.zhuangjiao=void 0,t.zhuangjiaoPath=void 0,t.zhuangjiaoAsset=void 0,t.equips=[],t.spec=!1,t}t(s,i);var e=s.prototype;return e.init=function(i,t,n){void 0===n&&(n=!1),this.bindPos=t,this.unit!=i&&(this.unit=i,this.spec=n,this.shenqi=u.findChild(this.node,"model/shenqi"),this.wing=u.findChild(this.node,"model/wing"),this.zhuangjiao=u.findChild(this.node,"model/zhuangjiao"))},e._findPath=function(i){var t=this.unit.findSlot(i);if(!t)return null;for(var n=t.bone.parent,s=n.data.name;n;)(n=n.parent)&&(s=n.data.name+"/"+s);return s},e.checkWuqiPath=function(){null==this.wuqiPath&&(this.wuqiPath=this._findPath("MX_j_wuqi"),this.wuqiPath+="/MX_j_wuqi")},e.checkWingPath=function(){null==this.wingPath&&(this.wingPath=this._findPath("MX_j_chibang"))},e.checkZhuangjiaoPath=function(){null==this.zhuangjiaoPath&&(this.zhuangjiaoPath=this._findPath("zhuangjiao1"))},e.loadEquip=function(i,t){void 0===t&&(t=h.Enum.DEFAULT),this.unload();for(var s,e=n(i);!(s=e()).done;){var a=s.value;if(!(a<=0)){var u=configAppearance.getDataByKey(a);if(null==u&&(u=configSeason_ship_appearance.getDataByKey(a)),null==u||o.isEmpty(u.spine))printLogErr(a,":形象不存在！！");else if(11!=u.part)if(12!=u.part)if(104!=u.part)this.equips.push(l.alloc(this.unit,this.spec?u.spec_spine:u.spine,u.part));else{if(this.checkZhuangjiaoPath(),!this.zhuangjiaoPath)continue;var p=c.alloc(this.unit,u.spine,this.zhuangjiaoPath,this.zhuangjiao);p.layer=t,this.zhuangjiaoAsset=p,this.equips.push(p)}else{if(this.checkWingPath(),!this.wingPath)continue;var f=r.alloc(this.unit,u.spine,this.wingPath,this.wing,this.bindPos);f.layer=t,this.wingAsset=f,this.equips.push(f)}else{if(this.checkWuqiPath(),!this.wuqiPath)continue;var d=c.alloc(this.unit,u.spine,this.wuqiPath,this.shenqi);d.layer=t,this.shenqiAsset=d,this.equips.push(d)}}}},e.unload=function(){if(this.unit&&this.unit.cleanMaterialCache?this.unit.cleanMaterialCache():this.unit&&this.unit._cleanMaterialCache(),null!=this.equips){for(var i,t=n(this.equips);!(i=t()).done;){var s=i.value;null==s||s.free()}this.shenqiAsset=null,this.wingAsset=null,this.zhuangjiaoAsset=null,this.equips.length=0}},s}(a))||p);s._RF.pop()}}}));

