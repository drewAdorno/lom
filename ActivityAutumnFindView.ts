System.register("chunks:///_virtual/ActivityAutumnFindView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemGrid.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ConfigGlobal.ts","./BagModel.ts","./MessageView.ts","./ActivityControl.ts","./ActivityDataCache.ts","./ActivityDefine.ts","./ActivityAutumnDataCache.ts","./BaseView.ts"],(function(t){"use strict";var i,e,n,a,s,o,d,r,c,h,l,v,u,f,m,p,g,w,C,I,S,y,A;return{setters:[function(t){i=t.inheritsLoose,e=t.createForOfIteratorHelperLoose},function(t){n=t.cclegacy,a=t.Button,s=t.HorizontalTextAlignment,o=t.ScrollView,d=t.Sprite,r=t.Label},function(t){c=t.ItemGrid},function(t){h=t.ListItem},function(t){l=t.default},function(t){v=t.default},function(t){u=t.default},null,function(t){f=t.ConfigGlobal},function(t){m=t.BagModel},function(t){p=t.default},function(t){g=t.default},function(t){w=t.default},function(t){C=t.ActivityEventDefine,I=t.ActivityType,S=t.ActivityState},function(t){y=t.default},function(t){A=t.BaseView}],execute:function(){n._RF.push({},"d8e50e2oi5AR4fHbiZVzoEX","ActivityAutumnFindView",void 0);t("default",function(t){function n(){var i;return(i=t.call(this)||this).rewardScroll=void 0,i.taskList=void 0,i.name="ActivityAutumnFindView",i.url="ui/module/autumn/ActivityAutumnFindView",i}i(n,t);var d=n.prototype;return d.onInit=function(){var t=this,i=this.findChild("view/btnClose");this.addComponentCallbackListener(i,a.EventType.CLICK,(function(){t.close()}));var e=this.findChild("view/bg/title/btn");this.addComponentCallbackListener(e,a.EventType.CLICK,(function(){p.showBoxTip({tip:GetLanguage(200744),btnCnt:1,horizontalAlign:s.LEFT})})),this.rewardScroll=this.addUIList(this.findChildComponent("view/reward/reward/rewardScroll",o),G),this.taskList=this.addUIList(this.findChildComponent("view/taskList",o),_)},d.registerUpdateHandler=function(){this.addEvent(C.OnAutumnFindUpdate,this.updateInfo,this)},d.onAfterOpen=function(){IS(g).send_24_52(),this.rewardScroll.datas=f.autumn_search_complete_reward},d.onBeforeClose=function(){},d.onDestroy=function(){},d.updateInfo=function(){for(var t,i=IS(w).GetActivityInfo(I.AutumnFind),n=[],a=configMoonfestival_search.getDatas(),s=e(a);!(t=s()).done;){var o=t.value;o.type==i.type&&o.group_id==i.roundCfg.group_id&&n.push(o)}var d=IS(y).getFindInfo();n.sort((function(t,i){var e,n,a=null!=(e=d.list[t.id])?e:0,s=null!=(n=d.list[i.id])?n:0;return a==s?t.rank_num-i.rank_num:2==a?1:2==s||1==a?-1:1==s?1:void 0})),this.taskList.datas=n,this.rewardScroll.updateAll()},n}(A));var G=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i.received=void 0,i.mask=void 0,i.canGet=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){var t=this;this.received=l.findChild(this.node,"received"),this.mask=l.findChild(this.node,"mask"),this.canGet=l.findChild(this.node,"canGet"),this.itemGridNode=l.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode,(function(){t.canGet.active?IS(g).send_24_53(0):IS(m).OpenItemTips(t.data[0],t.node)}))},n.onRender=function(t,i){this.itemGrid.SetItemId(t[0],t[1]);var e=IS(y).getFindInfo();this.received.active=1==e.total_reward,this.mask.active=1==e.total_reward,this.canGet.active=0==e.total_reward&&IS(y).isAllFind()},e}(h),_=function(t){function n(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).imgTitle=void 0,i.txtState=void 0,i.txtDesc=void 0,i.received=void 0,i.state1=void 0,i.state2=void 0,i.state3=void 0,i.mask=void 0,i.nothing=void 0,i.rewardScroll=void 0,i}i(n,t);var a=n.prototype;return a.onInit=function(){this.imgTitle=l.findChildComponent(this.node,"imgTitle2",d),this.txtDesc=l.findChildComponent(this.node,"txtDesc",r),this.txtState=l.findChildComponent(this.node,"state3/Label",r),this.state1=l.findChild(this.node,"state1"),this.state2=l.findChild(this.node,"state2"),this.state3=l.findChild(this.node,"state3"),this.mask=l.findChild(this.node,"mask"),this.nothing=l.findChild(this.node,"nothing"),this.rewardScroll=this.view.addUIList(l.findChildComponent(this.node,"rewardScroll",o),k)},a.onRender=function(t,i){var n;this.view.loadIcon(this.imgTitle,"autumn_find","zq_ui_xiansuo0"+t.rank_num),this.txtDesc.string=t.clue;for(var a,s=[],o=e(t.clue_reward);!(a=o()).done;){var d=a.value;s.push({id:t.id,reward:d})}this.rewardScroll.datas=s;var r=null!=(n=IS(y).getFindInfo().list[t.id])?n:0;if(this.mask.active=2==r,2==r)this.state1.active=!1,this.state2.active=!0,this.state3.active=!1,this.nothing.active=!1,this.rewardScroll.node.active=!0,this.txtDesc.node.active=!0;else if(0==r){this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,this.nothing.active=!0,this.rewardScroll.node.active=!1,this.txtDesc.node.active=!1;var c=IS(w).GetActivityInfo(I.AutumnFind).state_time[S.Open].start_time+24*(this.data.open_time-1)*3600,h=u.formatDate(new Date(1e3*c),"MM.dd");this.txtState.string=v.formatStrWithMirrorDeal(GetLanguage(201369),h)}else{this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,IS(y).getCurFind()==t.id?(this.state1.active=!0,this.state2.active=!1,this.state3.active=!1,this.nothing.active=!1,this.rewardScroll.node.active=!0,this.txtDesc.node.active=!0):(this.state1.active=!1,this.state2.active=!1,this.state3.active=!0,this.nothing.active=!0,this.rewardScroll.node.active=!1,this.txtDesc.node.active=!1,this.txtState.string=GetLanguage(201370))}},n}(h),k=function(t){function e(){for(var i,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(i=t.call.apply(t,[this].concat(n))||this).itemGridNode=void 0,i.itemGrid=void 0,i.received=void 0,i.mask=void 0,i}i(e,t);var n=e.prototype;return n.onInit=function(){this.received=l.findChild(this.node,"received"),this.mask=l.findChild(this.node,"mask"),this.itemGridNode=l.findChild(this.node,"itemGrid"),this.itemGrid=new c(this.view,this.itemGridNode)},n.onRender=function(t,i){var e;this.itemGrid.SetItemId(t.reward[0],t.reward[1]);var n=null!=(e=IS(y).getFindInfo().list[t.id])?e:0;this.received.active=2==n,this.mask.active=2==n},e}(h);n._RF.pop()}}}));

