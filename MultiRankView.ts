System.register("chunks:///_virtual/MultiRankView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./V2.ts","./UIList.ts","./NodeUtil.ts","./StringUtil.ts","./TimeUtil.ts","./index57.ts","./ChapterDefine.ts","./CommonModel.ts","./FriendControl.ts","./FrameDataCache.ts","./RoleDataCache.ts","./RoleDefine.ts","./BaseView.ts"],(function(n){"use strict";var i,e,t,a,r,o,s,h,l,d,m,k,c,f,g,u,v,_,C,R,p;return{setters:[function(n){i=n.inheritsLoose,e=n.createForOfIteratorHelperLoose},function(n){t=n.cclegacy,a=n.Button,r=n.Sprite,o=n.Label,s=n.ScrollView,h=n.sys},function(n){l=n.V2},function(n){d=n.SelectedType,m=n.ListItem},function(n){k=n.default},function(n){c=n.default},function(n){f=n.default},null,function(n){g=n.DungeonDefine},function(n){u=n.CommonModel},function(n){v=n.default},function(n){_=n.FrameDataCache},function(n){C=n.RoleDataCache},function(n){R=n.PlayerAttr},function(n){p=n.BaseView}],execute:function(){t._RF.push({},"1cc38+ddPtBFp747qRng5zV","MultiRankView",void 0);n("default",function(n){function t(){var i;return(i=n.call(this)||this).rankList=void 0,i.rank1Name=void 0,i.rank1Score=void 0,i.rank1Icon=void 0,i.rank1Head=void 0,i.rank1HeadFrame=void 0,i.rank2Name=void 0,i.rank2Score=void 0,i.rank2Icon=void 0,i.rank2Head=void 0,i.rank2HeadFrame=void 0,i.rank3Name=void 0,i.rank3Score=void 0,i.rank3Icon=void 0,i.rank3Head=void 0,i.rank3HeadFrame=void 0,i.meRankIcon=void 0,i.imgHeadFrame=void 0,i.meRankIndex=void 0,i.meNoRank=void 0,i.meRankScore=void 0,i.meRankName=void 0,i.rank1Role=void 0,i.rank2Role=void 0,i.rank3Role=void 0,i.Rank1Job=void 0,i.Rank2Job=void 0,i.Rank3Job=void 0,i.pos1=new l,i.pos2=new l,i.pos3=new l,i.txtLevel=void 0,i.txtTime=void 0,i.txtTitle=void 0,i.rank_info_list=void 0,i.name="MultiRankView",i.url="ui/module/guildwar/MultiRankView",i.poolTime=3e3,i}i(t,n);var m=t.prototype;return m.onInit=function(){var n=this,i=this.findChild("imgMask");this.addComponentCallbackListener(i,a.EventType.CLICK,(function(){n.close()}));var e=this.findChild("content/btnClose");this.addComponentCallbackListener(e,a.EventType.CLICK,(function(){n.close()})),this.loadIcon(this.findChildComponent("content/mainRank/rank1/imgFrame/rank_icon",r),"friend","hy_ICON_paiming01"),this.loadIcon(this.findChildComponent("content/mainRank/rank2/imgFrame/rank_icon",r),"friend","hy_ICON_paiming02"),this.loadIcon(this.findChildComponent("content/mainRank/rank3/imgFrame/rank_icon",r),"friend","hy_ICON_paiming03"),this.rank1Name=this.findChildComponent("content/mainRank/rank1/name",o),this.rank1Score=this.findChildComponent("content/mainRank/rank1/score",o),this.rank1Icon=this.findChild("content/mainRank/rank1/imgFrame"),this.rank1Head=this.findChildComponent("content/mainRank/rank1/imgFrame/frame/imgIcon",r),this.rank1HeadFrame=this.findChildComponent("content/mainRank/rank1/imgFrame/frame/imgHeadFrame",r),this.addComponentCallbackListener(this.rank1Icon,a.EventType.CLICK,(function(){IS(v).reqOtherRoleNotice(n.rank_info_list[0].role_id)})),this.Rank1Job=this.findChild("content/mainRank/rank1/role");var t=this.findChild("content/mainRank/rank1/role/click");this.addComponentCallbackListener(t,a.EventType.CLICK,(function(){IS(v).reqOtherRoleNotice(n.rank_info_list[0].role_id)})),this.rank2Name=this.findChildComponent("content/mainRank/rank2/name",o),this.rank2Score=this.findChildComponent("content/mainRank/rank2/score",o),this.rank2Icon=this.findChild("content/mainRank/rank2/imgFrame"),this.rank2Head=this.findChildComponent("content/mainRank/rank2/imgFrame/frame/imgIcon",r),this.rank2HeadFrame=this.findChildComponent("content/mainRank/rank2/imgFrame/frame/imgHeadFrame",r),this.addComponentCallbackListener(this.rank2Icon,a.EventType.CLICK,(function(){IS(v).reqOtherRoleNotice(n.rank_info_list[1].role_id)}));var h=this.findChild("content/mainRank/rank2/role/click");this.addComponentCallbackListener(h,a.EventType.CLICK,(function(){IS(v).reqOtherRoleNotice(n.rank_info_list[1].role_id)})),this.Rank2Job=this.findChild("content/mainRank/rank2/role"),this.rank3Name=this.findChildComponent("content/mainRank/rank3/name",o),this.rank3Score=this.findChildComponent("content/mainRank/rank3/score",o),this.rank3Icon=this.findChild("content/mainRank/rank3/imgFrame"),this.rank3HeadFrame=this.findChildComponent("content/mainRank/rank3/imgFrame/frame/imgHeadFrame",r),this.addComponentCallbackListener(this.rank3Icon,a.EventType.CLICK,(function(){IS(v).reqOtherRoleNotice(n.rank_info_list[2].role_id)}));var l=this.findChild("content/mainRank/rank3/role/click");this.addComponentCallbackListener(l,a.EventType.CLICK,(function(){IS(v).reqOtherRoleNotice(n.rank_info_list[2].role_id)})),this.Rank3Job=this.findChild("content/mainRank/rank3/role"),this.rank3Head=this.findChildComponent("content/mainRank/rank3/imgFrame/frame/imgIcon",r);this.findChild("content/mainRank/rankList");var m=this.findChildComponent("content/mainRank/rankList",s);this.rankList=this.addUIList(m,I),this.rankList.selectedMode=d.SINGLE,this.meRankIcon=this.findChildComponent("content/mainRank/meRank/imgFrame/frame/imgIcon",r),this.imgHeadFrame=this.findChildComponent("content/mainRank/meRank/imgFrame/frame/imgHeadFrame",r),this.meRankName=this.findChildComponent("content/mainRank/meRank/name",o),this.meRankIndex=this.findChildComponent("content/mainRank/meRank/rank",o),this.meNoRank=this.findChild("content/mainRank/meRank/no_rank"),this.meRankScore=this.findChildComponent("content/mainRank/meRank/score",o),this.pos1.set(0,-35),this.pos2.set(0,-15),this.pos3.set(0,-15),this.txtLevel=this.findChildComponent("content/nodeTitle/txtLevel",o),this.txtTime=this.findChildComponent("content/nodeTitle/txtTime",o),this.txtTitle=this.findChildComponent("content/nodeTitle/txtTitle",o)},m.onAfterOpen=function(){this.refreshTop3(),this.refreshMyRank(),this.refreshTitle()},m.registerUpdateHandler=function(){},m.refreshTop3=function(){var n=this.openArgs[0],i=n.rank_list.sort((function(n,i){return n.rank>i.rank?1:-1}));if(this.rank_info_list=i,this.rank1Name.string=GetLanguage(200038),this.rank1Score.string="",this.rank1Icon.active=!1,this.rank2Name.string=GetLanguage(200038),this.rank2Score.string="",this.rank2Icon.active=!1,this.rank3Name.string=GetLanguage(200038),this.rank3Score.string="",this.rank3Icon.active=!1,null!=this.rank1Role&&(this.removeUnitModel(this.rank1Role),this.rank1Role=null),null!=this.rank2Role&&(this.removeUnitModel(this.rank2Role),this.rank2Role=null),null!=this.rank3Role&&(this.removeUnitModel(this.rank3Role),this.rank3Role=null),i&&i.length>0){for(var e=n.rank_list[0].figure,t=e.skin_list||[],a=e.hair_figure>0&&e.hair_figure||6,r=e.equip_list.length>0&&IS(u).GetKvListByK(e.equip_list,0)||0,o=e.equip_list.length>1&&IS(u).GetKvListByK(e.equip_list,1)||0,s=e.equip_list.length>2&&IS(u).GetKvListByK(e.equip_list,2)||0,l=0,d=0;d<t.length;d++)2==t[d].k&&(l=t[d].v);var m=e.gender||1;this.rank1Role=this.addUnitModel({job:e.job_figure||1001,dressId:l,gender:m,parent:this.Rank1Job,color:a,weapon:r,ornaments:o,face:s,mount:e.mount_figure||0,shenqi:e.artifact_figure||0}),h.uiMirror&&(this.getUnitModel(this.rank1Role).dir=-1),this.getUnitModel(this.rank1Role).mount=e.mount_figure,this.loadRemoteIcon(n.rank_list[0].role_head.url,this.rank1Head),this.rank1Icon.active=!0,this.rank1Name.string=n.rank_list[0].role_name,this.rank1Score.string=h.uiMirror?c.GetNumString(n.rank_list[0].value)+GetLanguage(200380):GetLanguage(200380)+c.GetNumString(n.rank_list[0].value);var k=n.rank_list[0].role_head.frame_id;if(k>0){this.rank1HeadFrame.node.active=!0;var f=configAvatar_frame.getDataByKey(k);this.loadIcon(this.rank1HeadFrame,"icon_frame",f.icon)}else this.rank1HeadFrame.node.active=!1}if(i&&i.length>1){for(var g=n.rank_list[1].figure,v=g.skin_list||[],_=g.hair_figure>0&&g.hair_figure||6,C=g.equip_list.length>0&&IS(u).GetKvListByK(g.equip_list,0)||0,R=g.equip_list.length>1&&IS(u).GetKvListByK(g.equip_list,1)||0,p=g.equip_list.length>2&&IS(u).GetKvListByK(g.equip_list,2)||0,I=0,L=0;L<v.length;L++)2==v[L].k&&(I=v[L].v);var F=g.gender||1;this.rank2Role=this.addUnitModel({job:g.job_figure||1001,dressId:I,gender:F,parent:this.Rank2Job,color:_,weapon:C,ornaments:R,face:p,mount:g.mount_figure||0,shenqi:g.artifact_figure||0}),h.uiMirror&&(this.getUnitModel(this.rank2Role).dir=-1),this.getUnitModel(this.rank2Role).mount=g.mount_figure,this.loadRemoteIcon(n.rank_list[1].role_head.url,this.rank2Head),this.rank2Icon.active=!0,this.rank2Name.string=n.rank_list[1].role_name,this.rank2Score.string=h.uiMirror?c.GetNumString(n.rank_list[1].value)+GetLanguage(200380):GetLanguage(200380)+c.GetNumString(n.rank_list[1].value);var S=n.rank_list[1].role_head.frame_id;if(S>0){this.rank2HeadFrame.node.active=!0;var y=configAvatar_frame.getDataByKey(S);this.loadIcon(this.rank2HeadFrame,"icon_frame",y.icon)}else this.rank2HeadFrame.node.active=!1}if(i&&i.length>2){for(var H=n.rank_list[2].figure,N=H.hair_figure>0&&H.hair_figure||6,G=H.equip_list.length>0&&IS(u).GetKvListByK(H.equip_list,0)||0,M=H.equip_list.length>1&&IS(u).GetKvListByK(H.equip_list,1)||0,K=H.equip_list.length>2&&IS(u).GetKvListByK(H.equip_list,2)||0,T=H.skin_list||[],b=0,q=0;q<T.length;q++)2==T[q].k&&(b=T[q].v);var x=H.gender||1;this.rank3Role=this.addUnitModel({job:H.job_figure||1001,dressId:b,gender:x,parent:this.Rank3Job,color:N,weapon:G,ornaments:M,face:K,mount:H.mount_figure,shenqi:H.artifact_figure||0}),h.uiMirror&&(this.getUnitModel(this.rank3Role).dir=-1),this.getUnitModel(this.rank3Role).mount=H.mount_figure,this.loadRemoteIcon(n.rank_list[2].role_head.url,this.rank3Head),this.rank3Icon.active=!0,this.rank3Name.string=n.rank_list[2].role_name,this.rank3Score.string=h.uiMirror?c.GetNumString(n.rank_list[2].value)+GetLanguage(200380):GetLanguage(200380)+c.GetNumString(n.rank_list[2].value);var B=n.rank_list[2].role_head.frame_id;if(B>0){this.rank3HeadFrame.node.active=!0;var w=configAvatar_frame.getDataByKey(B);this.loadIcon(this.rank3HeadFrame,"icon_frame",w.icon)}else this.rank3HeadFrame.node.active=!1}for(var U=new Array,D=0;D<n.rank_list.length;D++)D>2&&U.push({info:n.rank_list[D]});this.rankList.datas=U},m.refreshMyRank=function(){var n=this.openArgs[0].my_rank;this.meNoRank.active=n.rank<=0,n.rank>0?this.meRankIndex.string=n.rank+"":this.meRankIndex.string="";var i=IS(C).GetRoleAttr(R.ROLE_ATTR_HEAD_URL);this.loadRemoteIcon(i,this.meRankIcon);var e=IS(_).curFrameId;if(e>0){var t=configAvatar_frame.getDataByKey(e);this.loadIcon(this.imgHeadFrame,"icon_frame",t.icon),this.imgHeadFrame.node.active=!0}else this.imgHeadFrame.node.active=!1;this.meRankName.string=n.role_name,this.meRankScore.string=h.uiMirror?c.GetNumString(n.value)+GetLanguage(200380):GetLanguage(200380)+c.GetNumString(n.value)},m.refreshTitle=function(){this.txtTitle.string=configChapter_type.getDataByKey(g.CHAPTER_TYPE_LEAGUE_GVE).name;for(var n,i=this.openArgs[0].ext,t=e(i);!(n=t()).done;){var a=n.value,r=a.k,o=a.v;1==r?this.txtTime.string=f.formatDate(new Date(1e3*o),"MM/dd hh:mm"+f.GetServerTimeZoneStr()):2==r&&(this.txtLevel.string=c.formatStrWithMirrorDeal(GetLanguage(300182),o))}},m.onBeforeClose=function(){},m.onDestroy=function(){},t}(p));var I=function(n){function e(){for(var i,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(i=n.call.apply(n,[this].concat(t))||this).imgFrame=void 0,i.imgIcon=void 0,i.imgHeadFrame=void 0,i.txtScore=void 0,i.txtRank=void 0,i.txtName=void 0,i.btnHead=void 0,i}i(e,n);var t=e.prototype;return t.onInit=function(){var n=this;this.imgFrame=k.findChildComponent(this.node,"imgFrame",r),this.imgIcon=k.findChildComponent(this.node,"imgFrame/frame/imgIcon",r),this.imgHeadFrame=k.findChildComponent(this.node,"imgFrame/frame/imgHeadFrame",r),this.txtScore=k.findChildComponent(this.node,"score",o),this.txtRank=k.findChildComponent(this.node,"rank",o),this.txtName=k.findChildComponent(this.node,"name",o),this.btnHead=k.findChild(this.node,"imgFrame"),this.view.addComponentCallbackListener(this.btnHead,a.EventType.CLICK,(function(){n.onItemClick()}))},t.onRender=function(n,i){var e=GetLanguage(200380);this.view.loadRemoteIcon(n.info.role_head.url,this.imgIcon),this.txtRank.string=n.info.rank,this.txtScore.string=h.uiMirror?c.GetNumString(n.info.value)+e:e+c.GetNumString(n.info.value),this.txtName.string=n.info.role_name;var t=n.info.role_head.frame_id;if(t>0){this.imgHeadFrame.node.active=!0;var a=configAvatar_frame.getDataByKey(t);this.view.loadIcon(this.imgHeadFrame,"icon_frame",a.icon)}else this.imgHeadFrame.node.active=!1},t.onItemClick=function(){IS(v).reqOtherRoleNotice(this.data.info.role_id)},e}(m);t._RF.pop()}}}));

