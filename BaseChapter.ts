System.register("chunks:///_virtual/BaseChapter.ts",["cc","./FixMath.ts","./BattleData.ts","./UnitGroupCtr.ts","./EnumDefine.ts"],(function(t){"use strict";var e,i,a,s,h;return{setters:[function(t){e=t.cclegacy},function(t){i=t.FixMath},function(t){a=t.ChapterType},function(t){s=t.UnitGroupCtr},function(t){h=t.UnityType}],execute:function(){e._RF.push({},"ac685BLB2ZHVJl/sUEMznWN","BaseChapter",void 0);t("BaseChapter",function(){function t(t){this.battleMain=void 0,this.config=void 0,this.chapterTime=0,this.timeModel=!1,this.maxChapterTime=0,this.mapConfig=void 0,this.over=!1,this.nextPartState=0,this.battleMain=t}var e=t.prototype;return e.setChapter=function(t,e){void 0===e&&(e=!1);var i=this.battleMain;this.config=this.getConfig(t),this.mapConfig=configMap.getDataByKey(this.config.map);var s=configChapter_type.getDataByKey(i.data.chapterType);if(e||1!=s.time_type){if(GlobalDefine.CLIENT_TYPE)this.chapterTime=this.config.time;else switch(i.data.chapterType){case a.Main:this.chapterTime=this.config.time>0?this.config.time:40;break;case a.Coin:case a.Diamond:case a.Mount:case a.Fate:this.chapterTime=this.config.time>0?this.config.time:30;break;case a.Arena:this.chapterTime=this.config.time>0?this.config.time:40;break;case a.Team3:this.chapterTime=this.config.time>0?this.config.time:90;break;case a.Team20:case a.WorldBoss:this.chapterTime=this.config.time>0?this.config.time:600;break;case a.Solo:this.chapterTime=this.config.time>0?this.config.time:30;break;case a.Gvg:case a.CrossPvp:case a.StrategyActivity:case a.CrossWarPvp:case a.CrossWarMonster:case a.Farm:case a.ParkPvp:this.chapterTime=this.config.time>0?this.config.time:120;break;case a.ArtifactGem:case a.Seven:case a.Slave:this.chapterTime=this.config.time>0?this.config.time:30;break;case a.CrossParkPvp:case a.SeasonPvp:this.chapterTime=this.config.time>0?this.config.time:120;break;default:this.chapterTime=this.config.time}this.battleMain.printLogFlag&&this.battleMain.printLogDebug("chapterType "+i.data.chapterType+", chapterId "+i.data.chapterId+", chapterTime "+this.chapterTime),this.maxChapterTime=this.chapterTime,this.timeModel=this.chapterTime>0}},e.loadData=function(t){var e=this.battleMain,i=new s;i.offsetY=160;var a=e.data.playerList[1].units;i.playerData=e.data.playerList[1];for(var r=0;r<a.length;r++){var c=e.unitMgr.addPlayer(a[r]);c.config.type==h.Player&&(i.player=c),c.config.type==h.FlyPet&&(i.player.flyPet=c),i.units.push(c)}i.positionSelected(t,!0),e.playerCtrs.push(i),e.mainCtr=i,e.showMainCtr=i},e.updateTime=function(t){if(this.timeModel){if(this.chapterTime<=0)return this.over=!0,this.toResult(1,!0),!0;this.chapterTime=i.round(this.chapterTime-t),this.chapterTime=Math.max(this.chapterTime,0)}return!1},e.toNextPart=function(t){},e.onEndDrawUpdate=function(){},t}());e._RF.pop()}}}));

